/*******************************************************************************
 * Copyright 2017 Adobe Systems Incorporated
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
if (window.Element && !Element.prototype.closest) {
    // eslint valid-jsdoc: "off"
    Element.prototype.closest =
        function(s) {
            "use strict";
            var matches = (this.document || this.ownerDocument).querySelectorAll(s);
            var el      = this;
            var i;
            do {
                i = matches.length;
                while (--i >= 0 && matches.item(i) !== el) {
                    // continue
                }
            } while ((i < 0) && (el = el.parentElement));
            return el;
        };
}

if (window.Element && !Element.prototype.matches) {
    Element.prototype.matches =
        Element.prototype.matchesSelector ||
        Element.prototype.mozMatchesSelector ||
        Element.prototype.msMatchesSelector ||
        Element.prototype.oMatchesSelector ||
        Element.prototype.webkitMatchesSelector ||
        function(s) {
            "use strict";
            var matches = (this.document || this.ownerDocument).querySelectorAll(s);
            var i       = matches.length;
            while (--i >= 0 && matches.item(i) !== this) {
                // continue
            }
            return i > -1;
        };
}

if (!Object.assign) {
    Object.assign = function(target, varArgs) { // .length of function is 2
        "use strict";
        if (target === null) {
            throw new TypeError("Cannot convert undefined or null to object");
        }

        var to = Object(target);

        for (var index = 1; index < arguments.length; index++) {
            var nextSource = arguments[index];

            if (nextSource !== null) {
                for (var nextKey in nextSource) {
                    if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                        to[nextKey] = nextSource[nextKey];
                    }
                }
            }
        }
        return to;
    };
}

(function(arr) {
    "use strict";
    arr.forEach(function(item) {
        if (item.hasOwnProperty("remove")) {
            return;
        }
        Object.defineProperty(item, "remove", {
            configurable: true,
            enumerable: true,
            writable: true,
            value: function remove() {
                this.parentNode.removeChild(this);
            }
        });
    });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);

/*******************************************************************************
 * Copyright 2016 Adobe Systems Incorporated
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var NS = "cmp";
    var IS = "image";

    var EMPTY_PIXEL = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
    var LAZY_THRESHOLD = 0;
    var SRC_URI_TEMPLATE_WIDTH_VAR = "{.width}";

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]',
        image: '[data-cmp-hook-image="image"]',
        map: '[data-cmp-hook-image="map"]',
        area: '[data-cmp-hook-image="area"]'
    };

    var lazyLoader = {
        "cssClass": "cmp-image__image--is-loading",
        "style": {
            "height": 0,
            "padding-bottom": "" // will be replaced with % ratio
        }
    };

    var properties = {
        /**
         * An array of alternative image widths (in pixels).
         * Used to replace a {.width} variable in the src property with an optimal width if a URI template is provided.
         *
         * @memberof Image
         * @type {Number[]}
         * @default []
         */
        "widths": {
            "default": [],
            "transform": function(value) {
                var widths = [];
                value.split(",").forEach(function(item) {
                    item = parseFloat(item);
                    if (!isNaN(item)) {
                        widths.push(item);
                    }
                });
                return widths;
            }
        },
        /**
         * Indicates whether the image should be rendered lazily.
         *
         * @memberof Image
         * @type {Boolean}
         * @default false
         */
        "lazy": {
            "default": false,
            "transform": function(value) {
                return !(value === null || typeof value === "undefined");
            }
        },
        /**
         * The image source.
         *
         * Can be a simple image source, or a URI template representation that
         * can be variable expanded - useful for building an image configuration with an alternative width.
         * e.g. '/path/image.coreimg{.width}.jpeg/1506620954214.jpeg'
         *
         * @memberof Image
         * @type {String}
         */
        "src": {
        }
    };

    var devicePixelRatio = window.devicePixelRatio || 1;

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function Image(config) {
        var that = this;

        function init(config) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");

            setupProperties(config.options);
            cacheElements(config.element);

            if (!that._elements.noscript) {
                return;
            }

            that._elements.container = that._elements.link ? that._elements.link : that._elements.self;

            unwrapNoScript();

            if (that._properties.lazy) {
                addLazyLoader();
            }

            if (that._elements.map) {
                that._elements.image.addEventListener("load", onLoad);
            }

            window.addEventListener("scroll", that.update);
            window.addEventListener("resize", onWindowResize);
            window.addEventListener("update", that.update);
            that._elements.image.addEventListener("cmp-image-redraw", that.update);
            that.update();
        }

        function loadImage() {
            var hasWidths = that._properties.widths && that._properties.widths.length > 0;
            var replacement = hasWidths ? "." + getOptimalWidth() : "";
            var url = that._properties.src.replace(SRC_URI_TEMPLATE_WIDTH_VAR, replacement);

            if (that._elements.image.getAttribute("src") !== url) {
                that._elements.image.setAttribute("src", url);
                if (!hasWidths) {
                    window.removeEventListener("scroll", that.update);
                }
            }

            if (that._lazyLoaderShowing) {
                that._elements.image.addEventListener("load", removeLazyLoader);
            }
        }

        function getOptimalWidth() {
            var container = that._elements.self;
            var containerWidth = container.clientWidth;
            while (containerWidth === 0 && container.parentNode) {
                container = container.parentNode;
                containerWidth = container.clientWidth;
            }
            var optimalWidth = containerWidth * devicePixelRatio;
            var len = that._properties.widths.length;
            var key = 0;

            while ((key < len - 1) && (that._properties.widths[key] < optimalWidth)) {
                key++;
            }

            return that._properties.widths[key].toString();
        }

        function addLazyLoader() {
            var width = that._elements.image.getAttribute("width");
            var height = that._elements.image.getAttribute("height");

            if (width && height) {
                var ratio = (height / width) * 100;
                var styles = lazyLoader.style;

                styles["padding-bottom"] = ratio + "%";

                for (var s in styles) {
                    if (styles.hasOwnProperty(s)) {
                        that._elements.image.style[s] = styles[s];
                    }
                }
            }
            that._elements.image.setAttribute("src", EMPTY_PIXEL);
            that._elements.image.classList.add(lazyLoader.cssClass);
            that._lazyLoaderShowing = true;
        }

        function unwrapNoScript() {
            var markup = decodeNoscript(that._elements.noscript.textContent.trim());
            var parser = new DOMParser();

            // temporary document avoids requesting the image before removing its src
            var temporaryDocument = parser.parseFromString(markup, "text/html");
            var imageElement = temporaryDocument.querySelector(selectors.image);
            imageElement.removeAttribute("src");
            that._elements.container.insertBefore(imageElement, that._elements.noscript);

            var mapElement = temporaryDocument.querySelector(selectors.map);
            if (mapElement) {
                that._elements.container.insertBefore(mapElement, that._elements.noscript);
            }

            that._elements.noscript.parentNode.removeChild(that._elements.noscript);
            if (that._elements.container.matches(selectors.image)) {
                that._elements.image = that._elements.container;
            } else {
                that._elements.image = that._elements.container.querySelector(selectors.image);
            }

            that._elements.map = that._elements.container.querySelector(selectors.map);
            that._elements.areas = that._elements.container.querySelectorAll(selectors.area);
        }

        function removeLazyLoader() {
            that._elements.image.classList.remove(lazyLoader.cssClass);
            for (var property in lazyLoader.style) {
                if (lazyLoader.style.hasOwnProperty(property)) {
                    that._elements.image.style[property] = "";
                }
            }
            that._elements.image.removeEventListener("load", removeLazyLoader);
            that._lazyLoaderShowing = false;
        }

        function isLazyVisible() {
            if (that._elements.container.offsetParent === null) {
                return false;
            }

            var wt = window.pageYOffset;
            var wb = wt + document.documentElement.clientHeight;
            var et = that._elements.container.getBoundingClientRect().top + wt;
            var eb = et + that._elements.container.clientHeight;

            return eb >= wt - LAZY_THRESHOLD && et <= wb + LAZY_THRESHOLD;
        }

        function resizeAreas() {
            if (that._elements.areas && that._elements.areas.length > 0) {
                for (var i = 0; i < that._elements.areas.length; i++) {
                    var width = that._elements.image.width;
                    var height = that._elements.image.height;

                    if (width && height) {
                        var relcoords = that._elements.areas[i].dataset.cmpRelcoords;
                        if (relcoords) {
                            var relativeCoordinates = relcoords.split(",");
                            var coordinates = new Array(relativeCoordinates.length);

                            for (var j = 0; j < coordinates.length; j++) {
                                if (j % 2 === 0) {
                                    coordinates[j] = parseInt(relativeCoordinates[j] * width);
                                } else {
                                    coordinates[j] = parseInt(relativeCoordinates[j] * height);
                                }
                            }

                            that._elements.areas[i].coords = coordinates;
                        }
                    }
                }
            }
        }

        function cacheElements(wrapper) {
            that._elements = {};
            that._elements.self = wrapper;
            var hooks = that._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

            for (var i = 0; i < hooks.length; i++) {
                var hook = hooks[i];
                var capitalized = IS;
                capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
                var key = hook.dataset[NS + "Hook" + capitalized];
                that._elements[key] = hook;
            }
        }

        function setupProperties(options) {
            that._properties = {};

            for (var key in properties) {
                if (properties.hasOwnProperty(key)) {
                    var property = properties[key];
                    if (options && options[key] != null) {
                        if (property && typeof property.transform === "function") {
                            that._properties[key] = property.transform(options[key]);
                        } else {
                            that._properties[key] = options[key];
                        }
                    } else {
                        that._properties[key] = properties[key]["default"];
                    }
                }
            }
        }

        function onWindowResize() {
            that.update();
            resizeAreas();
        }

        function onLoad() {
            resizeAreas();
        }

        that.update = function() {
            if (that._properties.lazy) {
                if (isLazyVisible()) {
                    loadImage();
                }
            } else {
                loadImage();
            }
        };

        if (config && config.element) {
            init(config);
        }
    }

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Image({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body             = document.querySelector("body");
        var observer         = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Image({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

    /*
        on drag & drop of the component into a parsys, noscript's content will be escaped multiple times by the editor which creates
        the DOM for editing; the HTML parser cannot be used here due to the multiple escaping
     */
    function decodeNoscript(text) {
        text = text.replace(/&(amp;)*lt;/g, "<");
        text = text.replace(/&(amp;)*gt;/g, ">");
        return text;
    }

})();

if (window.Element && !Element.prototype.closest) {
    Element.prototype.closest =
        function (s) {
            'use strict';
            var matches = (this.document || this.ownerDocument).querySelectorAll(s),
                el      = this,
                i;
            do {
                i = matches.length;
                while (--i >= 0 && matches.item(i) !== el) {
                }
            } while ((i < 0) && (el = el.parentElement));
            return el;
        };
}

if (window.Element && !Element.prototype.matches) {
    Element.prototype.matches =
        Element.prototype.matchesSelector ||
        Element.prototype.mozMatchesSelector ||
        Element.prototype.msMatchesSelector ||
        Element.prototype.oMatchesSelector ||
        Element.prototype.webkitMatchesSelector ||
        function (s) {
            'use strict';
            var matches = (this.document || this.ownerDocument).querySelectorAll(s),
                i       = matches.length;
            while (--i >= 0 && matches.item(i) !== this) {
            }
            return i > -1;
        };
}

if (!Object.assign) {
    Object.assign = function (target, varArgs) { // .length of function is 2
        'use strict';
        if (target === null) {
            throw new TypeError('Cannot convert undefined or null to object');
        }

        var to = Object(target);

        for (var index = 1; index < arguments.length; index++) {
            var nextSource = arguments[index];

            if (nextSource !== null) {
                for (var nextKey in nextSource) {
                    if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                        to[nextKey] = nextSource[nextKey];
                    }
                }
            }
        }
        return to;
    };
}

(function (arr) {
    'use strict';
    arr.forEach(function (item) {
        if (item.hasOwnProperty('remove')) {
            return;
        }
        Object.defineProperty(item, 'remove', {
            configurable: true,
            enumerable: true,
            writable: true,
            value: function remove() {
                this.parentNode.removeChild(this);
            }
        });
    });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);


(function () {
    'use strict';

    var NS = 'cmp';
    var IS = 'image';

    var EMPTY_PIXEL = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
    var LAZY_THRESHOLD = 0;
    var SRC_URI_TEMPLATE_WIDTH_VAR = '{.width}';

    var selectors = {
        self : '[data-' + NS + '-is="' + IS +'"]',
        image : '[data-cmp-hook-image="image"]'
    };

    var lazyLoader = {
        'cssClass' : 'cmp-image__image--is-loading',
        'style' : {
            'height': 0,
            'padding-bottom': '' // will be replaced with % ratio
        }
    };

    var properties = {
        /**
         * An array of alternative image widths (in pixels).
         * Used to replace a {.width} variable in the src property with an optimal width if a URI template is provided.
         */
        'widths': {
            'default' : [],
            'transform' : function(value) {
                // number[]
                var widths = [];
                value.split(',').forEach(function(item) {
                    item = parseFloat(item);
                    if (!isNaN(item)) {
                        widths.push(item);
                    }
                });
                return widths;
            }
        },
        /**
         * Indicates whether the image should be rendered lazily.
         */
        'lazy': {
            'default': false,
            'transform': function(value) {
                // boolean
                return !(value === null || typeof value === 'undefined');
            }
        },
        /**
         * The image source.
         *
         * Can be a simple image source, or a URI template representation that
         * can be variable expanded - useful for building an image configuration with an alternative width.
         * e.g. '/path/image.coreimg{.width}.jpeg/1506620954214.jpeg'
         */
        'src': {
        }
    };

    var devicePixelRatio = window.devicePixelRatio || 1;

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ['is', 'hook' + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function Image(config) {
        var that = this;

        function init(config) {
            // prevents multiple initialization
            config.element.removeAttribute('data-' + NS + '-is');

            setupProperties(config.options);
            cacheElements(config.element);

            if (!that._elements.noscript) {
                return;
            }

            that._elements.container = that._elements.link ? that._elements.link : that._elements.self;

            unwrapNoScript();

            if (that._properties.lazy) {
                addLazyLoader();
            }

            window.addEventListener('scroll', that.update);
            window.addEventListener('resize', that.update);
            window.addEventListener('update', that.update);
            that._elements.image.addEventListener('cmp-image-redraw', that.update);
            that.update();
        }

        function loadImage() {
            var hasWidths = that._properties.widths && that._properties.widths.length > 0;
            var replacement = hasWidths ? '.' + getOptimalWidth() : '';
            var url = that._properties.src.replace(SRC_URI_TEMPLATE_WIDTH_VAR, replacement);

            if (that._elements.image.getAttribute('src') !== url) {
                that._elements.image.setAttribute('src', url);
                if (!hasWidths) {
                    window.removeEventListener('scroll', that.update);
                }
            }

            if (that._lazyLoaderShowing) {
                that._elements.image.addEventListener('load', removeLazyLoader);
            }
        }

        function getOptimalWidth() {
            var containerWidth = that._elements.self.clientWidth;
            var optimalWidth = containerWidth * devicePixelRatio;
            var len = that._properties.widths.length;
            var key = 0;

            while ((key < len-1) && (that._properties.widths[key] < optimalWidth)) {
                key++;
            }

            return that._properties.widths[key].toString();
        }

        function addLazyLoader() {
            var width = that._elements.image.getAttribute('width'); 
            var height = that._elements.image.getAttribute('height');

            if (width && height) {
                var ratio = (height / width) * 100;
                var styles = lazyLoader.style;

                styles['padding-bottom'] = ratio + '%';

                for (var s in styles) {
                    if (styles.hasOwnProperty(s)) {
                        that._elements.image.style[s] = styles[s];
                    }
                }
            }
            that._elements.image.setAttribute('src', EMPTY_PIXEL);
            that._elements.image.classList.add(lazyLoader.cssClass);
            that._lazyLoaderShowing = true;
        }

        function unwrapNoScript() {
            var markup = decodeNoscript(that._elements.noscript.textContent.trim());
            var parser = new DOMParser();

            // temporary document avoids requesting the image before removing its src
            var temporaryDocument = parser.parseFromString(markup, "text/html");
            var imageElement = temporaryDocument.querySelector(selectors.image);
            imageElement.removeAttribute('src');

            that._elements.container.insertBefore(imageElement, that._elements.noscript);
            that._elements.noscript.parentNode.removeChild(that._elements.noscript);
            if (that._elements.container.matches(selectors.image)) {
                that._elements.image = that._elements.container;
            } else {
                that._elements.image = that._elements.container.querySelector(selectors.image);
            }
        }

        function removeLazyLoader() {
            that._elements.image.classList.remove(lazyLoader.cssClass);
            for (var property in lazyLoader.style) {
                if (lazyLoader.style.hasOwnProperty(property)) {
                    that._elements.image.style[property] = '';
                }
            }
            that._elements.image.removeEventListener('load', removeLazyLoader);
            that._lazyLoaderShowing = false;
        }

        function isLazyVisible() {
            if (that._elements.container.offsetParent === null) {
                return false;
            }

            var wt = window.pageYOffset,
                wb = wt + document.documentElement.clientHeight,
                et = that._elements.container.getBoundingClientRect().top + wt,
                eb = et + that._elements.container.clientHeight;

            return eb >= wt - LAZY_THRESHOLD && et <= wb + LAZY_THRESHOLD;
        }

        function cacheElements(wrapper) {
            that._elements = {};
            that._elements.self = wrapper;
            var hooks = that._elements.self.querySelectorAll('[data-' + NS + '-hook-' + IS + ']');

            for (var i = 0; i < hooks.length; i++) {
                var hook = hooks[i];
                var capitalized = IS;
                capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
                var key = hook.dataset[NS + 'Hook' + capitalized];
                that._elements[key] = hook;
            }
        }

        function setupProperties(options) {
            that._properties = {};

            for (var key in properties) {
                if (properties.hasOwnProperty(key)) {
                    var property = properties[key];
                    if (options && options[key] != null) {
                        if (property && typeof property.transform === 'function') {
                            that._properties[key] = property.transform(options[key]);
                        } else {
                            that._properties[key] = options[key];
                        }
                    } else {
                        that._properties[key] = properties[key]['default'];
                    }
                }
            }
        }

        that.update = function () {
            if (that._properties.lazy) {
                if (isLazyVisible()) {
                    loadImage();
                }
            } else {
                loadImage();
            }
        };

        if (config.element) {
            init(config);
        }
    }

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Image({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body             = document.querySelector('body');
        var observer         = new MutationObserver(function (mutations) {
            mutations.forEach(function (mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function (addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function (element) {
                                new Image({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree      : true,
            childList    : true,
            characterData: true
        });
    }

    if (document.readyState != 'loading'){
        onDocumentReady();
    } else {
        document.addEventListener('DOMContentLoaded', onDocumentReady());
    }

    /*
        on drag & drop of the component into a parsys, noscript's content will be escaped multiple times by the editor which creates
        the DOM for editing; the HTML parser cannot be used here due to the multiple escaping
     */
    function decodeNoscript(text){
        text = text.replace(/&(amp;)*lt;/g, '<');
        text = text.replace(/&(amp;)*gt;/g, '>');
        return text;
    }

})();

/*******************************************************************************
 * Copyright 2017 Adobe Systems Incorporated
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var NS = "cmp";
    var IS = "search";

    var DELAY = 300; // time before fetching new results when the user is typing a search string
    var LOADING_DISPLAY_DELAY = 300; // minimum time during which the loading indicator is displayed
    var PARAM_RESULTS_OFFSET = "resultsOffset";

    var keyCodes = {
        TAB: 9,
        ENTER: 13,
        ESCAPE: 27,
        ARROW_UP: 38,
        ARROW_DOWN: 40
    };

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]',
        item: {
            self: "[data-" + NS + "-hook-" + IS + '="item"]',
            title: "[data-" + NS + "-hook-" + IS + '="itemTitle"]',
            focused: "." + NS + "-search__item--is-focused"
        }
    };

    var properties = {
        /**
         * The minimum required length of the search term before results are fetched.
         *
         * @memberof Search
         * @type {Number}
         * @default 3
         */
        minLength: {
            "default": 3,
            transform: function(value) {
                value = parseFloat(value);
                return isNaN(value) ? null : value;
            }
        },
        /**
         * The maximal number of results fetched by a search request.
         *
         * @memberof Search
         * @type {Number}
         * @default 10
         */
        resultsSize: {
            "default": 10,
            transform: function(value) {
                value = parseFloat(value);
                return isNaN(value) ? null : value;
            }
        }
    };

    var idCount = 0;

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function toggleShow(element, show) {
        if (element) {
            if (show !== false) {
                element.style.display = "block";
                element.setAttribute("aria-hidden", false);
            } else {
                element.style.display = "none";
                element.setAttribute("aria-hidden", true);
            }
        }
    }

    function serialize(form) {
        var query = [];
        if (form && form.elements) {
            for (var i = 0; i < form.elements.length; i++) {
                var node = form.elements[i];
                if (!node.disabled && node.name) {
                    var param = [node.name, encodeURIComponent(node.value)];
                    query.push(param.join("="));
                }
            }
        }
        return query.join("&");
    }

    function mark(node, regex) {
        if (!node || !regex) {
            return;
        }

        // text nodes
        if (node.nodeType === 3) {
            var nodeValue = node.nodeValue;
            var match = regex.exec(nodeValue);

            if (nodeValue && match) {
                var element = document.createElement("mark");
                element.className = NS + "-search__item-mark";
                element.appendChild(document.createTextNode(match[0]));

                var after = node.splitText(match.index);
                after.nodeValue = after.nodeValue.substring(match[0].length);
                node.parentNode.insertBefore(element, after);
            }
        } else if (node.hasChildNodes()) {
            for (var i = 0; i < node.childNodes.length; i++) {
                // recurse
                mark(node.childNodes[i], regex);
            }
        }
    }

    function Search(config) {
        if (config.element) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");
        }

        this._cacheElements(config.element);
        this._setupProperties(config.options);

        this._action = this._elements.form.getAttribute("action");
        this._resultsOffset = 0;
        this._hasMoreResults = true;

        this._elements.input.addEventListener("input", this._onInput.bind(this));
        this._elements.input.addEventListener("focus", this._onInput.bind(this));
        this._elements.input.addEventListener("keydown", this._onKeydown.bind(this));
        this._elements.clear.addEventListener("click", this._onClearClick.bind(this));
        document.addEventListener("click", this._onDocumentClick.bind(this));
        this._elements.results.addEventListener("scroll", this._onScroll.bind(this));

        this._makeAccessible();
    }

    Search.prototype._displayResults = function() {
        if (this._elements.input.value.length === 0) {
            toggleShow(this._elements.clear, false);
            this._cancelResults();
        } else if (this._elements.input.value.length < this._properties.minLength) {
            toggleShow(this._elements.clear, true);
        } else {
            this._updateResults();
            toggleShow(this._elements.clear, true);
        }
    };

    Search.prototype._onScroll = function(event) {
        // fetch new results when the results to be scrolled down are less than the visible results
        if (this._elements.results.scrollTop + 2 * this._elements.results.clientHeight >= this._elements.results.scrollHeight) {
            this._resultsOffset += this._properties.resultsSize;
            this._displayResults();
        }
    };

    Search.prototype._onInput = function(event) {
        var self = this;
        self._cancelResults();
        // start searching when the search term reaches the minimum length
        this._timeout = setTimeout(function() {
            self._displayResults();
        }, DELAY);
    };

    Search.prototype._onKeydown = function(event) {
        var self = this;

        switch (event.keyCode) {
            case keyCodes.TAB:
                if (self._resultsOpen()) {
                    event.preventDefault();
                }
                break;
            case keyCodes.ENTER:
                event.preventDefault();
                if (self._resultsOpen()) {
                    var focused = self._elements.results.querySelector(selectors.item.focused);
                    if (focused) {
                        focused.click();
                    }
                }
                break;
            case keyCodes.ESCAPE:
                self._cancelResults();
                break;
            case keyCodes.ARROW_UP:
                if (self._resultsOpen()) {
                    event.preventDefault();
                    self._stepResultFocus(true);
                }
                break;
            case keyCodes.ARROW_DOWN:
                if (self._resultsOpen()) {
                    event.preventDefault();
                    self._stepResultFocus();
                } else {
                    // test the input and if necessary fetch and display the results
                    self._onInput();
                }
                break;
            default:
                return;
        }
    };

    Search.prototype._onClearClick = function(event) {
        event.preventDefault();
        this._elements.input.value = "";
        toggleShow(this._elements.clear, false);
        toggleShow(this._elements.results, false);
    };

    Search.prototype._onDocumentClick = function(event) {
        var inputContainsTarget =  this._elements.input.contains(event.target);
        var resultsContainTarget = this._elements.results.contains(event.target);

        if (!(inputContainsTarget || resultsContainTarget)) {
            toggleShow(this._elements.results, false);
        }
    };

    Search.prototype._resultsOpen = function() {
        return this._elements.results.style.display !== "none";
    };

    Search.prototype._makeAccessible = function() {
        var id = NS + "-search-results-" + idCount;
        this._elements.input.setAttribute("aria-owns", id);
        this._elements.results.id = id;
        idCount++;
    };

    Search.prototype._generateItems = function(data, results) {
        var self = this;

        data.forEach(function(item) {
            var el = document.createElement("span");
            el.innerHTML = self._elements.itemTemplate.innerHTML;
            el.querySelectorAll(selectors.item.title)[0].appendChild(document.createTextNode(item.title));
            el.querySelectorAll(selectors.item.self)[0].setAttribute("href", item.url);
            results.innerHTML += el.innerHTML;
        });
    };

    Search.prototype._markResults = function() {
        var nodeList = this._elements.results.querySelectorAll(selectors.item.self);
        var escapedTerm = this._elements.input.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");
        var regex = new RegExp("(" + escapedTerm + ")", "gi");

        for (var i = this._resultsOffset - 1; i < nodeList.length; ++i) {
            var result = nodeList[i];
            mark(result, regex);
        }
    };

    Search.prototype._stepResultFocus = function(reverse) {
        var results = this._elements.results.querySelectorAll(selectors.item.self);
        var focused = this._elements.results.querySelector(selectors.item.focused);
        var newFocused;
        var index = Array.prototype.indexOf.call(results, focused);
        var focusedCssClass = NS + "-search__item--is-focused";

        if (results.length > 0) {

            if (!reverse) {
                // highlight the next result
                if (index < 0) {
                    results[0].classList.add(focusedCssClass);
                } else if (index + 1 < results.length) {
                    results[index].classList.remove(focusedCssClass);
                    results[index + 1].classList.add(focusedCssClass);
                }

                // if the last visible result is partially hidden, scroll up until it's completely visible
                newFocused = this._elements.results.querySelector(selectors.item.focused);
                if (newFocused) {
                    var bottomHiddenHeight = newFocused.offsetTop + newFocused.offsetHeight - this._elements.results.scrollTop - this._elements.results.clientHeight;
                    if (bottomHiddenHeight > 0) {
                        this._elements.results.scrollTop += bottomHiddenHeight;
                    } else {
                        this._onScroll();
                    }
                }

            } else {
                // highlight the previous result
                if (index >= 1) {
                    results[index].classList.remove(focusedCssClass);
                    results[index - 1].classList.add(focusedCssClass);
                }

                // if the first visible result is partially hidden, scroll down until it's completely visible
                newFocused = this._elements.results.querySelector(selectors.item.focused);
                if (newFocused) {
                    var topHiddenHeight = this._elements.results.scrollTop - newFocused.offsetTop;
                    if (topHiddenHeight > 0) {
                        this._elements.results.scrollTop -= topHiddenHeight;
                    }
                }
            }
        }
    };

    Search.prototype._updateResults = function() {
        var self = this;
        if (self._hasMoreResults) {
            var request = new XMLHttpRequest();
            var url = self._action + "?" + serialize(self._elements.form) + "&" + PARAM_RESULTS_OFFSET + "=" + self._resultsOffset;

            request.open("GET", url, true);
            request.onload = function() {
                // when the results are loaded: hide the loading indicator and display the search icon after a minimum period
                setTimeout(function() {
                    toggleShow(self._elements.loadingIndicator, false);
                    toggleShow(self._elements.icon, true);
                }, LOADING_DISPLAY_DELAY);
                if (request.status >= 200 && request.status < 400) {
                    // success status
                    var data = JSON.parse(request.responseText);
                    if (data.length > 0) {
                        self._generateItems(data, self._elements.results);
                        self._markResults();
                        toggleShow(self._elements.results, true);
                    } else {
                        self._hasMoreResults = false;
                    }
                    // the total number of results is not a multiple of the fetched results:
                    // -> we reached the end of the query
                    if (self._elements.results.querySelectorAll(selectors.item.self).length % self._properties.resultsSize > 0) {
                        self._hasMoreResults = false;
                    }
                } else {
                    // error status
                }
            };
            // when the results are loading: display the loading indicator and hide the search icon
            toggleShow(self._elements.loadingIndicator, true);
            toggleShow(self._elements.icon, false);
            request.send();
        }
    };

    Search.prototype._cancelResults = function() {
        clearTimeout(this._timeout);
        this._elements.results.scrollTop = 0;
        this._resultsOffset = 0;
        this._hasMoreResults = true;
        this._elements.results.innerHTML = "";
    };

    Search.prototype._cacheElements = function(wrapper) {
        this._elements = {};
        this._elements.self = wrapper;
        var hooks = this._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

        for (var i = 0; i < hooks.length; i++) {
            var hook = hooks[i];
            var capitalized = IS;
            capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
            var key = hook.dataset[NS + "Hook" + capitalized];
            this._elements[key] = hook;
        }
    };

    Search.prototype._setupProperties = function(options) {
        this._properties = {};

        for (var key in properties) {
            if (properties.hasOwnProperty(key)) {
                var property = properties[key];
                if (options && options[key] != null) {
                    if (property && typeof property.transform === "function") {
                        this._properties[key] = property.transform(options[key]);
                    } else {
                        this._properties[key] = options[key];
                    }
                } else {
                    this._properties[key] = properties[key]["default"];
                }
            }
        }
    };

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Search({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Search({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

})();

/*******************************************************************************
 * Copyright 2016 Adobe Systems Incorporated
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var NS = "cmp";
    var IS = "formText";
    var IS_DASH = "form-text";

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]'
    };

    var properties = {
        /**
         * A validation message to display if there is a type mismatch between the user input and expected input.
         *
         * @type {String}
         */
        constraintMessage: {
        },
        /**
         * A validation message to display if no input is supplied, but input is expected for the field.
         *
         * @type {String}
         */
        requiredMessage: {
        }
    };

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function FormText(config) {
        if (config.element) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");
        }

        this._cacheElements(config.element);
        this._setupProperties(config.options);

        this._elements.input.addEventListener("invalid", this._onInvalid.bind(this));
        this._elements.input.addEventListener("input", this._onInput.bind(this));
    }

    FormText.prototype._onInvalid = function(event) {
        event.target.setCustomValidity("");
        if (event.target.validity.typeMismatch) {
            if (this._properties.constraintMessage) {
                event.target.setCustomValidity(this._properties.constraintMessage);
            }
        } else if (event.target.validity.valueMissing) {
            if (this._properties.requiredMessage) {
                event.target.setCustomValidity(this._properties.requiredMessage);
            }
        }
    };

    FormText.prototype._onInput = function(event) {
        event.target.setCustomValidity("");
    };

    FormText.prototype._cacheElements = function(wrapper) {
        this._elements = {};
        this._elements.self = wrapper;
        var hooks = this._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS_DASH + "]");
        for (var i = 0; i < hooks.length; i++) {
            var hook = hooks[i];
            var capitalized = IS;
            capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
            var key = hook.dataset[NS + "Hook" + capitalized];
            this._elements[key] = hook;
        }
    };

    FormText.prototype._setupProperties = function(options) {
        this._properties = {};

        for (var key in properties) {
            if (properties.hasOwnProperty(key)) {
                var property = properties[key];
                if (options && options[key] != null) {
                    if (property && typeof property.transform === "function") {
                        this._properties[key] = property.transform(options[key]);
                    } else {
                        this._properties[key] = options[key];
                    }
                } else {
                    this._properties[key] = properties[key]["default"];
                }
            }
        }
    };

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new FormText({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new FormText({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

})();

var jsonDataTravel = {};
var countriesData = {};
var readAndPopulateGetQuoteData = function callToReadGetQuoteData() {
    var response = JSON.parse(localStorage.getItem("getQuoteData"));
    if (response && response.payload) {

        if (response.payload.isCampaign) {
            $("#isCampaign").val(response.payload.isCampaign);
        }
    }
    jsonDataTravel = response;
  
    document.getElementById("travelType").value = jsonDataTravel.payload.travelType;
    //triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.TRAVEL[jsonDataTravel.payload.travelType])
    triggerSetProduct(window.productName);
    switch (jsonDataTravel.payload.travelType) {
        case "1":
            document.getElementById("familyDropdown") == null ? "" : document.getElementById("familyDropdown").remove();
            document.getElementById("studentDropdown") == null ? "" : document.getElementById("studentDropdown").remove();
            break;
        case "2":
            document.getElementById("individualDropdown") == null ? "" : document.getElementById("individualDropdown").remove();
            document.getElementById("studentDropdown") == null ? "" : document.getElementById("studentDropdown").remove();
            break;
        case "3":
            document.getElementById("individualDropdown") == null ? "" : document.getElementById("individualDropdown").remove();
            document.getElementById("familyDropdown") == null ? "" : document.getElementById("familyDropdown").remove();
            break;
        default:
            document.getElementById("individualDropdown") == null ? "" : document.getElementById("individualDropdown").remove();
            document.getElementById("familyDropdown") == null ? "" : document.getElementById("familyDropdown").remove();
            document.getElementById("studentDropdown") == null ? "" : document.getElementById("studentDropdown").remove();
            break;
    }
    $("#tripStartDate").val(dateFormatReverse(jsonDataTravel.payload.startDate));
    $("#tripEndDate").val(dateFormatReverse(jsonDataTravel.payload.endDate));

    /* Set value in DatePicker */

    var endDate = $("#tripEndDate").val().split("\/");
    var startdate = $("#tripStartDate").val().split("\/");

    $('#tripStartDt').val(startdate[0]);
    $('#tripStartMonth').val(startdate[1]);
    $('#tripStartYear').val(startdate[2]);

    $('#tripEndDt').val(endDate[0]);
    $('#tripEndMonth').val(endDate[1]);
    $('#tripEndYear').val(endDate[2]);

    var parentContainer = findSelectorParent($("#tripEndDate")[0], "FORM");
    var travelCountries = jsonDataTravel.payload.travellingCountries.map(function (countryObj) {
        return countryObj.countryCode
    })
    countriesData[parentContainer.id].countries = JSON.parse(localStorage.getItem("getQuoteData")).payload.travellingCountries;
    JSON.parse(localStorage.getItem("getQuoteData")).payload.travellingCountries.forEach(function (countryData) {
        if (travelCountries.indexOf(countryData.countryCode) !== -1) {
            var item = document.createElement("div");
            var name = document.createElement("span");
            var icon = document.createElement("i");
            item.classList.add("item");
            name.classList.add("name");
            name.setAttribute("data-ccode", countryData.countryCode);
            icon.className = "icon icon-close";

            // icon.setAttribute("data-cid", countryData.cid);
            icon.setAttribute("data-cdesc", countryData.countrydescription);
            icon.setAttribute("data-cregion", countryData.countrydescription);
            icon.setAttribute("data-ccode", countryData.countryCode);
            icon.setAttribute("onClick", "removeCountry(this)");
            name.innerHTML = countryData.countrydescription;
            item.appendChild(name);
            item.appendChild(icon);
            var copyItem = item.cloneNode(true);
            var ele = $(parentContainer).find("#countriesStoreInInput").children();
            var status = true;
            for (var i = 0; i < ele.length; i++) {
                status = (ele[i].querySelector("span").getAttribute("data-ccode") == name.innerHTML) ? false : true;
            }
            if (status == true) {
                $(parentContainer).find("#countriesStoreInInput").append(item);
            }
            $(parentContainer).find("#countryCode").html("+" + ($(parentContainer).find("#countriesStoreInInput").children().length - 1))

            return false
        } else {
            return true
        }
    })
    if (countriesData[parentContainer.id].countries.length > 0) {
        $(parentContainer).find("#travelCountries").css("width", "11px");
    }

    $(parentContainer).find("#travelCountryDiv").addClass("focus");
    $(parentContainer).find("#insuringListInnerText").html("");
    jsonDataTravel.payload.insuredDetails.forEach(function (insuredObj) {
        $(parentContainer).find("#insuringListInnerText").html($(parentContainer).find("#insuringListInnerText").html() + insuredObj.relationship.toLowerCase() + ",");
    })
    $(parentContainer).find("#insuringListInnerText").html($(parentContainer).find("#insuringListInnerText").html().slice(0, -1));
    $(parentContainer).find("[data-insured] label").each(function (ele) {
        var insureEle = this;
        var relationship = this.innerText.trim().toLowerCase();
        jsonDataTravel.payload.insuredDetails.forEach(function (insuredObj) {
            if (insuredObj.relationship.toLowerCase() == relationship) {
                if (!insureEle.querySelector("input").checked) {
                    insureEle.click();
                }
                findSelectorParent(insureEle, ".checkbox-list").querySelector("[type=tel]").value = insuredObj.age;
                return;
            }
        })
    })
    var childsIsuredObj = jsonDataTravel.payload.insuredDetails.filter(function (insuredObj) {
        return (insuredObj.relationship == "CHILD") ? true : false;
    })
    for (var i = 1; i < childsIsuredObj.length; i++) {
        if ($(parentContainer).find("#familyDropdown .icon[data-child]").length < childsIsuredObj.length) {
            $(parentContainer).find("#familyDropdown .icon-plus[data-child]").click();
        }
    }
    if (childsIsuredObj && childsIsuredObj.length > 0) {
        $(parentContainer).find("#familyDropdown .icon").each(function (ele, index) {
            var relationship = findSelectorParent(this, ".bs-form").querySelector("label").innerText.trim().toLowerCase();
            var insuredObj = childsIsuredObj[ele]
            if (insuredObj.relationship.toLowerCase() == relationship) {
                if (!findSelectorParent(this, ".bs-form").querySelector("label").querySelector("input").checked) {
                    findSelectorParent(this, ".bs-form").querySelector("label").click();
                }
                findSelectorParent(this, ".checkbox-list").querySelector("[type=tel]").value = insuredObj.age;
                return;
            }
        })
    }
    loadPlanDetails(jsonDataTravel);
    $('#foucsOutInsureingList').on("click", function (e) {
        var container = $(".bs-dropdown");
        $(".dropdown-parent").find(".dropdown-content").slideUp(),
            $(".dropdown-parent").find(".dropdown-heading").removeClass("active");
    })
    toggleLoader(false);
}
function loadPlanDetails(jsonDataTravel, sumAssuredAmt) {
    var contriesList = '';
    jsonDataTravel.payload.travellingCountries.forEach(function (contry) {
        contriesList += contry.countrydescription + ",";
    });
    document.getElementById("proposedSumAssuredList").innerHTML = '';
    jsonDataTravel.payload.proposedSumAssuredList.forEach(function (sumAssured) {
        var option = document.createElement("option");
        option.value = sumAssured;
        if (sumAssured == jsonDataTravel.payload.sumAssuredDefaultValue) {
            option.selected = "selected"
        }
        option.innerHTML = "$" + sumAssured.toLocaleString();
        document.getElementById("proposedSumAssuredList").appendChild(option);
    })
    $('#proposedSumAssuredList').on('select2:select', function (e) {
        var data = e.params.data;
        compareObj = {};
        showCompareEle();
        showPlans(data.element.value)
        quoteSwiperVar;
        quoteSwiper();
        $("#targetPlanDetails").css({
            transform: "translate3d(0px, 0px, 0px)"
        })
        quoteDetails();
        popup();
    });
    var travelDays = parseInt(jsonDataTravel.payload.travelDays);
    if (travelDays > 1) {
        travelDays += " Days";
    } else {
        travelDays += " Day";
    }
    $('#tripStartDate').on('pick.datepicker', function (e) {
        showError('tripStartDateErrorMsg', '', false)
        if (jsonDataTravel.payload.travelType) {
            var days = 0;
            switch (jsonDataTravel.payload.travelType) {
                case "1":
                    days = 180;
                    break;
                case "2":
                    days = 60;
                    break;
                case "3":
                    days = 365;
                    break;
                default:
                    days = 0
                    break;
            }
            $('#tripEndDate').datepicker('setEndDate', ($('#tripStartDate').datepicker('getDate').addDays(days)));
        }
        $('#tripEndDate').val("DD/MM/YYYY");
    });
    if (jsonDataTravel.payload.travelType) {
        var days = 0;
        switch (jsonDataTravel.payload.travelType) {
            case "1":
                days = 179;
                break;
            case "2":
                days = 59;
                break;
            case "3":
                days = 364;
                break;
            default:
                days = 0
                break;
        }
        $('#tripEndDate').datepicker('setEndDate', ($('#tripStartDate').datepicker('getDate').addDays(days)));
    }
    var childAge = "";
    var showDataOfPayload = document.getElementById("showDataOfPayload");
    var updatedInsureDetails = jsonDataTravel.payload.insuredDetails.map(function (insureDetails, index, self) {
        insureDetails.ages = []
        insureDetails.index = self.filter(function (insureDetailsObj) {
            if (insureDetailsObj.relationship == insureDetails.relationship) {
                insureDetails.ages.push(insureDetailsObj.age)
            }

            return (insureDetailsObj.relationship == insureDetails.relationship)
        }).length
        return insureDetails;
    })
    updatedInsureDetails = removeDuplicatesFromObj(updatedInsureDetails, "relationship");
    var insuringListInnerText = document.getElementById("insuringListInnerText");
    insuringListInnerText.innerText = "";
    var insuringListInnerTextStr = "";
    document.querySelectorAll(".travelage").forEach(function eachagefunc(eachage) { eachage.remove() });
    if (showDataOfPayload) {
        updatedInsureDetails.forEach(function (insuredDetail) {
            var item = document.createElement("div");
            item.className = "aem-GridColumn aem-GridColumn--default--2 aem-GridColumn--tablet--6 aem-GridColumn--phone--6 item travelage";
            var labelValueForm = document.createElement("div");
            labelValueForm.className = "label-value-form";
            var formLabel = document.createElement("div");
            formLabel.className = "form-label";
            formLabel.innerText = insuredDetail.relationship;
            labelValueForm.appendChild(formLabel);
            var value = document.createElement("div");
            value.className = "value";
            value.innerText = ""
            var strAge = ""
            insuredDetail.ages.forEach(function (age) {

                strAge += age + ((age > 1) ? " years, " : " year, ");
            })
            value.innerText = strAge;
            insuringListInnerTextStr += ((insuredDetail.index > 1) ? insuredDetail.index : "") + insuredDetail.relationship + ", ";

            value.innerText = value.innerText.slice(0, -2);
            labelValueForm.appendChild(value);
            item.appendChild(labelValueForm);
            showDataOfPayload.appendChild(item);
        })
        insuringListInnerText.innerText = insuringListInnerTextStr.slice(0, -2);
    }

    document.getElementById("contriesList").innerText = contriesList.replace(/,$/g, "");
    document.getElementById("travelDays").innerText = travelDays;
    showPlans(jsonDataTravel.payload.sumAssuredDefaultValue);

    quoteSwiper();
    quoteSwiperVar.slideTo(1);
    quoteSwiperVar.slideTo(0);
    quoteDetails();
    popup();



    function showPlans(sumAssuredAmt) {
        var targetPlanDetails = document.getElementById("targetPlanDetails");
        var planDetailsDesktop = document.getElementById("planDetailsDesktop");
        planDetailsDesktop.innerHTML = '';
        targetPlanDetails.innerHTML = '';
        jsonDataTravel.payload.planDetails.filter(function (plan) {
            return (plan.sumAssured == sumAssuredAmt)
        }).forEach(function (plan, index, self) {
            document.getElementById("numberOfPlan").innerText = self.length;
            if (self.length > 1) {
                document.getElementById("compareContainer").style.display = "block";
            } else {
                document.getElementById("compareContainer").style.display = "none";
            }
            var count = index + 1;
            var planAmount = plan.grossPremium.toLocaleString();
            var planTitle = plan.displayName;
            var swiperSlide = document.createElement("div");
            swiperSlide.classList.add("swiper-slide");
            var bsQuoteCard = document.createElement("div");
            if (index == 0) {
                bsQuoteCard.classList.add("bs-quote-card");
                bsQuoteCard.classList.add("active");
            } else {
                bsQuoteCard.classList.add("bs-quote-card");
            }
            bsQuoteCard.setAttribute("rel", "quote-" + count);

            var icon = document.createElement("span");
            icon.classList.add("icon");
            icon.classList.add("icon-star");
            var cardHead = document.createElement("div");
            cardHead.classList.add("card-head");

            var quotePrice = document.createElement("div");
            quotePrice.classList.add("quote-price");

            var amount = document.createElement("span");
            amount.classList.add("amount");
            amount.innerHTML = "&#8377;" + planAmount.toLocaleString();
            var unit = document.createElement("span");
            unit.classList.add("unit");
            unit.innerText = "one time premium including GST";

            quotePrice.appendChild(amount);
            quotePrice.appendChild(unit);

            var title = document.createElement("h3");
            title.classList.add("title");
            title.innerText = planTitle;

            cardHead.appendChild(quotePrice);
            cardHead.appendChild(title);
            var cardBody = document.createElement("div");
            cardBody.classList.add("card-body");
            var cardList = document.createElement("div");
            cardList.classList.add("card-list");
            var ul = document.createElement("ul");
            plan.featureDetails.forEach(function (feature, i) {
                if (i < 3) {
                    var li = document.createElement("li");
                    var labelValuePair = document.createElement("div");
                    labelValuePair.classList.add("bs-label-value-pair");
                    var label = document.createElement("div");
                    label.classList.add("label");
                    label.innerHTML = feature.featureDescription;
                    var value = document.createElement("div");
                    value.classList.add("value");
                    if (feature.value === null) {
                        value.innerText = "";
                    } else {
                        value.innerText = feature.value.toLocaleString();
                    }
                    labelValuePair.appendChild(label)
                    labelValuePair.appendChild(value)
                    li.appendChild(labelValuePair);
                    ul.appendChild(li);
                }
            })
            cardList.appendChild(ul);
            cardBody.appendChild(cardList);

            var cardFoooter = document.createElement("div");
            cardFoooter.classList.add("card-footer");
            var buttonWrap = document.createElement("div");
            buttonWrap.classList.add("button-wrap");
            var addToCompare = document.createElement("button");
            addToCompare.addEventListener("click", function (e) {
                if (e.target.getAttribute("data-show") == "true") {
                    removeCompareObj(plan.variantCode, plan.displayName)
                    e.target.setAttribute("data-show", "false")
                } else {
                    triggerTravelCompareStartData(plan.variantCode, plan.sumAssured, $(e.target).attr("data-isRecommended"))
                    setCompareObj(plan.variantCode, plan.displayName, plan.grossPremium, addToCompare);
                    e.target.setAttribute("data-show", "true")
                }
            })
            addToCompare.id = plan.variantCode;
            addToCompare.setAttribute("data-show", "false");
            addToCompare.setAttribute("data-displayname", plan.displayName)
            addToCompare.setAttribute("data-isRecommended", "false")
            addToCompare.className = "btn btn-link compare typ-red";
            var text = document.createElement("span");
            text.classList.add("text");
            text.innerText = "ADD to compare";
            var iconPlus = document.createElement("i");
            iconPlus.className = "icon icon-plus";
            addToCompare.appendChild(text);
            addToCompare.appendChild(iconPlus);
            var buyNow = document.createElement("button");
            buyNow.className = "btn buy-now";
            buyNow.innerText = "buy now";
            buyNow.setAttribute("data-sumAssured", plan.sumAssured);
            buyNow.setAttribute("data-source", "card");
            buyNow.setAttribute("data-isRecommended", "false");
            buyNow.setAttribute("data-planCode", plan.planCode);
            buyNow.setAttribute("data-variantCode", plan.variantCode);

            buyNow.setAttribute("data-netPremium", plan.netPremium);
            buyNow.setAttribute("data-gst", plan.gst);
            buyNow.setAttribute("data-grossPremium", plan.grossPremium);
            buyNow.setAttribute("onClick", "setPlanDetails(this,1)");
            // buyNow.setAttribute("data-target", "#myPopup-buy-now");
            // buyNow.setAttribute("data-toggle", "popup");
            if (self.length > 1) {
                buttonWrap.appendChild(addToCompare);
            } else {

            }
            buttonWrap.appendChild(buyNow);
            cardFoooter.appendChild(buttonWrap);
            if (plan.isRecommended) {
                bsQuoteCard.appendChild(icon);
            }
            bsQuoteCard.appendChild(cardHead);
            bsQuoteCard.appendChild(cardBody);
            bsQuoteCard.appendChild(cardFoooter);
            /* ================================================= */
            var quoteDetailsWrapper = document.createElement("div");
            quoteDetailsWrapper.classList.add("quote-details-wrapper");
            quoteDetailsWrapper.classList.add("mobile");

            var detailContent = document.createElement("div");
            if (index == 0) {
                detailContent.classList.add("detail-content");
                detailContent.classList.add("active");
            } else {
                detailContent.classList.add("detail-content");
            }

            detailContent.setAttribute("name", "quote-" + count);
            var bsQuoteCardDetails = document.createElement("div");
            bsQuoteCardDetails.classList.add("bs-quote-card");
            bsQuoteCardDetails.classList.add("typ2");
            var cardHeadDetails = document.createElement("div");
            cardHeadDetails.classList.add("card-head");

            var button = document.createElement("button");
            button.classList.add("btn");
            button.classList.add("buy-now");
            button.innerText = "buy now";

            button.setAttribute("data-sumAssured", plan.sumAssured);
            button.setAttribute("data-source", "details");
            button.setAttribute("data-isRecommended", "false");
            button.setAttribute("data-planCode", plan.planCode);
            button.setAttribute("data-variantCode", plan.variantCode);
            button.setAttribute("data-netPremium", plan.netPremium);
            button.setAttribute("data-gst", plan.gst);
            button.setAttribute("data-grossPremium", plan.grossPremium);
            button.setAttribute("onClick", "setPlanDetails(this,1)");

            // button.setAttribute("data-target", "#myPopup-buy-now");
            // button.setAttribute("data-toggle", "popup");

            var titleDetails = document.createElement("h3");
            titleDetails.classList.add("title");
            titleDetails.innerText = planTitle;
            var quotePriceDetails = document.createElement("div");
            quotePriceDetails.classList.add("quote-price");
            var amountDetails = document.createElement("span");
            amountDetails.classList.add("amount");
            amountDetails.innerHTML = "&#8377;" + planAmount;
            quotePriceDetails.appendChild(amountDetails);

            cardHeadDetails.appendChild(button);
            cardHeadDetails.appendChild(titleDetails);
            cardHeadDetails.appendChild(quotePriceDetails);
            var cardSubHeadDetails = document.createElement("div");
            cardSubHeadDetails.classList.add("card-sub-heading");

            var coverage = document.createElement("div");
            coverage.classList.add("heading")
            var benifits = document.createElement("div");
            benifits.classList.add("heading");
            cardSubHeadDetails.appendChild(coverage);
            cardSubHeadDetails.appendChild(benifits);
            var cardBodyDetails = document.createElement("div");
            cardBodyDetails.classList.add("card-body")
            var cardListDetails = document.createElement("div");
            cardListDetails.classList.add("card-list");
            var ulDetails = document.createElement("ul");
            plan.featureDetails.forEach(function (feature, i) {
                var li = document.createElement("li");
                var labelValuePair = document.createElement("div");
                labelValuePair.classList.add("bs-label-value-pair");
                var label = document.createElement("div");
                label.classList.add("label");
                label.innerHTML = feature.featureDescription;
                var value = document.createElement("div");
                value.classList.add("value");
                if (feature.value === null) {
                    value.innerText = "";
                } else {
                    value.innerText = feature.value.toLocaleString();
                }
                labelValuePair.appendChild(label)
                labelValuePair.appendChild(value)
                li.appendChild(labelValuePair);
                ulDetails.appendChild(li);
            })
            cardListDetails.appendChild(ulDetails);
            cardBodyDetails.appendChild(cardListDetails);
            bsQuoteCardDetails.appendChild(cardHeadDetails);
            bsQuoteCardDetails.appendChild(cardSubHeadDetails);
            bsQuoteCardDetails.appendChild(cardBodyDetails);

            var buttonWrapDetails = document.createElement("div");
            buttonWrapDetails.classList.add("button-wrap");
            buttonWrapDetails.classList.add("typ-2")
/*            var emailBtn = document.createElement("button");
            emailBtn.innerText = "Email Quote";

            emailBtn.setAttribute("data-isRecommended", "false")
            emailBtn.setAttribute("data-sumAssured", plan.sumAssured)
            emailBtn.setAttribute("data-variantCode", plan.variantCode)
            emailBtn.setAttribute("data-netPremium", plan.netPremium)
            emailBtn.setAttribute("data-grossPremium", plan.grossPremium)
            emailBtn.classList.add("btn");
            emailBtn.setAttribute("onClick", "setPlanDetails(this)");

            emailBtn.setAttribute("data-target", "#myPopup-email-varient");
            emailBtn.setAttribute("data-toggle", "popup");*/
            var downloadBtn = document.createElement("button");
            downloadBtn.classList.add("btn");
            downloadBtn.innerText = "DOWNLOAD sale s brochure";
            downloadBtn.setAttribute("data-variantCode", plan.variantCode);
            downloadBtn.setAttribute("data-sumAssured", plan.sumAssured);

            downloadBtn.setAttribute("data-isRecommended", "false")
            downloadBtn.setAttribute("onClick", "callAjaxForDownload(this)");
            //buttonWrapDetails.appendChild(emailBtn);
            buttonWrapDetails.appendChild(downloadBtn);

            detailContent.appendChild(bsQuoteCardDetails);
            detailContent.appendChild(buttonWrapDetails);
            console.log(detailContent)
            detailContent2 = detailContent.cloneNode(true)
            quoteDetailsWrapper.appendChild(detailContent);
            /* ================================================= */
            swiperSlide.appendChild(bsQuoteCard);
            swiperSlide.appendChild(quoteDetailsWrapper);

            planDetailsDesktop.appendChild(detailContent2);
            targetPlanDetails.appendChild(swiperSlide);
        })
    }
    callTravelTrigger();
}
function travelBuyNow(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            triggerCreateLead(response.payload.applicationId, productName);
            var url = handoverEndpointURL + travelHandoverURL
            url += "apcantid=" + response.payload.applicantId + "&";
            url += "aptionid=" + response.payload.applicationId + "&";
            url += "apcaptid=" + response.payload.applicationApplicantId + "&";
            url += "skipLogin=true";

            if (window.location.href.includes("is-mobile")) {
                url += "&isMobile=1";
            }
            if (response.payload.authToken) {
                window.sessionStorage.setItem("SS_1", response.payload.authToken)
                window.sessionStorage.setItem("SS_4", response.payload.guardKey)
                document.cookie = "SS_1=" + response.payload.authToken
                document.cookie = "SS_4=" + response.payload.guardKey
            }

            location.href = url;
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false);
        }
        popup_close()
    }).catch(function (err) {
        toggleLoader(false);
    })
}

function travelComparePlans(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            popup_open("#myPopup-compare-popup")
            var payload = response.payload.variantFeaturesMap;
            var featureList = [];
            var compareDetails = document.getElementById("compareDetails");
            var compareDetailsHead = document.getElementById("compareDetailsHead");
            compareDetails.innerHTML = "";
            compareDetailsHead.innerHTML = '<th class="back"><span class="popup-back bs-icon-text typ-4" data-dismiss="popup"><span class="icon icon-arrowback"></span><span class="text">BACK</span></span></th>';
            Object.keys(payload).forEach(function (variationObj) {
                console.log(variationObj)
                var productDetails = document.createElement("th");
                var title = document.createElement("h3");
                var price = document.createElement("div");
                var amount = document.createElement("span");
                var unit = document.createElement("span");
                var buyNow = document.createElement("button");
                productDetails.classList.add("product-details");
                title.classList.add("title");
                price.classList.add("price");
                amount.classList.add("amount");
                unit.classList.add("unit");
                buyNow.classList.add("btn");
                var planData = jsonDataTravel.payload.planDetails.find(function (planObj) {
                    return (planObj.variantCode == variationObj)
                });
                title.innerText = planData.displayName;
                amount.innerHTML = "&#8377;" + planData.grossPremium;
                unit.innerText = " Premium";
                buyNow.innerText = "Buy Now";
                buyNow.setAttribute("data-sumAssured", planData.sumAssured);
                buyNow.setAttribute("data-source", "compare");
                buyNow.setAttribute("data-isRecommended", "false");
                buyNow.setAttribute("data-planCode", planData.planCode);
                buyNow.setAttribute("data-variantCode", planData.variantCode);
                buyNow.setAttribute("data-netPremium", planData.netPremium);
                buyNow.setAttribute("data-gst", planData.gst);
                buyNow.setAttribute("data-grossPremium", planData.grossPremium);
                buyNow.setAttribute("onClick", "openBuyNowPopUpIncompare(this)");
                buyNow.setAttribute("data-target", "#myPopup-buy-now");
                buyNow.setAttribute("data-toggle", "popup");
                price.appendChild(amount);
                price.appendChild(unit);
                productDetails.appendChild(title);
                productDetails.appendChild(price);
                productDetails.appendChild(buyNow);
                compareDetailsHead.appendChild(productDetails);
                payload[variationObj].forEach(function (featureObj) {
                    featureList.push(featureObj);
                })
            })

            featureList = removeDuplicates(featureList, "featureCode");
            featureList.forEach(function (feature) {
                var tr = document.createElement("tr");
                var td = document.createElement("td");
                td.classList.add("align-left");
                td.innerText = feature.featureDescription;
                tr.appendChild(td);

                Object.keys(payload).forEach(function (variationObj, index) {

                    var value = document.createElement("td");

                    var price = document.createElement("div");
                    price.classList.add("price");
                    var amount = document.createElement("span");
                    amount.classList.add("amount");
                    var variantObjIsValid = payload[variationObj].find(function (featureData) {
                        return featureData.featureCode == feature.featureCode
                    });

                    amount.innerHTML = ((variantObjIsValid) ? variantObjIsValid.value : 0);

                    price.appendChild(amount);
                    value.appendChild(amount);
                    tr.appendChild(value);


                })

                compareDetails.appendChild(tr)

                $('[data-dismiss="popup"]').click(function () {
                    popup_close();
                });
            })
            callTravelTrigger();
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
        }
        toggleLoader(false);

    }).catch(function (err) {
        toggleLoader(false);
    })
}

function travelEmailQuote(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            toastr.success("The Quote has been mailed to your ID.", "", {
                timeOut: 5e3,
                closeButton: !0,
                preventDuplicates: !0
            });
        } else {
            toastr.error("Failed to mail the Quote to your ID.", "", {
                timeOut: 5e3,
                closeButton: !0,
                preventDuplicates: !0
            });
        }
        popup_close()
        toggleLoader(false);

    }).catch(function (err) {
        toggleLoader(false);
    })
}

function travelDownloadBrochure(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        window.open(
            response.payload.docDownloadUrl,
            '_blank'
        );
        toggleLoader(false);

    }).catch(function (err) {
        toggleLoader(false);
    })
}
function callTravelTrigger() {
    $("[data-target]").on("click", function () {
        if ($(this).attr("data-target") == "#myPopup-buy-now") {
            triggerTravelBuyNowData(sorcueForTravelBuyNow, selectedPlanDetails.variantCode, isRecommendedForTravel, selectedPlanDetails.sumAssured, true);
        }

        if ($(this).attr("data-target") == "#myPopup-call-us") {
            triggerCommonCallUs(true);
        }
    })

}

function callAjaxForDownload(el) {

    var formData = new FormData();
    formData.append("variantCode", el.getAttribute("data-variantCode"));
    triggerDownload(el.getAttribute("data-variantCode"), el.getAttribute("data-sumAssured"), el.getAttribute("data-isRecommended"))
    var sendData = "";
    if (AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.includes("?")) {
        AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url = AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.substring(0, AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.indexOf("?"));
    }
    AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url += "?variantcode=" + el.getAttribute("data-variantCode");
    travelDownloadBrochure(AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.name, sendData);
}

function callAjaxForEmail() {

    var email = document.getElementById("emailId").value;
    var formData = new FormData();
    if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(document.getElementById("emailId").value)) {
        formData.append("emailId", document.getElementById("emailId").value);
        AppData.localStorage.setValue("email", document.getElementById("emailId").value || "")
        showError("emailIdErrorMsg", "Enter Valid Email Id", false);
    } else {
        showError("emailIdErrorMsg", "Enter Valid Email Id", true);
        return;
    }
    triggerEmail(selectedPlanDetails.variantCode, selectedPlanDetails.sumAssured, isRecommendedForTravel);
    var send = {
        "emailPayload": {
            "sumAssured": selectedPlanDetails.sumAssured,
            "productCategoryCode": "TGI",
            "premium": selectedPlanDetails.grossPremium,
            "emailId": email,
            "insProdTypeCode": "TRAVEL"
        }
    }
    travelEmailQuote(AppConstants.API_SELECTOR.TRAVEL_EMAIL_QUOTE.name, send);
}

function callAjaxForCompare() {
    if (Object.keys(compareObj).length > 1) {
        toggleLoader(true)
        var formData = new FormData();
        formData.append("variantCode1", (compareObj.variantCode1) ? compareObj.variantCode1.code : "");
        formData.append("variantCode2", (compareObj.variantCode2) ? compareObj.variantCode2.code : "");
        triggerTravelCompareEndData([compareObj.variantCode1.code, compareObj.variantCode2.code]);

        var sendData = "";
        travelComparePlans(AppConstants.API_SELECTOR.TRAVEL_COMPARE_PLANS.name, sendData);

    } else {
        toastr.warning(AppConstants.VALIDATION_MSG.TRAVEL.QUOTE.COMPARE.SELECT_ONE_MORE_PRODUCT, '', {
            timeOut: 5000,
            "closeButton": true,
            "preventDuplicates": true
        });
    }
}
var selectedPlanDetails = {};
var compareObj = {};
var limit = 2

function openBuyNowPopUpIncompare(that) {
    $('.bs-popup').fadeOut().removeClass('active');
    setPlanDetails(that, 1);
    var openPopup = $(that).attr("data-target");
    $(openPopup).fadeIn().addClass("active");
}

function setCompareObj(variantCodeData, displayName, grossPremium, e) {
    if (Object.keys(compareObj).length == limit) {
        toastr.warning(AppConstants.VALIDATION_MSG.TRAVEL.QUOTE.COMPARE.MAX_PLAN, '', {
            timeOut: 5000,
            "closeButton": true,
            "preventDuplicates": true
        });
        return
    }
    for (var i = 1; i < limit + 1; i++) {
        var variantCode = compareObj["variantCode" + i];
        if (!variantCode) {
            if (!Object.keys(compareObj).find(function (variantObj) {
                return (compareObj[variantObj] && compareObj[variantObj].code == variantCodeData) ? true : false
            })) {
                compareObj["variantCode" + i] = {
                    "code": variantCodeData,
                    "displayName": displayName,
                    "grossPremium": grossPremium
                };
                e.querySelector("span").innerText = "Added to compare";
                e.querySelector(".icon").classList.add("icon-tick2");
                e.querySelector(".icon").classList.remove("icon-plus");
                break;
            }
        }
    }
    showCompareEle();
}

function removeCompareObj(variantCodeData, displayName) {

    for (var i = 1; i < limit + 1; i++) {
        var variantCode = compareObj["variantCode" + i];
        if (variantCode && variantCode.code == variantCodeData) {
            delete compareObj["variantCode" + i];
        }
    }
    var ele = document.getElementById(variantCodeData);
    ele.querySelector("span").innerText = "Add to compare";
    ele.querySelector(".icon").classList.remove("icon-tick2");
    ele.querySelector(".icon").classList.add("icon-plus");

    for (var i = 1; i < limit + 1; i++) {
        var variantCode = compareObj["variantCode" + i];
        if (!variantCode && compareObj["variantCode" + (i + 1)]) {
            compareObj["variantCode" + i] = compareObj["variantCode" + (i + 1)];
            delete compareObj["variantCode" + (i + 1)];
        }
    }
    showCompareEle();
}

function showCompareEle() {

    var container = document.getElementById("compareContainer");
    if (container) {
        var compareContainer = findSelectorParent(container, ".lyt-compare");
        if (Object.keys(compareObj).length > 0) {
            compareContainer.style.display = "block";
            if (Object.keys(compareObj).length == 2 && $(window).width() < breakpoint_sm) {
                $(".compare-doc-btn").show()
            }
        } else {
            compareContainer.style.display = "none";
            $(".compare-doc-btn").hide()
        }
        container.innerHTML = "";
        for (var i = 1; i < limit + 1; i++) {
            if (compareObj["variantCode" + i]) {
                var li = document.createElement("li");
                li.classList.add("compared-item");
                var div = document.createElement("div");
                div.classList.add("inner-wrap");
                var h4 = document.createElement("h4");
                h4.classList.add("title");
                h4.innerText = compareObj["variantCode" + i].displayName;
                var button = document.createElement("button");
                button.className = "remove icon icon-close";
                button.setAttribute("onClick", "removeCompareObj('" + compareObj["variantCode" + i].code + "','" + compareObj["variantCode" + i].displayName + "')")
                div.appendChild(h4);
                div.appendChild(button);
                li.appendChild(div);
                container.appendChild(li);
            } else {
                var li = document.createElement("li");
                li.className = "compared-item add-more";
                var div = document.createElement("div");
                div.classList.add("inner-wrap");
                var button = document.createElement("button");
                button.className = "add-more btn btn-link btn-icon-text";
                var plusIcon = document.createElement("span");
                plusIcon.className = "icon icon-plus";
                var text = document.createElement("span");
                text.className = "text";
                text.innerText = "Add one more";
                button.appendChild(plusIcon);
                button.appendChild(text);
                div.appendChild(button);
                li.appendChild(div);

                container.appendChild(li);
            }
        }
    }
}
var sorcueForTravelBuyNow;
var isRecommendedForTravel;

function setPlanDetails(el, state) {
    var dataList = ["sumAssured", "planCode", "variantCode", "netPremium", "gst", "grossPremium"];
    dataList.forEach(function (item) {
        selectedPlanDetails[item] = el.getAttribute("data-" + item)
    })
    sorcueForTravelBuyNow = el.getAttribute("data-source");
    isRecommendedForTravel = el.getAttribute("data-isRecommended");
    switch (state) {
        case 1:
            callAjaxForBuyNow()
            break;
    }
}



function callAjaxForBuyNow(e) {
    var sendData = {
        "travellerType": document.getElementById("travelType").value,
        "geographicalAreaCode": jsonDataTravel.payload.geographicalAreaCode,
        "travellingCountries": jsonDataTravel.payload.travellingCountries.map(function (countryObj) { return countryObj.countryCode }),
        "travelStartDate": jsonDataTravel.payload.startDate,
        "travelEndDate": jsonDataTravel.payload.endDate,
        "productCategoryCode": "TGI",
        "channelType": window.channelType.channelType,
        "selectedPlanDetails": selectedPlanDetails,
        "utmParams": window.utmParams,
        "proposerDetails": {
            "firstName": jsonDataTravel.payload.firstName,
            "lastName": jsonDataTravel.payload.lastName,
            "mobileNumber": jsonDataTravel.payload.mobileno
        },
        "insuredDetails": jsonDataTravel.payload.insuredDetails
    };

    country = jsonDataTravel.payload.travellingCountries.map(function (countryObj) {
        return countryObj.countryCode
    })


    triggerTravelBuyNowData(sorcueForTravelBuyNow, selectedPlanDetails.variantCode, isRecommendedForTravel, selectedPlanDetails.sumAssured, false);
    travelBuyNow(AppConstants.API_SELECTOR.TRAVEL_BUY_NOW.name, sendData);
}

document.addEventListener("DOMContentLoaded", function () {
	
    if (document.querySelector('#plandetailscontainer #travelType')) {
        if (!window.countryPromise) {
            AppConstants.API_SELECTOR.COUNTRY_MASTER.url = AppConstants.API_SELECTOR.COUNTRY_MASTER.url.substring(0, AppConstants.API_SELECTOR.COUNTRY_MASTER.url.indexOf('=') + 1) + JSON.parse(localStorage.getItem("getQuoteData")).payload.travellingCountries[0].countrydescription;

            window.countryPromise = AppEvent.trigger(AppConstants.API_SELECTOR.COUNTRY_MASTER.name).then(function (responseData) {
                countriesMasterData = responseData.payload;
            });
            window.countryPromise.then(function () {
                toggleLoader(false);
                $('.travelCountries input').keydown(function (e) {
                    if (e.keyCode == 13) {
                        e.preventDefault();
                        return false;
                    }
                });
                if (document.getElementsByClassName("travelCountries").length > 0) {
                    document.getElementsByClassName("travelCountries").forEach(function (travelCountriesEle) {
                        var parentContainer = findSelectorParent(travelCountriesEle, "FORM");
                        countriesData[parentContainer.id] = {}
                        countriesData[parentContainer.id].countries = countriesMasterData.countries

                        travelCountriesEle.addEventListener("keyup", function (e) {
                            var autoFillCountrires = parentContainer.querySelector("#autoFillCountrires")
                            switch (e.keyCode) {
                                case 8:
                                    var childCountryEle = $(parentContainer).find("#countriesStoreInInput .icon")
                                    console.log(childCountryEle)
                                    if (childCountryEle.length > 0) {
                                        console.log(childCountryEle[childCountryEle.length - 1])
                                        removeCountry(childCountryEle[childCountryEle.length - 1])
                                        $(parentContainer).find("#travelCountries").parent().addClass('focus');
                                        $(parentContainer).find("#countryCode").hide();
                                        $(parentContainer).find('#countriesStoreInInput').children().each(function (index, ele) {
                                            ele.style.display = "inline-block"
                                        })
                                    }
                                    break;
                            }
                            if (autoFillCountrires.children.length > 0) {
                                switch (e.keyCode) {
                                    case 38:
                                        console.log(e.keyCode, "Arrow up", autoFillCountrires.children.length);
                                        if ($(autoFillCountrires).find(".active").length == 1) {
                                            $(autoFillCountrires).find(".active").removeClass("active").prev().addClass("active")
                                        } else {
                                            // $(autoFillCountrires).find("li").first().addClass("active")
                                        }
                                        break;

                                    case 40:

                                        console.log(e.keyCode, "Arrow down", autoFillCountrires.children.length);
                                        if ($(autoFillCountrires).find(".active").length == 1) {
                                            $(autoFillCountrires).find(".active").removeClass("active").next().addClass("active");
                                        } else {
                                            $(autoFillCountrires).find("li").first().addClass("active");
                                        }
                                        break;

                                    case 13:
                                        $(autoFillCountrires).find(".active").click()
                                        $(parentContainer).find("#travelCountries").parent().addClass('focus');
                                        $(parentContainer).find("#countryCode").hide();

                                        $(parentContainer).find('#countriesStoreInInput').children().each(function (index, ele) {
                                            ele.style.display = "inline-block";
                                        })
                                        e.preventDefault();
                                        return false;
                                        break;
                                }
                            }
                        })
                        $(parentContainer).find("#travelCountries").on("input", function (e) {

                            $(parentContainer).find("#travelCountries").width(8 * ((e.target.value.length == 0) ? 1 : e.target.value.length) + "px");
                            $(parentContainer).find("#travelCountries").css("display", "inline-block");
                            if ($(parentContainer).find("#countriesStoreInInput").children().length > 9) {
                                $(parentContainer).find("#travelCountries").val("");
                                showError("countryErrorMsg", "Max Countries limit is 10.", true);
                            } else if (e.target.value.length > 1) {

                                showError("countryErrorMsg", "Max Countries limit is 10.", false);
                                $(parentContainer).find("#autoFillCountrires").html("");
                                $(parentContainer).find("#autoFillCountrires").removeClass("hide");
                                $(parentContainer).find("#autoFillCountrires").addClass("show");
                                var reg = new RegExp("^" + e.target.value.toLowerCase(), "g")
                             
                                AppConstants.API_SELECTOR.COUNTRY_MASTER.url = AppConstants.API_SELECTOR.COUNTRY_MASTER.url.substring(0, AppConstants.API_SELECTOR.COUNTRY_MASTER.url.indexOf('=') + 1) + e.target.value;
                                // loadCountryData(AppConstants.API_SELECTOR.COUNTRY_MASTER.name,"",countriesData[parentContainer.id],parentContainer);

                                window.countryPromise = AppEvent.trigger(AppConstants.API_SELECTOR.COUNTRY_MASTER.name).then(function (responseData) {
                                    if (responseData.payload.length == 0) {
                                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", true);
                                    }
                                    else {
                                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
                                    }
                                    countriesData[parentContainer.id].countries = responseData.payload;
                                    $(parentContainer).find("#autoFillCountrires").html("");
                                    responseData.payload.forEach(function (response, index) {

                                        var li = document.createElement("li");
                                        li.innerText = response.countryName;
                                        if (index == 0) {
                                            li.className = "active";
                                        }

                                        li.setAttribute("data-cregion", response.countryName);
                                        li.setAttribute("data-ccode", response.countryShortCode);
                                        li.addEventListener("click", function (e) {
                                            storeCountry("travelCountries", e, parentContainer);
                                            countriesData[parentContainer.id].countries = countriesData[parentContainer.id].countries.filter(function (countryData) {
                                                return (countryData.countryShortCode != response.countryShortCode)
                                            })
                                        })
                                        $(parentContainer).find("#autoFillCountrires").append(li);
                                    });

                                });

                            } else {
                                $(parentContainer).find("#autoFillCountrires").innerHTML = "";

                                showError("countryErrorMsg", "Enter Valid Country.", false);
                            }

                        });
                    })
                }
            })

            window.countryPromise.then(function () {
                toggleLoader(false);
                if (document.getElementById("travelType")) {
                    showCompareEle();
                    try {
                        if (localStorage.hasOwnProperty("getQuoteData")) {
                            if (document.getElementById("travelType").value == "" && window.location.href.includes("/travel-Quote")) {
                                readAndPopulateGetQuoteData();
                            } else if (document.getElementById("travelType").value == JSON.parse(localStorage.getItem("getQuoteData")).payload.travelType && window.location.href.includes("/travel-Quote")) {
                                readAndPopulateGetQuoteData();
                            }
                        }
                    } catch (error) { }
                }
            })
        }
    }
});
var cyberData;

function cyberSearchPlan(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            cyberData = response;
            toggleLoader(false);
            //	   triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.CYBER);
            triggerSetProduct(window.productName)
            var select = document.getElementById('Covering');
            select.innerHTML = "";
            console.log(select);
            for (var i = 0; i < response.payload.proposedSumAssuredList.length; i++) {
                var option = document.createElement('option');
                option.value = response.payload.proposedSumAssuredList[i];
                option.innerText = response.payload.proposedSumAssuredList[i];
                select.appendChild(option);
            }
            grossPremium()
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false);
        }
        popup_close()

        resolve(true);
    }).catch(function (data) {
        toggleLoader(false);
    })
}

if (document.getElementById('Covering')) {

    send = {
        "applicationId": null,
        "proposerDOB": null,
        "sumAssured": null
    };

    cyberSearchPlan(AppConstants.API_SELECTOR.CYBER_SEARCH_PLAN.name, send);
}

function grossPremium() {
    var grossValue = cyberData.payload.planDetails.find(function (plan) {
        return plan.sumAssured == document.getElementById("Covering").value;
    }).grossPremium;
    console.log(grossValue);
    var x = grossValue;
    document.getElementById("displaygrossValue").innerHTML = "<br>" + "Rs. " + x.toLocaleString();
}

//cyber url creation
function cyberBuyNow(selector, data) {
    var form = findSelectorParent(event.target, ".bs-form");
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            localStorage.setItem("mobileNumber", form.querySelector("#mobileNumber").value);
            var url = handoverEndpointURL + cyberHandoverURL
            url += "apcantid=" + response.payload.applicantId + "&";
            url += "aptionid=" + response.payload.applicationId + "&";
            url += "apcaptid=" + response.payload.applicationApplicantId + "&";
            url += "skipLogin=true";

            response.responseURL = url;
            var responsevalue = response.responseURL;
            var searchParams = new URLSearchParams(responsevalue);

            var applicationId = response.payload.applicationId || "";
            var mobileno;
            if (localStorage.hasOwnProperty("defaultUserValue")) {
                var isMob = JSON.parse(localStorage.getItem("defaultUserValue"));
                if (isMob.hasOwnProperty("mobileNumber")) {
                    mobileno = isMob.mobileNumber;
                } else {
                    mobileno = ""
                }
            }
            var appStage = "NA";
            var dob = "NA";
            var trafficType = "No Offer";
            if (response.payload.existingApplicationFound) {
                var resumeAppStage = productName + "_LEAD_PROD_INFO" || "";
                var resumePage = digitalData.page.name;
                triggerToResumeCalls(applicationId, mobileno, appStage, dob, trafficType, resumeAppStage, resumePage);
            } else {
                    /*triggerCreateLead(applicationId, productName);*/
                	triggerToCreatApplication(applicationId, mobileno, appStage, dob, trafficType);
            }
            if (window.location.href.includes("is-mobile")) {
                url += "&isMobile=1";
            }
            if (response.payload.authToken) {
                window.sessionStorage.setItem("SS_1", response.payload.authToken)
                window.sessionStorage.setItem("SS_4", response.payload.guardKey)
                document.cookie = "SS_1=" + response.payload.authToken
                document.cookie = "SS_4=" + response.payload.guardKey
            }

            location.href = response.responseURL;
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false);
        }
        popup_close()
    }).catch(function (err) {
        toggleLoader(false);
    })
}
//cyber url creation

function callAjaxForBuyNowCyber(event) {
    var form = findSelectorParent(event.target, ".bs-form");
    console.log(form);
    var hasEmail = $(form).find("#email").length == 1;
    var email;

    if (hasEmail) {
        email = $(form).find("#email").val();
    }

    var selectedPlan = cyberData.payload.planDetails.find(function (plan) {
        return plan.sumAssured == document.getElementById("Covering").value;
    });
    var string = document.getElementById("cyberfullName").value;
    string = string.split(" ");
    console.log(string);
    console.log(string[0]);
    console.log(string[1]);
    var cyberfirstName = string[0];
    var cyberlastName = string[1];

    if (string == "") {
        showError("cyberfullNameErrorMsg", "Enter Valid Full name", true);
    } else {
        if (cyberlastName == undefined || "") {
            cyberlastName = "";
            showError("cyberfullNameErrorMsg", "Enter Valid last name", false);
        } else {
            showError("cyberfullNameErrorMsg", "Enter Valid last name", true);
        }

        if (/^[a-zA-Z]+$/.test(cyberfirstName)) {
            showError("cyberfullNameErrorMsg", "Enter Valid First name", false);
        } else {
            showError("cyberfullNameErrorMsg", "Enter Valid First name", true);
        }

        if (/^[a-zA-Z]+$/.test(cyberlastName)) {
            showError("cyberfullNameErrorMsg", "Enter Valid Last name", false);
        } else {
            showError("cyberfullNameErrorMsg", "Enter Valid Last name", true);
        }
    }

    var cybermobileNumber = form.querySelector("#mobileNumber").value;

    if (/^[6-9][0-9]{9}$/.test(cybermobileNumber)) {
        showError("mobileNumberErrorMsg", "Enter Valid Mobile Number", false);
    } else {
        showError("mobileNumberErrorMsg", "Enter Valid Mobile Number", true);
    }

    if (hasEmail) {
        if (/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email)) {
            showError("emailErrorMsg", "Insert Valid Email Id.", false);
        } else {
            showError("emailErrorMsg", "Insert Valid Email Id.", true);
        }
    }

    if (hasEmail === true) {
        if (/^[a-zA-Z]+$/.test(cyberfirstName) && /^[a-zA-Z]+$/.test(cyberlastName) && /^[6-9][0-9]{9}$/.test(cybermobileNumber) && /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email)) {} else {
            return;
        }
    } else {
        if (/^[a-zA-Z]+$/.test(cyberfirstName) && /^[a-zA-Z]+$/.test(cyberlastName) && /^[6-9][0-9]{9}$/.test(cybermobileNumber)) {} else {
            return;
        }
    }

    /*
     var formData = new FormData();
     formData.append("userAction", "buynow");
     formData.append("is-mobile", window.isMobile);
     formData.append("selectedPlanDetails", JSON.stringify(selectedPlanDetails));
     formData.append("utmParams", JSON.stringify(window.utmParams));
     formData.append("channelType", JSON.stringify(window.channelType));
     formData.append("firstName", cyberfirstName || "");
     formData.append("lastName", cyberlastName || "");
     formData.append("mobileNumber", cybermobileNumber || "");
     formData.append("emailId", email || "");
     formData.append("isCampaign", $("#isCampaign").val() || "");
     var coveringFor = document.getElementById('Covering').value;
     var sendData = new URLSearchParams(formData).toString();*/
    var coveringFor = document.getElementById('Covering').value;

    var gclID;
    try {
        gclID = _satellite.getVisitorId().getMarketingCloudVisitorID()
    } catch (err) {
        console.log(err);
    }

    var send = {
        "userAction": "buynow",
        "channelType": JSON.stringify(window.channelType),
        "selectedPlanDetails": {
            "sumAssured": document.getElementById('Covering').value,
            "planCode": selectedPlan.planCode,
            "variantCode": selectedPlan.variantCode,
            "policyTerm": cyberData.payload.policyTerm,
            "netPremium": selectedPlan.netPremium,
            "gst": selectedPlan.gst,
            "grossPremium": selectedPlan.grossPremium
        },
        "utmParams": {
            "utmSource": window.utmParams.utmSource,
            "utmMedium": window.utmParams.utmMedium,
            "utmCampaign": window.utmParams.utmCampaign,
            "utmContent": window.utmParams.utmContent,
            "utmTerm": window.utmParams.utmTerm
        },
        "proposerDetails": {
            "firstName": cyberfirstName,
            "middleName": "",
            "lastName": cyberlastName,
            "mobileNumber": cybermobileNumber
        }
    }

    if (gclID != undefined) {
        send.utmParams.gclId = gclID;
    } else {
        send.utmParams.gclId = "";
    }
    console.log(JSON.stringify(send))

    triggerCyberBuyNow(coveringFor);
    cyberBuyNow(AppConstants.API_SELECTOR.CYBER_BUY_NOW.name, send)
}
var jsonDataHealth;
var activePlan = "";
var selectedInsurancePlanDetails = {};
var planAjaxData = {};
function setActivePlan(event, ele, state) {
    activePlan = ele.getAttribute("Data-variantCode")
    planAjaxData[activePlan]["buyNowSource"] = ele.getAttribute("Data-sourceCode")
    switch (state) {
        case 1:
            callAjaxForHealthBuyNow(event)
            break;

    }
    if (/buy/g.test(ele.innerText.trim())) {
        // triggerHealthBuyNow(planAjaxData[activePlan].variantCode,
        // planAjaxData[activePlan].policyTerm,
        // planAjaxData[activePlan].isRecommend,
        // planAjaxData[activePlan].sumAssured,
        // planAjaxData[activePlan]["buyNowSource"],true);
    }
    else if (/email/g.test(ele.innerText.trim())) {
    }
    console.log(planAjaxData[activePlan])
}
function setYearlyQuoteWrapElement(premiumDetailsAsPerTenorData, variantCode) {
    var yqList = document.createElement("ul");
    yqList.className = "yq-list";
    premiumDetailsAsPerTenorData.forEach(function (premiumDetailsAsPerTenorObj, index) {
        var yqItem = document.createElement("div");
        yqItem.className = "yq-item";
        var bsRadio = document.createElement("div");
        bsRadio.className = "bs-radio";
        var input = document.createElement("input");
        input.type = "radio";
        input.name = "premiumDetailsAsPerTenor" + variantCode
        input.id = variantCode + index;
        bsRadio.appendChild(input)
        var label = document.createElement("label");
        label.setAttribute("for", variantCode + index);
        label.className = "input-label";
        label.innerText = premiumDetailsAsPerTenorObj.policyTerm + " year" + ((premiumDetailsAsPerTenorObj.discountPercentage != "0") ? " - save " + premiumDetailsAsPerTenorObj.discountPercentage + "%" : "");
        label.setAttribute("data-grossPremium", premiumDetailsAsPerTenorObj.grossPremium);
        label.setAttribute("data-gst", premiumDetailsAsPerTenorObj.gst);
        label.setAttribute("data-netPremium", premiumDetailsAsPerTenorObj.netPremium);
        label.setAttribute("data-policyTerm", premiumDetailsAsPerTenorObj.policyTerm);

        label.addEventListener("click", function (e) {
            $(".quote-amount-" + variantCode).html("&#8377; " + e.target.getAttribute("data-grossPremium"))
            planAjaxData[variantCode].grossPremium = e.target.getAttribute("data-grossPremium")
            planAjaxData[variantCode].gst = e.target.getAttribute("data-gst")
            planAjaxData[variantCode].netPremium = e.target.getAttribute("data-netPremium")
            planAjaxData[variantCode].policyTerm = e.target.getAttribute("data-policyTerm")
        })
        bsRadio.appendChild(label)
        yqItem.appendChild(bsRadio);
        yqList.appendChild(yqItem);
    })
    return yqList;
}
// changed
var firstPlan = true;
var firstPlanDesktop = true;
function setPlanDetailsInhealth(planData) {
    var count = planData.count;
    var premium = planData.premium;
    var planCode = planData.planCode;
    var variantCode = planData.variantCode;
    var premiumDetailsAsPerTenorData = planData.premiumDetailsAsPerTenor;
    var proposedSumAssuredList = planData.proposedSumAssuredList;
    var zoneList = planData.zoneList;
    var featureDetails = planData.featureDetails;
    var displayName = planData.displayName;
    var displayTitle = planData.displayTitle;
    var displaySubTitle = planData.displaySubTitle;
    var isRecommend = planData.isRecommend;
    var sumAssured = planData.sumAssured;
    var quoteListItem = document.createElement("div");
    if (!planAjaxData[variantCode]) {
        planAjaxData[variantCode] = {
            insuringFor: jsonDataHealth.payload.insuringFor,
            sumAssured: sumAssured,
            zoneCode: "",
            zone: "",
            policyTerm: "",
            planCode: planCode,
            variantCode: variantCode,
            netPremium: "",
            gst: "",
            grossPremium: "",
            isRecommend: isRecommend
        }
    }

    // if(document.getElementsByClassName("quote-list-item aem-GridColumn
    // aem-GridColumn--default--6 aem-GridColumn--tablet--6
    // aem-GridColumn--phone--12 scroll-plan-1")){
    quoteListItem.className = "quote-list-item aem-GridColumn aem-GridColumn--default--6 aem-GridColumn--tablet--6 aem-GridColumn--phone--12 scroll-plan-1";


    var quoteCard = document.createElement("div");
    quoteCard.className = "bs-quote-card";
    if (firstPlan) {
        quoteCard.className += " active";
        // firstPlan = false;
    }
    quoteCard.setAttribute("rel", "quote-" + variantCode);
    var icon = document.createElement("span");
    icon.className = "icon icon-star";
    var cardHead = document.createElement("div");
    cardHead.className = "card-head typ-double-line";
    var quotePrice = document.createElement("div");
    quotePrice.className = "quote-price";
    var amount = document.createElement("span");
    amount.className = " quote-amount-" + variantCode;
    amount.className += " amount";
    amount.innerHTML = "&#8377; " + premium;
    var unit = document.createElement("span");
    unit.className = "unit";
    unit.innerHTML = "one time premium including GST";

    quotePrice.appendChild(amount)
    quotePrice.appendChild(unit)
    cardHead.appendChild(quotePrice);
    var cardHeadTitle = document.createElement("h3");
    cardHeadTitle.className = "title";
    cardHeadTitle.innerHTML = displayTitle + '<span class="cm-line-break">' + displaySubTitle + '</span>';
    cardHead.appendChild(cardHeadTitle);

    var cardSubHead = document.createElement("div");
    cardSubHead.className = "card-sub-head";
    var bsForm = document.createElement("div");
    bsForm.className = "bs-form";
    var formList = document.createElement("ul");
    formList.className = "form-list";
    var premiumDetailsAsPerTenor = document.createElement("li");
    premiumDetailsAsPerTenor.className = "item";
    var yearlyQuoteWrap = document.createElement("div");
    yearlyQuoteWrap.id = "yearly-quote-wrap-" + variantCode;
    yearlyQuoteWrap.className = "yearly-quote-wrap";

    yearlyQuoteWrap.appendChild(setYearlyQuoteWrapElement(premiumDetailsAsPerTenorData, variantCode));
    premiumDetailsAsPerTenor.appendChild(yearlyQuoteWrap);
    var sumInsuredContainer = document.createElement("div");
    sumInsuredContainer.className = "bs-label-value-pair";
    var sumInsuredLabel = document.createElement("div");
    sumInsuredLabel.className = "label";
    sumInsuredLabel.innerText = "Sum Insured";
    sumInsuredContainer.appendChild(sumInsuredLabel);
    var valueSumInsured = document.createElement("div");
    valueSumInsured.className = "value";
    var select = document.createElement("select");
    select.setAttribute("data-variantCode", variantCode)
    select.setAttribute("data-sumAssured", sumAssured)
    select.className = "select form-control sumassuredDefault";
    proposedSumAssuredList.forEach(function (proposedSumAssured) {
        var option = document.createElement("option");
        option.value = proposedSumAssured;
        option.innerHTML = "&#8377;" + proposedSumAssured.toLocaleString();
        select.appendChild(option);
    })

    valueSumInsured.appendChild(select);
    sumInsuredContainer.appendChild(valueSumInsured);
    premiumDetailsAsPerTenor.appendChild(sumInsuredContainer);

    var zoneContainer = document.createElement("div");
    var iconbs = document.createElement("div");
    var icondrop = document.createElement("div");
    var icondiv = document.createElement("i");
    iconbs.className = "info bs-dropdown-hover bs-dropdown center";
    icondrop.className = "dropdown-heading";
    icondiv.className = "icon icon-question";

    icondrop.appendChild(icondiv);
    var tipcontainer = document.createElement("div");
    var tiptitle = document.createElement("div");
    var tiptext = document.createElement("div");
    tipcontainer.className = "dropdown-content";
    tiptitle.className = "title";
    tiptitle.innerHTML = "What is co-pay?";
    tiptext.className = "content";

    tiptext.innerHTML += "If you want to seek treatment in a hospital other than the city that you reside in,";
    tiptext.innerHTML += "then at the time of hospitalization you will need to pay the Co-payment amount ";
    tiptext.innerHTML += "from your own pocket.<br>";
    tiptext.innerHTML += "Cities where copay will be applicable: Mumbai (Navi Mumbai, Thane, Kalyan), ";
    tiptext.innerHTML += "Delhi/NCR, Bangalore, Kolkata, Ahmedabad, Vadodara and Surat, Hyderabad and Secunderabad.";
    tipcontainer.appendChild(tiptitle);
    tipcontainer.appendChild(tiptext);
    zoneContainer.className = "bs-label-value-pair";
    if (planData.zoneCode == "ZONEB") {
        var zoneLabel = document.createElement("div");
        zoneLabel.className = "label copay bs-sum typ-filter";
        zoneLabel.innerText = "Do you want to opt for Co-payment?";
        iconbs.appendChild(icondrop);
        iconbs.appendChild(tipcontainer);
        zoneLabel.appendChild(iconbs);
        zoneContainer.appendChild(zoneLabel);
        var zoneValue = document.createElement("div");
        zoneValue.className = "value copay-select";
        zoneValue.setAttribute("data-variantCode", variantCode);
        zoneValue.setAttribute("data-zone", planData.zoneCode);


        var radio1 = document.createElement("input");
        radio1.type = "radio";
        radio1.value = "ZONEB";
        radio1.className = "radio";
        radio1.name = "" + variantCode;
        radio1.setAttribute("data-zone", planData.zoneCode);
        radio1.setAttribute("data-variantCode", variantCode);
        radio1.checked = true;
        var radioLabel1 = document.createElement("label");
        radioLabel1.className = "control control--radio copay";
        radioLabel1.innerText = "Yes";
        var radioDiv1 = document.createElement("div");
        radioDiv1.className = "control__indicator copay";
        radioLabel1.appendChild(radio1);
        radioLabel1.appendChild(radioDiv1);



        var radio2 = document.createElement("input");
        radio2.type = "radio";
        radio2.value = "ZONEA";
        radio2.className = "radio";
        radio2.name = "" + variantCode;
        radio2.setAttribute("data-zone", planData.zoneCode);
        radio2.setAttribute("data-variantCode", variantCode);
        var radioLabel2 = document.createElement("label");
        radioLabel2.className = "control control--radio copay";
        radioLabel2.innerText = "No";
        var radioDiv2 = document.createElement("div");
        radioDiv2.className = "control__indicator copay";
        radioLabel2.appendChild(radio2);
        radioLabel2.appendChild(radioDiv2);

        zoneValue.appendChild(radioLabel1);
        zoneValue.appendChild(radioLabel2);
        zoneContainer.appendChild(zoneValue);

    }


    premiumDetailsAsPerTenor.appendChild(zoneContainer);
    formList.appendChild(premiumDetailsAsPerTenor);
    bsForm.appendChild(formList);
    cardSubHead.appendChild(bsForm);
    var cardBody = document.createElement("div");
    cardBody.className = "card-body";
    var cardList = document.createElement("div");
    cardList.className = "card-list";
    var list = document.createElement("ul");
    featureDetails.forEach(function (featureDetail, index) {
        if (index < 3) {
            var li = document.createElement("li");
            var liLable = document.createElement("div");
            liLable.className = "bs-label-value-pair";
            var label = document.createElement("div");
            label.className = "label";
            label.innerText = featureDetail.featureDescription;
            var value = document.createElement("div");
            value.className = "value";
            value.innerText = featureDetail.value;
            liLable.appendChild(label);
            liLable.appendChild(value);
            li.appendChild(liLable);
            list.appendChild(li);
        }
    })
    cardList.appendChild(list);
    cardBody.appendChild(cardList);
    var cardFooter = document.createElement("div");
    cardFooter.className = "card-footer type-center";
    var btnWrap = document.createElement("div");
    btnWrap.className = "button-wrap";
    var btn = document.createElement("button");
    btn.className = "btn buy-now quote" + variantCode;
    // btn.setAttribute("data-toggle", "popup");
    // btn.setAttribute("data-target", "#myPopup-buy-now");
    btn.setAttribute("data-variantCode", variantCode);
    btn.setAttribute("data-sourceCode", "card");
    btn.setAttribute("onclick", "setActivePlan(event,this,1)")
    btn.innerText = "buy now";
    btnWrap.appendChild(btn);
    cardFooter.appendChild(btnWrap);
    if (isRecommend) {
        quoteCard.appendChild(icon);
    }
    quoteCard.appendChild(cardHead);
    quoteCard.appendChild(cardSubHead);
    quoteCard.appendChild(cardBody);
    quoteCard.appendChild(cardFooter);
    quoteListItem.appendChild(quoteCard);
    var quoteDetailsWrap = document.createElement("div");
    quoteDetailsWrap.className = "quote-details-wrapper  mobile";
    var detailsContent = document.createElement("div");
    detailsContent.className = "detail-content";
    if (firstPlan) {
        detailsContent.className += " active";
        firstPlan = false;
    }
    detailsContent.setAttribute("name", "quote-" + variantCode);
    console.log("detailscontent: " + detailsContent);
    var quoteCard = document.createElement("div");
    quoteCard.className = "bs-quote-card typ2";
    var cardHead = document.createElement("div");
    cardHead.className = "card-head";
    cardHead.innerHTML = '<button class="btn buy-now quote"' + variantCode + '" data-sourceCard="card" data-variantCode="' + variantCode + /*
																																			 * '
																																			 * data-toggle="popup"
																																			 * data-target="#myPopup-buy-now"
																																			 */' onclick="setActivePlan(event,this,1)">buy now</button><h3 class="title">' + displayName + '</h3><div class="quote-price"><span class="amount">&#8377;' + amount + ' </span></div>';
    quoteCard.appendChild(cardHead);
    var cardSubHeading = document.createElement("div");
    cardSubHeading.className = "card-sub-heading";
    cardSubHeading.innerHTML = '<div class="heading">Coverage</div><div class="heading last">Benefits</div>';
    quoteCard.appendChild(cardSubHeading);
    var cardBody = document.createElement("div");
    cardBody.className = "card-body";
    var cardList = document.createElement("div");
    cardList.className = "card-list";
    var ul = document.createElement("ul");
    featureDetails.forEach(function (featureDetail) {
        var li = document.createElement("li");
        var liLable = document.createElement("div");
        liLable.className = "bs-label-value-pair";
        var label = document.createElement("div");
        label.className = "label";
        label.innerText = featureDetail.featureDescription;
        var value = document.createElement("div");
        value.className = "value";
        value.innerText = featureDetail.value;
        liLable.appendChild(label);
        liLable.appendChild(value);
        li.appendChild(liLable);
        ul.appendChild(li);
    })
    cardList.appendChild(ul);
    cardBody.appendChild(cardList);
    quoteCard.appendChild(cardBody);
    detailsContent.appendChild(quoteCard);
    var btnWrapExtra = document.createElement("div");
    btnWrapExtra.className = "button-wrap typ-2";
    btnWrapExtra.innerHTML = '<button class="btn quote' + variantCode + '" data-variantCode="' + variantCode + '" data-toggle="popup" data-target="#myPopup-email-varient" onclick="setActivePlan(event,this)"  >Email Quote</button><button class="btn" data-variantCode="' + planData.variantCode + '" onclick="callAjaxForHealthDownload(this)">DOWNLOAD sales brochure</button>';
    detailsContent.appendChild(btnWrapExtra);
    quoteDetailsWrap.appendChild(detailsContent);
    quoteListItem.appendChild(quoteDetailsWrap);

    return quoteListItem;
}
// changed

function setPlanDetailsInHealthForDesktop(planData) {
    var count = planData.count;
    var premium = planData.premium;
    var planCode = planData.planCode;
    var variantCode = planData.variantCode;
    var premiumDetailsAsPerTenorData = planData.premiumDetailsAsPerTenor;
    var proposedSumAssuredList = planData.proposedSumAssuredList;
    var zoneList = planData.zoneList;
    var featureDetails = planData.featureDetails;
    var displayName = planData.displayName;
    var displayTitle = planData.displayTitle;
    var displaySubTitle = planData.displaySubTitle;
    var isRecommend = planData.isRecommend;


    var detailContent = document.createElement("div");
    detailContent.className = "detail-content";
    if (firstPlanDesktop) {
        detailContent.className += " active";
        firstPlanDesktop = false;
    }
    detailContent.setAttribute("name", "quote-" + variantCode)
    var bsQuoteCard = document.createElement("div");
    bsQuoteCard.className = "bs-quote-card typ2";
    var cardHead = document.createElement("div");
    cardHead.className = "card-head";
    var btn = document.createElement("button");
    btn.className = "btn buy-now quote" + variantCode;
    btn.innerText = "buy now";
    // btn.setAttribute("data-toggle", "popup");
    // btn.setAttribute("data-target", "#myPopup-buy-now");

    btn.setAttribute("data-variantCode", planData.variantCode);
    btn.setAttribute("data-sourceCode", "details");
    btn.setAttribute("onClick", "setActivePlan(event,this,1)");
    var h3 = document.createElement("h3");
    h3.className = "title";
    h3.innerText = displayName;
    var quotePrice = document.createElement("div");
    quotePrice.className += " quote-price";
    quotePrice.innerHTML = '<span class="amount quote-amount-' + variantCode + '">&#8377; ' + premium + '</span>';

    cardHead.appendChild(btn);
    cardHead.appendChild(h3);
    cardHead.appendChild(quotePrice);

    var cardSubHeading = document.createElement("div");
    cardSubHeading.className = "card-sub-heading";
    cardSubHeading.innerHTML = '<div class="heading">Coverage</div><div class="heading last">Benefits</div>';

    var cardBody = document.createElement("div");
    cardBody.className = "card-body";
    var cardList = document.createElement("div");
    cardList.classList.add("card-list");
    var ul = document.createElement("ul");
    featureDetails.forEach(function (featureDetail) {
        var li = document.createElement("li");
        var liLable = document.createElement("div");
        liLable.className = "bs-label-value-pair";
        var label = document.createElement("div");
        label.className = "label";
        label.innerText = featureDetail.featureDescription;
        var value = document.createElement("div");
        value.className = "value";
        value.innerText = featureDetail.value;
        liLable.appendChild(label);
        liLable.appendChild(value);
        li.appendChild(liLable);
        ul.appendChild(li);
    })
    cardList.appendChild(ul)
    cardBody.appendChild(cardList);

    bsQuoteCard.appendChild(cardHead);
    bsQuoteCard.appendChild(cardSubHeading);
    bsQuoteCard.appendChild(cardBody);
    var btnWrap = document.createElement("div");
    btnWrap.className = "button-wrap typ-2";
    btnWrap.innerHTML = '<button class="btn quote' + variantCode + '" data-variantCode="' + variantCode + '" data-toggle="popup" data-target="#myPopup-email-varient" onclick="setActivePlan(event,this)"  >Email Quote</button><button class="btn"  data-variantCode="' + planData.variantCode + '" onclick="callAjaxForHealthDownload(this)">DOWNLOAD sale s brochure</button>';
    detailContent.appendChild(bsQuoteCard);
    detailContent.appendChild(btnWrap);
    copay_hover();
    return detailContent;
}
function loadPlanDetailsHealth(jsonDataHealth) {
    try {
        toggleLoader(true);
        var parentContainer = findSelectorParent($("#insuringFor")[0], "FORM");
        document.getElementById("pincodeJsonValue").innerText = jsonDataHealth.payload.pinCode
        document.getElementById("genderJsonValue").innerText = (jsonDataHealth.payload.gender == "F") ? "Female" : "Male";
        $(parentContainer).find("#insuringFor").val(jsonDataHealth.payload.insuringFor)
        $(parentContainer).find("#gender").val(jsonDataHealth.payload.gender)

        $(parentContainer).find("#pinCode").val(jsonDataHealth.payload.pinCode)
        switch (jsonDataHealth.payload.insuringFor) {

            case "2":
                document.getElementById("familyDropdown") == null ? "" : document.getElementById("familyDropdown").remove();
                break;
            case "3":
                document.getElementById("individualDropdown") == null ? "" : document.getElementById("individualDropdown").remove();
                break;
            default:
                document.getElementById("individualDropdown") == null ? "" : document.getElementById("individualDropdown").remove();
                document.getElementById("familyDropdown") == null ? "" : document.getElementById("familyDropdown").remove();
                break;
        }
        $(parentContainer).find("#insuringListInnerText").html("");
        jsonDataHealth.payload.insuredDetails.forEach(function (insuredObj) {
            $(parentContainer).find("#insuringListInnerText").html($(parentContainer).find("#insuringListInnerText") + insuredObj.relationship.toLowerCase() + ",");
        })
        $(parentContainer).find("#insuringListInnerText").html($(parentContainer).find("#insuringListInnerText").html().slice(0, -1));
        $(parentContainer).find("[data-insured] label").each(function (ele) {
            var insuredEle = this;
            var relationship = insuredEle.innerText.trim().toLowerCase();
            jsonDataHealth.payload.insuredDetails.forEach(function (insuredObj) {
                if (insuredObj.relationship.toLowerCase() == relationship) {
                    if (!insuredEle.querySelector("input").checked) {
                        insuredEle.click();
                    }
                    findSelectorParent(insuredEle, ".checkbox-list").querySelector("[type=tel]").value = insuredObj.age;
                    return;
                }
            })
        })
        var daughterIsured = jsonDataHealth.payload.insuredDetails.filter(function (insuredObj) {
            return (insuredObj.relationship == "DAUGHTER") ? true : false;
        })
        for (var i = 1; i < daughterIsured.length; i++) {
            if ($(parentContainer).find("#familyDropdown .icon[data-daughter]").length < daughterIsured.length) {
                $(parentContainer).find("#familyDropdown .icon-plus[data-daughter]").click();
            }
        }
        var sonIsuredObj = jsonDataHealth.payload.insuredDetails.filter(function (insuredObj) {
            return (insuredObj.relationship == "SON") ? true : false;
        })
        for (var i = 1; i < sonIsuredObj.length; i++) {
            if ($(parentContainer).find("#familyDropdown .icon[data-son]").length < sonIsuredObj.length) {
                $(parentContainer).find("#familyDropdown .icon-plus[data-son]").click();
            }
        }
        if (sonIsuredObj && sonIsuredObj.length > 0) {
        	var eleIn=0;
            $(parentContainer).find("#familyDropdown .icon").each(function (ele, index) {
            	if(!index.hasAttribute("data-daughter")){
            		var relationship = findSelectorParent(this, ".bs-form").querySelector("label").innerText.trim().toLowerCase();
                    var insuredObj = sonIsuredObj[eleIn];
                    if(insuredObj != undefined){
                    	if (insuredObj.relationship.toLowerCase() == relationship) {
                            /*if (!findSelectorParent(this, ".bs-form").querySelector("label").querySelector("input").checked) {
                                findSelectorParent(this, ".bs-form").querySelector("label").click();
                            }*/
                            findSelectorParent(this, ".checkbox-list").querySelector("[type=tel]").value = insuredObj.age;
                            eleIn++;
                            return;
                        }
                    }
            	}
            })
        }
        if (daughterIsured && daughterIsured.length > 0) {
        	var eleIn=0;
            $(parentContainer).find("#familyDropdown .icon").each(function (ele, index) {
            	if(!index.hasAttribute("data-son")){
                    var relationship = findSelectorParent(this, ".bs-form").querySelector("label").innerText.trim().toLowerCase();
                    var insuredObj = daughterIsured[eleIn];
                    if(insuredObj != undefined){
                    	if (insuredObj.relationship.toLowerCase() == relationship) {
                            /*if (!findSelectorParent(this, ".bs-form").querySelector("label").querySelector("input").checked) {
                                findSelectorParent(this, ".bs-form").querySelector("label").click();
                            }*/
                            findSelectorParent(this, ".checkbox-list").querySelector("[type=tel]").value = insuredObj.age;
                            eleIn++;
                            return;
                        }
                    }
            	}
            })
        }
        var showDataOfPayloadHealth = document.getElementById("showDataOfPayloadHealth");
        var updatedInsureDetails = jsonDataHealth.payload.insuredDetails.map(function (insureDetails, index, self) {
            insureDetails.ages = []
            insureDetails.index = self.filter(function (insureDetailsObj) {
                if (insureDetailsObj.relationship == insureDetails.relationship) {
                    insureDetails.ages.push(insureDetailsObj.age)
                }

                return (insureDetailsObj.relationship == insureDetails.relationship)
            }).length
            return insureDetails;
        })

        updatedInsureDetails = removeDuplicatesFromObj(updatedInsureDetails, "relationship");
        var insuringListInnerText = document.getElementById("insuringListInnerText");
        insuringListInnerText.innerText = "";

        document.querySelectorAll(".healthage").forEach(function eachagefunc(eachage) { eachage.remove() });

        if (showDataOfPayloadHealth) {
            updatedInsureDetails.forEach(function (insuredDetail) {

                var item = document.createElement("div");
                item.className = "aem-GridColumn aem-GridColumn--default--2 aem-GridColumn--tablet--6 aem-GridColumn--phone--6 item healthage";
                var labelValueForm = document.createElement("div");
                labelValueForm.className = "label-value-form";
                var formLabel = document.createElement("div");
                formLabel.className = "form-label";
                formLabel.innerText = insuredDetail.relationship;
                labelValueForm.appendChild(formLabel);
                var value = document.createElement("div");
                value.className = "value";
                value.innerText = ""
                insuredDetail.ages.forEach(function (age) {
                    value.innerText += age + " years, ";
                })
                
                insuringListInnerText.innerText += ((insuredDetail.index > 1) ? insuredDetail.index : "") + insuredDetail.relationship + ", ";

                value.innerText = value.innerText.slice(0, -2);
                labelValueForm.appendChild(value);
                item.appendChild(labelValueForm)
                showDataOfPayloadHealth.appendChild(item);
            })
            
            insuringListInnerText.innerText = insuringListInnerText.innerText.slice(0, -2);
        }
        var totalPlanInHealth = document.getElementById("totalPlanInHealth");

        if (totalPlanInHealth && jsonDataHealth.payload.recommendedPlans) {
            totalPlanInHealth.innerText = jsonDataHealth.payload.recommendedPlans.length + jsonDataHealth.payload.otherPlans.length;
        }
        var recommendFirstPlanDisplay = document.getElementById("recommendFirstPlanDisplay");
        if (recommendFirstPlanDisplay && jsonDataHealth.payload.recommendedPlans && jsonDataHealth.payload.recommendedPlans.length > 0) {
            recommendFirstPlanDisplay.innerText = jsonDataHealth.payload.recommendedPlans[0].displayName.trim();
        }

        jsonDataHealth.payload.totalPlans = []

        if (jsonDataHealth.payload.recommendedPlans) {
            jsonDataHealth.payload.recommendedPlans.forEach(function (planData, index) {
                planData.count = index + 1;
                planData.premium = planData.premiumDetailsAsPerTenor[0].grossPremium;
                planData.zoneList = ["A", "B"];
                planData.isRecommend = true;
                planData.displayTitle = planData.displayName.split("-")[0];
                planData.displaySubTitle = (planData.displayName.split("-").length == 2) ? planData.displayName.split("-")[1] : "";
                document.querySelector("#setPlanDetailsContainerInHealth").innerHTML = "";
                document.getElementById("setPlanDetailsContainerInHealth").appendChild(setPlanDetailsInhealth(planData));
            })
            jsonDataHealth.payload.recommendedPlans.forEach(function (plan) {
                jsonDataHealth.payload.totalPlans.push(plan);
            })
        }
        if (jsonDataHealth.payload.otherPlans) {
            jsonDataHealth.payload.otherPlans.forEach(function (planData, index) {
                planData.count = index + 1;
                planData.premium = planData.premiumDetailsAsPerTenor[0].grossPremium;
                planData.zoneList = ["A", "B"];
                planData.isRecommend = false;
                planData.displayTitle = planData.displayName.split("-")[0];
                planData.displaySubTitle = (planData.displayName.split("-").length == 2) ? planData.displayName.split("-")[1] : "";
                document.querySelector("#setPlanDetailsContainerInHealth").innerHTML;
                document.getElementById("setPlanDetailsContainerInHealth").appendChild(setPlanDetailsInhealth(planData));
            })
            jsonDataHealth.payload.otherPlans.forEach(function (plan) {
                jsonDataHealth.payload.totalPlans.push(plan);
            })
        }
        document.querySelector("#setPlanDetailsContainerInHealthForDesktop").innerHTML = "";
        jsonDataHealth.payload.totalPlans.forEach(function (planData, index) {
            planData.count = index + 1;
            planData.zoneList = ["A", "B"];
            planData.isRecommend = false;
            planData.displayTitle = planData.displayName.split("-")[0];
            planData.displaySubTitle = (planData.displayName.split("-").length == 2) ? planData.displayName.split("-")[1] : "";
            document.getElementById("setPlanDetailsContainerInHealthForDesktop").appendChild(setPlanDetailsInHealthForDesktop(planData));
        })

        if (document.querySelectorAll("#setPlanDetailsContainerInHealth .bs-quote-card")[0].classList.contains("active") == false) {
            document.querySelectorAll("#setPlanDetailsContainerInHealth .bs-quote-card")[0].setAttribute("class", "bs-quote-card active");
        }
        if (document.querySelectorAll("#setPlanDetailsContainerInHealthForDesktop .detail-content")[0].classList.contains("active") == false) {
            document.querySelectorAll("#setPlanDetailsContainerInHealthForDesktop .detail-content")[0].setAttribute("class", "detail-content active");
        }
        if (document.querySelectorAll("#setPlanDetailsContainerInHealthForDesktop .detail-content")[0].style.display == "none" || document.querySelectorAll("#setPlanDetailsContainerInHealthForDesktop .detail-content")[0].style.display == "") {
            document.querySelectorAll("#setPlanDetailsContainerInHealthForDesktop .detail-content")[0].style.display = "block";
        }
        quoteDetails();
        select();

        $('.bs-quote-card .copay .radio').change('.copay .radio', function (e) {
            planAjaxData[e.target.getAttribute("data-variantCode")].zone = e.target.value;
            planAjaxData[e.target.getAttribute("data-variantCode")].zoneCode = e.target.value;
            callAjaxForHealthZonePlan(e);
        });
        $('.bs-quote-card .select.sumassuredDefault').on('select2:select', function (e) {
            planAjaxData[e.target.getAttribute("data-variantCode")].sumAssured = e.target.value;
            callAjaxForHealthZonePlan(e);
        });
        $('.bs-quote-card .select.sumassuredDefault').each(function (e, ele) {
            ele.value = ele.getAttribute("data-sumassured");
            planAjaxData[ele.getAttribute("data-variantCode")].sumAssured = ele.value;
            $(ele).trigger('change.select2');
        })
        $('.bs-quote-card .copay-select').each(function (e, ele) {
            ele.value = ele.getAttribute("data-zone");
            planAjaxData[ele.getAttribute("data-variantCode")].zone = ele.value;
            planAjaxData[ele.getAttribute("data-variantCode")].zoneCode = ele.value;
            $(ele).trigger('change');
        })
        popup();
        $(".yq-list .yq-item:first-child label").click();
        document.getElementById("recommendFirstPlanDisplay").scrollIntoView();
        callHealthTrigger()
        toggleLoader(false)

        callHealthTrigger()
    }
    catch (e) {
        console.error("error : ", e)
    }
}

document.addEventListener("DOMContentLoaded", function () {

    if (document.getElementById("healthType")) {
        showCompareEle();
        try {
            if (localStorage.hasOwnProperty("getQuoteData")) {
                if (document.getElementById("healthType").value == "" && window.location.href.includes("/health-Quote.h")) {
                    response = localStorage.getItem("getQuoteData");
                    jsonDataHealth = response;
                    document.getElementById("healthType").value = jsonDataHealth.payload.healthType;
                    loadPlanDetailsHealth(jsonDataHealth)
                } else if (document.getElementById("healthType").value == JSON.parse(localStorage.getItem("getQuoteData")).payload.healthType && window.location.href.includes("/health-Quote.h")) {
                    response = localStorage.getItem("getQuoteData");
                    jsonDataHealth = response;
                    document.getElementById("healthType").value = jsonDataHealth.payload.healthType;
                    loadPlanDetailsHealth(jsonDataHealth)
                }
            }
        } catch (error) { }
    }

    try {

        if (document.getElementById("showDataOfPayloadHealth")) {

            // getQuoteData(quoteCode).then(function (response) {
            response = localStorage.getItem("getQuoteData");
            resp = JSON.parse(response);
            jsonDataHealth = resp;
            // document.getElementById("healthType").value =
            // jsonDataHealth.payload.healthType;
            loadPlanDetailsHealth(jsonDataHealth)
            if (jsonDataHealth && jsonDataHealth.payload) {

                if (jsonDataHealth.payload.isCampaign) {
                    $("#isCampaign").val(jsonDataHealth.payload.isCampaign);
                }
            }
            toggleLoader(false);

            // })
        }
    } catch (error) {
        console.error(error)
    }

});


function callAjaxForHealthCallUs(e) {

    var formData = new FormData();
    formData.append("productCategoryCode", "HGI");
    formData.append("channelType", "Web");
    formData.append("utmParams", JSON.stringify(window.utmParams));
    formData.append("channelType", JSON.stringify(window.channelType));

    formData.append("is-mobile", window.isMobile);
    var callUsFirstName = document.getElementById("callUsFirstName").value
    var callUsLastName = document.getElementById("callUsLastName").value
    var callUsMobileNo = document.getElementById("callUsMobileNo").value

    if (/^[a-zA-Z]+$/.test(callUsFirstName)) {

        showError("callUsFirstNameErrorMsg", "Enter Valid First name", false);

    }
    else {
        showError("callUsFirstNameErrorMsg", "Enter Valid First name", true);

    }
    if (/^[a-zA-Z]+$/.test(callUsLastName)) {

        showError("callUsLastNameErrorMsg", "Enter Valid Last name", false);

    }
    else {
        showError("callUsLastNameErrorMsg", "Enter Valid Last name", true);

    }
    var mobileNumberStatus = true;
    if (/^[6-9]{1}[0-9]{9}$/g.test(callUsMobileNo)) {
        mobileNumberStatus = true;
        if (/^([6-9])\1{9}$/g.test(callUsMobileNo)) {
            mobileNumberStatus = false;
            showError("callUsMobileNoErrorMsg", "Enter Valid Mobile Number", true);
        }

        else {
            showError("callUsMobileNoErrorMsg", "Enter Valid Mobile Number", false);
        }
    }
    else {
        mobileNumberStatus = false;
        showError("callUsMobileNoErrorMsg", "Enter Valid Mobile Number", true);

    }

    if (/^[a-zA-Z]+$/.test(callUsFirstName) && /^[a-zA-Z]+$/.test(callUsLastName) && mobileNumberStatus) {

    }
    else {
        return;
    }
    formData.append("firstName", callUsFirstName);
    formData.append("lastName", callUsLastName);
    formData.append("mobileNumber", callUsMobileNo);

    AppData.localStorage.setValue("mobileNumber", callUsMobileNo || "");
    AppData.localStorage.setValue("firstName", callUsFirstName || "");
    AppData.localStorage.setValue("lastName", callUsLastName || "");
    triggerCommonCallUs(false)
    var sendData = new URLSearchParams(formData).toString();
    AppEvent.trigger(AppConstants.API_SELECTOR.HEALTH_CALL_US.name, sendData).then(function (response) {
        popup_close()
        toggleLoader(false);
    }).catch(function (err) {
        toggleLoader(false);
    })
}

// health download
function healthDownloadBrochure(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        window.open(
            response.payload.docDownloadUrl,
            '_blank'
        );
        toggleLoader(false);

    }).catch(function (err) {
        toggleLoader(false);
    })
}

// health download

function callAjaxForHealthDownload(el) {

    var formData = new FormData();
//    formData.append("is-mobile", window.isMobile);
    var activePlan = el.getAttribute("data-variantCode");
    formData.append("variantCode", el.getAttribute("data-variantCode")); // el.getAttribute("data-variantCode")

    if (document.getElementById("healthType")) {
        if (document.getElementById("healthType").value == "1") {
            // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[2]);
            triggerSetProduct(window.productName);
        }
        else if (document.getElementById("healthType").value == "2") {
            // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[3]);
            triggerSetProduct(window.productName)
        }
    }
    triggerDownload(planAjaxData[activePlan].variantCode, planAjaxData[activePlan].sumAssured, planAjaxData[activePlan].isRecommend)
    var sendData = new URLSearchParams(formData).toString();

    if (AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.includes("?")) {
        AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url = AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.substring(0, AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.indexOf("?"));
    }
    AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url += "?variantcode=" + el.getAttribute("data-variantCode");
    travelDownloadBrochure(AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.name, sendData);
    
//    healthDownloadBrochure(AppConstants.API_SELECTOR.HEALTH_DOWNLOAD_BROCHURE.name, sendData)
}
function callHealthTrigger() {
    $("[data-target]").on("click", function () {
        if ($(this).attr("data-target") == "#myPopup-buy-now") {
            var selectedPlanDetails = {
                "sumAssured": planAjaxData[activePlan].sumAssured,
                "planCode": planAjaxData[activePlan].planCode,
                "variantCode": planAjaxData[activePlan].variantCode,
                "zone": planAjaxData[activePlan].zone,
                "policyTerm": planAjaxData[activePlan].policyTerm,

                "netPremium": planAjaxData[activePlan].netPremium,
                "gst": planAjaxData[activePlan].gst,
                "grossPremium": planAjaxData[activePlan].grossPremium,
                "isRecommend": (planAjaxData[activePlan].isRecommend) ? planAjaxData[activePlan].isRecommend : false
            }

            if (document.getElementById("healthType")) {
                if (document.getElementById("healthType").value == "1") {
                    // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[2]);
                    triggerSetProduct(window.productName)
                }
                else if (document.getElementById("healthType").value == "2") {
                    // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[3]);
                    triggerSetProduct(window.productName)
                }
            }
            triggerHealthBuyNow(selectedPlanDetails.variantCode, selectedPlanDetails.policyTerm, selectedPlanDetails.isRecommend, selectedPlanDetails.sumAssured, planAjaxData[activePlan]["buyNowSource"], true);
        }

    })

}

// health zone plan
function healthZonePlan(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        popup_close();
        if (response.status == "SUCCESS") {
            var data = response;
            showResponse(response);
            var variantCode = data.payload.premiumByZoneOutput.selectedInsurancePlanDetails.variantCode;
            var container = document.getElementById("yearly-quote-wrap-" + variantCode);
            container.innerHTML = "";
            var premiumDetailsAsPerTenorData = data.payload.premiumByZoneOutput.selectedInsurancePlanDetails.premiumDetailsAsPerTenor
            container.append(setYearlyQuoteWrapElement(premiumDetailsAsPerTenorData, variantCode))
            var firstLabel = container.querySelector(".input-label")
            if (firstLabel) {
                firstLabel.click();
            }
            else {
                $(".quote-amount-" + variantCode).html("")
            }
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
        }
        toggleLoader(false);
    }).catch(function (err) {
        toggleLoader(false);
    })

}
// health zone plan
function callAjaxForHealthZonePlan(e) {
    var variantCode = e.target.getAttribute("data-variantCode");
    var formData = new FormData();
    formData.append("is-mobile", window.isMobile);
    var selectedInsurancePlanDetailsData = {
        "insuringFor": parseInt(jsonDataHealth.payload.insuringFor),
        "sumAssured": parseInt(planAjaxData[variantCode].sumAssured),
        "zoneCode": planAjaxData[variantCode].zoneCode || "ZONEA",
        "policyTerm": parseInt(planAjaxData[variantCode].policyTerm),
        "planCode": planAjaxData[variantCode].planCode,
        "variantCode": planAjaxData[variantCode].variantCode,
    }

    formData.append("selectedInsurancePlanDetails", JSON.stringify(selectedInsurancePlanDetailsData));
    var proposerDetails = {
        "gender": jsonDataHealth.payload.gender,
        "dob": "",
        "pinCode": jsonDataHealth.payload.pinCode
    }
    formData.append("proposerDetails", JSON.stringify(proposerDetails));
    formData.append("insuredDetails", JSON.stringify(jsonDataHealth.payload.insuredDetails));
    formData.append("applicationId", JSON.stringify(jsonDataHealth.payload.applicationId) || "");

    var sendData = new URLSearchParams(formData).toString();
    var appid = generateRandom().toString();
    var send = {
        "applicationId": appid,
        "selectedInsurancePlanDetails": selectedInsurancePlanDetailsData,
        "proposerDetails": proposerDetails,
        "insuredDetails": jsonDataHealth.payload.insuredDetails
    };

    healthZonePlan(AppConstants.API_SELECTOR.HEALTH_ZONE_PLAN.name, send)
}

// health email
function healthEmailQuote(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            toastr.success("The Quote has been mailed to your ID.", "", {
                timeOut: 5e3,
                closeButton: !0,
                preventDuplicates: !0
            });
        } else {
            toastr.error("Failed to mail the Quote to your ID.", "", {
                timeOut: 5e3,
                closeButton: !0,
                preventDuplicates: !0
            });
        }
        popup_close()
        toggleLoader(false);
    }).catch(function (err) {
        toggleLoader(false);
    })
}
// health email

function callAjaxForHealthEmail() {
    var formData = new FormData();
    formData.append("is-mobile", window.isMobile);
    formData.append("sumAssured", planAjaxData[activePlan].sumAssured); // selectedPlanDetails.sumAssured
    formData.append("premium", planAjaxData[activePlan].grossPremium); // selectedPlanDetails.netPremium
    formData.append("productCategoryCode", planAjaxData[activePlan].productCategoryCode);
    var email = document.getElementById("emailId").value
    if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(document.getElementById("emailId").value)) {

        formData.append("emailId", document.getElementById("emailId").value); // document.getElementById("emailId").value
        showError("emailIdErrorMsg", "Enter Valid Email Id", false);

    }
    else {
        showError("emailIdErrorMsg", "Enter Valid Email Id", true);
        return;

    }
    if (document.getElementById("healthType")) {
        if (document.getElementById("healthType").value == "1") {
            // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[2]);
            triggerSetProduct(window.productName);
        }
        else if (document.getElementById("healthType").value == "2") {
            // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[3]);
            triggerSetProduct(window.productName)
        }
    }
    triggerEmail(planAjaxData[activePlan].variantCode, planAjaxData[activePlan].sumAssured, planAjaxData[activePlan].isRecommend)
    AppData.localStorage.setValue("email", document.getElementById("emailId").value || "")
    var sendData = new URLSearchParams(formData).toString();

    var send = {
        "emailPayload":
        {
            "sumAssured": planAjaxData[activePlan].sumAssured,
            "productCategoryCode": "HGI",
            "premium": planAjaxData[activePlan].grossPremium,
            "emailId": email

        }
    }
    healthEmailQuote(AppConstants.API_SELECTOR.HEALTH_EMAIL_QUOTE.name, send);
}

// health buy now
function healthBuyNow(selector, data) {
    AppEvent.trigger(selector, data).then(function (response) {
        if (response.status == "SUCCESS") {
            triggerCreateLead(response.payload.applicationId, productName);
            var url = handoverEndpointURL + healthHandoverURL
            url += "apcantid=" + response.payload.applicantId + "&";
            url += "aptionid=" + response.payload.applicationId + "&";
            url += "apcaptid=" + response.payload.applicationApplicantId + "&";
            url += "skipLogin=true";
            // url += "utm_source=" + "WEBSITE_PRODUCT_PAGE";

            if (window.location.href.includes("is-mobile")) {
                url += "&isMobile=1";
            }
            if (response.payload.authToken) {
                window.sessionStorage.setItem("SS_1", response.payload.authToken)
                window.sessionStorage.setItem("SS_4", response.payload.guardKey)
                document.cookie = "SS_1=" + response.payload.authToken
                document.cookie = "SS_4=" + response.payload.guardKey
            }
            location.href = url;
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false);
        }
        popup_close()
    }).catch(function (err) {
        toggleLoader(false);
    })
}
// health buy now
function callAjaxForHealthBuyNow(e) {

    var formData = new FormData();
    formData.append("is-mobile", window.isMobile);
    formData.append("insuringFor", jsonDataHealth.payload.insuringFor);
    formData.append("healthId", quoteCode);
    formData.append("productCategoryCode", "HGI");
    formData.append("utmParams", JSON.stringify(window.utmParams));
    formData.append("channelType", JSON.stringify(window.channelType));

    var selectedPlanDetails = {
        "sumAssured": planAjaxData[activePlan].sumAssured,
        "planCode": planAjaxData[activePlan].planCode,
        "variantCode": planAjaxData[activePlan].variantCode,
        "zone": planAjaxData[activePlan].zone || "ZONEA",
        "policyTerm": planAjaxData[activePlan].policyTerm,
        "netPremium": planAjaxData[activePlan].netPremium,
        "gst": planAjaxData[activePlan].gst,
        "grossPremium": planAjaxData[activePlan].grossPremium,
        "isRecommend": (planAjaxData[activePlan].isRecommend) ? planAjaxData[activePlan].isRecommend : false
    }
    formData.append("selectedPlanDetails", JSON.stringify(selectedPlanDetails));
    formData.append("firstName", jsonDataHealth.payload.firstName);
    formData.append("lastName", jsonDataHealth.payload.lastName);
    formData.append("mobileNumber", jsonDataHealth.payload.mobileno);
    formData.append("gender", jsonDataHealth.payload.gender);
    formData.append("pinCode", jsonDataHealth.payload.pinCode);
    formData.append("insuredDetails", JSON.stringify(jsonDataHealth.payload.insuredDetails));

    var send = {
        "insuringFor": jsonDataHealth.payload.insuringFor,
        "productCategoryCode": "HGI",
        "channelType": JSON.stringify(window.channelType),
        "selectedPlanDetails": {
            "sumAssured": planAjaxData[activePlan].sumAssured,
            "planCode": planAjaxData[activePlan].planCode,
            "variantCode": planAjaxData[activePlan].variantCode,
            "zone": planAjaxData[activePlan].zone || "ZONEA",
            "policyTerm": planAjaxData[activePlan].policyTerm,
            "netPremium": planAjaxData[activePlan].netPremium,
            "gst": planAjaxData[activePlan].gst,
            "grossPremium": planAjaxData[activePlan].grossPremium,
            "isRecommend": (planAjaxData[activePlan].isRecommend) ? planAjaxData[activePlan].isRecommend : false
        },
        "utmParams": window.utmParams,
        "proposerDetails": {
            "firstName": jsonDataHealth.payload.firstName,
            "lastName": jsonDataHealth.payload.lastName,
            "mobileNumber": jsonDataHealth.payload.mobileno,
            "gender": jsonDataHealth.payload.gender,
            "pinCode": jsonDataHealth.payload.pinCode
        },
        "insuredDetails": jsonDataHealth.payload.insuredDetails
    }
    console.log(JSON.stringify(send))

    if (document.getElementById("healthType")) {
        if (document.getElementById("healthType").value == "1") {
            // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[2]);
            triggerSetProduct(window.productName);
        }
        else if (document.getElementById("healthType").value == "2") {
            // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[3]);
            triggerSetProduct(window.productName);
        }
    }
    triggerHealthBuyNow(selectedPlanDetails.variantCode, selectedPlanDetails.policyTerm, selectedPlanDetails.isRecommend, selectedPlanDetails.sumAssured, planAjaxData[activePlan]["buyNowSource"], false);
    var sendData = new URLSearchParams(formData).toString();

    healthBuyNow(AppConstants.API_SELECTOR.HEALTH_BUY_NOW.name, send)
}

/* copay tooltip function */
function copay_hover() {
    try {
        if (window.matchMedia('(max-width: 767px)').matches) {
            $(".bs-dropdown-hover .dropdown-heading").hover(function () {

                $(this).parents('.bs-dropdown-hover').find('.dropdown-content').stop(true, true).slideDown();
                $(this).parents('.bs-label-value-pair').css('overflow', 'visible');
                $(this).parents('.card-sub-head').css('height', '225px');

            }, function () {
                $(this).parents('.bs-dropdown-hover').find('.dropdown-content').stop(true, true).slideUp();
                $(this).parents('.bs-label-value-pair').css('overflow', 'hidden');
            });
        }
        else if (window.matchMedia('(min-width: 768px)' && '(max-width: 1199px)').matches) {
            $(".bs-dropdown-hover .dropdown-heading").hover(function () {

                $(this).parents('.bs-dropdown-hover').find('.dropdown-content').stop(true, true).slideDown();
                $(this).parents('.bs-label-value-pair').css('overflow', 'visible');
                $(this).parents('.card-sub-head').css('height', '162px');

            }, function () {
                $(this).parents('.bs-dropdown-hover').find('.dropdown-content').stop(true, true).slideUp();
                $(this).parents('.bs-label-value-pair').css('overflow', 'hidden');
            });
        }
        else {
            $(".bs-dropdown-hover .dropdown-heading").hover(function () {

                $(this).parents('.bs-dropdown-hover').find('.dropdown-content').stop(true, true).slideDown();
                $(this).parents('.bs-label-value-pair').css('overflow', 'visible');
                $(this).parents('.card-sub-head').css('height', '159px');

            }, function () {
                $(this).parents('.bs-dropdown-hover').find('.dropdown-content').stop(true, true).slideUp();
                $(this).parents('.bs-label-value-pair').css('overflow', 'hidden');
            });
        }
    } catch (err) {
        console.log(err);
    }
}
var checkValResultStr = generateRandom();
if (document.getElementById("ptype")) {
    var jsonData;
    var productName, serviceType, subServiceType, masterEmail, selectedProductNameObj;
    var productData, masterProductData;

    document.getElementById('existing-customer').addEventListener("change", function (e) {
        $(".select").val("").trigger('change.select2');
        $("#serviceRequestTypeContainer").hide();
        $("#subServiceRequestTypeContainer").hide();
        document.getElementById("name").value = "";
        document.getElementById("mob-no").value = "";
        document.getElementById("emailId").value = "";
        document.getElementById("comment").value = "";
        document.getElementById("card-no").value = "";
        document.getElementById("recipientEmailId").value = "";
        if (e.target.checked) {
            $("#policyNocontainer").show();
            document.getElementById("card-no").required = true;

        } else {
            $("#policyNocontainer").hide();
            document.getElementById("card-no").required = false;
        }
    })
    var productPromise = masterEvent.trigger(AppConstants.MASTER_SELECTOR.PRODUCTS.name).then(function (data) {
        productData = data;
        masterProductData = getValuesInObjectByKey(productData, "productName", []);
        var productName = masterProductData.map(function (data) {
            return data.productName
        }).getUnique();
        getProductName();
        resetContactusForm();
        //	$("#policyNocontainer").show();
        document.getElementById("card-no").required = true;
        toggleLoader(false)

    })
    /*function getProductName() {
    var productNames = masterProductData.map(function (data) { return data.productName }).getUnique();

    $("#productNameContainer").show();
    var select = document.getElementById("ptype");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Product Type";
    select.appendChild(option)
    productNames.forEach(function (product) {
    var option = document.createElement("option");
    option.value = product;
    option.innerText = product;
    select.appendChild(option)
    })
    $('.select').each(function () {
    $(this).select2({
    minimumResultsForSearch: -1,
    width: '100%'
    });

    })
    $("#ptype").on('select2:select', function (e) {
    var selectedProductName = $(this).val()
       selectedProductNameObj = masterProductData.find(function (data) { return data.productName == selectedProductName });


    if (selectedProductNameObj && selectedProductNameObj.redirectUrl != " " && ($("#existing-customer").is(":checked"))) {
    $("#myPopup-redirect").fadeIn().addClass("active");
    $("#redirectBtn").attr("href", selectedProductNameObj.redirectUrl);
    $("body").addClass("body-fixed");
    btnRedirect();
    }
    if ($("#existing-customer").is(":checked")) {

    document.getElementById("requesttype").required = true;
    getServiceType($(this).val());
    }
    });
    return productNames;
    }
    function getServiceType(productName) {

    $("#serviceRequestTypeContainer").show();
    var serviceTypeData = masterProductData.filter(function (data) { return data["productName"] == productName }).map(function (data) { return data.serviceType }).getUnique();
    var select = document.getElementById("requesttype");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Service Type";
    select.appendChild(option)
    serviceTypeData.forEach(function (serviceType) {
    var option = document.createElement("option");
    option.value = serviceType;
    option.innerText = serviceType;
    select.appendChild(option)
    })
    $('.select').each(function () {
    $(this).select2({
    minimumResultsForSearch: -1,
    width: '100%'
    });

    })
    $("#requesttype").on('select2:select', function (e) {

    document.getElementById("requestSubType").required = true;
    getSubServiceType(productName, $(this).val());
    });
    }
    function getSubServiceType(productName, serviceType) {
    $("#subServiceRequestTypeContainer").show();
    var subServiceTypeData = masterProductData.filter(function (data) { return (data["productName"] == productName && data["serviceType"] == serviceType) }).map(function (data) { return data.subServiceType }).getUnique()
    var select = document.getElementById("requestSubType");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Sub Service Type";
    select.appendChild(option)
    subServiceTypeData.forEach(function (subServiceType) {
    var option = document.createElement("option");
    option.value = subServiceType;
    option.innerText = subServiceType;
    select.appendChild(option)
    })
    $('.select').each(function () {
    $(this).select2({
    minimumResultsForSearch: -1,
    width: '100%'
    });
    })
    }*/
}

function getProductName() {
    var productNames = masterProductData.map(function (data) {
        return data.productName;
    }).getUnique();
    $("#productNameContainer").show();
    var select = document.getElementById("ptype");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Product Type";
    select.appendChild(option);
    productNames.forEach(function (product) {
        var option = document.createElement("option");
        option.value = product;
        option.innerText = product;
        select.appendChild(option);
    });
    $('.select').each(function () {
        $(this).select2({
            minimumResultsForSearch: -1,
            width: '100%'
        });
    });
    $("#ptype").on('select2:select', function (e) {
        var selectedProductName = $(this).val();
        selectedProductNameObj = masterProductData.find(function (data) {
            return data.productName == selectedProductName;
        });

        if (selectedProductNameObj && selectedProductNameObj.redirectUrl != " " && $("#existing-customer").is(":checked")) {
            $("#myPopup-redirect").fadeIn().addClass("active");
            $("#redirectBtn").attr("href", selectedProductNameObj.redirectUrl);
            $("body").addClass("body-fixed");
            btnRedirect();
        }

        if ($("#existing-customer").is(":checked")) {
            document.getElementById("requesttype").required = true;
            getServiceType($(this).val());
        }
    });
    return productNames;
}

function getServiceType(productName) {
    $("#serviceRequestTypeContainer").show();
    var serviceTypeData = masterProductData.filter(function (data) {
        return data["productName"] == productName;
    }).map(function (data) {
        return data.serviceType;
    }).getUnique();
    var select = document.getElementById("requesttype");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Service Type";
    select.appendChild(option);
    serviceTypeData.forEach(function (serviceType) {
        var option = document.createElement("option");
        option.value = serviceType;
        option.innerText = serviceType;
        select.appendChild(option);
    });
    $('.select').each(function () {
        $(this).select2({
            minimumResultsForSearch: -1,
            width: '100%'
        });
    });
    $("#requesttype").on('select2:select', function (e) {
        document.getElementById("requestSubType").required = true;
        getSubServiceType(productName, $(this).val());
    });
}

function getSubServiceType(productName, serviceType) {
    $("#subServiceRequestTypeContainer").show();
    var subServiceTypeData = masterProductData.filter(function (data) {
        return data["productName"] == productName && data["serviceType"] == serviceType;
    }).map(function (data) {
        return data.subServiceType;
    }).getUnique();
    var select = document.getElementById("requestSubType");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Sub Service Type";
    select.appendChild(option);
    subServiceTypeData.forEach(function (subServiceType) {
        var option = document.createElement("option");
        option.value = subServiceType;
        option.innerText = subServiceType;
        select.appendChild(option);
    });
    $('.select').each(function () {
        $(this).select2({
            minimumResultsForSearch: -1,
            width: '100%'
        });
    });
}

function contactUsForm(event) {
    try {
        checkValResultStr = generateRandom();
    } catch (e) {
        console.log(e);
    }
    var mobileNumber = document.getElementById("mob-no").value;
    var policyNo = document.getElementById("card-no").value;
    var subServiceType = document.getElementById("requestSubType").value;
    var serviceType = document.getElementById("requesttype").value;
    var productName = document.getElementById("ptype").value;
    var customerName = document.getElementById("name").value;
    var customerEmail = document.getElementById("emailId").value;
    var Queryfreetxt = document.getElementById("comment").value;

    if (/^[6-9][0-9]{9}$/.test(mobileNumber)) {

        showError("mobileNumberErrorMsg", "Enter Valid Mobile Number", false);

    } else {
        showError("mobileNumberErrorMsg", "Enter Valid Mobile Number", true);

    }

    if (/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(customerEmail)) {

        showError("emailIdErrorMsg", "Enter Valid Email ID", false);

    } else {
        showError("emailIdErrorMsg", "Enter Valid Email ID", true);

    }

    if (/^[6-9][0-9]{9}$/.test(mobileNumber) && /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(customerEmail)) {

    } else {
        return
    }
    var recipientEmailId;
    if ($("#existing-customer").is(":checked") == true) {
        recipientEmailId = selectedProductNameObj.productCategory + "," + productName + "," + serviceType + "," + subServiceType;
    } else {
        recipientEmailId = selectedProductNameObj.productCategory + "," + productName + "," + selectedProductNameObj.serviceType + "," + selectedProductNameObj.subServiceType;
    }
    getRecipientEmailAjax(customerName, mobileNumber, customerEmail, productName, serviceType, subServiceType, policyNo, Queryfreetxt, recipientEmailId);

    /*var formData = new FormData();
    formData.append("notificationTypeCode", " ");
    formData.append("customerMobile", mobileNumber);
    formData.append("customerName", customerName);
    formData.append("policyNo", policyNo);
    formData.append("subServiceType", subServiceType);
    formData.append("serviceType", serviceType);
    formData.append("productName", productName);
    formData.append("customerEmail", customerEmail);
    formData.append("Queryfreetxt", Queryfreetxt);
    formData.append("recipientEmailId", recipientEmailId);
    formData.append("notificationTypeCode", " ");

    var sendData = new URLSearchParams(formData).toString();*/

    /*getRecipientEmailAjax(customerName, mobileNumber, customerEmail, productName, serviceType, subServiceType, policyNo, Queryfreetxt, recipientEmailId);*/

    /*triggerContactUs(existingCustomer, productName, serviceType, subServiceType, policyNo, mobileNumber);
    AppEvent.trigger(AppConstants.API_SELECTOR.CONTACT_US_EMAIL.name, sendData).then(function(response) {
        $('#myPopup-thankyou').fadeIn().addClass("active");
        $('#caseId').text(response.caseId);
        toggleLoader(false)

    })*/

}
//new code
function popUpTimeOut() {
    document.getElementById("myPopup-non-loggedin").style.display = "none";
}

function timeOutDone() {
    setTimeout(popUpTimeOut, 10000);
}

function afterTimeOut() {
    $("#existing-customer").prop("checked", false);
    $("#policyNocontainer").hide();
}
//new code
function resetContactusForm() {
    var contactUsForm = document.getElementById("contactUsForm");
    contactUsForm.reset()
    $(".select").val("").trigger('change.select2');

    $("#policyNocontainer").hide();
    $("#serviceRequestTypeContainer").hide();
    $("#subServiceRequestTypeContainer").hide();
    document.getElementById("card-no").required = false;
    document.getElementById("requestSubType").required = false;
    document.getElementById("requesttype").required = false;
    if (document.getElementById('existing-customer').checked) {

        $("#policyNocontainer").show();
        document.getElementById("card-no").required = true;

    } else {
        $("#policyNocontainer").hide();
        document.getElementById("card-no").required = false;
    }

}
var existingCustomer = "no";
document.addEventListener("DOMContentLoaded", function (event) {

    if (document.getElementById("contactUsForm")) {

        $('input[type="checkbox"]').change(function () {

            if ($(this).prop("checked") == true) {
                console.log("Checkbox is checked.");
                //new code
                setTimeout(popUpTimeOut, 10000);
                $.when(timeOutDone()).done(afterTimeOut());
                $("#myPopup-non-loggedin").show();
                //new code
                existingCustomer = 'yes';
            } else if ($(this).prop("checked") == false) {
                $("#myPopup-non-loggedin").hide();
                console.log("Checkbox is unchecked.");
                existingCustomer = 'no';
            }
        });
    }
    $("#policyNocontainer").hide();
})

function checkValue(value) {

    if (checkValResultStr == "" || checkValResultStr == checkValResultStr) {
        return checkValResultStr;
    }
    return value;
}

function getRecipientEmailAjax(customerName, mobileNumber, customerEmail, productName, serviceType, subServiceType, policyNo, Queryfreetxt, recipientEmailId) {
    var emailData = productData;
    var email = "insuranceconnect@bajajfinservmarkets.in";
    try {
        recipientEmailId.toLowerCase().split(",").forEach(function (each) {
            emailData = emailData[(each.trim().replace(/([^a-z0-9]+)/gi, '-').toLowerCase())];
            if (emailData.hasOwnProperty("email")) {
                email = emailData["email"].trim();
            }
        });
    } catch (error) {
        console.log(error);
    }
    var sendData = {
        "notificationTypeCode": "WS_CONTACTUS_EMAIL",
        "templateDataMap": {
            "compliantId": checkValue(checkValResultStr),
            "customerName": customerName,
            "customerMobile": mobileNumber,
            "customerEmail": customerEmail,
            "productName": productName,
            "ETBFlag": false,
            "requestType": serviceType,
            "requestSubType": subServiceType,
            "policyNo": policyNo,
            "Queryfreetxt": Queryfreetxt,
            "recipientEmailId": email
        }
    }
    triggerContactUs(existingCustomer, productName, serviceType, subServiceType, policyNo, mobileNumber);
    contactUsApiCall(AppConstants.API_SELECTOR.CONTACT_US_EMAIL.name, sendData);
}

function contactUsApiCall(selector, sendData) {
    AppEvent.trigger(selector, sendData).then(function (response) {
        if (response.status == "SUCCESS") {
            response.sts = "SUCCESS";
            response.msg = "Registered";
            response.caseId = checkValResultStr;
            localStorage.setItem("ResponseData", JSON.stringify(response));
            response = JSON.parse(localStorage.getItem("ResponseData"));
            $('#myPopup-thankyou').fadeIn().addClass("active");
            $('#caseId').text(response.caseId);
            showResponse(response);
            toggleLoader(false)
        } else {
            response.status = 422;
            response.sts = "FAIL";
            response.msg = "Something went wrong. Please try again later";
            localStorage.setItem("ResponseData", JSON.stringify(response));
            response = JSON.parse(localStorage.getItem("ResponseData"));
            toggleLoader(false);
            toastr.error(response.status + " : " + response.msg, '', {
                timeOut: 5000,
                "closeButton": true,
                "preventDuplicates": true
            });
        }
    }).catch(function (err) {
        toggleLoader(false);
    })
}

function generateRandom() {
    return Math.floor(100000 + Math.random() * 900000);
}
var analyticsDataObj;
getFormData(
    "elegible-form",
    function (sendData) {
        analyticsDataObj = {};
        var analyticsData = new URLSearchParams(sendData);
        analyticsDataObj = searchParamsConvertToData(analyticsData);

        analyticsDataObj.degreeval = (AppData.Masters.degree) ? AppData.Masters.degree.degrees
            .find(function (data) {
                return data.qlfyMastkey == analyticsDataObj.degreeval
            }).degreeDescription
            : "";
        analyticsDataObj.specialisationSelect = (AppData.Masters.degree) ? AppData.Masters.degree.degrees
            .find(function (data) {
                return (data.spclMastKey == analyticsDataObj.specialisationSelect && data.degreeDescription == analyticsDataObj.degreeval)
            }).specialisation
            : "";
        /* To Avoid Blank Analytics Trigger */
        if (document.getElementById("productcode").value != "") {
            // triggerElegibilityCalculator(analyticsDataObj);
        }
        var formatData = sendData.split("&");
        var eachData = {};
        for (var i = 0; i < formatData.length; i++) {
            var eData = formatData[i].split("=");
            eachData[eData[0]] = eData[1];
        }
        var selectorValue = document.getElementById("selectorValue");
        var value = selectorValue.value;
        var reqPayload = {
            "productCode": eachData.productcode || "",
            "takeHomeSalary": parseInt(eachData.takeHomeSalary) || 0,
            "totalEMIperMonth": parseInt(eachData.totalemi) || 0,
            "mobileNo": parseInt(eachData.mobnumber) || 0,
        };
        switch (value) {
            case "eligibility-calculator-salaried":
                reqPayload.turnoverRange = eachData.turnoverRange || "";
                reqPayload.industryType = eachData.industryType || "";
                reqPayload.experience = parseInt(eachData.experience) || 0;
                reqPayload.degree = parseInt(eachData.degreeval) || 0;
                reqPayload.specialisation = parseInt(eachData.specialisationSelect) || 0;
                reqPayload.cityCategory = eachData.cityCategory || "";
                reqPayload.dob = eachData.dob == undefined ? "" : eachData.dob.split("%2F").join("/") || "";

                break;

            case "eligibility-calculator-salaried-doctor":

                reqPayload.occupationType = eachData.occupationType || "";
                reqPayload.turnoverRange = eachData.turnoverRange || "";
                reqPayload.industryType = eachData.industryType || "";
                reqPayload.experience = parseInt(eachData.experience) || 0;
                reqPayload.degree = parseInt(eachData.degreeval) || 0;
                reqPayload.specialisation = parseInt(eachData.specialisationSelect) || 0;
                reqPayload.cityCategory = eachData.cityCategory || "";
                reqPayload.dob = eachData.dob == undefined ? "" : eachData.dob.split("%2F").join("/") || "";

                break;

            case "eligibility-calculator-bl-sme":

                reqPayload.occupationType = eachData.occupationType || "";
                reqPayload.turnoverRange = eachData.turnoverRange || "";
                reqPayload.industryType = eachData.industryType || "";
                reqPayload.experience = parseInt(eachData.experience) || 0;
                reqPayload.degree = parseInt(eachData.degreeval) || 0;
                reqPayload.specialisation = parseInt(eachData.specialisationSelect) || 0;
                reqPayload.cityCategory = eachData.cityCategory || "";
                reqPayload.dob = eachData.dob == undefined ? "" : eachData.dob.split("%2F").join("/") || "";

                break;

            case "eligibility-calculator-bl-doctor":

                reqPayload.occupationType = eachData.occupationType || "";
                reqPayload.turnoverRange = eachData.turnoverRange || "";
                reqPayload.industryType = eachData.industryType || "";
                reqPayload.experience = parseInt(eachData.experience) || 0;
                reqPayload.degree = parseInt(eachData.degreeval) || 0;
                reqPayload.specialisation = parseInt(eachData.specialisationSelect) || 0;
                reqPayload.cityCategory = eachData.cityCategory || "";
                reqPayload.dob = eachData.dob == undefined ? "" : eachData.dob.split("%2F").join("/") || "";

                break;

            case "eligibility-calculator-bl-ca":

                reqPayload.occupationType = eachData.occupationType || "";
                reqPayload.turnoverRange = eachData.turnoverRange || "";
                reqPayload.industryType = eachData.industryType || "";
                reqPayload.experience = parseInt(eachData.experience) || 0;
                reqPayload.degree = parseInt(eachData.degreeval) || 0;
                reqPayload.specialisation = parseInt(eachData.specialisationSelect) || 0;
                reqPayload.cityCategory = eachData.cityCategory || "";
                reqPayload.dob = eachData.dob == undefined ? "" : eachData.dob.split("%2F").join("/") || "";

                break;

            case "eligibility-calculator-hl-bt-lap":

                reqPayload.cityName = eachData.cityval || "";
                reqPayload.sanctionedLoanAmount = parseInt(eachData.loanamount) || 0;
                reqPayload.years = parseInt(eachData.years) || 0;
                break;
        }


        var data = {
            "product": eachData.productType || "",
            "requestPayload": JSON.stringify(reqPayload)
        };
        callAPIForElegiCalc(AppConstants.API_SELECTOR.ELIGIBILITY_CALCULATOR_COMMON_CALL.name, data);

    })

/* API call for Eligibility Calculator */
var callAPIForElegiCalc = function callToEligibility(selector, sendData) {
    AppEvent.trigger(selector, sendData).then(function (response) {
        if(response.status == "SUCCESS"){
        	var myObj = response;
            var responseData = JSON.parse(myObj.payload);
            console.log("ResponseData" + responseData);
            if (responseData.hasOwnProperty("hlcalculatoroutput")) {
                analyticsDataObj.eligibilityAmount = responseData.hlcalculatoroutput.eligibleLoanAmount;
            } else {
                analyticsDataObj.eligibilityAmount = responseData.calculatorOutput.eligibilityDetails[0].eligibilityAmount;
            }

            triggerElegibilityCalculator(analyticsDataObj);
            var JsonData = JSON.parse(myObj.payload);
            var selectorValue = document.getElementById("selectorValue");
            var value = selectorValue.value;
            value == 'eligibility-calculator-hl-bt-lap' ? cardLAPDisplay(JsonData)
                : cardDisplay(JsonData);
        } else {
        	if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
        }
        toggleLoader(false);
    }).catch(function (err) {
    	toggleLoader(false);
    	if (err.errorBean) {
            toastr.error(err.errorBean[0].errorCode + " : " + err.errorBean[0].errorMessage, "", {
                timeOut: 5e3,
                closeButton: !0,
                preventDuplicates: !0
            });
        }
    })
}

/* Display Card POP UP */
function cardLAPDisplay(JsonDataLAP) {

    var eligibilityConatinerLAP = document
        .getElementById("eligibilityConatinerLAP");

    eligibilityConatinerLAP.innerHTML = "";
    var eligibilityTemplateLAP = document.getElementById(
        "eligibilityTemplateLAP").cloneNode(true);
    var contentElement = eligibilityTemplateLAP.content;

    contentElement.querySelector("#iconAmount").innerHTML = "₹ "
        + JsonDataLAP.hlcalculatoroutput.eligibleLoanAmount
            .toLocaleString();
    contentElement.querySelector(".btn").setAttribute("data-loanamount",
        JsonDataLAP.hlcalculatoroutput.eligibleLoanAmount);
    eligibilityConatinerLAP.appendChild(contentElement)

    btnRedirect();
}

/* Display Card POP UP */
function cardDisplay(JsonData) {

    var eligibilityConatiner = document.getElementById("eligibilityConatiner");
    eligibilityConatiner.innerHTML = "";
    var eligibilityTemplate = document.getElementById("eligibilityTemplate")
        .cloneNode(true);
    var contentElement = eligibilityTemplate.content;

    contentElement.querySelector("#iconAmount").innerHTML = "₹ "
        + JsonData.calculatorOutput.eligibilityDetails[0].eligibilityAmount
            .toLocaleString();
    contentElement.querySelector(".btn").setAttribute("data-loanamount",
        JsonData.calculatorOutput.eligibilityDetails[0].eligibilityAmount);

    eligibilityConatiner.appendChild(contentElement)
    btnRedirect();
}

/* CAllING MASTER DEGREE */

if (document.getElementById("degreeval")) {

    var degreePromise = masterEvent.trigger(
        AppConstants.MASTER_SELECTOR.DEGREE.name).then(function (data) {
            degreeData = data.degrees;

            var degreeName = degreeData.map(function (data) {
                return data.degreeDescription
            }).getUnique().map(function (data) {
                return degreeData.find(function (dData) {
                    return dData.degreeDescription == data
                })
            });

            var select = document.getElementById("degreeval");
            select.innerHTML = "";
            var option = document.createElement("option");
            option.value = "";
            option.innerText = "Select Degree";
            select.appendChild(option)
            degreeName.forEach(function (degreeObj) {
                var option = document.createElement("option");
                option.value = degreeObj.qlfyMastkey;
                option.innerText = degreeObj.degreeDescription;
                select.appendChild(option)
            })
            // select()
            $("#degreeval").on('select2:select', function (e) {
                var selectedDegreeName = $(this).val()
                getspecialisation($(this).val(), degreeData);

            });
            toggleLoader(false)

            return degreeName;

        });

}
// changed
function getspecialisation(degreeDesc, degreeData) {
    var specname = degreeData.filter(function (data) {
        return data.qlfyMastkey == degreeDesc;
    });
    console.log(specname);
    var select = document.getElementById("specialisationSelect");
    select.innerHTML = "";
    var option = document.createElement("option");
    option.value = "";
    option.innerText = "Select Specification";
    select.appendChild(option);
    specname.forEach(function (degreeObj) {
        var option = document.createElement("option");
        option.value = degreeObj.spclMastKey;
        option.innerText = degreeObj.specialisation;
        select.appendChild(option);
    }); // select()
}
// changed
if (document.getElementById("cityval")) {
    var cityPromise = masterEvent
        .trigger(AppConstants.MASTER_SELECTOR.CITY.name)
        .then(
            function (data) {
                cityData = data.cities;

                var cityName = cityData.map(function (data) {
                    return data.cityName
                }).getUnique().map(function (data) {
                    return cityData.find(function (dData) {
                        return dData.cityName == data
                    })
                });

                var select = document.getElementById("cityval");
                select.innerHTML = "";
                var option = document.createElement("option");
                option.value = "";
                option.innerText = "Select City";
                select.appendChild(option)
                cityName.forEach(function (cityObj) {
                    var option = document.createElement("option");
                    option.value = cityObj.cityName;
                    option.innerText = cityObj.cityName;
                    select.appendChild(option)
                })
                $("#cityval")
                    .on(
                        'select2:select',
                        function (e) {
                            var selectedcityName = $(this)
                                .val()
                            console.log(selectedcityName);

                            var citycategoryfilter = cityName
                                .filter(function (data) {
                                    return data.cityName == selectedcityName
                                })
                            var cityCategoryVal = document
                                .getElementById("cityCategory").value = citycategoryfilter[0].cityCategory;

                        });
                toggleLoader(false)

                return cityName;

            });
}

/* Eligibility Calculator Datepicker */
function validateEligibilityDob() {
    var dd = document.getElementById("dobDt").value;
    // dd = appendZero(dd,"dobDt");
    var mm = document.getElementById("dobMonth").value;
    // mm = appendZero(mm,"dobMonth");
    var yy = document.getElementById("dobYear").value;
    var dob = dd + "/" + mm + "/" + yy;
    if (mm == "" && yy.length != 4) {
        console.log("wrong date");

    } else {
        document.getElementById("dob").value = dob;
        var endDateVal = getFormattedDate(dd, mm, yy);
        var date = new Date();
        var currentDate = date.getFullYear();

        if (dob === "DD/MM/YYYY") {
            showError('dob-error', '', false);
        } else {
        	if (currentDate - dob.split("/")[2] <= 23) {
                showError("dob-error", "Minimum Age Should be 23 years", true);
                return;
            }
            if (/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/
                .test(dob)) {

                showError("dob-error", "", false);
                return true;

            } else {
                showError("dob-error", "Enter Valid Date of Birth", true);
                return false;

            }
        }
    }
}
$("#dobDt").keyup(validateEligibilityDob);
$("#dobMonth").keyup(validateEligibilityDob);
$("#dobYear").keyup(validateEligibilityDob);
/* Eligibility Calculator Datepicker End */

function eligibilityApplyClick(e){
	triggerLoanEligibilityApplyNow(e);
	UTMCheck();
}

/*GET RTO LIST FUNCTION*/
function getSelectedOption(sel) {
    var opt;
    for ( var i = 0, len = sel.options.length; i < len; i++ ) {
        opt = sel.options[i];
        if ( opt.selected === true ) {
            break;
        }
    }
    return opt;
}

function getRTOList(selectId) {
  var select = document.getElementById(selectId);
  if (select) {
    AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_GET_RTO_LIST.name)
      .then(
        function (response) {
          console.log(response);
          AppData.Api["motor-rto-lsit"].payload.rtoList
            .forEach(function (data) {
               var option = document
                .createElement('option');
              option.value = data.rtoName;
              option.innerText = data.rtoName;
              option.setAttribute("name" ,data.rtoLocationCode);
              
              // selected option name retrieval
              //var selectedOption = getSelectedOption(document.getElementById("selectId"));
              //var name = selectedOption.getAttribute('name');
              select.appendChild(option);
            })
         
          toggleLoader(false)

        });
  }
}

var inputDate = "dd/mm/yy";

/* Motor datepicker */
function validateRegDate() {
	var dd = document.getElementById("regDt").value;
	var mm = document.getElementById("regMonth").value;
	var yy = document.getElementById("regYear").value;
	 inputDate =  dd+"/"+mm+"/"+yy;
	 if(mm=="" || yy.length!=4){
			console.log("wrong date");
			
		}else{
	    var inputDateFormatVal = getFormattedDate(dd,mm,yy);
	    //var currentDate = new Date();
	    var validDate = new Date("11/01/2018");
	    if(inputDate==="DD/MM/YYYY"){
	        showError('regDateErrorMsg', '', false);
	    }else{
	if (/(((0[1-9]|[12][0-9]|3[01])([-./])(0[13578]|10|12)([-./])(\d{4}))|(([0][1-9]|[12][0-9]|30)([-./])(0[469]|11)([-./])(\d{4}))|((0[1-9]|1[0-9]|2[0-8])([-./])(02)([-./])(\d{4}))|((29)(\.|-|\/)(02)([-./])([02468][048]00))|((29)([-./])(02)([-./])([13579][26]00))|((29)([-./])(02)([-./])([0-9][0-9][0][48]))|((29)([-./])(02)([-./])([0-9][0-9][2468][048]))|((29)([-./])(02)([-./])([0-9][0-9][13579][26])))/.test(inputDate)) {

		          showError("regDateErrorMsg", "", false);
	    if(inputDateFormatVal > validDate){
	        showError('regDateErrorMsg', 'Reg. date cannot be more than October 31st,2018', true)
	         return false;
	        } else {
	            showError('regDateErrorMsg', '', false);
	            var data = [{
		            id: inputDateFormatVal.getFullYear(),
		            text: inputDateFormatVal.getFullYear()
		        },
		        {
		            id: inputDateFormatVal.getFullYear()-1,
		            text: inputDateFormatVal.getFullYear()-1
		        }
		    ];
	            $('.myear').prop("disabled", false);
	            $('.myear').empty().trigger("change");
	        $(".myear").select2({
	            data: data,
	            minimumResultsForSearch: -1
	        });
	        return true;
	        }
	}else{
		showError("regDateErrorMsg", "Please Enter valid date", true);
	    return false;
	}
	    }
		}
	    }

	 $("#regDt").keyup(validateRegDate);
	 $("#regMonth").keyup(validateRegDate);
	 $("#regYear").keyup(validateRegDate);
/* Motor datepicker End */

/* GET VECHILE DETAILS FUNCTION */
function getVechileDetails(vechileId) {
 }

if(document.getElementById('productType')){
var insProductType = document.getElementById('productType').value;
var isPolicyExp= 'no';
if(insProductType == "FWGI" && isPolicyExp == 'yes'){
//	triggerMotorFourWheelerPolicyExpired(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,isPolicyExp);
console.log("true");
}
}

if(document.getElementById('productType')){
  console.log('run');
  
  var isPolicyExp= 'no';
	$('#protect-loan-chk').click(function () {
		  console.log('chk');
	    if ($(this).is(':checked')) {
	  	isPolicyExp = "yes";
	    } else {
	  	 isPolicyExp = "no";
	    }
	    console.log("this is policy: " +isPolicyExp);
	    if(insProductType == "FWGI" && isPolicyExp == "yes"){
	    //	triggerMotorFourWheelerPolicyExpired(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,isPolicyExp);
	    	console.log("true");
	    }else{
	    	console.log("false");
	    }
	    
	});	
}

if(document.getElementById('productType')){
	console.log('run');
    var isPolicyExpTwo= 'no';
   $('#protect-loan-chk1').click(function () {
	  console.log('chk');
  if ($(this).is(':checked')) {
	  isPolicyExpTwo = "yes";
  } else {
	  isPolicyExpTwo = "no";
  }
  	console.log("this is isPolicyExpTwo: " +isPolicyExpTwo);
  	if(insProductType == "FWGI"  && isPolicyExpTwo == "yes"){
    //	triggerMotorFourWheelerPolicyExpired(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,isPolicyExpTwo);
    	console.log("true");
    }else{
    	console.log("false");
    }
});	 
console.log("this is isPolicyExpTwo outiside: " +isPolicyExpTwo);

}

if(document.getElementById('productType')){
	var insProductType = document.getElementById('productType').value;
/*	if(insProductType == "FWGI"){
		triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI);
    }else if(insProductType == "TWGI"){
    	triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI);
    }*/
	triggerSetProduct(window.productName);
}

/* POST MOTOR REG_NO SEARCH_PLAN FUNCTION */

function motorRegnoSearchPlan(event) {
  
  var path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0]	
  var parentElement = findSelectorParent(event.target, "FORM");
  var hasregistrationNumber = ($(parentElement).find('#rno').length == 1);
  var insProductType = $(parentElement).find('#productType').val();
  var hasFirstName = ($(parentElement).find("#firstName").length == 1);
  var hasLastName = ($(parentElement).find("#lastName").length == 1);
  var hasMobileNumber = ($(parentElement).find("#mobileNumber").length == 1);
  var hasEmail = ($(parentElement).find("#email").length == 1);
  var mobileNumber, email, firstName, lastName,registrationNumber;
  var status = true;
  if (hasFirstName) {
    firstName = $(parentElement).find("#firstName").val()
  }
  if (hasLastName) {
    lastName = $(parentElement).find("#lastName").val()
  }
  if (hasMobileNumber) {
    mobileNumber = $(parentElement).find("#mobileNumber").val()
  }
  if (hasEmail) {
    email = $(parentElement).find("#email").val()
  }
  if(hasregistrationNumber){
	  registrationNumber = $(parentElement).find('#rno').val();
  }

   
  if (hasMobileNumber) {
    if (mobileNumber) {
      if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"mobileNumberErrorMsg"), "Please Enter Valid Mobile Number.", true);
        if (status) {
          status = false;
        }
      }
      else {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"mobileNumberErrorMsg"), "Please Enter Mobile Number.", false);

      }
    }
    else {
    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"mobileNumberErrorMsg"), "Please Enter Mobile Number.", true);
      if (status) {
        status = false;
      }
    }
  }
   if (hasregistrationNumber) {
	    if (registrationNumber) {
	      if (!(/^[a-zA-Z0-9\-]{7,11}$/.test(registrationNumber))) {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"registrationNumberErrorMsg"), "Please Enter Valid registrationNumber.", true);
	        if (status) {
	          status = false;
	        }
	      }
	      else {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"registrationNumberErrorMsg"), "Please Enter Valid registrationNumber.", false);

	      }
	    }
	    else {
	    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"registrationNumberErrorMsg"), "Please Enter Valid registrationNumber.", true);
	      if (status) {
	        status = false;
	      }
	    }
	  }
   
  if (hasFirstName) {
    if (firstName) {

      if (!(/^[a-zA-Z]+$/.test(firstName))) {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"firstNameErrorMsg"), "Please Enter Valid First Name.", true);
        if (status) {
          status = false;
        }
      }
      else {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"firstNameErrorMsg"), "Please Enter Mobile Number.", false);

      }
    }
    else {
    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"firstNameErrorMsg"), "Please Enter First Name.", true);
      if (status) {
        status = false;
      }
    }
  }
  if (hasLastName) {
    if (lastName) {

      if (!(/^[a-zA-Z]+$/.test(lastName))) {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"lastNameErrorMsg"), "Insert Valid Last Name.", true);
        if (status) {
          status = false;
        }
      }
      else {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"lastNameErrorMsg"), "Insert Valid Last Name.", false);

      }
    }
    else {
    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"lastNameErrorMsg"), "Please Enter Last Name.", true);
      if (status) {
        status = false;
      }
    }
  }
  if (hasEmail) {
    if (email) {

      if (!(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email))) {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"emailErrorMsg"), "Insert Valid Email Id.", true);
        if (status) {
          status = false;
        }
      }
      else {
    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"emailErrorMsg"), "Insert Valid Email Id.", false);

      }
    }
    else {
    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"emailErrorMsg"), "Please Enter Email Id.", true);
      if (status) {
        status = false;
      }
    }
  } 
  if (!status) {
      return
  }
  
  AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
  AppData.localStorage.setValue("firstName", firstName || "")
  AppData.localStorage.setValue("lastName", lastName || "")
  AppData.localStorage.setValue("emailId", email || "")

  var formData = new FormData();
  formData.append("insProductType", insProductType);
  formData.append("registrationNumber", registrationNumber);
  formData.append("firstName", firstName || "");
  formData.append("lastName", lastName || "");
  formData.append("mobileNumber", mobileNumber || "");
  formData.append("emailId", email);
  formData.append("utmParams", JSON.stringify(window.utmParams));
  formData.append("channelType", JSON.stringify(window.channelType));

  formData.append("is-mobile", window.isMobile);

  var sendData = new URLSearchParams(formData).toString();
  
  
 
  AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_SEARCH_PLANS_REG_NO.name,
    sendData).then(function (response) {
    	var params = (new URL(document.location)).searchParams;
    	window.urlParams = params.toString();
    	console.log("This is urlparams" +window.urlParams);
    	console.log("Response");
    	console.log(response);
    	var responseData = JSON.parse(response.jsonData);
    	console.log(responseData);
    	var registrationNumber = responseData.payload.vehicleDetails.registrationDetails.registrationNumber;
    	var mobileNumber = responseData.payload.mobileno;
    	var emailId = (responseData.payload.emailId != "undefined") ? responseData.payload.emailId : "";
    	var registrationDate = responseData.payload.vehicleDetails.registrationDetails.registrationDt || "";
    	var city = responseData.payload.vehicleDetails.registrationDetails.location;
    	var vehicleDetails = responseData.payload.vehicleDetails.modelDetails.vehicleCode;
    	var manufacturingYear = responseData.payload.vehicleDetails.registrationDetails.mfgYear;
    	var renewal = responseData.payload.renewalFlag;
    	if(insProductType == "TWGI"){
    //		  triggerMotorRegnoTwoWheelerMotorPlan(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI,registrationNumber,isPolicyExp, mobileNumber, emailId, "Pass", registrationDate, city, vehicleDetails, manufacturingYear, renewal);
    	  }else{
    //		  triggerMotorRegnoFourWheelerMotorPlan(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,registrationNumber,mobileNumber,emailId,"Pass",registrationDate,city,vehicleDetails,manufacturingYear,renewal);	  
    	  }
    	
    	if (response.qid) {
        	triggerCreateLead(response.leadApplicantId,productName);
            window.location.href = path + "." + response.qid + ".html";
        }
      else{
        toggleLoader(false)
      }
    	
    }).catch(function (response) {
      if (response.errorregno) {
    	  if(insProductType == "TWGI"){
    //		  triggerMotorRegnoTwoWheelerMotorPlan(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI,registrationNumber,isPolicyExp, mobileNumber, "", "Fail", "", "", "", "", "");
    	  }else{
    //		  triggerMotorRegnoFourWheelerMotorPlan(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,registrationNumber,mobileNumber,"","Fail","","","","","");	  
    	  }
    	  motorCallUs();
        $('#registerredirect').click();
        toggleLoader(false)
      }
    })
}





/* POST MOTOR SEARCH_PLAN FUNCTION */
function motorSearchPlan(event) {
  var status = true;
  var path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0]	
  var parentElement = findSelectorParent(event.target, "FORM");
  var vehicleCode = $(parentElement).find('#vechileId').val();
  var newVehicle = $(parentElement).find('#newVehicle').val();
  var location = $(parentElement).find('#selectId').val();
  
  var registrationDt = inputDate.replace(/\//g, "-").split("-").reverse().join("-");
  var mfgYear = $(parentElement).find('#noRegMfYear').val();
  var insProductType = $(parentElement).find('#productType').val();
  var hasFirstName = ($(parentElement).find("#firstName").length == 1);
  var hasLastName = ($(parentElement).find("#lastName").length == 1);
  var hasMobileNumber = ($(parentElement).find("#mobileNumber").length == 1);
  var hasEmail = ($(parentElement).find("#email").length == 1);
  var mobileNumber, email, firstName, lastName;
  var status = true;
  if (hasFirstName) {
    firstName = $(parentElement).find("#firstName").val()
  }
  if (hasLastName) {
    lastName = $(parentElement).find("#lastName").val()
  }
  if (hasMobileNumber) {
    mobileNumber = $(parentElement).find("#mobileNumber").val()
  }
  if (hasEmail) {
    email = $(parentElement).find("#email").val()
  }
  if (hasMobileNumber) {
	    if (mobileNumber) {
	      if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"mobileNumberErrorMsg"), "Insert Valid Mobile Number.", true);
	        if (status) {
	          status = false;
	        }
	      }
	      else {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"mobileNumberErrorMsg"), "Please Enter Mobile Number.", false);

	      }
	    }
	    else {
	    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"mobileNumberErrorMsg"), "Please Enter Mobile Number.", true);
	      if (status) {
	        status = false;
	      }
	    }
	  }
	  if (hasFirstName) {
	    if (firstName) {

	      if (!(/^[a-zA-Z]+$/.test(firstName))) {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"firstNameErrorMsg"), "Insert Valid First Name.", true);
	        if (status) {
	          status = false;
	        }
	      }
	      else {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"firstNameErrorMsg"), "Please Enter Mobile Number.", false);

	      }
	    }
	    else {
	    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"firstNameErrorMsg"), "Please Enter First Name.", true);
	      if (status) {
	        status = false;
	      }
	    }
	  }
	  if (hasLastName) {
	    if (lastName) {

	      if (!(/^[a-zA-Z]+$/.test(lastName))) {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"lastNameErrorMsg"), "Insert Valid Last Name.", true);
	        if (status) {
	          status = false;
	        }
	      }
	      else {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"lastNameErrorMsg"), "Insert Valid Last Name.", false);

	      }
	    }
	    else {
	    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"lastNameErrorMsg"), "Please Enter Last Name.", true);
	      if (status) {
	        status = false;
	      }
	    }
	  }
	  if (hasEmail) {
	    if (email) {

	      if (!(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email))) {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"emailErrorMsg"), "Insert Valid Email Id.", true);
	        if (status) {
	          status = false;
	        }
	      }
	      else {
	    	  showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"emailErrorMsg"), "Insert Valid Email Id.", false);

	      }
	    }
	    else {
	    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"emailErrorMsg"), "Please Enter Email Id.", true);
	      if (status) {
	        status = false;
	      }
	    }
	  } 
    if(location){
		showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"locationErrorMsg"), "Please Enter RTO Location.", false);
    }else{
		showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"locationErrorMsg"), "Please Enter RTO Location.", true);
    }
    if(vehicleCode){
		showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"vehichleErrorMsg"), "Please Enter Vehicle Details.", false);
    }else{
		showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"vehichleErrorMsg"), "Please Enter Vehicle Details.", true);
    }
    if(registrationDt === "yy-mm-dd"){
    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"regDateErrorMsg"), "Please Enter Registration Date.", true);
    }
    else if(registrationDt === "--"){
    	showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"regDateErrorMsg"), "Please Enter Registration Date.", true);
    }else if(registrationDt!=="YYYY-MM-DD"){
    	status = validateRegDate();
    }else{
		showErrorByQuerySelector(createFormLabelQuery(parentElement.id,"regDateErrorMsg"), "Please Enter Registration Date.", true);
    }
	  if (!status) {
	      return
	  }  
	  
   var formData = new FormData();
  formData.append("insProductType", insProductType);
  formData.append("vehicleCode", vehicleCode);
  formData.append("newVehicle", newVehicle);
  formData.append("location", location);
  formData.append("registrationDt", registrationDt);
  formData.append("mfgYear", mfgYear);
  formData.append("is-mobile", window.isMobile);
  var selectedOption = getSelectedOption(document.getElementById("selectId"));
  var rtoname = selectedOption.getAttribute('name');
 
  formData.append("rtoCode",rtoname);

  AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
  AppData.localStorage.setValue("firstName", firstName || "")
  AppData.localStorage.setValue("lastName", lastName || "")
  AppData.localStorage.setValue("emailId", email || "")

  formData.append("firstName", firstName || "");
  formData.append("lastName", lastName || "");
  formData.append("mobileNumber", mobileNumber || "");
  formData.append("emailId", email);
  formData.append("utmParams", JSON.stringify(window.utmParams));
  formData.append("channelType", JSON.stringify(window.channelType));


  var sendData = new URLSearchParams(formData).toString();
  if(insProductType == "TWGI"){
//	  triggerMotorTwoWheelerSearchPlan(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI,registrationDt,location,vehicleCode,mfgYear,isPolicyExpTwo)
  }else{
//	  triggerMotorFourWheelerSearchPlan(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,registrationDt,location,vehicleCode,mfgYear)	  
  }
  AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_SEARCH_PLANS.name,
    sendData).then(function (response) {
    	var params = (new URL(document.location)).searchParams;
    	window.urlParams = params.toString();
    	console.log("This is urlparams" +window.urlParams);

    	if (response.qid) {
        	triggerCreateLead(response.leadApplicantId,productName);
            window.location.href = path + "." + response.qid + ".html";
        }
      else{
        toggleLoader(false)
      }
    	
    })
}

/* POST MOTOR SEARCH_PLAN FOR NEW CAR FUNCTION */
function motorSearchPlanNewVechile(event) {
  var status = true;
  var parentElement = findSelectorParent(event.target, "FORM");
  var vehicleCode = $(parentElement).find('#vechilenewId').val();
  var newVehicle = $(parentElement).find('#newVehicle').val();
  var location = $(parentElement).find('#locationId').val();
  var registrationDt = $(parentElement).find('#newcar').val();
  var insProductType = $(parentElement).find('#productType').val();
  var mfgYear = $(parentElement).find('#newmfgYear').val();
  var hasFirstName = ($(parentElement).find("#firstName").length == 1);
  var hasLastName = ($(parentElement).find("#lastName").length == 1);
  var hasMobileNumber = ($(parentElement).find("#mobileNumber2").length == 1);
  var hasEmail = ($(parentElement).find("#email").length == 1);
  var mobileNumber, email, firstName, lastName;
  if (hasFirstName) {
    firstName = $(parentElement).find("#firstName").val()
  }
  if (hasLastName) {
    lastName = $(parentElement).find("#lastName").val()
  }
  if (hasMobileNumber) {
    mobileNumber = $(parentElement).find("#mobileNumber2").val()
  }
  if (hasEmail) {
    email = $(parentElement).find("#email").val()
  }

  var formData = new FormData();
  formData.append("insProductType", insProductType);
  formData.append("vehicleCode", vehicleCode);
  formData.append("location", location);
  formData.append("registrationDt", registrationDt);
  formData.append("mfgYear", mfgYear);
  formData.append("newVehicle", newVehicle);
  formData.append("is-mobile", window.isMobile);
  if (hasMobileNumber) {
    if (mobileNumber) {
      if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
        showError("mobileNumber2ErrorMsg", "Insert Valid Mobile Number.", true);
        if (status) {
          status = false;
        }
      }
      else {
        showError("mobileNumber2ErrorMsg", "Please Enter Mobile Number.", false);

      }
    }
    else {
      showError("mobileNumberError2Msg", "Please Enter Mobile Number.", true);
      if (status) {
        status = false;
      }
    }
  }
  if (hasFirstName) {
    if (firstName) {

      if (!(/^[a-zA-Z]$/.test(firstName))) {
        showError("firstNameErrorMsg", "Insert Valid First Name.", true);
        if (status) {
          status = false;
        }
      }
      else {
        showError("firstNameErrorMsg", "Please Enter Mobile Number.", false);

      }
    }
    else {
      showError("firstNameErrorMsg", "Please Enter First Name.", true);
      if (status) {
        status = false;
      }
    }
  }
  if (hasLastName) {
    if (lastName) {

      if (!(/^[a-zA-Z]$/.test(LastName))) {
        showError("lastNameErrorMsg", "Insert Valid Last Name.", true);
        if (status) {
          status = false;
        }
      }
      else {
        showError("lastNameErrorMsg", "Insert Valid Last Name.", false);

      }
    }
    else {
      showError("lastNameErrorMsg", "Please Enter Last Name.", true);
      if (status) {
        status = false;
      }
    }
  }
  if (hasEmail) {
    if (email) {

      if (!(/^[6-9][0-9]{9}$/.test(email))) {
        showError("emailErrorMsg", "Insert Valid Email Id.", true);
        if (status) {
          status = false;
        }
      }
      else {
        showError("emailErrorMsg", "Insert Valid Email Id.", false);

      }
    }
    else {
      showError("emailErrorMsg", "Please Enter Email Id.", true);
      if (status) {
        status = false;
      }
    }
  }
  if (!status) {
    return
  }
  AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
  AppData.localStorage.setValue("firstName", firstName || "")
  AppData.localStorage.setValue("lastName", lastName || "")
  AppData.localStorage.setValue("emailId", email || "")

  formData.append("firstName", firstName || "");
  formData.append("lastName", lastName || "");
  formData.append("mobileNumber", mobileNumber || "");
  formData.append("emailId", email);
  formData.append("utmParams", JSON.stringify(window.utmParams));
  formData.append("channelType", JSON.stringify(window.channelType));

  formData.append("is-mobile", window.isMobile);

  var sendData = new URLSearchParams(formData).toString();
  AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_SEARCH_PLANS.name,
    sendData).then(function (response) {
      if (response.qid) {
      	triggerCreateLead(response.leadApplicantId,productName);
        window.location.href = path + "." + response.qid + ".html";
      }
      else{
        toggleLoader(false)
      }
    })
}

/* CALL US FUNCTION */
function motorCallUs() {
	
	  var parentElement = document.getElementById('register-form');
	  var hasFirstName = ($(parentElement).find("#firstName").length == 1);
	  var hasLastName = ($(parentElement).find("#lastName").length == 1);
	  var hasMobileNumber = ($(parentElement).find("#mobileNumber").length == 1);
	  var mobileNumber, firstName, lastName;
	  if (hasFirstName) {
	    firstName = $(parentElement).find("#firstName").val()
	  }
	  if (hasLastName) {
	    lastName = $(parentElement).find("#lastName").val()
	  }
	  if (hasMobileNumber) {
	    mobileNumber = $(parentElement).find("#mobileNumber").val()
	  }


  var callUsFirstName = firstName || "";
  var callUsLastName = lastName || "";
  var callUsMobileNo = mobileNumber || "";

  var formData = new FormData();
  formData.append("userAction", "callme");
  formData.append("insProductType", document.getElementById('productType').value);
  formData.append("utmParams", JSON.stringify(window.utmParams));
  formData.append("channelType", JSON.stringify(window.channelType));

  formData.append("is-mobile", window.isMobile);
  formData.append("firstName", callUsFirstName || "Name");
  formData.append("lastName", callUsLastName  || "SurName");
  formData.append("mobileNumber", callUsMobileNo  || "mobileNumber");

  var sendData = new URLSearchParams(formData).toString();
  AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_CALL_US.name, sendData)
    .then(function (response) {
      if (response.payload) {
    	  triggerCreateLead(response.payload.applicationId,productName);
    	  toggleLoader(false)
      }
      else{
        toggleLoader(false)
      }

    })
}

/* EMAIL FUNCTION */
function motorEmailHandler() {
}
function serachVehicle(params, data) {

  var formData = new FormData();
  formData.append("vehicleText", params.term);
  formData.append("insProductType", productTypevalue);
  var sendData = new URLSearchParams(formData).toString();
  AppEvent
    .trigger(
      AppConstants.API_SELECTOR.MOTOR_GET_VEHICLE_DETAILS.name, sendData)
    .then(
      function (response) {
        toggleLoader(false)

        return response.payload.vehicleInfoList;
      })
}

$(window).on('load',function(){
	//$(document).on("click", ".buy-check", function (ev) {
	$('input[name="buyNow-check-cp"]').click(function(){
			if(!($(this).is(':checked')) ){
			$(".btn.final-step-btn").attr('disabled','disabled');
		}else{
			$(".btn.final-step-btn").removeAttr('disabled');
		}		
		});
	
	$('input[name="buyNow-check-tp"]').click(function(){
		if(!($(this).is(':checked')) ){
			$(".btn.btn-tp").attr('disabled','disabled');
		}else{
			$(".btn.btn-tp").removeAttr('disabled');
		}		
		});
	
	$('input[name="buyNow-check"]').click(function(){
		if(!($(this).is(':checked')) ){
			$(".btn.step-next#refineCallBtn").attr('disabled','disabled');
		}else{
			$(".btn.step-next#refineCallBtn").removeAttr('disabled');
		}		
		});
});
document.addEventListener("DOMContentLoaded", function () {

	
  if (document.getElementById("productType")) {
    var productType = document.getElementById("productType").value;
    if (productType == "FWGI") {
      window.productTypevalue = "1"
    } else {
      window.productTypevalue = "2"
    }

    $("#vechileId,#vechilenewId").select2({
      minimumInputLength: 3,
      width: '100%',
      ajax: {
        url: AppConstants.API_URI + "." + AppConstants.API_SELECTOR.MOTOR_GET_VEHICLE_DETAILS.name + "." + AppConstants.EXTENSION,
        method: AppConstants.API_SELECTOR.MOTOR_GET_VEHICLE_DETAILS.method,
        data: function (params) {
          var query = {
            vehicleText: params.term,
            insProductType: window.productTypevalue
          }

          // Query parameters will be ?search=[term]&type=public
          return query;
        },
        processResults: function (data) {
          var results = data.payload.vehicleInfoList.map(function (vehicleData) {
            return { "id": vehicleData.vehicleCode, "text": vehicleData.vehicleDesc }
          })
          return {

            results : results
          };
        }
      }
    });
  }
})



getRTOList("selectId");
//getRTOList("locationId");

getVechileDetails("vechileId");
getVechileDetails("vechilenewId");

///*Expiry Date*/
var isPolicyExpiryDateValid = false;
var inputDate;
var claim = true;
function validatePolicyDate() {
	try{
    if (isPolicyExpiryDateValid) {
        if ($('.card-summary>.step-next').attr('data-step') === "2") {
            $('.card-summary>.step-next').prop('disabled', true)
        }
        $('.inner_steps').find('.policy-error').fadeIn();
        $('.expiry-date').text($('#edate').val());
        $('#expYear').prop('disabled', true);
        $('#expMonth').prop('disabled', true);
        $('#expDt').prop('disabled', true);
        $('.edit-datepicker').click(function () {
            $('#expYear').removeAttr('disabled');
            $('#expMonth').removeAttr('disabled');
            $('#expDt').removeAttr('disabled');
            $('.inner_steps').find('.policy-error').fadeOut();
            $('.card-summary>.step-next').prop('disabled', false);
        });
        $('.renewal-btn').click(function () {
        	if($(this).attr('valid')==="true") {
        		$('.step.step2').fadeOut()
        		$('.step.step2').removeClass('active')
        		$('.step.step3').fadeIn()
        		$('.step.step3').addClass('active')
        		$('.card-summary>.step-next').fadeOut();
        		$(".btn.final-step-btn").fadeIn();
        		$('.step-count-wrapper .steps-list li:nth-of-type(2)').removeClass('active')
        		$('.step-count-wrapper .steps-list li:nth-of-type(3)').addClass('active')
        		 $(".buynow-check").css("display","block");
        	}else{
	            $('.step-list ul li:nth-of-type(1)').removeClass('active');
	            $('.step-list ul li:nth-of-type(2)').removeClass('disable')
	            //$('.step-list ul li:nth-of-type(2)').addClass('active')
	            $('.step-list ul li:nth-of-type(2)').trigger('click');
	            $('.bs-step').find('.step-next').removeAttr('disabled'); 
        	}
        });
        $('.step-list ul li').click(function () {
            if ($(this).hasClass('active') == false) {
                var cur = $('.steps-content .inner-step:nth-of-type(' + ($(this).index() + 1) + ')');
                cur.siblings().fadeOut(function () {
                    cur.show().addClass('active');
                });

                $(this).addClass('active');
                $(this).siblings().removeClass('active');
            }
        });
        $('.inner_steps').find(".existing-customer").change(function () {
          if (!($(this).is(':checked'))) {
              claim = true;
              $(this).parents('.motor-card-inner').fadeOut(function () {
            	  $(this).next().fadeIn();
              });
          } else {
              claim = false;
          }
      });
    }
    else {
        if ($('.card-summary>.step-next').attr('data-step') === "2") {
            $('.card-summary>.step-next').prop('disabled', true)
        }
        $('.inner_steps').find('.policy-error').fadeOut();
    }
}catch (err) {
    console.log(err)
}
    
    
}



function motor_inner_steps1() {
    var dd = document.getElementById("expDt")? document.getElementById("expDt").value : "DD";
    var mm = document.getElementById("expMonth")? document.getElementById("expMonth").value : "MM";
    var yy = document.getElementById("expYear")?document.getElementById("expYear").value : "YYYY";
    if(yy!="YYYY"){
    	$('#expDt').attr("onkeyup","motor_inner_steps1()");
    	$('#expMonth').attr("onkeyup","motor_inner_steps1()");
    	   	
    }
    inputDate = yy + "-" + mm + "-" + dd;
    if(document.getElementById("edate")){document.getElementById("edate").value = inputDate;}
     
    var inputDateFormat = inputDate.split("-");
    var ipDate = new Date();
    ipDate.setYear(inputDateFormat[0]);
    ipDate.setMonth(inputDateFormat[1] - 1);
    ipDate.setDate(inputDateFormat[2]);
    var currentDate = new Date().addDays(-1);
    var validDate = currentDate.addDays(90);

    if (inputDate === "YYYY-MM-DD") {
        showError('edate-error', '', false);
    }
    else {
      if(inputDate === "--" || inputDate == "dd/mm/yy" ){
        $('#refineCallBtn').click(function (evt) {
        	showError('edate-error', 'This field is required', true);
    	   
    	});
    	

    	isPolicyExpiryDateValid = false;
        validatePolicyDate();

    }
      else if (inputDate.length === 10) {
            if (/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/.test(inputDate)) {
                showError('edate-error', '', false);
                if(AppData.QuoteData[quoteCode].payload.insProductType=="TWGI"){
                    if(ipDate < currentDate.addDays(-1824)){
                      showError('edate-error', 'Please Enter valid date', true);
                            isPolicyExpiryDateValid = false;
                            validatePolicyDate();
                            $('.renewal-btn').attr('valid',false);
                    }else if(ipDate < currentDate.addDays(-90)){
                    	 toastr.success("It’s been more than 90 days since your previous policy has expired. Your policy cover would start 3 days after policy is issued.");
                    	 isPolicyExpiryDateValid = true;
                         validatePolicyDate();
                         $('.renewal-btn').attr('valid',true)
                    }else if(ipDate > validDate){
                    	  showError('edate-error', 'Please Enter valid date', true);
                          isPolicyExpiryDateValid = false;
                          validatePolicyDate(); 
                          $('.renewal-btn').attr('valid',false)
                    }else{
                    	 showError('edate-error', '', false);
                         isPolicyExpiryDateValid = true;

                         validatePolicyDate();
                         $('.renewal-btn').attr('valid',false)
                         return true;
                    }
                }
                else if (ipDate > validDate || ipDate <= currentDate) {
                    showError('edate-error', 'Please Enter valid date', true);
                    isPolicyExpiryDateValid = false;
                    validatePolicyDate();
                    $('.renewal-btn').attr('valid',false)
                    return false;
                } else {
                    showError('edate-error', '', false);
                    isPolicyExpiryDateValid = true;

                    validatePolicyDate();

                    return true;
                }
            } else {
                showError('edate-error', 'Please Enter valid date', true);
                isPolicyExpiryDateValid = false;
                validatePolicyDate();
                return false;
            }
        } else {
            $('.inner_steps').find('.policy-error').fadeOut();
        }
    }
    
}


function material_input1() {
    try {
        var input_ele = $('.reg-no');
        input_ele.click(function () {
           // $('.datepicker input').datepicker();
            $(this).parent().addClass('focus');
            $(".reg-no").prev().focus();
        });
        
    } catch (err) {
        console.log(err);
    }
}
material_input1();


window.activePlanInRider = "";
var Rs = "&#8377;";
var activePlan = "";
var activeStep = 1;
function init() {
	// get_offer();
	tab_to_sticky();
	// checkExpiry();
	limitCheckbox();
	autoCompleteDd();
	accordian();
	side_menu();
	banner();
	testimonialSwiper();
	newsSwiper();
	quoteSwiper();
	emiCardSwiper();
	dealsSwiper();
	searchSwiper();
	fundRiderSlider();
	fundListSwiper();
	quoteDetails();
	offersSwiper();
	alsoConsideredSlider();

	customizeAllocation();
	riderList();
	fundList();
	newsReleaseBtn();
	set_bg();
	product_hover();
	wow_animate();
	put_header_in_side_menu();
	tab_sticky();

	make_active();
	top_menu_show();
	side_menu_active();
	material_input();
	//datepick();
	child_add();
	checkMultipleTabs();
	onclickOfTabDropdown();
	motor_editAmount();
	// equalizerHeight();
	planDropdown();
	// validation();

	motor_step();
	//motor_inner_steps();
	change_dom();
	append_default_years();
	otpFocus();
	editDetailsPopup();
	myOffersOpenClose();
	searchOpenClose();
	question_steps();
	menu_tabs();

	// warning,info,success
	// toastr.error('We do have the Kapua suite available.', '', {
	// timeOut: 5000,
	// "closeButton": true,
	// "preventDuplicates": true
	// });

	if ($("#column-chart").length) {
		$("li").click(function() {
			var isGraph = $(this).find(".icon-graph-view");
			if (isGraph) {
				columnChart();
			}
		});
	}
	$('#parentHorizontalTab').easyResponsiveTabs({
		type : 'default', // Types: default, vertical, accordion
		width : 'auto', // auto or any width like 600px
		fit : true, // 100% fit in a container
		tabidentify : 'hor_1', // The tab groups identifier
	});
	
	$('#parentHorizontalTabSec').easyResponsiveTabs({
		type : 'default', // Types: default, vertical, accordion
		width : 'auto', // auto or any width like 600px
		fit : true, // 100% fit in a container
		tabidentify : 'hor_2', // The tab groups identifier
	});

	// Child Tab
	$('#ChildVerticalTab_1').easyResponsiveTabs({
		type : 'vertical',
		width : 'auto',
		fit : true,
		tabidentify : 'ver_1', // The tab groups identifier
	});

	$('#ChildVerticalTab_2').easyResponsiveTabs({
		type : 'vertical',
		width : 'auto',
		fit : true,
		tabidentify : 'ver_2', // The tab groups identifier
	});

	$('#ChildVerticalTab_3').easyResponsiveTabs({
		type : 'vertical',
		width : 'auto',
		fit : true,
		tabidentify : 'ver_3', // The tab groups identifie
	});

	if ($('.lyt-protector-flow').length) {
		protectLoan();
	}

	slideEffectHorizontal();
	slideEffectVertical();

	bsLine();
	imageTile();
	scrollToActiveTab();
	popup();
	hide_show();
	swipeContent();
	readMoreCont();
	dropdown();
	select();
	hide_textbox();
	dropdown_hover();
	customResponsiveTable();
	contactForm();
	// themeSpace();
	searchResult();
	filterFaq();
	// filterOffers();
	// playVideo();
	moving_dom_sticky();

	country_close();
	addClassToRemainder();
	tabOnly();
	tabOnlySlideEffect();
	// menuHover();
	addToCompare();
	float_btn_new();
	equalheight('.eqheight .eq-item');
	toggleFeatureList();
	otpSteps();

	if ($("#bonus-slider").length) {
		filter_slider('bonus-slider');
	}
	if ($("#bonus-slider2").length) {
		filter_slider('bonus-slider2');
	}
	if ($("#tile-slider").length) {
		tile_slider('tile-slider');
	}
	articleVerticalSlider();
	

}
if (document.getElementById("fourWheelerregistartionNumberPreFillData")) {

	getQuoteData(quoteCode).then(function(data) {
		data = updateMotorJsonObj(data);
		updateMotorPlanData(data);
		loadMotorQuoteData(data);
		toggleLoader(false)

	})
	
	if(window.isMobile == "1"){
	document.getElementById('editButton').setAttribute('href', document.getElementById("editButton").getAttribute("href").substring(0,document.getElementById("editButton").getAttribute("href").length-5)+".is-mobile.html");
	}
	
}

window.addEventListener('load', function() {
	console.log('motor trigger');
	if (window.activePlan == "4WCI") {
//		triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI);
	}
	
})

function updateMotorPlanData(response) {
	AppData.QuoteData[quoteCode] = response;
	response.payload.premiumPlan.forEach(function(plan, index) {
		AppData.CurrentAPIPlanData[plan.variantCode] = plan;
	})
}
var lastRefineData;

function callAjaxForMotorRefine(idv,event) {
	try {
		var dd = document.getElementById("expDt").value;
//		dd = appendZero(dd,"expDt");
		var mm = document.getElementById("expMonth").value;
//		dd = appendZero(mm,"expMonth");
		var yy = document.getElementById("expYear").value;
	    var inputDate =  yy+"-"+mm+"-"+dd;
	    var edateText= document.getElementById("edate");
	    if(inputDate=="--"){edateText.value = "YYYY-MM-DD";}
	    else{edateText.value = inputDate;}
	 
		if (AppData.QuoteData[quoteCode].payload.insProductType == "FWGI") {
			return new Promise(
					function(resolve, reject) {
						var parentElement = findSelectorParent(event.target,
								".bs-step");
						var variantCode = event.target
								.getAttribute("data-variantcode")
								|| window.activePlan;
						var previousClaimSts;
						previousClaimSts = $(event.target).attr("data-step");
						console.log("previousClaimSts", previousClaimSts);
						var planData = AppData.CurrentAPIPlanData[event.target
								.getAttribute("data-variantcode")]
						var payloadData = AppData.QuoteData[quoteCode].payload
						var formData = new FormData();
						if (payloadData.premiumPlan[0].planCode == "4WCI") {
							formData.append("transactionId",
									payloadData.premiumPlan[0].transactionId);
						} else if(payloadData.premiumPlan.length == 2){
							formData.append("transactionId",
									payloadData.premiumPlan[1].transactionId);
						}

						var policyExpireDt = document.getElementById("edate").value;
						if (policyExpireDt != "YYYY-MM-DD") {
							triggerMotorIDVpolicyExpire(policyExpireDt);
						} else {
							console.log(policyExpireDt);
						}

						var recommedValue = document.getElementById(idv).value;
						var editAmount = payloadData.premiumPlan[0].idvmin;
						if (previousClaimSts == 1 ? false : true) {
							triggerMotorRefineFirstNextCall(
						           window.productName,
									variantCode, recommedValue, editAmount)
						}
						formData.append("insProductType",
								payloadData.insProductType);
						if(payloadData.premiumPlan.length == 2){
						formData.append("transactionIdTP",
								payloadData.premiumPlan[1].transactionId);
						}
						formData.append("policyExpireDt", policyExpireDt);
						formData.append("basicPremium",
								payloadData.premiumPlan[0].basicPremium);
						formData.append("netPremium",
								payloadData.premiumPlan[0].netPremium);
						formData.append("planCode",
								payloadData.premiumPlan[0].planCode);
						formData.append("gst", payloadData.premiumPlan[0].gst);
						formData.append("planName",
								payloadData.premiumPlan[0].planName);
						formData.append("variantCode", variantCode);
						formData.append("policyDuration",
								payloadData.premiumPlan[0].policyDuration);
						formData.append("allowedPolicyTerm",
								payloadData.premiumPlan[0].allowedPolicyTerm);
						formData.append("idv",
								document.getElementById(idv).value);
						formData.append("idvmin",
								payloadData.premiumPlan[0].idvmin);
						formData.append("idvmax",
								payloadData.premiumPlan[0].idvmax);
						formData.append("qid", quoteCode);
						if (previousClaimSts == 2) {
							formData.append("previousClaimSts",($(parentElement).find("#existing-customer")[0].checked) ? "Y" : "N");
						}else if(previousClaimSts == 1){
							formData.append("previousClaimSts", previousClaimSts ? "N" : "Y");
						}
						formData.append("is-mobile", window.isMobile);

						$('#existing-customer')
								.on(
										'change',
										function() {
											triggerMotorClaimInsurancetoggle();
											var date = new Date();
											var currentYear = date
													.getFullYear();
											var vechileyrs = payloadData.vehicleDetails.registrationDetails.mfgYear;
											var yearsCalculate = currentYear
													- vechileyrs;

											var claimStatusValue = new Array();
											claimStatusValue = [ "0", "20",
													"25", "35", "45", "50" ];
											var radioLabel = "";
											var arrayLength = claimStatusValue.length;
											if (arrayLength <= yearsCalculate) {
												for (var i = 0; i < arrayLength; i++) {

													radioLabel += '<li class="item aem-GridColumn aem-GridColumn--default--3 aem-GridColumn--tablet--6 aem-GridColumn--phone--12" id="claimStatusTemplate"><label class="control control--radio">'
															+ claimStatusValue[i]
															+ '%<input type="radio" class="checkbox" name="sumInsured" data-step="3" id="claimValue" value="'
															+ claimStatusValue[i]
															+ '"><div class="control__indicator"></div></label></li>';

												}
											} else {
												for (var i = 0; i < yearsCalculate; i++) {

													radioLabel += '<li class="item aem-GridColumn aem-GridColumn--default--3 aem-GridColumn--tablet--6 aem-GridColumn--phone--12" id="claimStatusTemplate"><label class="control control--radio">'
															+ claimStatusValue[i]
															+ '%<input type="radio" class="checkbox" name="sumInsured" data-step="3" id="claimValue" value="'
															+ claimStatusValue[i]
															+ '"><div class="control__indicator"></div></label></li>';

												}
											}

											$(
													'.claimStatusContainer .claimStatusul')
													.html(radioLabel);
											$("input[name='sumInsured']")
													.on(
															"change",
															function(event) {
																callAjaxForMotorRefine(idv,event);

															})

										})

						if ($("input[name='sumInsured']:checked").val()) {
							var radioValue = $(
									"input[name='sumInsured']:checked").val();
									triggerMotorClaimInsuranceBonus(radioValue);
							console.log("Your are a - " + radioValue);
						} else {
							var radioValue = $(
									"input[name='sumInsured']:checked").val();
							console.log("Your are a - " + radioValue);
						}

						var theArray = [ 0, 20, 25, 35, 45, 50, 50 ];
						var currentIndex = theArray
								.indexOf(parseInt(radioValue));

						function getAtIndex(i) {
							if (i === 0) {
								return theArray[currentIndex];
							} else if (i > 0) {
								return theArray[currentIndex + 1];
							}
						}

						console.log(getAtIndex(currentIndex + 1));

						formData.append("currentNcb",
								getAtIndex(currentIndex + 1) || 20);

						formData.append("previousNcb", radioValue || 0);
						formData.append("previousPolicyNum",
								payloadData.premiumPlan[0].policyDuration);

						if (payloadData.premiumPlan[0].addon == null) {
							formData.append("addon",
									payloadData.premiumPlan[0].addon)
						} else {
							formData.append("bagicCode",
									payloadData.premiumPlan[0].addon.bagicCode
											|| "");
							formData.append("amount",
									payloadData.premiumPlan[0].addon.amount
											|| "");
							formData
									.append(
											"code",
											payloadData.premiumPlan[0].addon.code
													|| "");
						}

						formData
								.append(
										"registrationDetails",
										JSON
												.stringify(payloadData.vehicleDetails.registrationDetails));
						formData
								.append(
										"modelDetails",
										JSON
												.stringify(payloadData.vehicleDetails.modelDetails));
						formData
								.append(
										"riderDetails",
										JSON
												.stringify(payloadData.premiumPlan[0].riderDetails));
						formData.append("is-mobile", window.isMobile);
						if ($('#existing-customer').is(":checked") == false) {
							formData.append("previousClaimSts", "N")
						} else {
							formData.append("previousClaimSts", "Y")
						}

						if(getAtIndex(currentIndex + 1) > 0){
							formData.append("previousClaimSts", "N")
						}else{
							formData.append("previousClaimSts", "Y")
						}

						/*
						 * if (previousClaimSts == 2) {
						 * triggerMotorRefineSecondNextCall(
						 * AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,
						 * variantCode, planRecommendedAmount,
						 * planConsideredAmount) }
						 */
						var sendData = new URLSearchParams(formData).toString();

						AppEvent
								.trigger(
										AppConstants.API_SELECTOR.MOTOR_GET_REFINED_PLANS.name,
										sendData)
								.then(
										function(data) {

											if (data.payload.insProductType == "FWGI") {

												var data = updateMotorJsonObj(data);
												updateMotorPlanData(data);
												console.log(variantCode);
												var plan = data.payload.premiumPlan
														.find(function(planObj) {
															return planObj.variantCode == variantCode
														})
												if (previousClaimSts == 1) {
													document
															.querySelectorAll(
																	"#planDetailsPremiumAmt"
																			+ variantCode)
															.forEach(
																	function(
																			ele) {
																		$(ele)
																				.html(
																						Rs
																								+ plan.netPremium);
																	})
												} else if (previousClaimSts == 3){
													
													document
													.querySelectorAll(
															"#planDetailsPremiumAmt"
																	+ variantCode)
													.forEach(
															function(
																	ele) {
																$(ele)
																		.html(
																				Rs
																						+ plan.netPremium);
															})
													
												}
												else if (previousClaimSts == 2 || false) {
													document
													.querySelectorAll(
															"#planDetailsPremiumAmt"
																	+ variantCode)
													.forEach(
															function(
																	ele) {
																$(ele)
																		.html(
																				Rs
																						+ plan.netPremium);
															})
													if(plan.riderDetails.length != 0){
													var riderString = "";
													var riderDeatilsString = "";

													plan.riderDetails
															.forEach(function(
																	riderPlanData,
																	index) {
																if (riderPlanData.riderCode != "4WCI_ADDON_PRIME") {
																	callAjaxForMotorRefine(idv);

																	riderString += '<div class="item bs-checkbox type3">'
																			+ '<input type="checkbox" data-variantcode="'
																			+ plan.variantCode
																			+ '" name="motor-plan" id="plan-'
																			+ (index + 1)
																			+ '"  value="'
																			+ riderPlanData.amount
																			+ '" data-premium="'
																			+ plan.netPremium
																			+ '" data-json=\''
																			+ JSON
																					.stringify(riderPlanData)
																			+ '\' data-transactionId="'
																			+ riderPlanData.transactionId
																			+ '">'
																			+ '<label for="plan-'
																			+ (index + 1)
																			+ '">'
																			+ riderPlanData.name
																			+ '<span class="amount" id="amount1">₹'
																			+ riderPlanData.amount
																			+ '</span>'
																			+ '</label>'
																			+ '</div>';
																	riderDeatilsString += '<div class="motor-plan-card-wrap '
																			+ ""
																			+ '" name="plan-'
																			+ (index + 1)
																			+ '" >'
																			+ ((riderPlanData.selected) ? '<span class="icon icon-star"></span>'
																					: '')
																			+ '<h3 class="card-title" id="cardTitle">'
																			+ riderPlanData.name
																			+ '</h3>'
																			+ '<div class="plan-card">'
																			+ '<div class="card-head">'
																			+ '<span class="icon icon-star"></span>'
																			+ '<div class="title">Covers Included</div>'
																			+ '</div>'
																			+ '<div class="card-body">'
																			+ '<div class="plan-features">'
																			+ '<div class="bs-list typ-horizontal typ-small">'
																			+ '<ul>';
																	riderPlanData.features
																			.forEach(function(
																					feature) {
																				riderDeatilsString += '<li class="list-item">'
																						+ feature
																						+ '</li>'
																			})
																	riderDeatilsString += '</ul>'
																			+ '</div>'
																			+ '</div>';
																	riderDeatilsString += '</div>'
																			+ '</div>'
																			+ '</div>'
																			+ '</div>';
																	window.activePlanInRider = (activePlanInRider == "" && riderPlanData.selected) ? (index + 1)
																			: "";
																} else {
																	lastRefineData = riderPlanData;
																}
															})

													riderDeatilsString += '<div class="motor-plan-card-wrap no-plan-selected" style="display: none;">'
															+ '<h3 class="card-title">'
															+ '<span class="icon icon-warning"></span>'
															+ 'No plan selected</h3>'
															+ '</div>';
													$(parentElement)
															.find(
																	".rider-plan .form-list")
															.html("");
													$(parentElement).find(
															".rider-plan-list")
															.html("")
													$(parentElement)
															.find(
																	".rider-plan .form-list")
															.append(riderString);

													limitCheckbox();
													$(
															".rider-plan input:checkbox")
															.click(
																	function() {
																		var value = (parseInt($(
																				this)
																				.attr(
																						"data-premium")));
																		var element = this;
																		var html = "";
																		if (element.checked) {
																			html = (Rs + (value + parseInt($(
																					this)
																					.val())));

																		} else {
																			html = (Rs + (value));

																		}
																		document
																				.querySelectorAll(
																						"#planDetailsPremiumAmt"
																								+ $(
																										this)
																										.attr(
																												"data-variantcode"))
																				.forEach(
																						function(
																								ele) {
																							$(
																									ele)
																									.html(
																											html);
																						})
																	})

													$(parentElement)
															.find(
																	".rider-plan-list")
															.append(
																	riderDeatilsString);
												}else{
													$(".rider").css('display','none');
													$(".rider-list").css('display','none');
													$(".no-rider").css('display','block');
													
												}

											}
												resolve(true)
												if (activePlanInRider) {
													$(parentElement)
															.find(
																	"#plan-"
																			+ window.activePlanInRider)
															.click()
												}
											}
											toggleLoader(false);
											
											// init();
										})
					})
		}

	} catch (e) {
		console.error(e);
	}
}

/*
 * getformData(motor-buy-now, function(data){
 * 
 * },{ "insProductType": data["insProductType"], "transactionId":
 * data["transactionId"]
 * 
 * });
 */
function updateMotorJsonObj(jsonData) {
	var tempObj = jsonData;
	jsonData.payload.premiumPlan.forEach(function(data, index, self) {
		var amountObj = data.riderDetails.find(function(riderData) {
			return riderData.riderCode == "4WCI_ADDON_PRIME"
		})
		// data.netPremium=parseInt(data.netPremium)+parseInt((amountObj)?amountObj.amount
		// : "0")
		/*
		 * data.riderDetails=data.riderDetails.filter(function(riderData){
		 * return riderData.riderCode!="4WCI_ADDON_PRIME" })
		 */
	})
	return jsonData;
	//motor_inner_steps(false);

}

function callAjaxForMotorBuyNow() {
	var variantCode = event.target.getAttribute("data-variantcode")
			|| window.activePlan;
	var planData = AppData.CurrentAPIPlanData[variantCode]
	var payloadData = AppData.QuoteData[quoteCode].payload
	var riderDetailsEle = document.getElementById(
			"quoteTargetPlanDetails" + variantCode).querySelectorAll(
			".bs-checkbox.type3 input");
	var riderDetails;
	var selectedRiderPlan = riderDetailsEle.forEach(function(checkboxEle) {
		if (checkboxEle.checked) {
			riderDetails = JSON.parse(checkboxEle.getAttribute("data-json"))
		}
	})

	console.log("rider Details" + riderDetails);
	var formData = new FormData();
	formData.append("insProductType", payloadData.insProductType);

	if (planData.planCode == "4WTP") {
		formData.append("transactionId", planData.transactionId);
	} else {
		if (riderDetails) {
			formData.append("transactionId", riderDetails.transactionId);
		} else {
			formData.append("transactionId", planData.transactionId);
		}
	}

	if (riderDetails != null) {
		formData.append("riderDetails", JSON.stringify(riderDetails));
	}else{
		formData.append("riderDetails", "undefined");
	} 
	formData.append("planCode", planData.planCode);
	formData.append("netPremium", planData.basicPremium);
	formData.append("variantCode", planData.variantCode);
	formData.append("gst", planData.gst);
	formData.append("grossPremium", planData.netPremium || "");
	formData.append("policyTerm", planData.policyDuration || "");
	formData.append("previousClaimSts", payloadData.previousClaimSts || "");
	formData.append("lastRefineData", JSON.stringify(lastRefineData));
	formData.append("renewalFlag", false);
	
	
	formData.append("vehiclePolicyDetails", JSON.stringify({
		"idvMin" : planData.idvmin,
		"idvMax" : planData.idvmax,
		"idvBase" : planData.idv || "",
		"policyType" : payloadData.policyType,
		"previousNCB" : planData.previousNcb,
		"currentNCB" : planData.currentNcb
	}))
	formData.append("previousPolicyDetails", JSON.stringify({
		"policyExpiryDate" : payloadData.policyExpireDt,
		"policyExpired" : "false",
		"policyNumber" : "",
		"insProviderCode" : ""
	}))
	formData.append("utmParams", JSON.stringify(window.utmParams));
    formData.append("channelType", JSON.stringify(window.channelType));
//	AppData.localStorage.setValue("mobileNumber", payloadData.mobileno || "")
	AppData.localStorage.setValue("firstName", payloadData.firstName || "")
	AppData.localStorage.setValue("lastName", payloadData.lastName || "")

	//formData.append("riderDetails", riderDetails);
	formData.append("firstName", payloadData.firstName || "");
	formData.append("lastName", payloadData.lastName || "");
	formData.append("mobileNumber", AppData.localStorage.props.mobileNumber || "");
	


	formData
			.append(
					"vehicleDetails",
					JSON
							.stringify({
								"registrationNumber" : payloadData.vehicleDetails.registrationDetails.registrationNumber
										|| "",
								"mfgYear" : payloadData.vehicleDetails.registrationDetails.mfgYear,
								"vehicleCode" : payloadData.vehicleDetails.modelDetails.vehicleCode,
								"rtoCode" : payloadData.vehicleDetails.registrationDetails.rtoCode
										|| "",
								"registrationDate" : payloadData.vehicleDetails.registrationDetails.registrationDt
							}))

	var riderPlanVariantCode;
	var riderPlanAmount;
	var sendData = new URLSearchParams(formData).toString();
	if (planData.planCode == "4WTP") {
		var variantCode = planData.variantCode;

		triggerThirdPartyMotorBuyNow(
				window.productName,
				variantCode, planData.netPremium);
	} else {

		tiggerMotorComperhensiveBuyNow(
				window.productName,
				planData.variantCode, planData.netPremium,
				riderPlanVariantCode, riderPlanAmount)
	}
	AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_BUY_NOW.name, sendData)
			.then(function(response) {
				if (response.responseURL) {

					if(response.authToken){
					window.sessionStorage.setItem("SS_1", response.authToken)
					window.sessionStorage.setItem("SS_4", response.guardKey)
					document.cookie = "SS_1=" + response.authToken 
					document.cookie = "SS_4=" + response.guardKey
					}

					location.href = response.responseURL;
				}
				popup_close()
				toggleLoader(false)

			})
}
function loadMotorQuoteData(responseData) {
	if (responseData.payload.insProductType == "FWGI") {
		var populateData = responseData;
		document.getElementById("cityPreFillData").innerHTML = populateData.payload.vehicleDetails.registrationDetails.location;
		document.getElementById("registartionDatePreFillData").innerHTML = populateData.payload.vehicleDetails.registrationDetails.registrationDt;
		document.getElementById("vehicleDetailsPreFillData").innerHTML = populateData.payload.vehicleDetails.modelDetails.make
				+ " "
				+ populateData.payload.vehicleDetails.modelDetails.variant
				+ ", "
				+ populateData.payload.vehicleDetails.modelDetails.fuelType
				+ ", "
				+ populateData.payload.vehicleDetails.modelDetails.cc
				+ "cc, "
				+ populateData.payload.vehicleDetails.modelDetails.model;

		if (populateData.payload.vehicleDetails.registrationDetails.registrationNumber == null
				|| "") {
			document.getElementById("registrationnumbercontainer").style.display = "none";
		} else {
			document.getElementById("registrationnumbercontainer");
			document.getElementById("fourWheelerregistartionNumberPreFillData").innerHTML = populateData.payload.vehicleDetails.registrationDetails.registrationNumber;
		}
		document.getElementById("totalPlans").innerHTML = populateData.payload.premiumPlan.length;
		
		if(populateData.payload.renewalFlag == true){
			$("#non-renewal-card").css("display","none");
			$("#renewal-card #planName").text(populateData.payload.premiumPlan[0].planName);
			$("#planDetailsPremiumAmtRenew").text(populateData.payload.premiumPlan[0].netPremium.toLocaleString());
			$("#planRecommendedAmount").text(populateData.payload.premiumPlan[0].idv.toLocaleString());
			$("#planConsideredAmount").text(populateData.payload.premiumPlan[0].currentNcb  + " %");
			//$(".subtitle").text(populateData.payload.premiumPlan[0].planName);
			$("#planDetailsPremiumAmt4WCI").text(populateData.payload.premiumPlan[0].netPremium.toLocaleString());
			
//			var riderData = populateData.payload.premiumPlan[0].riderDetails;
			if(populateData.payload.riderDescription){
				$("#riderPlan").css("display","block");
				var riderDescription = populateData.payload.riderDescription;
				if(riderDescription.indexOf("~") == -1){
					$('.rider-plan .form-list label').text(riderDescription);
				}else{
					riderDescription = riderDescription.split("~");
					$('.rider-plan .form-list label').text(riderDescription[1]);
				}
				
				
				
				
//				$("#plan-button").css("display" , "block");
//				$('renewal-card .rider-plan-list .motor-plan-card-wrap').find('.plan-features ul').html('');
//				for (i = 0; i < 2; i++) {
//				    var getAmount = riderData.riderDetails[i].amount;
//				    var gettitle = riderData.riderDetails[i].name;
//				    $('.rider-plan .form-list .item').eq(i).find('label').text(gettitle);
//				    $('.rider-plan .form-list .item').eq(i).find('label').append('<span class="amount">' + getAmount + '</span');
//				    console.log(riderData.riderDetails[i].features.length);
//				    for (j = 0; j < riderData.riderDetails[i].features.length; j++) {
//				        var getfeature1 = riderData.riderDetails[i].features[j];
//				        $('.rider-plan-list .motor-plan-card-wrap').eq(i).find('.plan-features ul').append('<li class="list-item">' + getfeature1 + '</li>');
//				        $('.rider-plan-list .motor-plan-card-wrap').eq(i).find('.card-title').text(gettitle);
//				    }
//				}
			}
			$(".buynow-check").css("display","block");
			
		}else{
			$("#renewal-card").css("display","none");
		var container = document.getElementById("planCardContainer");
		var containerPlanDetails = document
				.getElementById("planDetailsContainer");
		populateData.payload.premiumPlan
				.forEach(function(plan, index) {
					AppData.CurrentAPIPlanData[plan.variantCode] = plan;
					var rs = "&#8377;";
					/* quote card start */
					var quoteListTemplate = document.getElementById(
							"quoteListItemTemplate").cloneNode(true);
					quoteListTemplate = quoteListTemplate.content;
					if(populateData.payload.premiumPlan.length == 1){
						var quoteListItem = quoteListTemplate.querySelector(".quote-list-item");
						quoteListItem.classList.remove("aem-GridColumn--default--6");
						quoteListItem.classList.add("aem-GridColumn--default--12");
					}
					if (index == 0) {
						activePlan = plan.variantCode;
						quoteListTemplate.querySelector("[rel]").classList
								.add("active")
					}
					quoteListTemplate.querySelector("[rel]").setAttribute(
							"rel", "quote-" + index);

					quoteListTemplate.querySelector("[rel]").setAttribute(
							"onclick",
							"setActivePlanMotor('" + plan.variantCode + "')")
					quoteListTemplate.querySelector("#planName").innerHTML = plan.planName;
					quoteListTemplate.querySelector(".amount").innerHTML = rs
							+ plan.netPremium;
					quoteListTemplate.querySelector(".amount").id = "planDetailsPremiumAmt"
							+ plan.variantCode;
					if (plan.isRecommended) {
					} else {
						quoteListTemplate.querySelector(".icon-star").style.display = "none";
					}

					container.appendChild(document.importNode(
							quoteListTemplate, true));

					/* quote card end */
					if (plan.planCode == "4WCI") {
						/* quote details start */
						var templatePlanDetails = document.getElementById(
								"planDetailstemplate").cloneNode(true);
						templatePlanDetails = templatePlanDetails.content;

						templatePlanDetails.id = plan.variantCode;
						templatePlanDetails
								.querySelector("#planDetailsPremiumAmt").id = "planDetailsPremiumAmt"
								+ plan.variantCode;
						templatePlanDetails
								.querySelector("#planDetailsPremiumAmt"
										+ plan.variantCode).innerHTML = Rs
								+ plan.netPremium;
						templatePlanDetails.querySelector(
								"#quoteTargetPlanDetails").setAttribute("name",
								"quote-" + index);
						templatePlanDetails
								.querySelector("#quoteTargetPlanDetails").id = "quoteTargetPlanDetails"
								+ plan.variantCode;
						templatePlanDetails.querySelectorAll(".step-next")
								.forEach(
										function(val, index, self) {

											val.setAttribute(
													"data-variantCode",
													plan.variantCode);
											// val.setAttribute("onclick",
											// "callAjaxForMotorRefine('#planAmountStage1-"
											// + plan.variantCode + "')");
										})
						templatePlanDetails
								.querySelector("#planRecommendedAmount").innerHTML = Rs
								+ plan.idv;
						templatePlanDetails
								.querySelector("#planConsideredAmount").innerHTML = plan.idv;
						templatePlanDetails.querySelector("#planAmountStage1").value = plan.idv;

						templatePlanDetails.querySelector("#planAmountStage1")
								.setAttribute("data-min", plan.idvmin);
						templatePlanDetails.querySelector("#planAmountStage1")
								.setAttribute("data-max", plan.idvmax);

						templatePlanDetails.querySelector("#planAmountStage1").id = "#planAmountStage1-"
								+ plan.variantCode

						templatePlanDetails.querySelector("#buyNowBtn")
								.setAttribute("data-variantCode",
										plan.variantCode);
						// templatePlanDetails.querySelector("#buyNowBtn").setAttribute("onclick",
						// "callAjaxForMotorBuyNow()");

						containerPlanDetails.appendChild(document.importNode(
								templatePlanDetails, true));
						/* quote details end */
					} else if (plan.planCode == "4WTP") {
					//	$(".buynow-check")[1].css("display","block");
						var templatePlanDetails = document.getElementById(
								"thridPartyTemplate").cloneNode(true);
						templatePlanDetails = templatePlanDetails.content;
						templatePlanDetails.id = plan.variantCode;
						templatePlanDetails
								.querySelector("#planDetailsPremiumAmt").id = "planDetailsPremiumAmt"
								+ plan.variantCode;
						templatePlanDetails
								.querySelector("#planDetailsPremiumAmt"
										+ plan.variantCode).innerHTML = Rs
								+ plan.netPremium;
						templatePlanDetails.querySelector(
								"#quoteTargetPlanDetails").setAttribute("name",
								"quote-" + index);
						templatePlanDetails
								.querySelector("#quoteTargetPlanDetails").id = "quoteTargetPlanDetails"
								+ plan.variantCode;

						templatePlanDetails.querySelector("#buyNowBtn")
								.setAttribute("data-variantCode",
										plan.variantCode);
						// templatePlanDetails.querySelector("#buyNowBtn").setAttribute("onclick",
						// "callAjaxForMotorBuyNow()");

						containerPlanDetails.appendChild(document.importNode(
								templatePlanDetails, true));

					}
				})
		document.getElementsByName("quote-0")[0].classList.add("active");
		document.getElementsByName("quote-0")[0].style.display = "block";
		document.getElementsByClassName("buynow-check")[1].style.display ="block";

		init();
//		motor_inner_steps(false);
		}
	}
}

function setActivePlanMotor(variantCode) {
	window.activePlan = variantCode;
}


function callAjaxForMotorBuyNowRenew(event) {
	var payloadData = AppData.QuoteData[quoteCode].payload
	var variantCode = payloadData.premiumPlan[0].variantCode;
	var planData = AppData.CurrentAPIPlanData[variantCode]

	var formData = new FormData();
	formData.append("insProductType", payloadData.insProductType);
	formData.append("premiumPlanTransactionId", payloadData.premiumPlan[0].transactionId);
	formData.append("transactionId", planData.transactionId);

	if (payloadData.premiumPlan[0].riderDetails.length != 0) {
		formData.append("riderDetails", JSON.stringify(payloadData.premiumPlan[0].riderDetails));
	}else{
		formData.append("riderDetails", "undefined");
	} 
	
	formData.append("planCode", planData.planCode);
	formData.append("netPremium", planData.basicPremium);
	formData.append("variantCode", planData.variantCode);
	formData.append("gst", planData.gst);
	formData.append("grossPremium", planData.netPremium || "");
	formData.append("policyTerm", planData.policyDuration || "");
	formData.append("previousClaimSts", payloadData.previousClaimSts || "");
	//formData.append("lastRefineData", JSON.stringify(lastRefineData));

	
	
	formData.append("vehiclePolicyDetails", JSON.stringify({
		"idvMin" : planData.idvmin,
		"idvMax" : planData.idvmax,
		"idvBase" : planData.idv || "",
		"policyType" : payloadData.policyType,
		"previousNCB" : planData.previousNcb,
		"currentNCB" : planData.currentNcb
	}))
	formData.append("previousPolicyDetails", JSON.stringify({
		"policyExpiryDate" : payloadData.policyExpireDt,
		"policyExpired" : payloadData.previousPolicyDetails.policyExpired,
		"policyNumber" : payloadData.previousPolicyDetails.policyNumber,
		"insProviderCode" : payloadData.previousPolicyDetails.insProviderCode
	}))

	 formData.append("utmParams", JSON.stringify(window.utmParams));
    formData.append("channelType", JSON.stringify(window.channelType));
//	AppData.localStorage.setValue("mobileNumber", payloadData.mobileno || "")
	AppData.localStorage.setValue("firstName", payloadData.firstName || "")
	AppData.localStorage.setValue("lastName", payloadData.lastName || "")

	//formData.append("riderDetails", riderDetails);
	formData.append("proposerDetails",JSON.stringify(payloadData.proposerDetails));
	if(!payloadData.renewalFlag){
		formData.append("renewalFlag", "false");
	}else{
		formData.append("renewalFlag", payloadData.renewalFlag);
	}
	
	//formData.append("policyTerm", "1");
	formData.append("firstName", payloadData.firstName || "");
	formData.append("lastName", payloadData.lastName || "");
	formData.append("mobileNumber", AppData.localStorage.props.mobileNumber || "");
	


	formData
			.append(
					"vehicleDetails",
					JSON
							.stringify({
								"registrationNumber" : payloadData.vehicleDetails.registrationDetails.registrationNumber
										|| "",
								"mfgYear" : payloadData.vehicleDetails.registrationDetails.mfgYear,
								"vehicleCode" : payloadData.vehicleDetails.modelDetails.vehicleCode,
								"rtoCode" : payloadData.vehicleDetails.registrationDetails.rtoCode
										|| "",
								"registrationDate" : payloadData.vehicleDetails.registrationDetails.registrationDt,
								"engineNumber" : payloadData.vehicleDetails.registrationDetails.engineNo,
								"chasisNumber" : payloadData.vehicleDetails.registrationDetails.chassisNo
							}))

	var riderPlanVariantCode;
	var riderPlanAmount;
	var sendData = new URLSearchParams(formData).toString();
	/*if (planData.planCode == "4WTP") {
		var variantCode = planData.variantCode;
		triggerThirdPartyMotorBuyNow(
				AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,
				variantCode, planData.netPremium);
	} else {
		tiggerMotorComperhensiveBuyNow(
				AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.FWGI,
				planData.variantCode, planData.netPremium,
				riderPlanVariantCode, riderPlanAmount)
	}*/
	AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_BUY_NOW.name, sendData)
			.then(function(response) {
				if (response.responseURL) {
					if(response.authToken){
					window.sessionStorage.setItem("SS_1", response.authToken)
					window.sessionStorage.setItem("SS_4", response.guardKey)
					document.cookie = "SS_1=" + response.authToken 
					document.cookie = "SS_4=" + response.guardKey
					}
					location.href = response.responseURL;
				}
				popup_close()
				toggleLoader(false)

			})
}
console.log("motor");
var Rs = "&#8377;";
var activePlan = "";
var activeStep = 1;

function init() {
    // get_offer();
    tab_to_sticky();
    // checkExpiry();
    limitCheckbox();
    autoCompleteDd();
    accordian();
    side_menu();
    banner();
    testimonialSwiper();
    newsSwiper();
    quoteSwiper();
    emiCardSwiper();
    dealsSwiper();
    searchSwiper();
    fundRiderSlider();
    fundListSwiper();
    quoteDetails();
    offersSwiper();
    alsoConsideredSlider();

    customizeAllocation();
    riderList();
    fundList();
    newsReleaseBtn();
    set_bg();
    product_hover();
    wow_animate();
    put_header_in_side_menu();
    tab_sticky();

    make_active();
    top_menu_show();
    side_menu_active();
    material_input();
    //datepick();
    child_add();
    checkMultipleTabs();
    onclickOfTabDropdown();
    motor_editAmount();
    // equalizerHeight();
    planDropdown();
    // validation();

    motor_step();
    //motor_inner_steps();
    change_dom();
    append_default_years();
    otpFocus();
    editDetailsPopup();
    myOffersOpenClose();
    searchOpenClose();
    question_steps();
    menu_tabs();
    // warning,info,success
    // toastr.error('We do have the Kapua suite available.', '', {
    // timeOut: 5000,
    // "closeButton": true,
    // "preventDuplicates": true
    // });

    if ($("#column-chart").length) {
        $("li").click(function() {
            var isGraph = $(this).find(".icon-graph-view");
            if (isGraph) {
                columnChart();
            }
        });
    }
    $('#parentHorizontalTab').easyResponsiveTabs({
        type: 'default', // Types: default, vertical, accordion
        width: 'auto', // auto or any width like 600px
        fit: true, // 100% fit in a container
        tabidentify: 'hor_1', // The tab groups identifier
    });

    $('#parentHorizontalTabSec').easyResponsiveTabs({
        type: 'default', // Types: default, vertical, accordion
        width: 'auto', // auto or any width like 600px
        fit: true, // 100% fit in a container
        tabidentify: 'hor_2', // The tab groups identifier
    });
    // Child Tab
    $('#ChildVerticalTab_1').easyResponsiveTabs({
        type: 'vertical',
        width: 'auto',
        fit: true,
        tabidentify: 'ver_1', // The tab groups identifier
    });

    $('#ChildVerticalTab_2').easyResponsiveTabs({
        type: 'vertical',
        width: 'auto',
        fit: true,
        tabidentify: 'ver_2', // The tab groups identifier
    });

    $('#ChildVerticalTab_3').easyResponsiveTabs({
        type: 'vertical',
        width: 'auto',
        fit: true,
        tabidentify: 'ver_3', // The tab groups identifie
    });

    if ($('.lyt-protector-flow').length) {
        protectLoan();
    }

    slideEffectHorizontal();
    slideEffectVertical();

    bsLine();
    imageTile();
    scrollToActiveTab();
    popup();
    hide_show();
    swipeContent();
    readMoreCont();
    dropdown();
    select();
    hide_textbox();
    dropdown_hover();
    customResponsiveTable();
    contactForm();
    // themeSpace();
    searchResult();
    filterFaq();
    // filterOffers();
    playVideo();
    moving_dom_sticky();

    country_close();
    addClassToRemainder();
    tabOnly();
    tabOnlySlideEffect();
    // menuHover();
    addToCompare();
    float_btn_new();
    equalheight('.eqheight .eq-item');
    toggleFeatureList();
    otpSteps();
    if ($("#bonus-slider").length) {
        filter_slider('bonus-slider');
    }
    if ($("#bonus-slider2").length) {
        filter_slider('bonus-slider2');
    }
    if ($("#tile-slider").length) {
        tile_slider('tile-slider');
    }
    articleVerticalSlider();
}
window.addEventListener('load', function() {
    console.log('motor trigger');
    if (window.activePlan == "2WCI") {
        //		triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI);
    }
});

if (document.getElementById("twoWheelerregistartionNumberPreFillData")) {

    getQuoteData(quoteCode).then(function(data) {
        data = updateMotorTwoJsonObj(data);
        twowheelerupdateMotorPlanData(data);
        twowheelerloadMotorQuoteData(data);
        toggleLoader(false)

    })
    if (window.isMobile == "1") {
        document.getElementById('editButton').setAttribute('href', document.getElementById("editButton").getAttribute("href").substring(0, document.getElementById("editButton").getAttribute("href").length - 5) + ".is-mobile.html");
    }

}

function twowheelerupdateMotorPlanData(response) {
    AppData.QuoteData[quoteCode] = response;
    response.payload.premiumPlan.forEach(function(plan, index) {
        AppData.CurrentAPIPlanData[plan.variantCode] = plan;
    })
}

var lastRefineData;

function twowheelercallAjaxForMotorRefine(idv, event) {
    try {
        var dd = document.getElementById("expDt").value;
        //		dd = appendZero(dd,"expDt");
        var mm = document.getElementById("expMonth").value;
        //		dd = appendZero(mm,"expMonth");
        var yy = document.getElementById("expYear").value;
        var inputDate = yy + "-" + mm + "-" + dd;
        var edateText = document.getElementById("edate");
        if (inputDate == "--") { edateText.value = "YYYY-MM-DD"; } else { edateText.value = inputDate; }
        if (AppData.QuoteData[quoteCode].payload.insProductType == "TWGI") {
            return new Promise(
                function(resolve, reject) {
                    var parentElement = findSelectorParent(event.target,
                        ".bs-step")
                    previousClaimSts = $(event.target).attr("data-step");
                    console.log("previousClaimSts", previousClaimSts);
                    var planData = AppData.CurrentAPIPlanData[event.target
                        .getAttribute("data-variantcode")]
                    var payloadData = AppData.QuoteData[quoteCode].payload
                    var formData = new FormData();
                    var variantCode = event.target
                        .getAttribute("data-variantcode") ||
                        window.activePlan;
                    formData.append("is-mobile", window.isMobile);
                    if (payloadData.premiumPlan[0].planCode == "2WCI") {
                        formData.append("transactionId",
                            payloadData.premiumPlan[0].transactionId);

                    } else if (payloadData.premiumPlan.length == 2) {
                        formData.append("transactionId",
                            payloadData.premiumPlan[1].transactionId);
                    }
                    if (payloadData.premiumPlan.length == 2) {
                        formData.append("transactionIdTP",
                            payloadData.premiumPlan[1].transactionId);
                    }
                    var policyExpireDt = document.getElementById("edate").value;
                    if (policyExpireDt != "YYYY-MM-DD") {
                        triggerMotorIDVpolicyExpire(policyExpireDt);
                    } else {
                        console.log(policyExpireDt);
                    }
                    if (previousClaimSts == 1) {

                        triggerMotorRefineFirstNextCall(
                            Productname,
                            variantCode,
                            document.getElementById(idv).value,
                            payloadData.premiumPlan[0].idvmin)
                    }
                    formData.append("insProductType",
                        payloadData.insProductType);
                    formData.append("policyExpireDt", policyExpireDt);
                    formData.append("basicPremium",
                        payloadData.premiumPlan[0].basicPremium);
                    formData.append("netPremium",
                        payloadData.premiumPlan[0].netPremium);
                    formData.append("planCode",
                        payloadData.premiumPlan[0].planCode);
                    formData.append("planName",
                        payloadData.premiumPlan[0].planName);
                    formData.append("variantCode", variantCode);
                    formData.append("policyDuration",
                        payloadData.premiumPlan[0].policyDuration);
                    formData.append("allowedPolicyTerm",
                        payloadData.premiumPlan[0].allowedPolicyTerm);
                    formData.append("idv",
                        document.getElementById(idv).value);
                    formData.append("idvmin",
                        payloadData.premiumPlan[0].idvmin);
                    formData.append("idvmax",
                        payloadData.premiumPlan[0].idvmax);
                    formData.append("qid", quoteCode);
                    formData.append("is-mobile", window.isMobile);
                    if (previousClaimSts == 2) {
                        formData
                            .append(
                                "previousClaimSts",
                                ($(parentElement).find(
                                    "#existing-customer")[0].checked) ? "Y" :
                                "N");
                    } else if (previousClaimSts == 1) {
                        formData.append("previousClaimSts", previousClaimSts ? "N" : "Y");
                    }
                    formData.append("is-mobile", window.isMobile);

                    $('#existing-customer')
                        .on(
                            'change',
                            function() {
                                var date = new Date();
                                var currentYear = date
                                    .getFullYear();
                                var vechileyrs = payloadData.vehicleDetails.registrationDetails.mfgYear;
                                var yearsCalculate = currentYear -
                                    vechileyrs;

                                var claimStatusValue = new Array();
                                claimStatusValue = ["0", "20",
                                    "25", "35", "45", "50"
                                ];
                                var radioLabel = "";
                                var arrayLength = claimStatusValue.length;
                                if (arrayLength <= yearsCalculate) {
                                    for (var i = 0; i < arrayLength; i++) {

                                        radioLabel += '<li class="item aem-GridColumn aem-GridColumn--default--3 aem-GridColumn--tablet--6 aem-GridColumn--phone--12" id="claimStatusTemplate"><label class="control control--radio">' +
                                            claimStatusValue[i] +
                                            '%<input type="radio" class="checkbox" name="sumInsured" data-step="3" id="claimValue" value="' +
                                            claimStatusValue[i] +
                                            '"><div class="control__indicator"></div></label></li>';

                                    }
                                } else {
                                    for (var i = 0; i < yearsCalculate; i++) {

                                        radioLabel += '<li class="item aem-GridColumn aem-GridColumn--default--3 aem-GridColumn--tablet--6 aem-GridColumn--phone--12" id="claimStatusTemplate"><label class="control control--radio">' +
                                            claimStatusValue[i] +
                                            '%<input type="radio" class="checkbox" name="sumInsured" data-step="3" id="claimValue" value="' +
                                            claimStatusValue[i] +
                                            '"><div class="control__indicator"></div></label></li>';

                                    }
                                }

                                $(
                                        '.claimStatusContainer .claimStatusul')
                                    .html(radioLabel);
                                $("input[name='sumInsured']")
                                    .on(
                                        "change",
                                        function(event) {
                                            twowheelercallAjaxForMotorRefine(idv, event);

                                        })

                            })
                    if ($("input[name='sumInsured']:checked").val()) {
                        var radioValue = $(
                            "input[name='sumInsured']:checked").val();
                        triggerMotorClaimInsuranceBonus(radioValue);
                        console.log("Your are a - " + radioValue);
                    } else {
                        var radioValue = $(
                            "input[name='sumInsured']:checked").val();
                        console.log("Your are a - " + radioValue);
                    }
                    var theArray = [0, 20, 25, 35, 45, 50, 50];
                    var currentIndex = theArray
                        .indexOf(parseInt(radioValue));

                    function getAtIndex(i) {
                        if (i === 0) {
                            return theArray[currentIndex];
                        } else if (i > 0) {
                            return theArray[currentIndex + 1];
                        }
                    }

                    console.log(getAtIndex(currentIndex + 1));

                    formData.append("currentNcb",
                        getAtIndex(currentIndex + 1) || 20);
                    formData.append("previousNcb", radioValue || 0);
                    formData.append("previousPolicyNum",
                        payloadData.premiumPlan[0].policyDuration);
                    formData
                        .append(
                            "registrationDetails",
                            JSON
                            .stringify(payloadData.vehicleDetails.registrationDetails));
                    formData
                        .append(
                            "modelDetails",
                            JSON
                            .stringify(payloadData.vehicleDetails.modelDetails));
                    formData
                        .append(
                            "riderDetails",
                            JSON
                            .stringify(payloadData.premiumPlan[0].riderDetails));
                    if ($('#existing-customer').is(":checked") == false) {
                        formData.append("previousClaimSts", "N")
                    } else {
                        formData.append("previousClaimSts", "Y")
                    }
                    if (getAtIndex(currentIndex + 1) > 0) {
                        formData.append("previousClaimSts", "N")
                    } else {
                        formData.append("previousClaimSts", "Y")
                    }

                    var sendData = new URLSearchParams(formData).toString();
                    AppEvent
                        .trigger(
                            AppConstants.API_SELECTOR.MOTOR_GET_REFINED_PLANS.name,
                            sendData)
                        .then(
                            function(data) {
                                if (data.payload.insProductType == "TWGI") {
                                    var data = updateMotorTwoJsonObj(data);
                                    twowheelerupdateMotorPlanData(data);
                                    console.log(variantCode);
                                    var plan = data.payload.premiumPlan
                                        .find(function(planObj) {
                                            return planObj.variantCode == variantCode
                                        })
                                    if (previousClaimSts == 1) {
                                        document
                                            .querySelectorAll(
                                                "#planDetailsPremiumAmt" +
                                                variantCode)
                                            .forEach(
                                                function(
                                                    ele) {
                                                    $(ele)
                                                        .html(
                                                            Rs +
                                                            plan.netPremium);
                                                })
                                    } else if (previousClaimSts == 3) {

                                        document
                                            .querySelectorAll(
                                                "#planDetailsPremiumAmt" +
                                                variantCode)
                                            .forEach(
                                                function(
                                                    ele) {
                                                    $(ele)
                                                        .html(
                                                            Rs +
                                                            plan.netPremium);
                                                })

                                    } else if (previousClaimSts == 2) {
                                        document
                                            .querySelectorAll(
                                                "#planDetailsPremiumAmt" +
                                                variantCode)
                                            .forEach(
                                                function(
                                                    ele) {
                                                    $(ele)
                                                        .html(
                                                            Rs +
                                                            plan.netPremium);
                                                })
                                        if (plan.riderDetails.length != 0) {
                                            var riderString = "";
                                            var riderDeatilsString = "";
                                            plan.riderDetails
                                                .forEach(function(
                                                    riderPlanData,
                                                    index) {
                                                    riderString += '<div class="item bs-checkbox type3">' +
                                                        '<input type="checkbox" data-variantcode="' +
                                                        plan.variantCode +
                                                        '" name="motor-plan" id="plan-' +
                                                        (index + 1) +
                                                        '" ' +
                                                        ((riderPlanData.selected) ? "checked" :
                                                            "") +
                                                        ' value="' +
                                                        riderPlanData.amount +
                                                        '" data-premium="' +
                                                        plan.netPremium +
                                                        '" data-json=\'' +
                                                        JSON
                                                        .stringify(riderPlanData) +
                                                        '\' data-transactionId="' +
                                                        riderPlanData.transactionId +
                                                        '">' +
                                                        '<label for="plan-' +
                                                        (index + 1) +
                                                        '">' +
                                                        riderPlanData.name +
                                                        '<span class="amount" id="amount1">₹' +
                                                        riderPlanData.amount +
                                                        '</span>' +
                                                        '</label>' +
                                                        '</div>';
                                                    riderDeatilsString += '<div class="motor-plan-card-wrap ' +
                                                        "" +
                                                        '" name="plan-' +
                                                        (index + 1) +
                                                        '" >' +
                                                        ((riderPlanData.selected) ? '<span class="icon icon-star"></span>' :
                                                            '') +
                                                        '<h3 class="card-title" id="cardTitle">' +
                                                        riderPlanData.name +
                                                        '</h3>' +
                                                        '<div class="plan-card">' +
                                                        '<div class="card-head">' +
                                                        '<span class="icon icon-star"></span>' +
                                                        '<div class="title">Covers Included</div>' +
                                                        '</div>' +
                                                        '<div class="card-body">' +
                                                        '<div class="plan-features">' +
                                                        '<div class="bs-list typ-horizontal typ-small">' +
                                                        '<ul>';
                                                    riderPlanData.features
                                                        .forEach(function(
                                                            feature) {
                                                            riderDeatilsString += '<li class="list-item">' +
                                                                feature +
                                                                '</li>'
                                                        })
                                                    riderDeatilsString += '</ul>' +
                                                        '</div>' +
                                                        '</div>';
                                                    riderDeatilsString += '</div>' +
                                                        '</div>' +
                                                        '</div>' +
                                                        '</div>';
                                                    window.activePlanInRider = (activePlanInRider == "" && riderPlanData.selected) ? (index + 1) :
                                                        "";
                                                    lastRefineData = riderPlanData;
                                                })


                                            riderDeatilsString += '<div class="motor-plan-card-wrap no-plan-selected" style="display: none;">' +
                                                '<h3 class="card-title">' +
                                                '<span class="icon icon-warning"></span>' +
                                                'No plan selected</h3>' +
                                                '</div>';
                                            $(parentElement)
                                                .find(
                                                    ".rider-plan .form-list")
                                                .html("");
                                            $(parentElement).find(
                                                    ".rider-plan-list")
                                                .html("")
                                            $(parentElement)
                                                .find(
                                                    ".rider-plan .form-list")
                                                .append(riderString);
                                            limitCheckbox();
                                            $(
                                                    ".rider-plan input:checkbox")
                                                .click(
                                                    function() {
                                                        var value = (parseInt($(
                                                                this)
                                                            .attr(
                                                                "data-premium")));
                                                        var element = this;
                                                        var html = "";
                                                        if (element.checked) {
                                                            html = (Rs + (value + parseInt($(
                                                                    this)
                                                                .val())));

                                                        } else {
                                                            html = (Rs + (value));

                                                        }
                                                        document
                                                            .querySelectorAll(
                                                                "#planDetailsPremiumAmt" +
                                                                $(
                                                                    this)
                                                                .attr(
                                                                    "data-variantcode"))
                                                            .forEach(
                                                                function(
                                                                    ele) {
                                                                    $(
                                                                            ele)
                                                                        .html(
                                                                            html);
                                                                })
                                                    })

                                            $(parentElement)
                                                .find(
                                                    ".rider-plan-list")
                                                .append(
                                                    riderDeatilsString);
                                        } else {
                                            $(".rider").css('display', 'none');
                                            $(".rider-list").css('display', 'none');
                                            $(".no-rider").css('display', 'block');

                                        }

                                    }
                                    resolve(true)
                                }
                                toggleLoader(false);

                            })
                })
        }
    } catch (e) {
        console.error(e);
    }
}
/*
 * getformData(motor-buy-now, function(data){
 * 
 * },{ "insProductType": data["insProductType"], "transactionId":
 * data["transactionId"]
 * 
 * });
 */

function updateMotorTwoJsonObj(jsonData) {
    var tempObj = jsonData;
    jsonData.payload.premiumPlan.forEach(function(data, index, self) {
        var amountObj = data.riderDetails.find(function(riderData) {
                return riderData.riderCode == "TWCI_ADDON_PRIME"
            })
            // data.netPremium=parseInt(data.netPremium)+parseInt((amountObj)?amountObj.amount
            // : "0")
        data.riderDetails = data.riderDetails.filter(function(riderData) {
            return riderData.riderCode != "TWCI_ADDON_PRIME"
        })
    })
    return jsonData;

}

function twowheelercallAjaxForMotorBuyNow() {
    var variantCode = event.target.getAttribute("data-variantcode") ||
        window.activePlan;
    var planData = AppData.CurrentAPIPlanData[variantCode]
    var payloadData = AppData.QuoteData[quoteCode].payload
    var riderDetailsEle = document.getElementById(
        "quoteTargetPlanDetails" + variantCode).querySelectorAll(
        ".bs-checkbox.type3 input");
    var riderDetails;
    var selectedRiderPlan = riderDetailsEle.forEach(function(checkboxEle) {
        if (checkboxEle.checked) {
            riderDetails = JSON.parse(checkboxEle.getAttribute("data-json"))
        }
    })

    console.log("rider Details" + riderDetails);

    var formData = new FormData();
    formData.append("insProductType", payloadData.insProductType);

    if (planData.planCode == "2WTP") {
        formData.append("transactionId", planData.transactionId);
    } else {
        if (riderDetails) {
            formData.append("transactionId", riderDetails.transactionId);
        } else {
            formData.append("transactionId", planData.transactionId);
        }
    }
    formData.append("transactionId", planData.transactionId);

    if (riderDetails != null) {
        formData.append("riderDetails", JSON.stringify(riderDetails));
    } else {
        formData.append("riderDetails", "undefined");
    }
    // formData.append("transactionId", payloadData.transactionId);
    formData.append("planCode", planData.planCode);
    formData.append("netPremium", planData.basicPremium);
    formData.append("variantCode", planData.variantCode);
    formData.append("gst", planData.gst);
    formData.append("grossPremium", planData.netPremium || "");
    formData.append("policyTerm", planData.policyDuration || "");
    formData.append("previousClaimSts", payloadData.previousClaimSts || "");
    formData.append("lastRefineData", JSON.stringify(lastRefineData));
    formData.append("renewalFlag", false);

    formData.append("vehiclePolicyDetails", JSON.stringify({
        "idvMin": planData.idvmin,
        "idvMax": planData.idvmax,
        "idvBase": planData.idv || "",
        "policyType": payloadData.policyType,
        "previousNCB": planData.previousNcb
    }))

    formData.append("previousPolicyDetails", JSON.stringify({
        "policyExpiryDate": payloadData.policyExpireDt,
        "policyExpired": "false",
        "policyNumber": "",
        "insProviderCode": ""
    }))
    formData.append("utmParams", JSON.stringify(window.utmParams));
    formData.append("channelType", JSON.stringify(window.channelType));
    //	AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
    AppData.localStorage.setValue("firstName", firstName || "")
    AppData.localStorage.setValue("lastName", lastName || "")

    //formData.append("riderDetails", riderDetails);
    formData.append("firstName", payloadData.firstName || "");
    formData.append("lastName", payloadData.lastName || "");
    formData.append("mobileNumber", AppData.localStorage.props.mobileNumber || "");

    formData.append("is-mobile", window.isMobile);

    formData
        .append(
            "vehicleDetails",
            JSON
            .stringify({
                "registrationNumber": payloadData.vehicleDetails.registrationDetails.registrationNumber ||
                    "",
                "mfgYear": payloadData.vehicleDetails.registrationDetails.mfgYear,
                "vehicleCode": payloadData.vehicleDetails.modelDetails.vehicleCode,
                "rtoCode": payloadData.vehicleDetails.registrationDetails.rtoCode ||
                    "",
                "registrationDate": payloadData.vehicleDetails.registrationDetails.registrationDt
            }))

    formData.append("isMobile", window.isMobile);
    var riderPlanVariantCode;
    var riderPlanAmount;
    var sendData = new URLSearchParams(formData).toString();
    if (planData.planCode == "2WTP") {
        var variantCode = planData.variantCode;
        triggerThirdPartyMotorTwoWheelerBuyNow(
            Productname,
            variantCode, planData.netPremium);
    } else {
        tiggerTwoWheelerMotorComperhensiveBuyNow(
            Productname,
            planData.variantCode, planData.netPremium,
            riderPlanVariantCode, riderPlanAmount)
    }
    AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_BUY_NOW.name, sendData)
        .then(function(response) {
            if (response.responseURL) {
                window.sessionStorage.setItem("SS_1", response.authToken)
                window.sessionStorage.setItem("SS_4", response.guardKey)
                document.cookie = "SS_1=" + response.authToken
                document.cookie = "SS_4=" + response.guardKey
                location.href = response.responseURL;
            } else {
                toggleLoader(false)
            }
            popup_close()

        })

}

function twowheelerloadMotorQuoteData(responseData) {


    if (responseData.payload.insProductType == "TWGI") {
        var populateData = responseData;


        document.getElementById("cityPreFillData").innerHTML = populateData.payload.vehicleDetails.registrationDetails.location;
        document.getElementById("registartionDatePreFillData").innerHTML = populateData.payload.vehicleDetails.registrationDetails.registrationDt;
        document.getElementById("vehicleDetailsPreFillData").innerHTML = populateData.payload.vehicleDetails.modelDetails.make +
            " " +
            populateData.payload.vehicleDetails.modelDetails.variant +
            ", " +
            populateData.payload.vehicleDetails.modelDetails.fuelType +
            ", " +
            populateData.payload.vehicleDetails.modelDetails.cc +
            "cc, " +
            populateData.payload.vehicleDetails.modelDetails.model;
        if (populateData.payload.vehicleDetails.registrationDetails.registrationNumber == null ||
            "") {
            document.getElementById("registrationnumbercontainer").style.display = "none";
        } else {
            document.getElementById("registrationnumbercontainer");
            document.getElementById("twoWheelerregistartionNumberPreFillData").innerHTML = populateData.payload.vehicleDetails.registrationDetails.registrationNumber;
        }

        document.getElementById("totalPlans").innerHTML = populateData.payload.premiumPlan.length;


        if (populateData.payload.renewalFlag == true) {
            $("#non-renewal-card").css("display", "none");
            $("#renewal-card #planName").text(populateData.payload.premiumPlan[0].planName);
            $("#planDetailsPremiumAmtRenew").text(populateData.payload.premiumPlan[0].netPremium.toLocaleString());
            $("#planRecommendedAmount").text(populateData.payload.premiumPlan[0].idv.toLocaleString());
            $("#planConsideredAmount").text(populateData.payload.premiumPlan[0].currentNcb + " %");
            //$(".subtitle").text(populateData.payload.premiumPlan[0].planName);
            $("#planDetailsPremiumAmt4WCI").text(populateData.payload.premiumPlan[0].netPremium.toLocaleString());
            $(".buynow-check").css("display", "block");
            if (populateData.payload.riderDescription) {
                $("#riderPlan").css("display", "block");
                var riderDescription = populateData.payload.riderDescription;
                if (riderDescription.indexOf("~") == -1) {
                    $('.rider-plan .form-list label').text(riderDescription);
                } else {
                    riderDescription = riderDescription.split("~");
                    $('.rider-plan .form-list label').text(riderDescription[1]);
                }

                //			var riderData = populateData.payload.premiumPlan[0].riderDetails;
                //				if(riderData.length != 0){
                //					$("#plan-button").css("display" , "block");
                //					$('renewal-card .rider-plan-list .motor-plan-card-wrap').find('.plan-features ul').html('');
                //					for (i = 0; i < 2; i++) {
                //					    var getAmount = riderData.riderDetails[i].amount;
                //					    var gettitle = riderData.riderDetails[i].name;
                //					    $('.rider-plan .form-list .item').eq(i).find('label').text(gettitle);
                //					    $('.rider-plan .form-list .item').eq(i).find('label').append('<span class="amount">' + getAmount + '</span');
                //					    console.log(riderData.riderDetails[i].features.length);
                //					    for (j = 0; j < riderData.riderDetails[i].features.length; j++) {
                //					        var getfeature1 = riderData.riderDetails[i].features[j];
                //					        $('.rider-plan-list .motor-plan-card-wrap').eq(i).find('.plan-features ul').append('<li class="list-item">' + getfeature1 + '</li>');
                //					        $('.rider-plan-list .motor-plan-card-wrap').eq(i).find('.card-title').text(gettitle);
                //					    }
                //					}
            }
            $(".buynow-check").css("display", "block");
        } else {
            $("#renewal-card").css("display", "none");
            var container = document.getElementById("planCardContainer");
            var containerPlanDetails = document
                .getElementById("planDetailsContainer");
            populateData.payload.premiumPlan
                .forEach(function(plan, index) {

                    AppData.CurrentAPIPlanData[plan.variantCode] = plan;
                    var rs = "&#8377;";
                    /* quote card start */
                    var quoteListTemplate = document.getElementById(
                        "quoteListItemTemplate").cloneNode(true);
                    quoteListTemplate = quoteListTemplate.content;
                    if (populateData.payload.premiumPlan.length == 1) {
                        var quoteListItem = quoteListTemplate.querySelector(".quote-list-item");
                        quoteListItem.classList.remove("aem-GridColumn--default--6");
                        quoteListItem.classList.add("aem-GridColumn--default--12");
                    }
                    if (index == 0) {
                        activePlan = plan.variantCode;
                        quoteListTemplate.querySelector("[rel]").classList
                            .add("active")
                    }
                    quoteListTemplate.querySelector("[rel]").setAttribute(
                        "rel", "quote-" + index);

                    quoteListTemplate.querySelector("[rel]").setAttribute(
                        "onclick",
                        "setActivePlanMotor('" + plan.variantCode + "')")
                    quoteListTemplate.querySelector("#planName").innerHTML = plan.planName;
                    quoteListTemplate.querySelector(".amount").innerHTML = rs +
                        plan.netPremium;
                    quoteListTemplate.querySelector(".amount").id = "planDetailsPremiumAmt" +
                        plan.variantCode;
                    if (plan.isRecommended) {} else {
                        quoteListTemplate.querySelector(".icon-star").style.display = "none";
                    }

                    container.appendChild(document.importNode(
                        quoteListTemplate, true));

                    /* quote card end */
                    if (plan.planCode == "2WCI") {
                        /* quote details start */
                        var templatePlanDetails = document.getElementById(
                            "planDetailstemplate").cloneNode(true);
                        templatePlanDetails = templatePlanDetails.content;

                        templatePlanDetails.id = plan.variantCode;
                        templatePlanDetails
                            .querySelector("#planDetailsPremiumAmt").id = "planDetailsPremiumAmt" +
                            plan.variantCode;
                        templatePlanDetails
                            .querySelector("#planDetailsPremiumAmt" +
                                plan.variantCode).innerHTML = Rs +
                            plan.netPremium;
                        templatePlanDetails.querySelector(
                            "#quoteTargetPlanDetails").setAttribute("name",
                            "quote-" + index);
                        templatePlanDetails.querySelector(
                            "#quoteTargetPlanDetails").setAttribute("id",
                            "quoteTargetPlanDetails" + plan.variantCode);
                        templatePlanDetails.querySelectorAll(".step-next")
                            .forEach(
                                function(val, index, self) {

                                    val.setAttribute(
                                        "data-variantCode",
                                        plan.variantCode);
                                    // val.setAttribute("onclick",
                                    // "callAjaxForMotorRefine('#planAmountStage1-"
                                    // + plan.variantCode + "')");
                                })
                        templatePlanDetails
                            .querySelector("#planRecommendedAmount").innerHTML = Rs +
                            plan.idv;
                        templatePlanDetails
                            .querySelector("#planConsideredAmount").innerHTML = plan.idv;
                        templatePlanDetails.querySelector("#planAmountStage1").value = plan.idv;

                        templatePlanDetails.querySelector("#planAmountStage1")
                            .setAttribute("data-min", plan.idvmin);
                        templatePlanDetails.querySelector("#planAmountStage1")
                            .setAttribute("data-max", plan.idvmax);

                        templatePlanDetails.querySelector("#planAmountStage1").id = "#planAmountStage1-" +
                            plan.variantCode

                        templatePlanDetails.querySelector("#buyNowBtn")
                            .setAttribute("data-variantCode",
                                plan.variantCode);
                        // templatePlanDetails.querySelector("#buyNowBtn").setAttribute("onclick",
                        // "callAjaxForMotorBuyNow()");

                        containerPlanDetails.appendChild(document.importNode(
                            templatePlanDetails, true));
                        /* quote details end */
                    } else if (plan.planCode == "2WTP") {

                        var templatePlanDetails = document.getElementById(
                            "thridPartyTemplate").cloneNode(true);
                        templatePlanDetails = templatePlanDetails.content;
                        templatePlanDetails.id = plan.variantCode;
                        templatePlanDetails
                            .querySelector("#planDetailsPremiumAmt").id = "planDetailsPremiumAmt" +
                            plan.variantCode;
                        templatePlanDetails
                            .querySelector("#planDetailsPremiumAmt" +
                                plan.variantCode).innerHTML = Rs +
                            plan.netPremium;
                        templatePlanDetails.querySelector(
                            "#quoteTargetPlanDetails").setAttribute("name",
                            "quote-" + index);
                        templatePlanDetails.querySelector(
                            "#quoteTargetPlanDetails").setAttribute("id",
                            "quoteTargetPlanDetails" + plan.variantCode);

                        templatePlanDetails.querySelector("#buyNowBtn")
                            .setAttribute("data-variantCode",
                                plan.variantCode);
                        // templatePlanDetails.querySelector("#buyNowBtn").setAttribute("onclick",
                        // "callAjaxForMotorBuyNow()");

                        containerPlanDetails.appendChild(document.importNode(
                            templatePlanDetails, true));

                    }
                })
            document.getElementsByName("quote-0")[0].classList.add("active");
            document.getElementsByName("quote-0")[0].style.display = "block";
            document.getElementsByClassName("buynow-check")[1].style.display = "block";

            init();
            //motor_inner_steps(false);
        }

    }
}

function setActivePlanMotor(variantCode) {
    window.activePlan = variantCode;
}


function twowheelercallAjaxForMotorBuyNowRenewal(event) {
    var payloadData = AppData.QuoteData[quoteCode].payload

    var variantCode = payloadData.premiumPlan[0].variantCode;
    var planData = AppData.CurrentAPIPlanData[variantCode]
    var formData = new FormData();
    formData.append("insProductType", payloadData.insProductType);
    formData.append("premiumPlanTransactionId", payloadData.premiumPlan[0].transactionId);
    formData.append("transactionId", planData.transactionId);

    if (payloadData.premiumPlan[0].riderDetails.length != 0) {
        formData.append("riderDetails", JSON.stringify(payloadData.premiumPlan[0].riderDetails));
    } else {
        formData.append("riderDetails", "undefined");
    }
    // formData.append("transactionId", payloadData.transactionId);
    formData.append("planCode", planData.planCode);
    formData.append("netPremium", planData.basicPremium);
    formData.append("variantCode", planData.variantCode);
    formData.append("gst", planData.gst);
    formData.append("grossPremium", planData.netPremium || "");
    formData.append("policyTerm", planData.policyDuration || "");
    formData.append("previousClaimSts", payloadData.previousClaimSts || "");

    formData.append("vehiclePolicyDetails", JSON.stringify({
        "idvMin": planData.idvmin,
        "idvMax": planData.idvmax,
        "idvBase": planData.idv || "",
        "policyType": payloadData.policyType,
        "previousNCB": planData.previousNcb
    }))

    formData.append("previousPolicyDetails", JSON.stringify({
        "policyExpiryDate": payloadData.policyExpireDt,
        "policyExpired": payloadData.previousPolicyDetails.policyExpired,
        "policyNumber": payloadData.previousPolicyDetails.policyNumber,
        "insProviderCode": payloadData.previousPolicyDetails.insProviderCode
    }))

    formData.append("utmParams", JSON.stringify(window.utmParams));
    formData.append("channelType", JSON.stringify(window.channelType));
    //	AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
    AppData.localStorage.setValue("firstName", firstName || "")
    AppData.localStorage.setValue("lastName", lastName || "")

    //	formData.append("riderDetails", payloadData.premiumPlan[0].riderDetails || "undefined");
    formData.append("proposerDetails", JSON.stringify(payloadData.proposerDetails));
    if (!payloadData.renewalFlag) {
        formData.append("renewalFlag", "false");
    } else {
        formData.append("renewalFlag", payloadData.renewalFlag);
    }
    //formData.append("policyTerm", "1");
    formData.append("firstName", payloadData.firstName || "");
    formData.append("lastName", payloadData.lastName || "");
    formData.append("mobileNumber", AppData.localStorage.props.mobileNumber || "");

    formData.append("is-mobile", window.isMobile);

    formData
        .append(
            "vehicleDetails",
            JSON
            .stringify({
                "registrationNumber": payloadData.vehicleDetails.registrationDetails.registrationNumber ||
                    "",
                "mfgYear": payloadData.vehicleDetails.registrationDetails.mfgYear,
                "vehicleCode": payloadData.vehicleDetails.modelDetails.vehicleCode,
                "rtoCode": payloadData.vehicleDetails.registrationDetails.rtoCode ||
                    "",
                "registrationDate": payloadData.vehicleDetails.registrationDetails.registrationDt,
                "engineNumber": payloadData.vehicleDetails.registrationDetails.engineNo,
                "chasisNumber": payloadData.vehicleDetails.registrationDetails.chassisNo
            }))

    formData.append("isMobile", window.isMobile);
    var riderPlanVariantCode;
    var riderPlanAmount;
    var sendData = new URLSearchParams(formData).toString();
    //	if (planData.planCode == "2WTP") {
    //		var variantCode = planData.variantCode;
    //		triggerThirdPartyMotorTwoWheelerBuyNow(
    //				AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI,
    //				variantCode, planData.netPremium);
    //	} else {
    //		tiggerTwoWheelerMotorComperhensiveBuyNow(
    //				AppConstants.ANALYTICS_DATA.PRODUCT_NAME.MOTOR.TWGI,
    //				planData.variantCode, planData.netPremium,
    //				riderPlanVariantCode, riderPlanAmount)
    //	}
    AppEvent.trigger(AppConstants.API_SELECTOR.MOTOR_BUY_NOW.name, sendData)
        .then(function(response) {
            if (response.responseURL) {
                window.sessionStorage.setItem("SS_1", response.authToken)
                window.sessionStorage.setItem("SS_4", response.guardKey)
                document.cookie = "SS_1=" + response.authToken
                document.cookie = "SS_4=" + response.guardKey
                location.href = response.responseURL;
            } else {
                toggleLoader(false)
            }
            popup_close()

        })

}
var ulipGetQuoteSendData = {};
document.addEventListener("DOMContentLoaded", function (event) {

    if (document.getElementById('get-a-quote-ulip')) {
        if (document.getElementById('letstartform'))
            var investmentForValue = document.getElementById('letstartform').getAttribute('name');
        triggerSetProduct(window.productName);
    }
});

if (document.getElementById("letstartform") || document.getElementById("ulipchild") || document.getElementById("ulipretirement") || document.getElementById("ulipinvestment")) {

    var TIME_SPAN_MAP = new Map();
    TIME_SPAN_MAP.set("yearly", 1);
    TIME_SPAN_MAP.set("monthly", 12);
    TIME_SPAN_MAP.set("half-yearly", 2);
    TIME_SPAN_MAP.set("quarterly", 4);


    var quoteBtn = document.getElementsByClassName("get-quote-btn")[0];
    if (quoteBtn) {
        quoteBtn.addEventListener("click", ulipGetAQuoteHandler)

    }

    if (document.getElementById('isCampaign')) {
        var quoteBtns = document.getElementsByClassName("get-quote-btn");
        quoteBtns.forEach(function (btn) {
            btn.addEventListener("click", ulipGetAQuoteHandler)
        })
    }
}

function ulipGetAQuoteHandler(event) {
    var path;
    if (window.isMobile == "1") {
        path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0] + "." + window.location.pathname.split(".")[1];
    } else {
        path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0];
    }


    event.preventDefault();

    var parentContainer;
    if (document.getElementById("ulipchild")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("ulipchild form : ulipchild");
    } else if (document.getElementById("ulipretirement")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("ulipretirement form : ulipretirement");
    } else if (document.getElementById("ulipinvestment")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("ulipinvestment form : ulipinvestment");
    } else {
        parentContainer = findSelectorParent(event.target, "FORM");
    }

    var parentContainer = findSelectorParent(event.target, "FORM");
    var hasFirstName = ($(parentContainer).find("#firstName").length == 1);
    var hasLastName = ($(parentContainer).find("#lastName").length == 1);
    var hasMobileNumber = ($(parentContainer).find("#mobileNumber").length == 1);
    var hasEmail = ($(parentContainer).find("#email").length == 1);
    if (document.getElementById('tab-tiles-ulip')) {
        var riskScore = document.getElementById('scoreId').innerText;
    }
    var amountToInvest = $(parentContainer).find("#invest_amount").val();
    var proposerAge = $(parentContainer).find("#age").val();
    var lifeAssuredAge = $(parentContainer).find("#assured_age").val();
    var gender = $(parentContainer).find("#gender").val();
    var frequencyCode = $(parentContainer).find("#frequencyCode").val();
    var investmentForValue = $(parentContainer).attr('name');
    //				    var investmentForValue = document.getElementById('get-a-quote-ulip').getAttribute('name');
    var status = true;
    var mobileNumber, email, firstName, lastName;
    if (hasFirstName) {
        firstName = $(parentContainer).find("#firstName").val()
    }
    if (hasLastName) {
        lastName = $(parentContainer).find("#lastName").val()
    }
    if (hasMobileNumber) {
        mobileNumber = $(parentContainer).find("#mobileNumber").val();

    } else {
        mobileNumber = localStorage.getItem("mobileNumber") || "";
    }
    if (hasEmail) {
        email = $(parentContainer).find("#email").val()
    }

    if (/^[6-9][0-9]{9}$/.test(amountToInvest)) {

        showError("mobileNumberErrorMsg", "Enter Valid Mobile Number", false);

    } else {
        showError("mobileNumberErrorMsg", "Enter Valid Mobile Number", true);

    }

    /*Amount Error Msg*/
    var statusInvestmentAmount = true;
    if (!amountToInvest) {

        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Enter Investment Amount", true);
        statusInvestmentAmount = false
    } else if (/^[0-9]{6}$/g.test(amountToInvest)) {
        //					            data.append("amountToInvest", amountToInvest);
        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Invalid Pin Code", false);
    } else {
        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Invalid Pin Code", false);
        statusInvestmentAmount = false;
    }

    /*Proposer Age Validation*/
    if (/^(1[89]|[2-9][0-9])$/.test(proposerAge)) {

        showError("ageErrorMsg", "Please Enter a Age between 18 to 99. ", false);
        status = true;

    } else {
        showError("ageErrorMsg", "Please Enter a Age between 18 to 99. ", true);
        status = false;

    }

    /*life Assured Age*/
    if (jsonresponse && jsonresponse.payload) {
        investmentForValue = jsonresponse.payload.investmentFor;
    }

    if (investmentForValue == 3) {
        if (/^(?:[0]|0[0-9]|1[0-7]?)$/.test(lifeAssuredAge)) {

            showError("assured_ageErrorMsg", "Please Enter a Age between 0 to 17. ", false);
            status = true;

        } else {
            showError("assured_ageErrorMsg", "Please Enter a Age between 0 to 17. ", true);
            status = false;

        }

    } else {
        if (/^([1][8-9]|[2-5][0-9]|[6][0-5])$/.test(lifeAssuredAge)) {

            showError("assured_ageErrorMsg", "Please Enter a Age between 18 to 65. ", false);
            status = true;

        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "assured_ageErrorMsg"), "Please Enter a Age between 18 to 65.", true);
            status = false;

        }
    }



    if (hasMobileNumber) {
        if (mobileNumber) {
            if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Insert Valid Mobile Number.", true);
                if (status) {
                    status = false;
                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Please enter mobile number.", false);

            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Please enter mobile number.", true);
            if (status) {
                status = false;
            }
        }
    }
    if (hasFirstName) {
        if (firstName) {

            if (!(/^[a-zA-Z]+$/.test(firstName))) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Insert Valid First Name.", true);
                if (status) {
                    status = false;
                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Please enter first name.", false);

            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Please enter first name.", true);
            if (status) {
                status = false;
            }
        }
    }
    if (hasLastName) {
        if (lastName) {

            if (!(/^[a-zA-Z]+$/.test(lastName))) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Insert Valid Last Name.", true);
                if (status) {
                    status = false;
                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Please enter last name.", false);

            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Please enter last name.", true);
            if (status) {
                status = false;
            }
        }
    }
    if (hasEmail) {
        if (email) {

            if (!(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email))) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Insert Valid Email Id.", true);
                if (status) {
                    status = false;
                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Please enter email id.", false);

            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Please enter email id.", true);
            if (status) {
                status = false;
            }
        }
    }
    if (gender) {

    } else {
        return
    }


    switch (frequencyCode.toLowerCase()) {
        case "yearly":
            if (amountToInvest < 25000) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Investment Amount should be more than 25000", true);
                return
            }
            break;

        case "half-yearly":
            if (amountToInvest < 12500) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Investment Amount should be more than 12500", true);
                return
            }
            break;

        case "quarterly":
            if (amountToInvest < 6250) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Investment Amount should be more than 6250", true);
                return
            }
            break;

        case "monthly":
            if (amountToInvest < 2500) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "invest_amountErrorMsg"), "Investment Amount should be more than 2500", true);
                return
            }
            break;
    }
    if (!status) {
        return
    }
    var formData = new FormData();
    if (jsonresponse && jsonresponse.payload) {
        mobileNumber = jsonresponse.payload.mobileNumber || "";
        email = jsonresponse.payload.email || "";
        lastName = jsonresponse.payload.lastName || "";
        firstName = jsonresponse.payload.firstName || "";
        investmentForValue = jsonresponse.payload.investmentFor;
    }
    AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
    AppData.localStorage.setValue("firstName", firstName || "")
    AppData.localStorage.setValue("lastName", lastName || "")
    AppData.localStorage.setValue("email", email || "")
    localStorage.setItem("mobileNumber", mobileNumber || "");
    ulipGetQuoteSendData = {
        "lifeAssured": {
            "age": lifeAssuredAge,
            "gender": gender,
            "riskScore": ""
        },
        "plan": {
            "frequencyCode": TIME_SPAN_MAP.get(frequencyCode),
            "policyTerm": null,
            "premiumPayingTerm": null,
            "sumAssured": null,
            "returnOnMaturity": null,
            "multiplier": null,
            "code": null,
            "variantCode": null,
            "portfolioStrategyCode": null,
            "selected": null,
            "possibleValues": {
                "premiumPayingFrequency": [{
                    "value": null,
                    "code": null,
                    "minPremium": null,
                    "maxPremium": null
                }],
                "riderSumAssured": [{
                    "code": null,
                    "min": null,
                    "max": null
                }],
                "policyTerms": [{
                    "value": null,
                    "premiumPayingTerms": [{
                        "value": null
                    }]
                }],
                "policySumAssured": {
                    "min": null,
                    "max": null
                }
            },
            "funds": null,
            "riders": [{
                "code": null,
                "selected": null,
                "sumAssured": null,
                "policyTerm": null,
                "premiumPayingTerm": null,
                "applicability": null
            }]
        },
        "planSpecificOutPutRequired": "N",
        "investmentGoal": "1",
        "proposer": {
            "age": ""
        },
        "isLAPHsame": "",
        "premium": amountToInvest,
        "applicationId": null,
        "investmentFor": investmentForValue
    };
    if (investmentForValue === "3") {
        ulipGetQuoteSendData.proposer.age = proposerAge;
        ulipGetQuoteSendData.isLAPHsame = "N"
    } else {
        ulipGetQuoteSendData.proposer.age = lifeAssuredAge;
        ulipGetQuoteSendData.isLAPHsame = "Y"
    }

    if (riskScore) {
        ulipGetQuoteSendData.lifeAssured.riskScore = riskScore
    }
    
    var clickToCallProposerAge;
    if (investmentForValue === "3") {
    	clickToCallProposerAge = proposerAge;
    } else {
    	clickToCallProposerAge = lifeAssuredAge;
    }
    

    
    var clickToCallProposerAge;
    if (investmentForValue === "3") {
    	clickToCallProposerAge = proposerAge;
    } else {
    	clickToCallProposerAge = lifeAssuredAge;
    }
    
    var sendData = {
        "userAction": "callme",
        "channelType": window.channelType.channelType,
        "investmentFor": investmentForValue,
        "investmentGoal": null,
        "riskScore": null,
        "investmentAmount": amountToInvest,
        "selectedPlanDetails": {
            "planCode": null,
            "variantCode": null,
            "sumAssured": null,
            "frequencyCode": TIME_SPAN_MAP.get(frequencyCode),
            "premiumPayingTerm": null,
            "policyTerm": null,
            "portfolioStrategyCode": "IS",
            "funds": null,
            "riders": null
        },
        "utmParams": window.utmParams,
        "proposerDetails": {
            "firstName": firstName || "",
            "lastName": lastName || "",
            "middleName": "",
            "mobileNumber": mobileNumber,
            "email": email || "",
            "age": clickToCallProposerAge || "",
        },
        "lifeAssuredDetails": {
            "age": lifeAssuredAge,
            "gender": gender
        }
    }
if(!location.href.includes("/ulip-quote.u")){
	triggerUlipGetQuote(amountToInvest, frequencyCode, proposerAge, lifeAssuredAge, gender, mobileNumber, riskScore, email);
    ulipClickToCall(AppConstants.API_SELECTOR.ULIP_CLICK_TO_CALL.name, sendData);
}else{
	triggerUlipGetQuote(amountToInvest, frequencyCode, proposerAge, lifeAssuredAge, gender, mobileNumber, riskScore, email);
	ulipClickToCall(AppConstants.API_SELECTOR.ULIP_CLICK_TO_CALL.name, sendData);
}
};

function ulipClickToCall(selector, sendData) {

    AppEvent.trigger(selector, sendData).then(function (responseData) {
        if (responseData.status == "SUCCESS") {
            var applicationId = responseData.payload.applicationId || "";
            var mobileno;
            if (localStorage.hasOwnProperty("defaultUserValue")) {
                var isMob = JSON.parse(localStorage.getItem("defaultUserValue"));
                if (isMob.hasOwnProperty("mobileNumber")) {
                    mobileno = isMob.mobileNumber;
                } else {
                    mobileno = ""
                }
            }
            var appStage = "NA";
            var dob = "NA";
            var trafficType = "No Offer";
            if (responseData.payload.existingApplicationFound == true) {
                var resumeAppStage = productName + "_LEAD_PROD_INFO" || "";
                var resumePage = digitalData.page.name;
                triggerToResumeCalls(applicationId, mobileno, appStage, dob, trafficType, resumeAppStage, resumePage);
            } else {
                /*triggerCreateLead(applicationId, responseData.payload.insProductType);*/
                triggerToCreatApplication(applicationId, mobileno, appStage, dob, trafficType);
            }

            ulipGetQuoteAPICall(AppConstants.API_SELECTOR.ULIP_GET_QUOTE_PLAN.name, ulipGetQuoteSendData)
        } else {
            if (responseData.errorBean) {
                toastr.error(responseData.errorBean[0].errorCode + " : " + responseData.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false);
        }
        console.log(JSON.stringify(responseData));
    }).catch(function (err) {
        toggleLoader(false);
        console.log(err);
    });
}

function ulipGetQuoteAPICall(selector, sendData) {

    var path;
    var parentContainer = findSelectorParent(event.target, "FORM");
    if (window.isMobile == "1") {
        path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0] + "." + window.location.pathname.split(".")[1];
    } else {
        path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0];
    }

    var hasFirstName = ($(parentContainer).find("#firstName").length == 1);
    var hasLastName = ($(parentContainer).find("#lastName").length == 1);
    var hasMobileNumber = ($(parentContainer).find("#mobileNumber").length == 1);
    var hasEmail = ($(parentContainer).find("#email").length == 1);

    var mobileNumber, email, firstName, lastName;
    if (hasFirstName) {
        firstName = $(parentContainer).find("#firstName").val()
    }
    if (hasLastName) {
        lastName = $(parentContainer).find("#lastName").val()
    }
    if (hasMobileNumber) {
        mobileNumber = $(parentContainer).find("#mobileNumber").val();
    } else {
        mobileNumber = localStorage.getItem("mobileNumber") || "";
    }
    if (hasEmail) {
        email = $(parentContainer).find("#email").val()
    }
    AppEvent.trigger(selector, sendData).then(function (response) {
        if (response.status == "SUCCESS") {
            window.localStorage.setItem("mobileNumber", mobileNumber || "");
            response.qid = "u" + generateRandom();
            if (mobileNumber != undefined) {
                response.payload.mobileNumber = mobileNumber || "";
            } else {
                response.payload.mobileNumber = window.localStorage.getItem("mobileNumber") || "";
            }
            localStorage.setItem("getQuoteData", JSON.stringify(response));
            var gclID;
            try {
                gclID = _satellite.getVisitorId().getMarketingCloudVisitorID()
            } catch (err) {
                console.log(err);
            }
            var htmlExtension = ".html";
            window.location.href = path + "." + response.qid + htmlExtension;
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false);
        }
    }).catch(function (err) {
        toggleLoader(false);
    });

}

var jsonresponse;

function loadPlanDetailsUlip(){ 
	var parentContainer = $("#get-a-quote-ulip").find("form");
	$(parentContainer).find("#invest_amount").parent().addClass("focus")
     var amountToInvest = $(parentContainer).find("#invest_amount").val(jsonresponse.payload.premium);
	
	if(jsonresponse.payload.proposer.age  == null || ""){
		document.getElementById("proposerAgeContainer").style.display = "none";
	}else{
		document.getElementById("proposerAgeContainer");
		$(parentContainer).find("#age").parent().addClass("focus")
		var proposerAge = $(parentContainer).find("#age").val(jsonresponse.payload.proposer.age);	
	}
	
	$(parentContainer).find("#assured_age").parent().addClass("focus")
	  var lifeAssuredAge = $(parentContainer).find("#assured_age").val(jsonresponse.payload.lifeAssured.age < 10 ? "0"+jsonresponse.payload.lifeAssured.age : jsonresponse.payload.lifeAssured.age);
	var gender = $(parentContainer).find("#gender").val(jsonresponse.payload.lifeAssured.gender);
	console.log(gender);
	if(jsonresponse.payload.lifeAssured.gender === "M"){
		document.getElementById('genderJsonValue').innerText = "Male";
	}else{
		document.getElementById('genderJsonValue').innerText = "Female";
	}
	var frequencyCode = $(parentContainer).find("#frequencyCode").val();

	if(jsonresponse.payload.investmentFor==2 || jsonresponse.payload.investmentFor==1){
			document.getElementById("proposerAgeInputContainer").style.display = "none";
        	document.getElementById("proposerAgeContainer").style.display = "none";
        	document.getElementById("lifeAgeContainer").querySelectorAll(".form-label")[0].innerText="Your Age";
        	document.getElementById("lifeAssuredAgeInputContainer").querySelectorAll(".form-label")[0].innerText="Your Age"
	}else{
			document.getElementById("proposerAgeInputContainer");
			var proposerAge = $(parentContainer).find("#age").val(jsonresponse.payload.proposer.age);	
	} 
	
}



function populateQuoteData(e) {

	
	  // amount invested population
	
	var amountInvested = "₹ "+jsonresponse.payload.premium.toLocaleString("en-in")+" ";
	if(document.querySelectorAll('.label-value-form .value')[0].childNodes[0].nodeType != Node.TEXT_NODE) {
		var textNode = document.createTextNode(amountInvested);
		document.querySelectorAll('.label-value-form .value')[0].insertBefore(textNode,document.getElementById("frequencyCodeVal"))
	}
	else{
		document.querySelectorAll('.label-value-form .value')[0].childNodes[0].nodeValue = amountInvested;
	}
   	jsonresponse.payload.plans.forEach(function (e, index) {
		var premiumPayingFrequency = e.possibleValues.premiumPayingFrequency.filter(function(premium){
			return  premium.code === e.frequencyCode;
		}
          
        );

		document.querySelectorAll('.label-value-form .value small')[0].innerText = premiumPayingFrequency[0].value;
    })
    // amount invested population end

    
    
    // proposer age population
    if(jsonresponse.payload.proposer.age!==null)
	    document.querySelectorAll('.label-value-form .value')[1].innerText = jsonresponse.payload.proposer.age+ " Years";
	else
        document.querySelectorAll('.label-value-form .value')[1].innerText = "-";
    // proposer age population end

    // life Assured age population
    document.querySelectorAll('.label-value-form .value')[2].innerText = jsonresponse.payload.lifeAssured.age+ " Years";
	// life Assured age population end

       
       // Gender population
	var gender;
    var genderFromResponse = jsonresponse.payload.lifeAssured.gender;
    if(genderFromResponse === 'M' || genderFromResponse === 'male'){
	    gender = "Male";
    }else if(genderFromResponse === 'F' || genderFromResponse === 'female'){
        gender = "Female"
    }
    document.getElementById('select2-gender-container').textContent = gender;
    
	// Gender population end

    
    //frequency Code Population
     var frequencyPopulation;  
    jsonresponse.payload.plans.forEach(function (e, index) {
     frequencyPopulation = e.frequencyCode;
    });
    
    if(frequencyPopulation == 12){
    	frequencyPopulation = "monthly";
    }else if(frequencyPopulation == 1){
    	frequencyPopulation = "yearly";
    }else if(frequencyPopulation == 2){
    	frequencyPopulation = "half-yearly";
    }else if(frequencyPopulation == 4){
    	frequencyPopulation = "quarterly";
    }   
   

    document.getElementById('select2-frequencyCode-container').textContent = frequencyPopulation;
    
    change_select_value('#frequencyCode', frequencyPopulation);

    
  if (jsonresponse.payload.plans.length > 1) {
    document.querySelectorAll(".bs-quote-card")[1].style.display = "block";
 
  } else {
    document.querySelectorAll(".bs-quote-card")[1].style.display = "none";
  }
  jsonresponse.payload.plans.forEach(function (e, index) {
	  
	//dropdown   
	  var llg = e.planDesc;
	    if(llg=="LongLife Goal") {
	       
	    	document.querySelectorAll(".lyt-section.quote-listing.typ2 .unit.ulip")[index].innerHTML = "Expected return on maturity";
	    	document.querySelectorAll(".dropdown")[index].style.display = "block";
//	    	var select = document.createElement('select');
	    	var selecrLLG = document.querySelectorAll('.select-llg')[index];
	    	selecrLLG.setAttribute("data-variantcode",e.variantCode);
	    	selecrLLG.setAttribute("name","retirementIncome");
	    	selecrLLG.innerHTML="";
	      	for (var i = 0; i <e.rLI.rLIfundpercentagelist.length; i++) {
	               var option = document.createElement('option');
	               option.value = e.rLI.rLIfundpercentagelist[i];
	               option.innerText = e.rLI.rLIfundpercentagelist[i];
	               if($("#rliDropdownValue").val() != ""){
	            	   if(e.rLI.rLIfundpercentagelist[i] == $("#rliDropdownValue").val()){
	            		   option.setAttribute("selected", "selected");
	            	   }
	               }
	               else if (e.rLI.rLIfundpercentagelist[i]==e.rLI.rliFundPercentage ) {
					
	            	   option.setAttribute("selected", "selected");
				}
	               
	               selecrLLG.append(option);
	           }
	      	
	       	document.querySelectorAll('.select-llg')[index].append(select);
	       	document.querySelectorAll('.rli')[index].innerText = "";
	       	var rliIncome = e.rLI.rLIincome;
	       	document.querySelectorAll('.rli')[index].append("₹ " + Math.round(e.rLI.rLIincome).toLocaleString("en-in") + " approx.");
//	       	document.querySelectorAll(".bs-quote-card .card-head .title")[1].innerText=e.planDesc;
	       	//select.onChange = function(){alert("clicked");};

	       }else{
	    	   document.querySelectorAll(".lyt-section.quote-listing.typ2 .unit.ulip")[index].innerHTML = "Expected Maturity Return";
	    	   document.querySelectorAll(".dropdown")[index].style.display = "none"; 
	    	    document.querySelectorAll(".bs-quote-card .title")[index].innerText = e.planDesc;
	    	    
	       }
	 
	    //dropdown
	    
	    //Fund Card
	    
	    var cards = document.querySelectorAll(".bs-quote-card");
	    var fundCards = document.querySelectorAll(".detail-content");
	    if(cards[0].classList.contains("active")){
	      fundCards[0].classList.add("active");
	      fundCards[1].classList.remove("active");
	      fundCards[0].style.display = "block";
	      fundCards[1].style.display = "none";
	      document.querySelectorAll(".lyt-funds.type-allocation.theme-gray")[0].style.display = "block";
	      document.querySelectorAll(".lyt-funds.type-allocation.theme-gray")[1].style.display = "none";
	    
	  }else if(cards[1].classList.contains("active")){
	    fundCards[1].classList.add("active");
	    fundCards[0].classList.remove("active");
	    fundCards[1].style.display = "block";
	      fundCards[0].style.display = "none";
	      document.querySelectorAll(".lyt-funds.type-allocation.theme-gray")[1].style.display = "block";
	      document.querySelectorAll(".lyt-funds.type-allocation.theme-gray")[0].style.display = "none";
	  }
	    
	    //Fund Card
	  
    // checking which card is selected
    var quoteCards = document.querySelectorAll(".bs-quote-card");
    if (e.selected === "Y") {
      quoteCards[index].classList.add("active");
      quoteCards[index].querySelector(".icon").classList.add("icon-star");
    }
    else{
    	quoteCards[index].classList.remove("active");
        quoteCards[index].querySelector(".icon").classList.remove("icon-star");
    }
    document.querySelectorAll(".bs-quote-card")[index].setAttribute("data-variantcode",e.variantCode)

    // Fund card population
    var fundCardTitle = document.querySelectorAll(".quote-list-item .card-head .title")[index];
    fundCardTitle.innerText = e.planDesc;
    var maturityReturnAmount = document.querySelectorAll(".quote-list-item .card-head .quote-price .amount")[index];
    maturityReturnAmount.innerHTML = "₹ " + parseFloat((e.returnOnMaturity/100000).toFixed(2)).toLocaleString("en-IN") +" <span class='unit inline'>Lakhs</span>";

    var policyTerms = e.possibleValues.policyTerms;
    var policyTermDropdown = quoteCards[index].querySelectorAll(".form-control")[0];
      policyTermDropdown.setAttribute("data-variantcode",e.variantCode);
	removeAllChildElements(policyTermDropdown);
    policyTerms.forEach(function (policy, index) {
      var option = document.createElement("option");
      option.value = policy.value + "-years";
      option.innerText = policy.value + " Years";
        if(e.policyTerm===policy.value){
            option.setAttribute("selected","");
        }
      policyTermDropdown.appendChild(option);

    });

    var selector = '[rel=quote-'+(index+1)+'] .aem-GridColumn';
    document.querySelectorAll(selector)[0];
    changeEventHandler(document.querySelectorAll(selector)[0],e.variantCode)
    // policyTermDropdown.onchange = changeEventHandler;
	// document.querySelectorAll('.card-sub-head
	// .aem-GridColumn').forEach(e=>e.onchange=changeEventHandler);
    document.querySelectorAll('.card-sub-head .aem-GridColumn').forEach(function(e,i){if((i+1)%2!=0){e.onchange=changeEventHandler}})

    var sumAssuredDiv = document.querySelectorAll(".bs-quote-card")[index].querySelectorAll(".bs-label-value-pair .value")[0];
    sumAssuredDiv.innerText ="₹ " + Math.round(e.sumAssured).toLocaleString("en-IN");

    var premiumPayingFrequency = e.possibleValues.premiumPayingFrequency.filter(
        function(premium) { return premium.code === e.frequencyCode}
    );
    var premiumPayingFrequencyDiv = document.querySelectorAll(".bs-quote-card")[index].querySelectorAll(".bs-label-value-pair .value")[1];
    premiumPayingFrequencyDiv.innerText = "₹ " + jsonresponse.payload.premium.toLocaleString("en-in") +"/" +premiumPayingFrequency[0].value;

      if(e.funds !== null && e.funds.length>0){
    var noOfFundsAllocated = e.funds.filter(
        function(fund) { return fund.selected.toLowerCase() === "y"}
    ).length;
    var fundAllocatedTextArr = document.querySelectorAll(".btn-fundlist .text")[0].innerText.split(" ");
    fundAllocatedTextArr[0] = noOfFundsAllocated;
    var fundAllocatedDiv = document.querySelectorAll(".bs-quote-card")[index].querySelectorAll(".btn-fundlist .text")[0];
    fundAllocatedDiv.innerText = fundAllocatedTextArr.join(" ");
		var fundsArray = document.getElementsByName("quote-"+(index+1))[0].querySelectorAll(".fund-swiper .swiper-wrapper")[0];
 
		while (fundsArray.firstChild) {
            fundsArray.removeChild(fundsArray.firstChild);
        }
      e.funds.forEach(function(fund,i){
          var filtered = jsonresponse.payload.funds.filter(function(e){
        	  return e.fundCode===fund.code;
          })
          fund = filtered[0];
          document.getElementsByName("quote-"+(index+1))[0].querySelectorAll(".fund-swiper .swiper-wrapper")[0].appendChild(addFundCard(fund.fundCode,fund.fundName,fund.fndRating[0].ratingOverall,fund.riskProfileDesc,e.funds[i].returnPercentage,e.funds[i].allocation,e.funds[i].returnTerm))
      })
	  checkAllocationValue();
      }else{
        $('[rel=quote-'+(index+1)+'] .btn-fundlist').hide()
		$('[name=quote-'+(index+1)+'] .lyt-funds').hide()
      }
      if(e.riders!=null && e.riders.length>0){
      var card = document.getElementsByName('quote-'+(index+1))[0];
     var swipperWrapper = card.querySelectorAll('.lyt-rider .swiper-wrapper')[0];
 /*    swipperWrapper.children.forEach(function(childNode){swipperWrapper.removeChild(childNode);})
  	var removeCard = document.getElementsByClassName('swiper-slide');
	removeCard[removeCard.length-1].style="display:none";
*/	
    /* function checkNotAvailRider(riderCode){
    	 var status = true;
    	 document.querySelectorAll(".lyt-rider").forEach(function(card){
    			if(card.getElementsByClassName("swiper-slide").length>0){
    				card.getElementsByClassName("swiper-slide").forEach(function(el){
    					var code = el.getAttribute("data-id");
    					console.log(code);
    				if(code === riderCode){
    					status = false;
    				}
    					
    					//	status = (code !== riderCode) ? true : false;
    				});
    			}
    		});
    	 return status;
     }*/
     swipperWrapper.innerHTML = "";
     e.riders.forEach(function(rider){
          console.log(rider.code)
//              if(rider.code!==null && checkNotAvailRider(rider.code)){  
          if(rider.code!==null){    
        	  swipperWrapper.appendChild(createRiderCard(rider.code,rider.riderDesc,rider.riderDesc,rider.sumAssured,rider.selected));  
          }        
      })
      var ridersCount = e.riders.filter(function(riderCode){return riderCode.code !== null}).length;
      if(ridersCount != 0){
    	  var noOfRiderCard = e.riders.filter(function(e){return e.selected ==='Y'}).length;
//    	  var noOfRiderCardDiv = document.querySelectorAll('.no-of-cards .count')[index].innerText = noOfRiderCard;
    	  if(noOfRiderCard>0){    		  
    		  document.querySelectorAll('.no-of-cards .count')[index].innerText = noOfRiderCard;
    		  document.querySelectorAll('.bs-quote-card .card-footer .btn-riderlist .text')[0].innerText = noOfRiderCard + " Rider added";
    		  document.querySelector('.no-of-cards').style.display='block';
    	  }
      }
  //    else if(ridersCount > 0) {
    	  $('[rel=quote-'+(index+1)+'] .btn-riderlist').show()
  //		$('[name=quote-'+(index+1)+'] .lyt-rider').show()    	  
  //    }
    }else{
		$('[rel=quote-'+(index+1)+'] .btn-riderlist').hide()
		$('[name=quote-'+(index+1)+'] .lyt-rider').hide()
    }
      document.querySelectorAll(".buy-now")[index].setAttribute("data-variantcode",e.variantCode)
		document.querySelectorAll(".buy-now").forEach(function(btn){
	btn.addEventListener("click",ulipBuyNow)
})
  });

	customizeAllocation()
}

//changed
function checkNotAvailRider(riderCode) {
	  var status = true;
	  document.querySelectorAll(".lyt-rider").forEach(function (card) {
	    if (card.getElementsByClassName("swiper-slide").length > 0) {
	      card.getElementsByClassName("swiper-slide").forEach(function (el) {
	        var code = el.getAttribute("data-id");
	        console.log(code);

	        if (code === riderCode) {
	          status = false;
	        } //	status = (code !== riderCode) ? true : false;

	      });
	    }
	  });
	  return status;
	}
//changed

function addFundCard(fundCode,title,rating,riskProfileDesc,returnPercentage,allocationText,returnTerm) {
  var swiperSlide = document.createElement("div");

  swiperSlide.classList.add("swiper-slide" ,"swiper-no-swiping");
  swiperSlide.setAttribute("data-id", fundCode);
  var bsFundCard = document.createElement("div");
  bsFundCard.classList.add("bs-fund-card");
  bsFundCard.classList.add(riskProfileDesc.toLowerCase().replace(/ /g,'')); // value
																			// will
																			// come
																			// from
																			// api
  swiperSlide.appendChild(bsFundCard);
  // ------------------------------------cardTitle-----------------------------------------------
  var cardTitle = document.createElement("h3");
  bsFundCard.appendChild(cardTitle);
  cardTitle.innerText = title;
  cardTitle.classList.add("title"); // value will come from api
  // -----------------------------------------ratingWrap------------------------------------------
  var ratingWrap = document.createElement("div");
  bsFundCard.appendChild(ratingWrap);
  ratingWrap.classList.add("rating-wrap");
  var bsRating = document.createElement("div");
  bsRating.classList.add("bs-rating");
    if(rating===null){
		bsRating.classList.add("rating-0"); // value will come from api
    }else{
  		bsRating.classList.add("rating-"+rating); // value will come from api
    }
  ratingWrap.appendChild(bsRating);
  for (var i = 0; i < 5; i++) {
    var starSpan = document.createElement("span");
    starSpan.classList.add("star");
    bsRating.appendChild(starSpan);
    var icon = document.createElement("icon");
    icon.classList.add("icon");
    icon.classList.add("icon-rating-star");
    starSpan.appendChild(icon);
  }
  bsFundCard.appendChild(ratingWrap);
  ratingWrap.appendChild(bsRating);
  // ------------------------------------------performance-----------------------------------------
  var performance = document.createElement("div");
  performance.classList.add("performance");
  performance.innerText = "Past "+returnTerm +" years performance"; // value
																	// will come
																	// from api
  bsFundCard.appendChild(performance);
  swiperSlide.style.marginRight = "30px";
  swiperSlide.style.width = "330.333px";
  var value = document.createElement("span");
  value.classList.add("cm-bold");
  value.classList.add("value");
  value.innerText = Math.round( returnPercentage * 10 ) / 10+"%"; // value
																	// will come
																	// from api
  performance.appendChild(value);
  // -------------------------------------allocation----------------------------------------------
  var allocation = document.createElement("div");
  allocation.classList.add("allocation");
  var allocationTitle = document.createElement("div");
  allocationTitle.classList.add("title");
  allocation.appendChild(allocationTitle);
  allocationTitle.innerText = "Allocation";
  bsFundCard.appendChild(allocation);
  var amountWrap = document.createElement("div");
  amountWrap.classList.add("amount-wrap");
  var minusBtn = document.createElement("button");
  var minusBtnClasses = "btn btn-link icon btn-minus icon-minus".split(" ");
  minusBtnClasses.forEach(function(e){
	return  minusBtn.classList.add(e);
  });
  amountWrap.appendChild(minusBtn);
  var allocationValue = document.createElement("div");
  allocationValue.classList.add("value");
  var amount = document.createElement("span");
  amount.innerText = allocationText; // value will come from api
  allocationValue.appendChild(amount);
  amountWrap.appendChild(allocationValue);
  amount.classList.add("amount");
  allocation.appendChild(amountWrap);
  var unit = document.createElement("span");
  unit.classList.add("unit");
  unit.innerText = "%";
  allocationValue.appendChild(unit);
  var plusBtn = document.createElement("button");
  var plusBtnClasses = "btn btn-link icon icon-plus btn-plus".split(" ");
  plusBtnClasses.forEach(function(e){
	return  plusBtn.classList.add(e);  
  });
  amountWrap.appendChild(plusBtn);
  // -------------------------------------fundDetailsBtn----------------------------------------------
  var fundDetailsBtn = document.createElement("button");
  fundDetailsBtn.classList.add("btn");
  fundDetailsBtn.classList.add("btn-link");
  fundDetailsBtn.classList.add("fund-details");
  fundDetailsBtn.setAttribute("data-toggle", "popup");
  fundDetailsBtn.setAttribute("data-target", "#myPopup-fund-details");

  fundDetailsBtn.innerText = "Fund Details";
  allocation.appendChild(fundDetailsBtn);
  allocation.removeChild(fundDetailsBtn);
  bsFundCard.appendChild(fundDetailsBtn);
  allocation.appendChild(fundDetailsBtn);
  allocation.removeChild(fundDetailsBtn);
  bsFundCard.appendChild(fundDetailsBtn);

  swiperSlide.addEventListener("click",fundDetailsModal);
  popup();
  return swiperSlide;
}


function createRiderCard(riderCode,rider_title,riderDesc,sumAssured,isSelected) {
	
	
	var swiper_slide = document.createElement("div");
    // document.querySelectorAll('.rider-swiper
	// .swiper-wrapper').appendChild(swiper_slide);
    swiper_slide.classList.add("swiper-slide");
    swiper_slide.style="width: 329.667px; margin-right: 30px;"

	swiper_slide.setAttribute("data-id",riderCode);
    // Create Rider Card
    var bsRiderCard = document.createElement("div");
    bsRiderCard.classList.add("bs-rider-card");
    swiper_slide.appendChild(bsRiderCard);

    var card_head = document.createElement("div");
    card_head.classList.add("card-head");
    bsRiderCard.appendChild(card_head);

    var card_title = document.createElement("h3");
    card_title.classList.add("title");
    card_title.innerText = rider_title;
    card_head.appendChild(card_title);

    // create button For ADD RIDER with add(plus) icon
    var btn_add_rider = document.createElement("button");
    btn_add_rider.classList.add("btn");
    btn_add_rider.classList.add("btn-link");
    btn_add_rider.classList.add("btn-add-rider");
	var btnText = document.createElement('span')
    btnText.classList.add('btn-text');
	btn_add_rider.appendChild(btnText);
    if(isSelected.toLowerCase()==='y'){
        btn_add_rider.classList.add("rider-added");
        btnText.innerText = "Remove";
    }else{
        btnText.innerText = "Add";
    }
    var txt = document.createTextNode(' Rider')
    btn_add_rider.appendChild(txt);

    var icon_plus = document.createElement("span");
    icon_plus.classList.add("icon");
    if(isSelected.toLowerCase()==='y')
		icon_plus.classList.add("icon-delete");
    else
        icon_plus.classList.add("icon-plus");
    btn_add_rider.appendChild(icon_plus);

    card_head.appendChild(btn_add_rider);

    if(riderDesc){
        var card_body = document.createElement("div");
        card_body.classList.add("card-body");
        bsRiderCard.appendChild(card_body);

        var rider_description = document.createElement("p");
        rider_description.innerText = riderDesc;
        card_body.appendChild(rider_description);

        var notify = document.createElement("div");
        notify.classList.add("notify");
    
        notify.innerText = "Added";
        if(isSelected.toLowerCase()==='y')
			notify.style.display = "block";

        card_body.appendChild(notify);
    }

	if(sumAssured!==0){
        var card_footer = document.createElement("div");
        card_footer.classList.add("card-footer");
        bsRiderCard.appendChild(card_footer);
    
        var sum_assured = document.createElement("div");
        sum_assured.classList.add("sum-assured");
        sum_assured.innerText = "Sum assured";
    
    
        var amount = document.createElement("span");
        amount.classList.add("amount");
        amount.innerText = "₹ "+sumAssured.toLocaleString('EN-IN');
        sum_assured.appendChild(amount);
    
        card_footer.appendChild(sum_assured);
    }

    //card_footer.appendChild(notify);

    return swiper_slide;
}

function calculateAllocationForFundCards(){
	document.querySelectorAll('.lyt-funds .btn-continue').forEach(
        function(e){e.addEventListener("click",function(event){
            var fundAllocated = 0;
        	var lyt_funds = $(event.target).parents('.lyt-funds')[0]
            var activePlan = parseInt(document.querySelectorAll(".bs-quote-card.active")[0].getAttribute('rel').split('-')[1])
			var planJson = jsonresponse.payload.plans[--activePlan];
        	var fundsArray = planJson.funds
            var finalFundAllocated = "";
            lyt_funds.querySelectorAll('.fund-swiper .swiper-slide').forEach(function(card,index){
                var allocation = parseInt(card.querySelectorAll('.allocation .value .amount')[0].innerText)
                finalFundAllocated += card.getAttribute("data-id")+"-"+allocation+":"
					fundAllocated++;
					fundsArray[index].allocation = allocation;
                if(allocation>0)
                    fundsArray[index].selected = "Y";
                else
                	fundsArray[index].selected = "N";
              
            })
            document.querySelectorAll('[rel='+lyt_funds.parentElement.getAttribute('name')+']')[0].querySelectorAll('.btn-fundlist .text')[0].innerText = fundAllocated+' Funds Allocated';
            lyt_funds.querySelectorAll('.fund-swiper .swiper-slide .allocation').forEach(function(e){
            	e.classList.remove('active')	
            });
            lyt_funds.classList.remove('customization-on');
            lyt_funds.querySelectorAll('.btn-customize')[0].style.display = 'block';
			var variantCode = document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode");
        	refinementCall(variantCode);
        	triggerUlipfundAllocationComplete(productName, variantCode, finalFundAllocated.substring(0,finalFundAllocated.length-1))
        })
        }
	)
}



function refinementCall(variantcode){
	var formData = new FormData();
	var responseJsonReplica = jsonresponse;
	var variantCode = variantcode
	var planJson = jsonresponse.payload.plans.filter(function(plan){return plan.variantCode === variantCode;})[0]
/*	
    formData.append("frequencyCode",JSON.stringify(planJson.frequencyCode));
    formData.append("policyTerm",JSON.stringify(planJson.policyTerm));	
	
	formData.append("premiumPayingTerm",JSON.stringify(planJson.premiumPayingTerm)); //JSON.stringify(planJson.premiumPayingTerm)									

    formData.append("sumAssured",JSON.stringify(planJson.sumAssured))
	formData.append("returnOnMaturity",JSON.stringify(planJson.returnOnMaturity))
	formData.append("multiplier",JSON.stringify(planJson.multiplier))
	formData.append("code",planJson.code)
    formData.append("variantCode",planJson.variantCode)
	formData.append("portfolioStrategyCode",planJson.portfolioStrategyCode)
    formData.append("selected",planJson.selected)
    formData.append("premiumPayingFrequency",JSON.stringify(jsonresponse.payload.plans[0].possibleValues.premiumPayingFrequency))
    formData.append("riderSumAssured",JSON.stringify(jsonresponse.payload.plans[0].possibleValues.riderSumAssured))
	formData.append("policyTerms",JSON.stringify(planJson.possibleValues.policyTerms));
	formData.append("policySumAssured",JSON.stringify(planJson.possibleValues.policySumAssured))
    formData.append("funds",JSON.stringify(planJson.funds))															// value
																													// to
																								// modified
	formData.append("riders",JSON.stringify(planJson.riders))
    formData.append("planSpecificOutPutRequired","N");
	delete responseJsonReplica.payload.proposer.address;
	formData.append("proposer",JSON.stringify(responseJsonReplica.payload.proposer));
    formData.append("isLAPHsame","Y");
	formData.append("premium",JSON.stringify(jsonresponse.payload.premium));
    formData.append("applicationId",JSON.stringify(jsonresponse.payload.applicationId))
	formData.append("investmentFor",jsonresponse.payload.investmentFor)
	//RLI	
	formData.append("rLI",JSON.stringify(planJson.rLI));
	
    var sendData = new URLSearchParams(formData).toString();
    */
    var sendData = {
    		"qid": quoteCode,
    		"lifeAssured": responseJsonReplica.payload.lifeAssured,
    		"plan": {
    			"frequencyCode": planJson.frequencyCode,
    			"policyTerm": planJson.policyTerm,
    			"premiumPayingTerm": planJson.premiumPayingTerm,
    			"sumAssured": planJson.sumAssured,
    			"returnOnMaturity": planJson.returnOnMaturity,
    			"multiplier": planJson.multiplier,
    			"code": planJson.code,
    			"variantCode": planJson.variantCode,
    			"portfolioStrategyCode": planJson.portfolioStrategyCode,
    			"selected": planJson.selected,
    			"rLI": planJson.rLI,
    			"possibleValues": {
    				"premiumPayingFrequency": jsonresponse.payload.plans[0].possibleValues.premiumPayingFrequency,
    				"riderSumAssured": jsonresponse.payload.plans[0].possibleValues.riderSumAssured,
    				"policyTerms": planJson.possibleValues.policyTerms,
    				"policySumAssured": planJson.possibleValues.policySumAssured,
    			},
    			"funds": planJson.funds,
    			"riders": planJson.riders
    		},
    		"planSpecificOutPutRequired": "N",
    		"proposer": responseJsonReplica.payload.proposer,
    		"isLAPHsame": "",
    		"premium": jsonresponse.payload.premium,
    		"applicationId": jsonresponse.payload.applicationId,
    		"investmentFor": jsonresponse.payload.investmentFor
    }
    
    if(jsonresponse.payload.investmentFor==="3"){
    //	sendData.proposer.age = proposerAge;
    	sendData.isLAPHsame = "N"
    }
    else{
    	//sendData.proposer.age = lifeAssuredAge;
    	sendData.isLAPHsame = "Y"
    }
    
	ulipGetPlanApiCall(AppConstants.API_SELECTOR.ULIP_GET_PLAN_DATA.name, sendData);

}

function ulipGetPlanApiCall(selector, sendData) {
	AppEvent.trigger(selector, sendData).then(function (refinedResponse) {
		if(refinedResponse.status == "SUCCESS"){
			refinedResponse.payload.mobileNumber = jsonresponse.payload.mobileNumber || localStorage.getItem("mobileNumber") || "";
			jsonresponse = refinedResponse
			populateQuoteData();
	        addRemoveRider();
	        //calculateAllocationForFundCards()
	        toggleLoader(false);
		}
		else{
			if (refinedResponse.errorBean) {
                toastr.error(refinedResponse.errorBean[0].errorCode + " : " + refinedResponse.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
		}
    }).catch(function (err) {
        toggleLoader(false);
    })
}

function changeEventHandler(event,variantCode) {

	var policyTerms;
    if(variantCode==null)
        var variantCode = $(this).find("[data-variantcode]").attr("data-variantcode")
	    //var variantCode = document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode");
	var selectedPlan = jsonresponse.payload.plans.filter(function(plan){return plan.variantCode === variantCode;})[0]
    if(event.target===undefined){
        var dd = $(event).find('.form-control')[0]
		policyTerms = selectedPlan.possibleValues.policyTerms.filter(
            function(e){
            return e.value === parseInt(dd.value.split("-")[0], 10);
            }
        );
        var premiumPayingTermDropdown = $(event).next().find(".form-control")[0];
    }else{
        policyTerms = selectedPlan.possibleValues.policyTerms.filter(
            function(e){
            	return e.value === parseInt(event.target.value.split("-")[0], 10)
            });
        var premiumPayingTermDropdown = $(this).next().find(".form-control")[0];
    }
		premiumPayingTermDropdown.setAttribute("data-variantcode",variantCode)
      removeAllChildElements(premiumPayingTermDropdown);
      policyTerms.forEach(function (policyTerm) {
        policyTerm.premiumPayingTerms.forEach(function (premium) {
          var option = document.createElement("option");
          option.value = premium.value + "-years";
          option.innerText = premium.value + " Years";
            if(selectedPlan.premiumPayingTerm===premium.value){
                option.setAttribute("selected","");
            }
          premiumPayingTermDropdown.appendChild(option);
        });
      });
}

function removeAllChildElements(element) {
  if (element.length > 0) {
    while (element.firstChild) {
      element.removeChild(element.firstChild);
    }
  }
}


function populateFundAnalysis(){
    var formData = new FormData();
    formData.append("type","detail");
    //var sendData = new URLSearchParams(formData).toString();
    
    var sendData = {
    		"type": "detail",
    		"listOfFundId": [],
    		"listOfVariantId": []
    }
    
    ulipFundMasterAPICall(AppConstants.API_SELECTOR.ULIP_FUND_MASTER_DATA.name,sendData);
}

function ulipFundMasterAPICall(selector,sendData) {
	AppEvent.trigger(selector,sendData).then(function (response) {
		if(response.status == "SUCCESS") {
			var tbody = document.getElementsByTagName("tbody");
	        response.payload.funds.forEach(function(fund,index){

	            var tr = document.createElement("tr");
	    
	            // Fund Column - fund Name
	            var fundName = document.createElement("h3");
	            fundName.classList.add("title");
	            fundName.innerText = fund.fundName;
	    
	            // Fund Column - rating
	    
	            var rating_wrapDiv = document.createElement("div");
	            rating_wrapDiv.classList.add("rating-wrap");
	            var ratingDiv = fund.fndRating!=null ? createRatingSection(fund.fndRating[0].ratingOverall) : createRatingSection(0) ;
	            rating_wrapDiv.appendChild(ratingDiv);
	    
	            // Fund Column - riskProfile
	            var bs_fund_card = document.createElement("div");
	            bs_fund_card.classList.add("bs-fund-card");
	            bs_fund_card.classList.add("typ-list");
	            var riskProfileDesc = fund.riskProfileDesc.toLowerCase().replace(" ","");
	            bs_fund_card.classList.add(riskProfileDesc);

	            var fundColumn = document.createElement("td");
	            fundColumn.classList.add("align-left");
				bs_fund_card.appendChild(fundName);
	            bs_fund_card.appendChild(rating_wrapDiv);
	            fundColumn.appendChild(bs_fund_card);					// appended
																		// first
																		// column
	            tr.appendChild(fundColumn);
				var averageReturnsColumn = document.createElement("td");
				var price = document.createElement("div");
				price.classList.add("price");
				averageReturnsColumn.appendChild(price);
	            var span = document.createElement("span");
	            span.innerText = fund.returnValutionTenure;
	            price.appendChild(span);
	            tr.appendChild(averageReturnsColumn);					// appended
																		// second
																		// column

	            var industryColumn = document.createElement("td");
				var industryPrice = document.createElement("div");
				industryPrice.classList.add("price");
				industryColumn.appendChild(industryPrice);
	            var industryspan = document.createElement("span");
	            industryspan.innerText = fund.fndPerformanceDetails[0].categoryReturnInValuationTerm
	            industryPrice.appendChild(industryspan);
	            tr.appendChild(industryColumn);							// appended
																		// third
																		// column

				var aumColumn = document.createElement("td");
				var aumPrice = document.createElement("div");
				aumPrice.classList.add("price");
				aumColumn.appendChild(aumPrice);
	            var aumspan = document.createElement("span");
	            aumspan.innerText = Math.round( fund.fndPerformanceDetails[0].fundNetAssets  / 10000000);
	            aumPrice.appendChild(aumspan);
	            tr.appendChild(aumColumn);							// appended
																	// third column

	            tbody[0].appendChild(tr);
	        })
	        toggleLoader(false);
		}
		else{
			if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
		}
    }).catch(function (err) {
        toggleLoader(false);
    });
}

function createRatingSection(overallRating){
	var bs_ratingDiv = document.createElement("div");
	bs_ratingDiv.classList.add("bs-rating");
    bs_ratingDiv.classList.add("rating-"+overallRating);
    for(var i = 0;i<5;i++){
	    bs_ratingDiv.appendChild(ratingSpan());
    }
    return bs_ratingDiv;
}

function ratingSpan(){
	var span = document.createElement("span");
    span.classList.add("star");
	span.appendChild(createRatingIcon());
    return span;
}

function createRatingIcon(){
	var ratingIcon = document.createElement("i");
    ratingIcon.classList.add("icon");
    ratingIcon.classList.add("icon-rating-star");
    return ratingIcon;
}
/*
 * var allocatedFund =
 * jsonresponse.payload.plans[0].funds.filter(function(fund){ return
 * fund.allocation>0 }) var defaultFunds=""; allocatedFund.forEach(function(f){
 * 
 * defaultFunds += f.code+"-"+f.allocation+":" console.log(defaultFunds) })
 * 
 * 
 * triggerUlipfundDetails(productName,
 * variantCode,defaultFunds.substring(0,defaultFunds.length-1))
 * 
 */



function populateMobileNo(){
	document.getElementById('mobile-no').parentElement.classList.add('focus');
    document.getElementById('mobile-no').value = jsonresponse.payload.mobileNumber || localStorage.getItem("mobileNumber") || "";
}
var productName;
var TIME_SPAN_MAP = new Map();
	TIME_SPAN_MAP.set("yearly", 1);
	TIME_SPAN_MAP.set("monthly", 12);
	TIME_SPAN_MAP.set("half-yearly", 2);
	TIME_SPAN_MAP.set("quarterly", 4);

document.addEventListener("DOMContentLoaded", function () {
    if (document.getElementById("ulip-product-card")) {
        /*getQuoteData(quoteCode).then(function (response) {*/
    	var response;
    	if(localStorage.getItem("getQuoteData")){
    		response = JSON.parse(localStorage.getItem("getQuoteData"))
    	}
        	
            console.log(response)
            jsonresponse = response;
            populateQuoteData();
            populateMobileNo()
            addRemoveRider();
            calculateAllocationForFundCards();
            populateFundAnalysis();
            popup();
            //downloadBrochure();
            refineCallsOnChangeEvent();
            calculateRiderCard();
    		toggleLoader(0);
    		//loadPlanDetailsUlip();
    		var investmentForValue = jsonresponse.payload.investmentFor;
    		
    		/*if(investmentForValue == 3){
    			triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.ULIP.CHILD);
    		}else if(investmentForValue == 2){    // Retirement
    			triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.ULIP.RETIREMENT);
    		}else if(investmentForValue == 1){
    			triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.ULIP.INVESTMENT);	
    		}*/
    		
    		triggerSetProduct(window.productName);
    		switch(parseInt(jsonresponse.payload.investmentFor)){
	    	    case 1:
	    			productName = window.productName
	    		break;
	    	case 2:
	    			productName = window.productName
	    		break;
	    	case 3:
	    			productName = window.productName
	    		break;
	    	}
    		 	var variantCode = jsonresponse.payload.plans.filter(function(e){
    			  return e.selected.toLowerCase()==="y"
    			})[0].variantCode;
    		 	document.querySelectorAll(".btn-riderlist").forEach(function(e){
                    e.addEventListener("click",function(event){
                        getDefaultRiders(document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode"))
                    })
                })
                
                	loadPlanDetailsUlip();
                

        /*})*/

    getDefaultsFunds();
    }
    
    fundRiderCardScroll();

});


if(document.getElementById("fundAnalysisTrigger")){
	
	document.getElementById('fundAnalysisTrigger').onclick = function(){
		 var variantCode = document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode");
		triggerUlipfundAnalysis(productName, variantCode);

	}
	 
}	


/* Ulip Buy Now */
function ulipBuyNow(event){
	
    var variantCode = event.target.getAttribute("data-variantcode")
    var selectedPlan = jsonresponse.payload.plans.filter(function(e){
		return e.variantCode === variantCode
	})[0];	
	
    var sendData = {
    		"userAction": "buynow",
    		"channelType": window.channelType.channelType,
    		"investmentFor": jsonresponse.payload.investmentFor,
    		"investmentAmount": jsonresponse.payload.premium,
    		"investmentGoal": "1",
    		"riskScore": "",
    		"selectedPlanDetails": {
    			"code": selectedPlan.code,
    			"variantCode": selectedPlan.variantCode,
    			"sumAssured": selectedPlan.sumAssured,
    			"frequencyCode": selectedPlan.frequencyCode,
    			"premiumPayingTerm": selectedPlan.premiumPayingTerm,
    			"policyTerm": selectedPlan.policyTerm,
    			"portfolioStrategyCode": selectedPlan.portfolioStrategyCode,
    			"multiplier": selectedPlan.multiplier,
    			"funds": selectedPlan.funds,
    			"riders": selectedPlan.riders,
    			"rLI": selectedPlan.rLI
    		},
    		"utmParams": window.utmParams,
    		"proposerDetails": {
    			"firstName": "",
    			"lastName": "",
    			"mobileNumber": jsonresponse.payload.mobileNumber || localStorage.getItem("mobileNumber") || "",
    			"email": "",
    			"age": "",
    			"gender": jsonresponse.payload.lifeAssured.gender
    		},
    		"lifeAssuredDetails": {
    			"age": jsonresponse.payload.lifeAssured.age,
    			"gender": jsonresponse.payload.lifeAssured.gender
    		}
    }
    
    if(jsonresponse.payload.investmentFor != 3){
    	sendData.proposerDetails.age = jsonresponse.payload.lifeAssured.age;
    }
    else{
    	sendData.proposerDetails.age = jsonresponse.payload.proposer.age;
    }
	
    if(jsonresponse.payload.lifeAssured.riskScore != "" && jsonresponse.payload.lifeAssured.riskScore != null){
    	sendData.riskScore = jsonresponse.payload.lifeAssured.riskScore
    }
    
	triggerUlipBuyNow(productName,selectedPlan.variantCode, selectedPlan.policyTerm, selectedPlan.premiumPayingTerm, selectedPlan.sumAssured)

	ulipBuyNowAPICall(AppConstants.API_SELECTOR.ULIP_BUY_NOW.name, sendData);
}

function ulipBuyNowAPICall(selector, sendData) {
	AppEvent.trigger(selector, sendData)
	.then(function(response) {
		if(response.status == "SUCCESS"){
			if(response.payload != null){
				
				/*response.authToken = response.payload.authToken;
				response.guardKey = response.payload.guardKey;*/
				var url = handoverEndpointURL + ulipHandoverURL;
				url += "apcantid=" + response.payload.applicantId + "&";
				url += "aptionid=" + response.payload.applicationId + "&";
				url += "apcaptid=" + response.payload.applicationApplicantId + "&";
				url += "skipLogin=true" + "&";
				url += "insProductType=" + "ULIP";
				response.responseURL = url; 
			}
			if (response.responseURL) {
	            if(response.payload.authToken){
	            	window.sessionStorage.setItem("SS_1", response.payload.authToken)
	            	window.sessionStorage.setItem("SS_4", response.payload.guardKey)
	            	document.cookie = "SS_1=" + response.payload.authToken 
	            	document.cookie = "SS_4=" + response.payload.guardKey
	            }
				location.href = response.responseURL;
			}
			popup_close()
			toggleLoader(false)
		}
		else{
			if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
		}
	}).catch(function (err) {
        toggleLoader(false);
    })
}

/* Email Variant */
function ulipEmailQuote(){
	var formData = new FormData();
	formData.append("investmentFor", "1");
	formData.append("investmentGoal", "1");
	formData.append("frequencyCode", selectedPlan.frequencyCode);
	formData.append("premiumPayingTerm", selectedPlan.premiumPayingTerm);
	formData.append("portfolioStrategyCode", selectedPlan.portfolioStrategyCode);
	formData.append("funds", JSON.stringify(selectedPlan.funds));
	formData.append("riders", JSON.stringify(selectedPlan.riders));
	formData.append("firstName", "");
	formData.append("middleName", "");
	formData.append("lastName", "");
	formData.append("mobileNumber", "");
	formData.append("email", "");
	formData.append("proposerage", jsonresponse.payload.proposer.age);
	formData.append("lifeAssuredage", jsonresponse.payload.lifeAssured.age);
	formData.append("gender", jsonresponse.payload.lifeAssured.gender);

	var sendData = new URLSearchParams(formData).toString();
	AppEvent.trigger(AppConstants.API_SELECTOR.ULIP_EMAIL_QUOTE.name, sendData)
	.then(function(response) {
		if (response.responseURL) {
	// location.href = response.responseURL;
		}
		popup_close()
		toggleLoader(false)

	})
}


function fundDetailsModal(event){
    if(event.target.classList.contains("fund-details")){
		 var variantCode = document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode");
		triggerUlipfundDetails(productName, variantCode, this.getAttribute("data-id"));
    }
    var fundCardTitle = this.querySelectorAll("h3.title")[0].innerText.trim();
    console.log("fundCardTitle :",fundCardTitle);
    var fundDetails = jsonresponse.payload.funds.filter(function(e){
        return e.fundName===fundCardTitle;
    })
	// adding Fund Card Title
    document.querySelectorAll("#myPopup-fund-details h4.title")[0].innerText = fundCardTitle;

    // inserting Morning star rating
	var element = document.querySelectorAll("#myPopup-fund-details #starRating .rating-wrap");
	while(element[0].hasChildNodes()){
		element[0].removeChild(element[0].firstChild)
	}
	element[0].appendChild(createRatingSection(fundDetails[0].fndRating[0].ratingOverall));

	// inserting risk profile description
	document.querySelectorAll("#myPopup-fund-details #riskProfile .value")[0].innerText = fundDetails[0].riskProfileDesc;

    // inception date
    document.querySelectorAll("#myPopup-fund-details #inceptionDate .value")[0].innerText = fundDetails[0].inceptionDate;

    // right section
	var bsLabelsValues = document.querySelectorAll("#myPopup-fund-details .desc-detail .bs-label-value");
    bsLabelsValues.forEach(function(e,i){
        while(e.hasChildNodes()){
            e.removeChild(e.firstChild)
        }
    })
    fundDetails[0].fundAllocations.forEach(function(allocation,index){
	var labelValuePair = document.querySelectorAll("#myPopup-fund-details .desc-detail .bs-label-value")[index];
    labelValuePair.style.display = "inline-block";

    var label = document.createElement("div")
    label.classList.add('label');
	label.innerText = allocation.allocationhead;

	labelValuePair.appendChild(label);
    var value = document.createElement("div")
    value.classList.add('value');
	value.innerText = allocation.allocationdetail;
    labelValuePair.appendChild(value);
    
})
}	


/* ULIP Download Broucher */

function downloadBrochure(ele,event){
	/*document.getElementsByClassName("bs-quote-card").forEach(function(card){
        card.addEventListener("click", function(event){
            event.preventDefault();*/
            if(event.target.classList.contains("downloadBrochure")){
                var planIndex = --ele.getAttribute("rel").split('-')[1]
               /* var formData = new FormData();
                formData.append("variantCode",jsonresponse.payload.plans[planIndex].variantCode);
                var sendData = new URLSearchParams(formData).toString();*/
                triggerUlipDownloadBrochure(productName, jsonresponse.payload.plans[planIndex].variantCode);
                var sendData = "";
                if(AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.includes("?")){
                	AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url = AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.substring(0,AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url.indexOf("?"));
                }

                AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.url += "?variantcode=" + jsonresponse.payload.plans[planIndex].variantCode;
                AppEvent.trigger(AppConstants.API_SELECTOR.TRAVEL_DOWNLOAD_BROCHURE.name, sendData).then(function(response){
                    window.open(
                        response.payload.docDownloadUrl,
                        '_blank'
                    );
                    toggleLoader(false);
                })
            }
     
}

function getDefaultsFunds(){

	document.getElementsByClassName("detail-content").forEach(function(e){
		e.addEventListener("click",function(){
			if(event.target.classList.contains("btn-customize")){
				var variantCode = jsonresponse.payload.plans[--this.getAttribute("name").split("-")[1]].variantCode;
                var defaultFunds = getFundDataInAnalyticsFormat(variantCode);
				// var variantCode = document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode");
				triggerUlipfundAllocationStart(productName,variantCode,defaultFunds.substring(0,defaultFunds.length-1));
			}
		})
	})

    document.querySelectorAll(".bs-quote-card").forEach(function(card){

		card.addEventListener("click",function(){
            if(event.target.parentElement.classList.contains("btn-fundlist")){
                var variantCode = this.getAttribute("data-variantcode");
				var defaultFunds = getFundDataInAnalyticsFormat(variantCode);
                triggerUlipfundAllocationStart(productName,variantCode,defaultFunds.substring(0,defaultFunds.length-1));
            }
		})
    })
}

function getFundDataInAnalyticsFormat(variantCode){
	var selectedPlan = jsonresponse.payload.plans.filter(function(plan){
        return plan.variantCode === variantCode;
    })[0];
	var defaultFunds="";
	selectedPlan.funds.forEach(function(fund){
		defaultFunds += fund.code+"-"+fund.allocation+":";
	});
	return defaultFunds;
}

function getDefaultRiders(variantCode){
    var selectedPlan = jsonresponse.payload.plans.filter(function(plan){
    return plan.variantCode === variantCode;
  })[0]
  var defaultRiders = "";
  var riders = selectedPlan.riders
  riders.forEach(function(rider){
    defaultRiders += rider.code +"-" +rider.selected+":";
  })
  triggerUlipRiderDefaultStart(productName,variantCode,defaultRiders.substring(0,defaultRiders.length-1))
}

function calculateRiderCard(){
	

    document.querySelectorAll(".lyt-rider").forEach(function(btn){
  btn.addEventListener("click",function(event){
    if(event.target.classList.contains("btn-continue")){
      var variantCode = document.querySelectorAll(".bs-quote-card.active")[0].getAttribute("data-variantcode");
	  var selectedPlan = jsonresponse.payload.plans.filter(function(plan){return plan.variantCode === variantCode;})[0]
      var finalRiderAdded="";
	  this.querySelectorAll(".swiper-slide").forEach(function(riderCard){
        var riderCode = riderCard.getAttribute("data-id");
        var rider = selectedPlan.riders.filter(function(rider){return rider.code == riderCode;})[0];
        finalRiderAdded += riderCode +"-"
        var isSelected;
        if(riderCard.querySelectorAll(".notify")[0].style.display==="block"){
          isSelected = "Y";
		  rider.selected = isSelected;
        }else if(riderCard.querySelectorAll(".notify")[0].style.display === "none"){
 //         isSelected = "N";
          rider.selected = "N";
      	}
        finalRiderAdded +=  isSelected+ ":";
        console.log(finalRiderAdded);
      })

      triggerUlipRiderComplete(productName,variantCode,finalRiderAdded.substring(0,finalRiderAdded.length-1));
      refinementCall(variantCode);
    }
  })
    })
}

function refineCallsOnChangeEvent(){


	$('[data-variantcode]').on('change', function (e) {
        e.preventDefault();
        e.stopPropagation();
        var variantCode = e.currentTarget.getAttribute("data-variantcode");
        var planJson = jsonresponse.payload.plans.filter(function(plan){return plan.variantCode === variantCode});
        var activePlanIndex = parseInt(document.querySelectorAll(".bs-quote-card.active")[0].getAttribute('rel').split('-')[1]);
		var activePlanJson = planJson[0];//[--activePlanIndex];

		if(e.target.getAttribute("name")==="policyTerm"){
			
			activePlanJson.policyTerm = parseInt(e.target.value.split("-")[0])
			activePlanJson.premiumPayingTerm = parseInt(document.querySelectorAll("[data-variantcode="+variantCode+"] [name=premiumPayingTerm]")[0].value)
			
			var premiumPayingTerm;
		    activePlanJson.possibleValues.policyTerms.forEach(function(each){
		    	if(activePlanJson.policyTerm == each.value){
		    		premiumPayingTerm = each.premiumPayingTerms[0].value;
		    	}
		    });
			   activePlanJson.premiumPayingTerm = premiumPayingTerm;
			   
			   if(activePlanJson.planDesc == "LongLife Goal") {  
				   
			   activePlanJson.rLI.rliFundPercentage = $("#rliDropdownValue").val();
			   }
			refinementCall(variantCode)
        }
		if(e.target.getAttribute("name")==="premiumPayingTerm"){
			activePlanJson.premiumPayingTerm = parseInt(e.target.value.split("-")[0])
        	activePlanJson.policyTerm = parseInt(document.querySelectorAll("[data-variantcode="+variantCode+"] [name=policyTerm]")[0].value)
			
        		var activeCard = document.querySelector(".bs-quote-card.type-ulip.active");
				var activePremiumPaying = activeCard.querySelector("select[name=premiumPayingTerm]");
				var premiumvalue = activePremiumPaying.value;
			    var premiumPayingTerm = premiumvalue.split("-")[0];	
			 if(activePlanJson.planDesc == "LongLife Goal") {  
				   activePlanJson.rLI.rliFundPercentage = $("#rliDropdownValue").val();
			 }
        	refinementCall(variantCode)
        }		
        
        if(e.target.getAttribute("name")==="retirementIncome"){
			activePlanJson.rLI.rliFundPercentage = parseInt(e.target.value.split("-")[0]);
			$("#rliDropdownValue").val(parseInt(e.target.value.split("-")[0]));
        	refinementCall(variantCode)
        }

	});
}

/*document.getElementById("riderBtn").addEventListener("click", function(){
	
	var card = document.getElementsByName("quote-1")[0];
	var swipperWrapper = card.querySelectorAll('.lyt-rider .swiper-wrapper')[0];
	swipperWrapper.children.forEach(function(childNode){swipperWrapper.removeChild(childNode);})
	var removeCard = document.getElementsByClassName('bs-rider-card');
	removeCard[removeCard.length-1].style="display:none";

	console.log(card);
})

*/

function fundRiderCardScroll(){
	document.querySelectorAll(".bs-quote-card .card-footer .btn-scroll-section").forEach(function(e){
		e.addEventListener("click", function(){
/*
	    $('html,body').animate({
	        scrollTop: $("#lyt-funds-rider-section").offset().top - 125},
	        'slow');
	;*/
			
			if(window.innerWidth > 767){
			
			var headerHeight = $(".bfs-header-wrap").outerHeight();
			var divHeight = $("#lyt-funds-rider-section").offset().top
			window.scrollTo(0, divHeight - headerHeight);	
			}
			else{
				var headerHeight = $(".bfs-header-wrap").outerHeight();
				var divHeight = $(".quote-details-wrapper.mobile").offset().top
				window.scrollTo(0, divHeight - headerHeight);	
			}
		});
	});
}


var curetn_step = 1;
var question_ans;
var noOfQuestions;
function validateForm(){
	var element = document.getElementsByClassName('bs-question-step')[0];
    var noOfQuestions = element.querySelectorAll(".step").length;
    document.querySelectorAll(".progress .total")[0].innerText = noOfQuestions;
    element.querySelectorAll('.question-wrapper .step:last-child .btn-parent button[type=submit]')[0].innerText = 'continue';

    element.querySelectorAll('.step').forEach(function(step,index){

         var error = document.createElement("label");
         error.classList.add('error');
         error.classList.add('label-err');
         error.style.display = "none";
         error.innerText = "This field is required.";
	     document.getElementsByClassName('content')[index].appendChild(error);


		var current_step = step;
        var form = step.getElementsByTagName('form')[0];
        var radio = form.querySelectorAll('input[type="radio"]');
        var btnSubmit = form.querySelectorAll('input[type="submit"]');


        for(var i =0;i<radio.length;i++){
            radio[i].addEventListener('change',function(){
				document.getElementsByClassName('error')[index].style.display = "none";
            });
        }

        var btn = 'btn-'+index;
        var bck_btn = 'bck-btn-'+index;
        document.getElementById(btn).addEventListener('click', function(event){
    		event.preventDefault();
            if($(radio).is(':checked')){

                    if (element.querySelectorAll('.step').length == curetn_step) {
            			var i = 1;
                		var obj = '{ "riskQuestions" : [';
                		element.querySelectorAll('.question-wrapper .step').forEach(function (e, index) {
                			var rval = document.querySelectorAll('input[type=radio]:checked')[index].value;
                    		obj += '{ "code":"Q' + i + '" , "answerCode":"' + rval + '" }';
                    		if (i != noOfQuestions) {
                    			obj += ',';
                    		}
                    		i++;
                		});
                		obj += ']}';
                		question_ans = JSON.parse(obj);
                        console.log(question_ans);
                        sendRequest(question_ans)
           			}
                    else{
                        var ele = document.getElementsByClassName('bs-question-step')[index];
                        if(current_step.nextSibling.nodeType != Node.TEXT_NODE){
                        	show_hide(current_step.nextSibling, current_step);
    						curetn_step= parseInt(event.target.id.split('-')[1],10 )+1;
                            curetn_step++;
                    		document.querySelectorAll('.progress .current')[0].innerText = curetn_step;
                    		document.querySelectorAll('.step-index')[0].innerText ='0' + curetn_step;
                        }
                        else{
                        	show_hide(current_step.nextSibling.nextSibling, current_step);
    						curetn_step= parseInt(event.target.id.split('-')[1],10 )+1;
                            curetn_step++;
                    		document.querySelectorAll('.progress .current')[0].innerText = curetn_step;
                    		document.querySelectorAll('.step-index')[0].innerText ='0' + curetn_step;
                        }
                		/*show_hide(current_step.nextSibling.nextSibling, current_step);
						curetn_step= parseInt(event.target.id.split('-')[1],10 )+1;
                        curetn_step++;
                		document.querySelectorAll('.progress .current')[0].innerText = curetn_step;
                		document.querySelectorAll('.step-index')[0].innerText ='0' + curetn_step;*/
                    }
            	}
            	else{

                    error.style.display = "inline-block";
	            }
        });
        document.getElementById(bck_btn).addEventListener('click', function (event) {
        	if(current_step.previousSibling.nodeType != Node.TEXT_NODE){
        		show_hide(current_step.previousSibling, current_step);
                curetn_step= parseInt(event.target.id.split('-')[2],10 )+1;
                curetn_step--;
                document.querySelectorAll('.progress .current')[0].innerText = curetn_step;
                document.querySelectorAll('.step-index')[0].innerText = '0' + curetn_step;
        	}
        	else{
        		show_hide(current_step.previousSibling.previousSibling, current_step);
                curetn_step= parseInt(event.target.id.split('-')[2],10 )+1;
                curetn_step--;
                document.querySelectorAll('.progress .current')[0].innerText = curetn_step;
                document.querySelectorAll('.step-index')[0].innerText = '0' + curetn_step;
        	}
        	/*show_hide(current_step.previousSibling.previousSibling, current_step);
            curetn_step= parseInt(event.target.id.split('-')[2],10 )+1;
            curetn_step--;
            document.querySelectorAll('.progress .current')[0].innerText = curetn_step;
            document.querySelectorAll('.step-index')[0].innerText = '0' + curetn_step;*/
        });
    });
}

function sendRequest(requestJson){
    console.log("risk json :"+JSON.stringify(requestJson));
    //var sendData = new URLSearchParams(ObjToFormData(requestJson)).toString();
    var sendData = requestJson;
    console.log(requestJson);
    ulipRiskCalcAPICall(AppConstants.API_SELECTOR.ULIP_FETCH_RISK.name,sendData);
}

function ulipRiskCalcAPICall(selector,sendData) {
	AppEvent.trigger(selector,sendData).then(function (response) {
		if(response.status == "SUCCESS"){
			response.qid = "m"+generateRandom();
		      console.log(response);
		      
		      localStorage.setItem("getQuoteData", JSON.stringify(response));
		        if (response.qid) {
		            window.location.href = document.getElementById('path').value + "." + response.qid + ".html";
		            console.log(response.qid);}
		        else{
		            toggleLoader(false);
		        }
		}
		else{
			if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
		}
	    }).catch(function (err) {
	        toggleLoader(false);
	    })
}

document.addEventListener("DOMContentLoaded", function() {
    if(document.getElementById('tab-tiles-risk-qustn')){
    	validateForm();
    }
});
function loadFundPerformanceDetails(responseJsonData) {
    var tbody = document.getElementsByTagName("tbody");
    while (tbody[0].hasChildNodes()) {
        tbody[0].removeChild(tbody[0].lastChild);
    }
    responseJsonData.payload.funds.forEach(function(fund, index) {

        var tr = document.createElement("tr");

        // Fund Column - fund Name
        var fundName = document.createElement("h3");
        fundName.classList.add("title");
        fundName.innerText = fund.fundName;

        //Fund Column - rating

        var rating_wrapDiv = document.createElement("div");
        rating_wrapDiv.classList.add("rating-wrap");
        var ratingDiv = fund.fndRating != null ? createRatingSection(fund.fndRating[0].ratingOverall) : createRatingSection(0);
        rating_wrapDiv.appendChild(ratingDiv);

        //Fund Column - riskProfile
        var bs_fund_card = document.createElement("div");
        bs_fund_card.classList.add("bs-fund-card");
        bs_fund_card.classList.add("typ-list");
        var riskProfileDesc = fund.riskProfileDesc.toLowerCase().replace(" ", "");
        bs_fund_card.classList.add(riskProfileDesc);

        var fundColumn = document.createElement("td");
        fundColumn.classList.add("align-left");

        bs_fund_card.appendChild(fundName);
        bs_fund_card.appendChild(rating_wrapDiv);
        fundColumn.appendChild(bs_fund_card); //appended first column
        tr.appendChild(fundColumn);

        var priceSpan = document.createElement("span");
        priceSpan.innerText = Number(fund.fndPerformanceDetails[0].returnInValuationTerm.toFixed(2));

        var priceDiv = document.createElement("div");
        priceDiv.classList.add("price");
        priceDiv.appendChild(priceSpan);

        var priceColumn = document.createElement("td");
        priceColumn.classList.add("align-center");
        priceColumn.appendChild(priceDiv);
        tr.append(priceColumn); //appended second column	


        var sinceInceptionSpan = document.createElement("span");
        sinceInceptionSpan.innerText = fund.fndPerformanceDetails != null ?
            Math.round(fund.fndPerformanceDetails[0].returnSinceInception * 100) / 100 + "%" : "-";

        var sinceInceptionDiv = document.createElement("div");
        sinceInceptionDiv.classList.add("price");
        sinceInceptionDiv.appendChild(sinceInceptionSpan);

        var sinceInceptionColumn = document.createElement("td");
        sinceInceptionColumn.classList.add("align-center");
        sinceInceptionColumn.appendChild(sinceInceptionDiv);
        tr.append(sinceInceptionColumn); //appended third column

        var inceptionDateColumn = document.createElement("td");
        inceptionDateColumn.classList.add("align-right");
        inceptionDateColumn.innerText = fund.inceptionDate;

        tr.append(inceptionDateColumn);

        var lastUpdateDateColumn = document.createElement("td");
        lastUpdateDateColumn.classList.add("align-right");
        var lastUpDateData = fund.fndPerformanceDetails[0].lstUpdateDt.trim();
        var lastUpt = new Date(lastUpDateData);
        if (lastUpDateData.includes(" ")) {
            lastUpt = new Date(lastUpDateData.split(" ")[0]);
        }
        var fmtLastUpdt = lastUpt.toISOString().replace(/T.+/g, "");
        lastUpdateDateColumn.innerText = fmtLastUpdt;

        tr.append(lastUpdateDateColumn);

        tbody[0].appendChild(tr);

    });
}

function createRatingSection(overallRating) {
    var bs_ratingDiv = document.createElement("div");
    bs_ratingDiv.classList.add("bs-rating");
    bs_ratingDiv.classList.add("rating-" + overallRating);
    for (var i = 0; i < 5; i++) {
        bs_ratingDiv.appendChild(ratingSpan());
    }
    return bs_ratingDiv;
}

function ratingSpan() {
    var span = document.createElement("span");
    span.classList.add("star");
    span.appendChild(createRatingIcon());
    return span;
}

function createRatingIcon() {
    var ratingIcon = document.createElement("i");
    ratingIcon.classList.add("icon");
    ratingIcon.classList.add("icon-rating-star");
    return ratingIcon;
}

document.addEventListener("DOMContentLoaded", function() {
    if (document.getElementsByClassName("fundperformance")[0] !== undefined) {
        var type = "detail";
        var variantList1 = [];
        if (type !== "" || fundList1.length > 1 || variantList1.length > 1) {
            /*
            var formData = new FormData();
            formData.append("type",type);
            formData.append("listOfFundId",JSON.stringify(fundList1));
            formData.append("listOfVariantId",JSON.stringify(variantList1));
            var sendData = new URLSearchParams(formData).toString();
            AppEvent.trigger(AppConstants.API_SELECTOR.ULIP_FUND_MASTER_DATA.name,sendData).then(function (response) {
                 loadFundPerformanceDetails(response);
                    toggleLoader(0);
            });
            */
            ajaxCall(type, fundList1, variantList1);
        }
        $('input[type=radio]').click(function() {
            var variantList1 = [];
            variantList1.push(this.getAttribute("data-id"));
            ajaxCall(type, fundList1, variantList1);
        })
    }
});

function ajaxCall(type, fundList1, variantList1) {
    var formData = new FormData();
    /* formData.append("type",type);
     formData.append("listOfFundId",JSON.stringify(fundList1));
     formData.append("listOfVariantId",JSON.stringify(variantList1));*/
    //var sendData = new URLSearchParams(formData).toString();

    var sendData = {
        "type": type,
        "listOfFundId": fundList1,
        "listOfVariantId": variantList1
    }

    ulipFundPerformanceMasterAPICall(AppConstants.API_SELECTOR.ULIP_FUND_PERFORMANCE_MASTER_DATA.name, sendData);
}

function ulipFundPerformanceMasterAPICall(selector, sendData) {
    AppEvent.trigger(selector, sendData).then(function(response) {
        loadFundPerformanceDetails(response);
        toggleLoader(0);
    });
}
document.addEventListener("DOMContentLoaded", function () {
        if (document.getElementById("tab-tiles-ulip")) {
      //getQuoteData(quoteCode).then(function (response) {
            response = JSON.parse(window.localStorage.getItem("getQuoteData"));
        toggleLoader(false);
                console.log(response);
          tile_slider('tile-slider',response.payload.riskscoreOut.possibleValues,response.payload.riskscoreOut.score);
          var score = response.payload.riskscoreOut.score;
          var profile = response.payload.riskscoreOut.profile;
          document.getElementById('scoreId').innerHTML = score;
          document.getElementById('profileId').innerHTML = profile;
      //});
        }


    
});



/*document.addEventListener('DOMContentLoaded', function(){
	var sitemapDiv = document.getElementById('sitemap');
	if(document.getElementById('sitemap')){
	AppEvent.trigger(AppConstants.API_SELECTOR.BFL_HTML_SITEMAP.name).then(
			
		    function(response){
		        if(response){
		        	var stucture = document.createElement('table');
		        	for(var i = 0; i<response.length; i++){
		        		var row = document.createElement('tr');
		        		var col1 = document.createElement('td');
		        		var col2 = document.createElement('td');
		        		col1.innerHTML = response[i].substring(response[i].lastIndexOf('/')+1,response[i].length) +"  -->"; 
		        		col2.innerHTML = "<a href="+ window.urlObj.origin+response[i]+".html>"+window.urlObj.origin+response[i]+".html</a>";
		        		
		        		row.appendChild(col1);
		        		row.appendChild(col2);
		        		pageTitle 
		        			+"<td>"+"<a href="+ window.urlObj.origin+response[i]+'.html>'+window.urlObj.origin+response[i]+'.html'+'</a>'+"</td></tr>";
		        		tble.innerHTML = row;
		        		stucture.appendChild(row);
		        	}
		        	
		        	sitemapDiv.appendChild(stucture);
		        	toggleLoader(false);
		        }
		    }
		);
	}
})

*/

/* --------------- OFFER JS --------------------- */
function generateOTP() {
    resendCount += 1;
    var mobile = document.getElementById("mob-no").value;

    if (/^[6-9][0-9]{9}$/.test(mobile)) {
        showError("mob-noErrorMsg", "Enter Valid Mobile Number", false);
    }
    else {
        showError("mob-noErrorMsg", "Enter Valid Mobile Number", true);
    }
    var dd = document.getElementById("dobDt").value;
    var mm = document.getElementById("dobMonth").value;
    var yy = document.getElementById("dobYear").value;
    var dob = dd + "/" + mm + "/" + yy;
    //var endDateVal = getFormattedDate(dd, mm, yy);
    document.getElementById("dob").value = dob;
    var date = new Date();
    var currentDate = date.getFullYear();


    if (/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/.test(dob)) {
        showError("dobErrorMsg", "Enter Valid Date of Birth", false);
    }
    else {
        showError("dobErrorMsg", "Enter Valid Date of Birth", true);
    }

    if (currentDate - dob.split("/")[2] <= 23) {
        showError("dobErrorMsg", "Minimum Age Should be 23 years", true);
        return;
    } else {
        if (/^[6-9][0-9]{9}$/.test(mobile) && /^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/.test(dob)) {
        }
        else {
            return;
        }
    }
    dob =  dd+ "-" + mm + "-" + yy;
    var sendData = {
        "dateOfBirth": dob,
        "mobileNumber": mobile,
        "source": "resend"
    };
    triggerOfferGenerateOtp(dob, mobile);
    generateOtpAPICall(AppConstants.API_SELECTOR.OTP_GENERATE.name, sendData);
}

function generateOTPWidget(flag) {
    resendCount += 1;
    var mobile = document.getElementById("mob-no").value;

    if (/^[6-9][0-9]{9}$/.test(mobile)) {
        showError("mob-noErrorMsg", "Enter Valid Mobile Number", false);
    }
    else {
        showError("mob-noErrorMsg", "Enter Valid Mobile Number", true);
    }
    var dd = document.getElementById("dobDt1").value;
    var mm = document.getElementById("dobMonth1").value;
    var yy = document.getElementById("dobYear1").value;
    var dob = dd + "/" + mm + "/" + yy;
    //var endDateVal = getFormattedDate(dd, mm, yy);
    document.getElementById("dob1").value = dob;
    var date = new Date();
    var currentDate = date.getFullYear();


    if (/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/.test(dob)) {
        showError("dob1ErrorMsg", "Enter Valid Date of Birth", false);
    }
    else {
        showError("dob1ErrorMsg", "Enter Valid Date of Birth", true);
    }

    if (currentDate - dob.split("/")[2] <= 23) {
        showError("dob1ErrorMsg", "Minimum Age Should be 23 years", true);
        return;
    } else {
        if (/^[6-9][0-9]{9}$/.test(mobile) && /^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/.test(dob)) {
        }
        else {
            return;
        }
    }
    dob =  dd+ "-" + mm + "-" + yy;
    var sendData = {
    		"dateOfBirth": dob,
    		"mobileNumber": mobile,
    		"source": "resend"
        }

    if (flag == 1) {
       // triggerOfferGenerateOtp(dob, mobile);
    }
    triggerOfferGenerateOtp(dob, mobile);
    generateOtpAPICall(AppConstants.API_SELECTOR.OTP_GENERATE.name,sendData);

}


function setUserValueinForm() {
    var mobile = document.getElementById("mob-no").value;
    var dob = document.getElementById("dob1").value;
    console.log("mobile: " + mobile + " DOB: " + dob);
    document.getElementById("mobilePlaceHolder").innerHTML = mobile;
    document.getElementById("dobPlaceHolder").innerHTML = dob;
}
function setValueinFormPage() {
    var mobile = document.getElementById("mob-no").value;
    var dob = document.getElementById("dob").value;
    console.log("mobile: " + mobile + " DOB: " + dob);
    document.getElementById("mobilePlaceHolder").innerHTML = mobile;
    document.getElementById("dobPlaceHolder").innerHTML = dob;
}
function validateOTP(){
	  var mobile = document.getElementById("mob-no").value;
	  var otpValue = document.getElementById("password").value;
	  
	  var formData = new FormData();
	  formData.append("policyName", "PL");
	  formData.append("mobile", mobile);
	  formData.append("otp", otpValue);
	  
	  var sendData = new URLSearchParams(formData).toString();
	  AppEvent.trigger(AppConstants.API_SELECTOR.OTP_VALIDATE.name,	sendData).then(function (response) {
			console.log(response);
//			toggleLoader(false);
			
			if(response.status == "SUCCESS"){
				if(document.getElementById("myOffers")){
					console.log('myOffers');
					// formOfferWidget();
					
				}else if(document.getElementById("myOffersPage")){
					console.log('myOffersPage');
					formOfferPage();
					popup_close();
					toggleLoader(false);
					
				}
				return true;
			}
			
			 else if(response.errorOtpcode == "OTP_809"){ toggleLoader(false);
			 document.getElementById("password").value="";
         	 document.getElementById("otpValidatebutton").disabled = true;
         	 setTimeout(function(){
         		 document.getElementById("otpValidatebutton").disabled = false;
         	 }, 5000);
			 toastr.error(response.errorOtpcode + " : " + response.description,
			 '', { timeOut: 5000, "closeButton": true, "preventDuplicates": true
			 }); }
			 
			
		});
	  
	}

if(document.getElementById("resendOtp")){
	var button = document.getElementById("resendOtp");
	count = 0;
	button.onclick = function() {
		document.getElementById("password").value="";
		generateOTP();
		document.getElementById("password").disabled = false;
		document.getElementById("otpValidatebutton").disabled = false;
		inputInvalidCount = 0;
	count += 1;
	
		showError("passwordErrorMsg", "",false);
		showError("sendOTPErorMsg", "",false);
	
	};
	
}

if (document.getElementById("resendOtpWidget")) {
    var button = document.getElementById("resendOtpWidget");
    count = 0;
    button.onclick = function () {
    	document.getElementById("password").value="";
        generateOTPWidget();
        document.getElementById("password").disabled = false;
        document.getElementById("otpValidatebutton").disabled = false;
        inputInvalidCount = 0;
        count += 1;
            showError("passwordErrorMsg", "", false);
            showError("sendOTPErorMsg", "", false);
    };
}

function formOfferWidget(){
	var offerWidgetForm = document.getElementById("myOffers");
	if (offerWidgetForm) {
/* getFormData("myOffers", function (sendData) {*/
		 var mobile = document.getElementById("mob-no").value;
		  var otpValue = document.getElementById("password").value;
		  
		  var status = true;
		  if (/^[0-9]{1,6}$/.test(otpValue)) {
		      showError("passwordErrorMsg", "Enter Valid OTP Number", false);
		  }
		  else {
		      showError("passwordErrorMsg", "Enter Valid OTP Number", true);
		  } if (/^[0-9]{1,6}$/.test(otpValue)) {
		  }
		  else {
		      return
		  }
		  if (!status) { 
		      return
		  }
		  var dateOfBirth = document.querySelector("#dobPlaceHolder").innerText.trim().split("/").join("-");
		  var sendData = {
	        		"dateOfBirth": dateOfBirth,
	        		"mobileNumber": mobile,
	        		"otp": otpValue,
	        		"source": "website"
	        };
	        otpValidationAPICall(AppConstants.API_SELECTOR.OTP_VALIDATE.name, sendData);
	}
}
function formatDate(date) {
    console.log("in format ", date);
    var date = new Date(date);
    var formattedDate = date.toLocaleDateString('en-GB', {
        year: 'numeric',month: 'short',day: 'numeric'
    }).replace(/ /g, '-');
    if(formattedDate.toLowerCase().includes("sept")){
        formattedDate.toLowerCase().replace("sept","Sep");
    }
    return formattedDate;
}

var invalidCount = 0;
var inputInvalidCount = 0;
var resendCount = 0;

function formOfferPage() {
    console.log('myOffersPage');
    var myOffersPageForm = document.getElementById("myOffersPage");
    if (myOffersPageForm) {
        var mobile = document.getElementById("mob-no").value;
        var otpValue = document.getElementById("password").value;
        var status = true;
        if (/^[0-9]{1,6}$/.test(otpValue)) {
            showError("passwordErrorMsg", "Enter Valid OTP Number", false);
        }
        else {
            showError("passwordErrorMsg", "Enter Valid OTP Number", true);
        } if (/^[0-9]{1,6}$/.test(otpValue)) {
        }
        else {
            return
        }
        if (!status) {
            return
        }
        var dateOfBirth = document.querySelector("#dobPlaceHolder").innerText.trim().split("/").join("-");
        var sendData = {
        		"dateOfBirth": dateOfBirth,
        		"mobileNumber": mobile,
        		"otp": otpValue,
        		"source": "website"
        };
        otpValidationAPICall(AppConstants.API_SELECTOR.OTP_VALIDATE.name, sendData);
    }
}

/*Onload Function for Offer*/
document.addEventListener("DOMContentLoaded", function () { 
	
	var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
	/*var utmData = window.utmParams;
	var utmString = "utm_source="+utmData.utmSource+"&utm_medium="+utmData.utmMedium+"&utm_campaign="+utmData.utmCampaign+"&utm_term="+utmData.utmTerm+"&utm_content="+utmData.utmContent;*/
	var utmString = utm;
    /*Offer Expiry Date Lock for 24 Lock*/
    var offerExpiryDate = new Date(window.localStorage.getItem("expiryTime"))
    if ((offerExpiryDate.getTime() + (24 * 60 * 60 * 1000 * 7)) < (new Date()).getTime()) {
        window.localStorage.removeItem("myOfferRequest");
        window.localStorage.removeItem("myOfferResponse");
        window.localStorage.removeItem("myOfferError");
        window.localStorage.removeItem("expiryTime");
        console.log("new Offer")
    } else {
        console.log("Default Offer")
    }
    
    /*No Offer Redirection URL*/
    var offerFormRedirecrURL = document.getElementById("offerFormRedirecrURL");
	var link = document.getElementById("link");
	if(window.localStorage.getItem("myOfferError")){
		window.myOfferError = JSON.parse(window.localStorage.getItem("myOfferError"))
		$(".form1.offer-inner").removeClass("active");
		$(".form5.offer-inner").addClass("active");
		$("#offerRateContainer").hide();

        if(window.location.pathname.indexOf('.is-mobile') > -1){
						   var offerismobiletrue = "1";
						}else
						{
							   var offerismobilefalse = "0";
						}
					
        try{
        	if(offerismobiletrue == 1){
        		if(urlParams){
        			var utm_params = window.urlObj.search; 
        			if(utm_params.includes("&nav_src")){
        				window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
        			}
        			else if(utm_params.includes("?nav_src")){
                		window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utmString;
        			}
        			else{
        				window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utm_params;
        			}
        			//window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + urlParams;
        		}
        		else{
        			window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utmString;
        		}
    			//window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html';
    		}else{
    			if(urlParams){
    				var utm_params = window.urlObj.search;
    				if(utm_params.includes("&nav_src")){
    					window.location.href = offerFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
    				}
    				else if(utm_params.includes("?nav_src")){
                		window.location.href = offerFormRedirecrURL.value + utmString;
        			}
    				else{
    					window.location.href = offerFormRedirecrURL.value + utm_params;
    				}
    			}
    			else{
            		window.location.href = offerFormRedirecrURL.value + utmString;
    			}
    			//window.location.href = offerFormRedirecrURL.value;	
    		}
        }
        catch(err){
        	console.log(err);
        }
		
		
	}
	/*MY offer from LocalStorage and Populate Data*/
	if (window.localStorage.getItem("myOfferResponse")) {
		window.myOfferResponse = JSON.parse(window.localStorage.getItem("myOfferResponse"))
		if(window.myOfferResponse.payload.offerDetailsResponse.offerDetails.length > 0){
        	$(".form1.offer-inner").removeClass("active");
            $(".form3.offer-inner").addClass("active");
            $("#offerRateContainer").hide();
        }
		else{
			$(".form1.offer-inner").removeClass("active");
		}
	
		if (window.myOfferResponse.payload && window.myOfferResponse.payload.offerDetailsResponse.offerDetails.length > 0) {
			if(link){
				if(urlParams){
					var utm_params = window.urlObj.search; 
					if(utm_params.includes("&nav_src")){
						window.location.href = link.value + "." + window.myOfferResponse.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
					}
					else{
						window.location.href = link.value + "." + window.myOfferResponse.payload.offerQID + ".html" + utm_params;
					}
				}
				else{
					window.location.href = link.value + "." + window.myOfferResponse.payload.offerQID + ".html" + utmString;
				}
				//window.location.href = link.value + "." + window.myOfferResponse.payload.offerQID + ".html";
			}
			
			/*Check for product value from pageConfig and Update the Match the offer*/
			var pageproductVal = $("#productType").val();

			var items = window.myOfferResponse.payload.offerDetailsResponse.offerDetails;
				//for (const item of items) {
			for(var i=0;i<items.length;i++){
				  if (pageproductVal && items[i].productCode === pageproductVal) {
				    
				    var data = items[i];
				    
				    if(window.location.pathname.indexOf('.is-mobile') > -1){
						   var offerismobiletrue = "1";
						   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
						}else
						{
							   var offerismobilefalse = "0";
							   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
						}
				    //offerFeatureTemplate(data,offerismobiletrue);
				    break;
				  }
				  else{
						/*This will set the ByDeafult value of the Offer page*/	
						var data = window.myOfferResponse.payload.offerDetailsResponse.offerDetails[0]
						if(window.location.pathname.indexOf('.is-mobile') > -1){
							   var offerismobiletrue = "1";
							   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
							}else
							{
								   var offerismobilefalse = "0";
								   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
							}
						//offerFeatureTemplate(data,offerismobiletrue);
				  }
				  
				  
				}			
				if(window.location.pathname.indexOf('.is-mobile') > -1){
				   var offerismobiletrue = "1";
				}else
				{
					   var offerismobilefalse = "0";
				}

			if(offerismobiletrue == 1){
				if(urlParams){
					var utm_params = window.urlObj.search; 
					if(utm_params.includes("&nav_src")){
						oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + window.myOfferResponse.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
					}
					else{
						oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + window.myOfferResponse.payload.offerQID + ".html" + utm_params;
					}
				}
				else{
					oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + window.myOfferResponse.payload.offerQID + ".html" +utmString;
				}
				//oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + window.myOfferResponse.payload.offerQID + ".html"
			}else {
				if(urlParams){
					var utm_params = window.urlObj.search;
					if(utm_params.includes("&nav_src")){
						oldurl = $("#viewAllOffersBtn").attr("href") + "." + window.myOfferResponse.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
					}
					else{
						oldurl = $("#viewAllOffersBtn").attr("href") + "." + window.myOfferResponse.payload.offerQID + ".html" + utm_params;
					}
				}
				else{
					oldurl = $("#viewAllOffersBtn").attr("href") + "." + window.myOfferResponse.payload.offerQID + ".html" + utmString;
				}
				//oldurl = $("#viewAllOffersBtn").attr("href") + "." + window.myOfferResponse.payload.offerQID + ".html";
			}
			$("#viewAllOffersBtn").attr("href",oldurl);
			btnRedirect();
			$("#noOfferMsg").hide();
			$("#offerDetails").show(); 
		}
		else {
			$(".form2.offer-inner").removeClass("active");
			$(".form5.offer-inner").addClass("active");
			$("#noOfferMsg").show();
			$("#offerDetails").hide();
			$("#viewAllOffersBtn").hide();
		}
	}
// formOfferWidget();
	
	
	$("#noOfferState").hide()
	$("#refreshIcon").css("width", "15px");
	var myOffersPageForm = document.getElementById("myOffersPage")
	if (myOffersPageForm) {
		try{
			if (response.payload.offerQID) {
				window.localStorage.setItem("myOfferRequest", sendData)
				window.localStorage.setItem("expiryTime", new Date())
				window.localStorage.setItem("myOfferResponse", JSON.stringify(response))
				window.location.href = link + "." + response.payload.offerQID + ".html";
			}
			var jsonData = response;
			personalDetails(jsonData);
			offersSwiper(jsonData);
			toggleLoader(false)
		}
		catch(err){
			console.log(err);
		}
	}

// formOfferPage();
	function personalDetails(JsonData) {
		var offerNav = document.getElementById("offerNav");
		var personalDetailsTemplate = document.getElementById("personalDetailsTemplate").cloneNode(true);
		var cloneElement = personalDetailsTemplate.content;
		cloneElement.querySelector("#personname").innerHTML = JsonData.personalDetails.firstName || "";
		// cloneElement.querySelector("#personname").innerHTML=JsonData.username;
		offerNav.appendChild(contentElement);
	}
})


function hideOfferFields(){
	if(document.getElementById('myOffers')){
		document.getElementById("generateOtp").disabled = true;
	}
	if(document.getElementById('getOtp1')){
		document.getElementById('resendOtpWidget').disabled = true;
		document.getElementById("password").value = "";
		document.getElementById("password").disabled = true;
		document.getElementById("otpValidatebutton").disabled = true;
	}
	if(document.getElementById('myOffersPage')){
		document.getElementById('sendOtpButton').disabled = true;
	}
	if(document.getElementById('getOtp')){
		document.getElementById('resendOtp').disabled = true;
		document.getElementById("password").value = "";
		document.getElementById("password").disabled = true;
		document.getElementById("otpValidatebutton").disabled = true;
	}
}

function generateOtpAPICall(selector,sendData){
	var myOffersPageForm = document.getElementById("offerFormContainer");
	var myOfferWidgetForm = document.getElementById("offerCOntainer");
	var gtlOfferPageForm = document.getElementById("gtlOffersPage");
	AppEvent.trigger(selector,sendData).then(function (response) {
	            toggleLoader(false);
	            if (response.status == 'SUCCESS') {
	            	if(myOffersPageForm){
	            		localStorage.setItem("mobileNumber",sendData.mobile);
	            		setValueinFormPage();
	                    popup_open("#myPopup-get-otp");
	                    showError("sendOTPErorMsg", "", false);
	            	}
	            	
	            	if(myOfferWidgetForm){
	            		console.log("inside success");
	            		localStorage.setItem("mobileNumber",sendData.mobile);
	                    $(".form1.offer-inner").removeClass("active");
	                    $(".form2.offer-inner").addClass("active");
	                    $(".form1.offer-inner").hide();
	                    $(".form2.offer-inner").show();
	                    setUserValueinForm();
	                    showError("sendOTPErorMsg", "", false);
	            	}
	                    /*setValueinFormPage();
	                    popup_open("#myPopup-get-otp");
	                    showError("sendOTPErorMsg", "", false);*/
	            	
	            	if(gtlOfferPageForm) {
	            		mobNo = document.getElementById("gtl-mob-no").value;
	            		localStorage.setItem("mobileNumber", mobNo);
	            		setValueinGTLFormPage(mobNo);
	                    popup_open("#gtlPopup-get-otp");
	                    showError("sendGTL_OTPErorMsg", "", false);
	            	}

	            } else {
	            	
	            	if(response.errorBean[0].erroBean.errorCode == "OTP_817") {
	            		if(myOffersPageForm){
	            			document.getElementById('sendOtpButton').disabled = true;
		            		
		            		if (document.getElementById("getOtp")) {
		                        document.getElementById("resendOtp").disabled = true;
		                        document.getElementById("otpValidatebutton").disabled = true;
		                        document.getElementById("password").disabled = true;
		                    }
		            		toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
			                    timeOut: 5000,
			                    "closeButton": true,
			                    "preventDuplicates": true
			                });
	            		}
	            		
	            		if(myOfferWidgetForm) {
	            			document.getElementById('generateOtp').disabled = true;
	            			toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
			                    timeOut: 5000,
			                    "closeButton": true,
			                    "preventDuplicates": true
			                });
	            		}
	            		
	            		if(gtlOfferPageForm) {
	            			document.getElementById('gtlSendOtpButton').disabled = true;

	                        if (document.getElementById("getOtp")) {
	                            document.getElementById("gtlResendOtp").disabled = true;
	                            document.getElementById("gtlOTPValidatebutton").disabled = true;
	                            document.getElementById("gtl-password").disabled = true;
	                        }
	                        toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
			                    timeOut: 5000,
			                    "closeButton": true,
			                    "preventDuplicates": true
			                });
	            		}
	            	}
	            	else{
	            		console.log('enter valid otp');
		                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
		                    timeOut: 5000,
		                    "closeButton": true,
		                    "preventDuplicates": true
		                });
	            	}
	            }
	        }).catch(function(err){
	        	toggleLoader(false);
	        })
}

function otpValidationAPICall(selector,ajaxObj){
	AppEvent.trigger(selector, ajaxObj).then(function (response) {
        console.log(response);
        var myOffersPageForm = document.getElementById("offerFormContainer");
    	var myOfferWidgetForm = document.getElementById("offerCOntainer");
    	var gtlOfferPageForm = document.getElementById("gtlOffersPage"); 
        if (response.status == "SUCCESS") {
        	window.sessionStorage.setItem("website_ss_4", response.payload.tokens[0].token);
        	if(myOffersPageForm){
        		var link = document.getElementById("link").value;
                var mobile = document.getElementById("mob-no").value;
                var dob = document.getElementById("dob").value;
                var dobformat = dob.split(/\//);
                var dobformatval = [dobformat[1], dobformat[0], dobformat[2]].join('/');
                console.log("Changed format ", dobformatval);
                var dobVal = formatDate(dobformatval);
                var sendData = {
                	"mobileNo": mobile,
                	"dob": dobVal
                }
                triggerOfferSubmitButton(dob,mobile);
                
                offerDetailAPICall(AppConstants.API_SELECTOR.OFFER_DETAILS_PARTNER.name,sendData);
        	}
        	
        	if(myOfferWidgetForm && myOfferWidgetForm.classList.contains("active")){
//				var link = document.getElementById("link").value;
				  var mobile = document.getElementById("mob-no").value;
				  var dob = document.getElementById("dob1").value;
				  
				  var dobformat = dob.split(/\//);
				  var dobformatval = [ dobformat[1], dobformat[0], dobformat[2] ].join('/');
				  console.log("Chnaged format ",dobformatval);
				  
				  var dobVal = formatDate(dobformatval);
				  var formData = new FormData();
				  formData.append("policyName", "PL");
				  formData.append("mobileNo", mobile);
				  formData.append("dob", dobVal);

				  if(urlObj.pathname.indexOf('.is-mobile') > -1){
					  formData.append("is-mobile", "1");
					}else
					{
						  formData.append("is-mobile", "0");
					}

				  console.log("calling offer page");
				  //	var sendData = new URLSearchParams(formData).toString();
				  	var sendData = {
				  		"mobileNo": mobile,
				  		"dob": dobVal
				  	}

				  	triggerOfferSubmitButton(dob,mobile);
					offerDetailAPICall(AppConstants.API_SELECTOR.OFFER_DETAILS_PARTNER.name,sendData)
        	}
        	
        	if(gtlOfferPageForm && !myOfferWidgetForm.classList.contains("active")) {
                var redirectLink = document.getElementById("gtl-link").value;
        		var mobile = document.getElementById("gtl-mob-no").value;
                var gtlDOBVal = document.getElementById("gtl-dob").value;
                var offerRedirectUrl;
                var dobformat = gtlDOBVal.split(/\//);
                var dobformatval = [dobformat[1], dobformat[0], dobformat[2]].join('/');
                var gtldobVal = formatDate(dobformatval);
                
                
                var sendData = {
					"mobileNo": mobile,
					"dob": gtldobVal
				}
                
                triggerOfferSubmitButton(gtlDOBVal,mobile);
                offerDetailAPICall(AppConstants.API_SELECTOR.OFFER_DETAILS_PARTNER.name, sendData);
                
        	}
        } 
        else{
        	data = response;
        	toggleLoader(false);
            if (data.errorBean[0].errorCode != "OTP_818") {
            	/*document.getElementById("password").value="";
            	 document.getElementById("otpValidatebutton").disabled = true;
            	 setTimeout(function(){
            		 document.getElementById("otpValidatebutton").disabled = false;
            	 }, 5000);*/
            	 showError("otpFormErrorMsg", "You've exhausted all 5 attempts to enter the correct OTP. Please try after 10 minutes", true);
            	 
            	 if(data.errorBean[0].errorCode == "OTP_809"){
            		 toggleLoader(false);
            		 document.getElementById("password").value="";
                	 document.getElementById("otpValidatebutton").disabled = true;
                	 setTimeout(function(){
                		 document.getElementById("otpValidatebutton").disabled = false;
                	 }, 5000);
                     toastr.error(data.errorBean[0].errorCode + " : " + data.errorBean[0].errorMessage, '', {
                         timeOut: 5000,
                         "closeButton": true,
                         "preventDuplicates": true
                     });
            	 }
            	 else{
            		 toggleLoader(false);
            		 document.getElementById("password").value="";
                	 document.getElementById("otpValidatebutton").disabled = true;
                	 setTimeout(function(){
                		 document.getElementById("otpValidatebutton").disabled = false;
                	 }, 5000);
                     popup_close();
                     toastr.error(data.errorBean[0].errorCode + " : " + data.errorBean[0].errorMessage, '', {
                         timeOut: 5000,
                         "closeButton": true,
                         "preventDuplicates": true
                     });
            	 }
            	 
                
            }
            else if (data.errorBean[0].errorCode === "OTP_818") {
    			toggleLoader(false);
    			document.getElementById('resendOtp').disabled = true;
    			document.getElementById("otpValidatebutton").disabled = true;
    			document.getElementById("password").value = "";
    			document.getElementById("password").disabled = true;
    			
    			showError("otpFormErrorMsg", "You've exhausted all 5 attempts to enter the correct OTP. Please try after 10 minutes", true);
    			toastr.remove();
    			
    		}
        }
    }).catch(function (err) {
        toggleLoader(false);
    })
}

function offerDetailAPICall(selector,sendData){
	var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
	/*var utmData = window.utmParams;
	var utmString = "utm_source="+utmData.utmSource+"&utm_medium="+utmData.utmMedium+"&utm_campaign="+utmData.utmCampaign+"&utm_term="+utmData.utmTerm+"&utm_content="+utmData.utmContent;*/
	var utm_params = window.urlObj.search;
	var utmString = utm;
	
	var myOffersPageForm = document.getElementById("offerFormContainer");
	var myOfferWidgetForm = document.getElementById("offerCOntainer");
	var gtlOfferPageForm = document.getElementById("gtlOffersPage");
	
	if(myOffersPageForm){
		 var mobile = document.getElementById("mob-no").value;
         var dob = document.getElementById("dob").value;
         var link = document.getElementById("link").value;
		AppEvent.trigger(selector,sendData).then(function (response) {
			localStorage.setItem("ResponseData",JSON.stringify(response));
				if(response.status == "SUCCESS"){
					getOfferURLCall(response,mobile,dob,sendData,"",link);
				}
				else{
					toggleLoader(false);
					data = JSON.parse(localStorage.getItem("ResponseData"));
	                if (data.errorBean[0].errorCode) {
	                	
	                    var offerFormRedirecrURL = document.getElementById("offerFormRedirecrURL");
	                    if(window.isMobile ==1 ){
	                    	if(urlParams){
	                    		if(utm_params.includes("&nav_src")){
	                    			window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
	                    		}
	                    		else{
	                    			window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utm_params;
	                    		}
	                    	}
	                    	else{
	    	            		window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utmString;
	                    	}
//	            			window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html';
	            		}else{
	            			if(urlParams){
	            				if(utm_params.includes("&nav_src")){
	            					window.location.href = offerFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
	            				}
	            				else{
	            					window.location.href = offerFormRedirecrURL.value + utm_params;
	            				}
	            			}
	            			else{
	            				window.location.href = offerFormRedirecrURL.value + utmString;
	            			}	
	            		}
	                    //window.location.href = offerFormRedirecrURL.value;
	                    window.localStorage.setItem("myOfferError", JSON.stringify(data));
	                    window.localStorage.setItem("expiryTime", new Date());
	                    localStorage.removeItem("ResponseData");
	                    $("#noOfferState").show()
	                    $("#offerFormContainer").hide()
	                    popup_close();
	                }
	                else if (data.errorCode) {
	                    toggleLoader(false);
	                    toastr.error(data.errorCode + " : " + data.description, '', {
	                        timeOut: 5000,
	                        "closeButton": true,
	                        "preventDuplicates": true
	                    });
	                }
				}
	     }).catch(function (err) {
	         toggleLoader(false);
	     })
	}
	
	if(myOfferWidgetForm && myOfferWidgetForm.classList.contains("active")){
		var mobile = document.getElementById("mob-no").value;
		var dob = document.getElementById("dob1").value;
		AppEvent.trigger(selector,sendData).then(function (response) {
			localStorage.setItem("ResponseData",JSON.stringify(response));
			if(response.status == "SUCCESS"){
				var ismobile;
				if(urlObj.pathname.indexOf('.is-mobile') > -1){
					ismobile =  "1";
				}else
				{
					ismobile = "0";
				}
				
				getOfferURLCall(response,mobile,dob,sendData,ismobile,"")
			}
			else{
				data = JSON.parse(localStorage.getItem("ResponseData"));
				if (data.errorBean[0].errorCode) {
					$(".form2.offer-inner").removeClass("active");
					$(".form5.offer-inner").addClass("active");
					$("#noOfferMsg").show();
					$("#availOfferBtn").html("Apply Now")
					$("#offerDetails").hide();
					$("#viewAllOffersBtn").hide();
					window.localStorage.setItem("myOfferError", JSON.stringify(data))
					window.localStorage.setItem("expiryTime", new Date())
					localStorage.removeItem("ResponseData");
					toggleLoader(false)
				}
				else if (data.errorCode) {
					toastr.error(data.errorCode + " : " + data.description, '', {
						timeOut: 5000,
						"closeButton": true,
						"preventDuplicates": true
					});
				}
			}
		})
	}
	
	
	if(gtlOfferPageForm && !myOfferWidgetForm.classList.contains("active")) {
		var mobile = document.getElementById("gtl-mob-no").value;
		var dob = document.getElementById("gtl-dob").value;
		
		AppEvent.trigger(selector,sendData).then(function (response) {
			localStorage.setItem("ResponseData",JSON.stringify(response));
			response = JSON.parse(localStorage.getItem("ResponseData"));
			if(response.status == "SUCCESS") {
				getOfferURLCall(response,mobile,dob,sendData,"","");
				//getOfferURLCall("o" + generateRandom(),response,mobile,dob,"")
			}
			else {
				data = JSON.parse(localStorage.getItem("ResponseData"));
				if(data.authToken) {
					window.sessionStorage.setItem("SS_1", data.authToken)
	                window.sessionStorage.setItem("SS_4", data.guardKey)
	                document.cookie = "SS_1=" + data.authToken
	                document.cookie = "SS_4=" + data.guardKey
				}
                
                toggleLoader(false);
                if (data.errorBean[0].errorCode) {
                    var gtlofferFormRedirecrURL = document.getElementById("gtlofferFormRedirecrURL");
                    if (window.isMobile == 1) {
                    	if(urlParams){
                    		if(utm_params.includes("&nav_src")){
                    			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                    		}
                    		else{
                    			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params;
                    		}
                    	}
                    	else{
                    		window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utmString;
                    	}
                        //window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + urlParams;
                    } else {
                    	if(urlParams){
                    		if(utm_params.includes("&nav_src")){
                    			window.location.href = gtlofferFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                    		}
                    		else{
                    			window.location.href = gtlofferFormRedirecrURL.value + utm_params;
                    		}
                    	}
                    	else{
                    		window.location.href = gtlofferFormRedirecrURL.value + utmString;
                    	}
                        //window.location.href = gtlofferFormRedirecrURL.value + urlParams;
                    }
                    window.localStorage.setItem("myOfferError", JSON.stringify(data));
                    window.localStorage.setItem("expiryTime", new Date());
                    localStorage.removeItem("ResponseData");
                    $("#noOfferState").show()
                    $("#offerFormContainer").hide()
                    popup_close();
                } else if (data.errorCode) {
                    toggleLoader(false);
                    toastr.error(data.errorCode + " : " + data.description, '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });


                }
			}
		});
	}
}



function getOfferURLCall(response,mobile,dob,sendData,ismobile,link) {
	var responseData = JSON.stringify(response);
	var mobile = mobile;
	
	var dobformat = dob.split(/\//);
    var dobformatval = [dobformat[1], dobformat[0], dobformat[2]].join('/');
    console.log("Changed format ", dobformatval);

    var dobVal = formatDate(dobformatval);
	var isMobile = ismobile != ""? ismobile : window.isMobile;
	$.ajax({
		url: AppConstants.offerMaster_URI+'.'+AppConstants.EXTENSION,
		type: 'POST',
		data: {
			responseData : responseData,
			mobile : mobile,
			dob : dobVal,
			isMobile : isMobile
		},
		success: function(responseValue) {
			//console.log(responseValue);
			OfferShowCall(responseValue,sendData,link);
		}
		
	})
	
}

function getURLFromProductType(offerNode,mobile,dob){
	var finalURL = "";
	var baseURL = API_ENDPOINT_URL;
	var identifier = offerNode.urlId;
	var paramsFromMaster = offerNode.applyNowRedirection;
	var params;
	var dobArray = dob.split("/");
	dateOfBirth = dobArray[2]+'-'+dobArray[1]+'-'+dobArray[0];
	if(window.isMobile == 1){
		params = paramsFromMaster + "&mob=" + mobile + "&dob="+ dateOfBirth + "&isMobile=1";
	}
	else{
		params = paramsFromMaster + "&mob=" + mobile + "&dob="+ dateOfBirth;
	}
	
	return finalURL = baseURL + identifier + "?" + params;
}

function OfferShowCall(responseData,sendData,link) {
	
	var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
	/*var utmData = window.utmParams;
	var utmString = "utm_source="+utmData.utmSource+"&utm_medium="+utmData.utmMedium+"&utm_campaign="+utmData.utmCampaign+"&utm_term="+utmData.utmTerm+"&utm_content="+utmData.utmContent;*/
	var utmString = utm;
	var utm_params = window.urlObj.search;
	console.log("responseData :"+ responseData);
	if(typeof(responseData) == "string"){
		response = JSON.parse(responseData);
	}
	else{
		response = responseData;
	}
	console.log("response :"+ response);
	//response = responeData;
	var myOffersPageForm = document.getElementById("offerFormContainer");
	var myOfferWidgetForm = document.getElementById("offerCOntainer");
	var gtlOfferPageForm = document.getElementById("gtlOffersPage");
	if(myOffersPageForm){
		if (response.payload && response.payload.offerDetailsResponse.offerDetails.length > 0) {
    		window.localStorage.setItem("offerCount",response.payload.offerDetailsResponse.offerDetails.length);
        if (response.payload.offerQID) {
        	if(response.payload.authToken){
	    		 window.sessionStorage.setItem("SS_1", response.payload.authToken)
				 window.sessionStorage.setItem("SS_4", response.payload.guardKey)
				 document.cookie = "SS_1=" + response.payload.authToken 
           	     document.cookie = "SS_4=" + response.payload.guardKey
	    	}  
            window.localStorage.setItem("myOfferRequest", JSON.stringify(sendData));
            window.localStorage.setItem("expiryTime", new Date());
            window.localStorage.setItem("myOfferResponse", JSON.stringify(response));
            localStorage.removeItem("ResponseData");
            
            if(window.isMobile ==1 ){
            	if(urlParams){
            		var utm_params = window.urlObj.search;
            		if(utm_params.includes("&nav_src")){
            			window.location.href = link + ".is-mobile." + response.payload.offerQID + '.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
            		}
            		else{
            			window.location.href = link + ".is-mobile." + response.payload.offerQID + '.html' + utm_params;
            		}
            	}
            	else{
            		window.location.href = link + ".is-mobile." + response.payload.offerQID + '.html' + utmString;
            	}
                //window.location.href = link + ".is-mobile." + response.payload.offerQID + '.html';
    		}else{
    			if(urlParams){
    				var utm_params = window.urlObj.search;
    				if(utm_params.includes("&nav_src")){
    					window.location.href = link + "." + response.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
    				}
    				else{
    					window.location.href = link + "." + response.payload.offerQID + ".html" + utm_params;
    				}
    			}
    			else{
    				window.location.href = link + "." + response.payload.offerQID + ".html" + utmString;
    			}
                //window.location.href = link + "." + response.payload.offerQID + ".html";
    		}
        }
    	}
    	else{
    		var offerFormRedirecrURL = document.getElementById("offerFormRedirecrURL");
            if(window.isMobile ==1 ){
            	if(urlParams){
            		var utm_params = window.urlObj.search;
            		if(utm_params.includes("&nav_src")){
            			window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
            		}
            		else{
            			window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utm_params;
            		}
            	}
            	else{
            		window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html' + utemString;
            	}
    			//window.location.href = offerFormRedirecrURL.value.substring(0,offerFormRedirecrURL.value.indexOf('.html'))+'.is-mobile.html';
    		}else{
    			if(urlParams){
    				var utm_params = window.urlObj.search;
    				if(utm_params.includes("&nav_src")){
    					window.location.href = offerFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
    				}
    				else{
    					window.location.href = offerFormRedirecrURL.value + utm_params;
    				}
    			}
    			else{
    				window.location.href = offerFormRedirecrURL.value + utmString;
    			}
    			//window.location.href = offerFormRedirecrURL.value;	
    		}
    	}
        var jsonData = response;
        personalDetails(jsonData);
        offersSwiper(jsonData);
//        toggleLoader(false)
	}
	
	if(myOfferWidgetForm){
		console.log(response);
		console.log("inside offer page");
		$(".form1.offer-inner").removeClass("active");
		$(".form3.offer-inner").addClass("active");
		$("#offerRateContainer").hide();
		
		if (response.payload && response.payload.offerDetailsResponse.offerDetails.length > 0) {	
			if(response.payload.authToken){
	    		 window.sessionStorage.setItem("SS_1", response.payload.authToken)
				 window.sessionStorage.setItem("SS_4", response.payload.guardKey)
				 document.cookie = "SS_1=" + response.payload.authToken 
          	     document.cookie = "SS_4=" + response.payload.guardKey
	    	}  
			
			window.localStorage.setItem("myOfferRequest", sendData)
			window.localStorage.setItem("expiryTime", new Date())
			window.localStorage.setItem("myOfferResponse", JSON.stringify(response))
			localStorage.removeItem("ResponseData");
			var data = response.payload.offerDetailsResponse.offerDetails[0]
			var featuresTemplate = '';
			if (data.offerFeatures.feature1) {
				featuresTemplate += ' <li class= "list-item" ><div class="desc"><p>' + data.offerFeatures.feature1 + '</p></div></li> '
			}
			if (data.offerFeatures.feature2) {
				featuresTemplate += ' <li class= "list-item" ><div class="desc"><p>' + data.offerFeatures.feature2 + '</p></div></li> '
			}
			if (data.offerFeatures.feature3 != " ") {
				featuresTemplate += ' <li class= "list-item" ><div class="desc"><p>' + data.offerFeatures.feature3 + '</p></div></li> '
			}
			if(data.prospectDetailsObject == null){
		        $("#userName").text("");
		       }else{
		       $("#userName").text(data.prospectDetailsObject.personalDetails.firstName || "");
		       }							
	
			$("#offerTitle").text(data.offerTitle || "");
			$("#offerValue").html("&#8377;" + (data.offerAmount.toLocaleString() || ""));
			$("#offerWidgetFeatureContainer").html(featuresTemplate)
			$("#offerRate").html("" + (data.offerFinalRate || "") + "%");
			
			offerConfigForHealthTerm(data);
			
			if(urlParams){
				if(utm_params.includes("&nav_src")){
					$("#availOfferBtn").attr("href", data.offerURL+"&offerId="+data.offerId + "&" + utm_params.substring(1,utm_params.indexOf("&nav_src")));
				}
				else{
					$("#availOfferBtn").attr("href", data.offerURL+"&offerId="+data.offerId + "&" + utm_params.substring(1,utm_params.length));
				}
			}
			else{
				if(utmString.length > 0){
					$("#availOfferBtn").attr("href", data.offerURL+"&offerId="+data.offerId + "&" + utmString.substring(1,utmString.length));
				}
				else{
					$("#availOfferBtn").attr("href", data.offerURL+"&offerId="+data.offerId);
				}
				
			}
			//$("#availOfferBtn").attr("href", data.offerURL+"&offerId="+data.offerId);
			
			var oldurl = $("#viewAllOffersBtn").attr("href") + "." + response.payload.offerQID + ".html";
			
			  if(urlObj.pathname.indexOf('.is-mobile') > -1){
				   var offerismobiletrue = "1";
				}else
				{
					   var offerismobilefalse = "0";
				}
			  
			if(offerismobiletrue == 1){
				if(urlParams){
					if(utm_params.includes("&nav_src")){
						oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + response.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
					}
					else{
						oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + response.payload.offerQID + ".html" + utm_params;
					}
				}
				else{
					oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + response.payload.offerQID + ".html" + utmString;
				}
			}else {
				if(urlParams){
					if(utm_params.includes("&nav_src")){
						oldurl = $("#viewAllOffersBtn").attr("href") + "." + response.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
					}
					else{
						oldurl = $("#viewAllOffersBtn").attr("href") + "." + response.payload.offerQID + ".html" + utm_params;
					}
				}
				else{
					oldurl = $("#viewAllOffersBtn").attr("href") + "." + response.payload.offerQID + ".html" + utmString;
				}
			}
			$("#viewAllOffersBtn").attr("href",oldurl);
			
			//$("#viewAllOffersBtn").attr("href", $("#viewAllOffersBtn").attr("href") + "." + response.payload.offerQID + ".html");
			btnRedirect();
			$("#noOfferMsg").hide();
			$("#offerDetails").show();
			$(".form2.offer-inner").removeClass("active");
		}
		else {
			$(".form2.offer-inner").removeClass("active");
			$(".form3.offer-inner").addClass("active");
			$("#noOfferMsg").show();
			$("#offerDetails").hide();
		}
		toggleLoader(false)
	}
	
	if(gtlOfferPageForm && !myOfferWidgetForm.classList.contains("active")) {
		var prodType;

	    if (document.getElementById("gtlProductType")) {
	        prodType = document.getElementById("gtlProductType").value;
	    }
	    var redirectLink = document.getElementById("gtl-link").value;
        if (response.payload.offerQID) {
        	
        	if(response.payload.authToken){
	    		 window.sessionStorage.setItem("SS_1", response.payload.authToken)
				 window.sessionStorage.setItem("SS_4", response.payload.guardKey)
				 document.cookie = "SS_1=" + response.payload.authToken 
          	     document.cookie = "SS_4=" + response.payload.guardKey
	    	}  
        	
            window.localStorage.setItem("myOfferRequest", sendData);
            window.localStorage.setItem("expiryTime", new Date());
            window.localStorage.setItem("myOfferResponse", JSON.stringify(response));

            var totalOffer = response.payload.offerDetailsResponse.offerDetails.length;
            var gtlOfferDetails = response.payload.offerDetailsResponse.offerDetails;
            if (response.payload.offerDetailsResponse.offerDetails.length > 0) {
                console.log("Total Offer" + totalOffer);
                gtlOfferDetails.forEach(function (items) {
                    if (items.offerStatus == 1 || items.offerStatus == 2) {
                        if (items.productCode == prodType) {
                            if (communityTabName) {
                                if (window.isMobile == 1) {
                                	if(urlParams){
                                		if(utm_params.includes("&nav_src")){
                                			window.location.href = redirectLink + ".is-mobile." + response.payload.offerQID + '.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                                		}
                                		else{
                                			window.location.href = redirectLink + ".is-mobile." + response.payload.offerQID + '.html' + utm_params;
                                		}
                                	}else{
                                		window.location.href = redirectLink + ".is-mobile." + response.payload.offerQID + '.html' + utmString;
                                	}
                                    
                                } else {
                                	if(urlParams){
                                		if(utm_params.includes("&nav_src")){
                                			window.location.href = redirectLink + "." + response.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                                		}
                                		else{
                                			window.location.href = redirectLink + "." + response.payload.offerQID + ".html" + utm_params;
                                		}
                                	}
                                	else{
                                		window.location.href = redirectLink + "." + response.payload.offerQID + ".html" + utmString;
                                	}
                                }
                            } else {
                            	if(urlParams){
                            		if(utm_params.includes("&nav_src")){
                            			offerRedirectUrl = items.offerURL + "&" + utm_params.substring(1,utm_params.indexOf("&nav_src")) + "&offerId=" + items.offerId;
                                        window.location.href = offerRedirectUrl;
                            		}
                            		else{
                            			offerRedirectUrl = items.offerURL + "&" + utm_params.substring(1,utm_params.length) + "&offerId=" + items.offerId;
                                        window.location.href = offerRedirectUrl;
                            		}
                            	}
                            	else{
                            		if(utmString.length > 0){
                            			offerRedirectUrl = items.offerURL + "&" + utmString.substring(1,utmString.length) + "&offerId=" + items.offerId;
                            		}
                            		else{
                            			offerRedirectUrl = items.offerURL + "&offerId=" + items.offerId;
                            		}
                            		
                                    window.location.href = offerRedirectUrl;
                            	}
                                
                            }
                        } else {
                            var gtlofferFormRedirecrURL = document.getElementById("gtlofferFormRedirecrURL");
                            if (window.isMobile == 1) {
                            	if(urlParams){
                            		if(utm_params.includes("&nav_src")){
                            			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                            		}
                            		else{
                            			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params;
                            		}
                            	}
                            	else{
                            		window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utmString;                            		
                            	}
                            } else {
                            	if(urlParams){
                            		if(utm_params.includes("&nav_src")){
                            			window.location.href = gtlofferFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                            		}
                            		else{
                            			window.location.href = gtlofferFormRedirecrURL.value + utm_params;
                            		}
                            	}
                            	else{
                            		window.location.href = gtlofferFormRedirecrURL.value + utmString;
                            	}
                            }
                        }
                    }
                    /*if(items.productCode == prodType){
                    	offerRedirectUrl = items.offerURL + "&offerId=" + items.offerId;
                    }*/
                });
            } else {
                var gtlofferFormRedirecrURL = document.getElementById("gtlofferFormRedirecrURL");
                if (window.isMobile == 1) {
                	if(urlParams){
                		if(utm_params.includes('&nav_src')){
                			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                		}
                		else{
                			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params;
                		}                		
                	}
                	else{
                		window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utmString;
                	}
                } else {
                	if(urlParams){
                		if(utm_params.includes("&nav_src")){
                			window.location.href = gtlofferFormRedirecrURL.value + utm_params.substring(0,utm_params("&nav_src"));
                		}
                		else{
                			window.location.href = gtlofferFormRedirecrURL.value + utm_params;
                		}
                	}
                	else{
                		window.location.href = gtlofferFormRedirecrURL.value + utmString;
                	}
                }
            }
            
        }
        var gltJsonData = response;
        /*personalDetails(gltJsonData);*/
        offersSwiper(gltJsonData);
        //toggleLoader(false);
	}
}

function offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString) {
	var featuresTemplate = '';
	if (data.offerFeatures.feature1) {
		featuresTemplate += ' <li class= "list-item" ><div class="desc"><p>' + data.offerFeatures.feature1 + '</p></div></li> '
	}
	if (data.offerFeatures.feature2) {
		featuresTemplate += ' <li class= "list-item" ><div class="desc"><p>' + data.offerFeatures.feature2 + '</p></div></li> '
	}
	if (data.offerFeatures.feature3 != " ") {
		featuresTemplate += ' <li class= "list-item" ><div class="desc"><p>' + data.offerFeatures.feature3 + '</p></div></li> '
	}
	if(data.prospectDetailsObject == null){
        $("#userName").text("");
       }else{
       $("#userName").text(data.prospectDetailsObject.personalDetails.firstName || "");
       }	
	$("#offerTitle").text(data.offerTitle || "");
	$("#offerValue").html("&#8377;" + (data.offerAmount.toLocaleString() || ""));
	$("#offerRate").html("" + (data.offerFinalRate || "") + "%");
	
	offerConfigForHealthTerm(data);
	
	if(offerismobiletrue == 1){
		if(urlParams){
			var utm_params = window.urlObj.search;
			if(utm_params.includes("&nav_src")){
				$("#availOfferBtn").attr("href", data.offerURL + "&" + utm_params.substring(1,utm_params.indexOf("&nav_src")) + "& isMobile=1");
			}
			else{
				$("#availOfferBtn").attr("href", data.offerURL + "&" + utm_params.substring(1,utm_params.length)  + "& isMobile=1");
			}
		}
		else{
			if(utmString.length > 0) {
				$("#availOfferBtn").attr("href", data.offerURL + "&" + utmString.substring(1,utmString.length)  + "& isMobile=1");
			}
			else{
				$("#availOfferBtn").attr("href", data.offerURL + "& isMobile=1");
			}
			
		}
	}
	else{
		if(urlParams){
			var utm_params = window.urlObj.search;
			if(utm_params.includes("&nav_src")){
				$("#availOfferBtn").attr("href", data.offerURL + "&" + utm_params.substring(1,utm_params.indexOf("&nav_src")));
			}
			else{
				$("#availOfferBtn").attr("href", data.offerURL + "&" + utm_params.substring(1,utm_params.length));
			}
		}
		else{
			if(utmString.length > 0){
				$("#availOfferBtn").attr("href", data.offerURL + "&" + utmString.substring(1,utmString.length));
			}
			else{
				$("#availOfferBtn").attr("href", data.offerURL);
			}
			
		}
	}
	//$("#availOfferBtn").attr("href", data.offerURL);
	$("#offerWidgetFeatureContainer").html(featuresTemplate)
//	var oldurl = $("#viewAllOffersBtn").attr("href") + "." + window.myOfferResponse.payload.offerQID + ".html";
}

function offerConfigForHealthTerm(data) {
	var pageproductVal = $("#productType").val();
	if (data.productCode === "LSPBP" || data.productCode === "IHG" || data.productCode === "HGFF") {
		if(data.offerAmount != null) {
			if($("#sumAssuredDiv").hasClass('dsp-none')) {
				$("#sumAssuredDiv").removeClass('dsp-none');
			}
			$("#sumAssuredValue").html("&#8377;" + data.offerAmount.toLocaleString())
		}
		else{
			$("#sumAssuredDiv").addClass('dsp-none');
		}
		
		if(data.grossPremium != null) {
			if($("#premiumDiv").hasClass('dsp-none')) {
				$("#premiumDiv").removeClass('dsp-none');
			}
			$("#premiumValue").html("&#8377;" + data.grossPremium.toLocaleString())
		}
		else{
			$("#premiumDiv").addClass('dsp-none');
		}
		
		if(data.hasOwnProperty('membercombo')) {
			if(data.membercombo != null) {
				$("#personCoveredValue").html(data.membercombo.toString());
			}
			else{
				$("#personCoveredValue").html("1");
			}
			if($("#personsCoveredDiv").hasClass('dsp-none')) {
				$("#personsCoveredDiv").removeClass('dsp-none');
			}
		}
		else{
			$("#personCoveredValue").html("1");
			if($("#personsCoveredDiv").hasClass('dsp-none')) {
				$("#personsCoveredDiv").removeClass('dsp-none');
			}
		}
		$("#offerValueDiv").hide();
		$("#offerDataDiv").show();
	}
	else{
		$("#offerValueDiv").show();
		$("#sumAssuredDiv").addClass('dsp-none');
		$("#premiumDiv").addClass('dsp-none');
		$("#personsCoveredDiv").addClass('dsp-none');
		$("#offerDataDiv").hide();
	}
}

/*Check for filter Details*/
if(document.getElementById('filterDeals')){
document.addEventListener("DOMContentLoaded",function(){
	var avtiveTabName = document.getElementById("tabActiveName").value;
	if(quoteCode){
		var quoteid = quoteCode.substring(quoteCode.indexOf(',')+1,quoteCode.length); 
		/*getQuoteData(quoteid).then(function(response){*/
		response = JSON.parse(localStorage.getItem("myOfferResponse"));
			if(response){
				var tagList;
				var offerList = response.payload.offerDetailsResponse.offerDetails;
				offerList.forEach(function(items){
					if(items.productCode == "GTL"){
						tagList=response.payload.offerDetailsResponse.offerDetails.map(function(offerObj){
							return offerObj.offerFeatures.tag;
						}).getUnique();
						
						tagList.forEach(function(value){
							/*if(document.getElementsByClassName("tag")[0].classList.contains("active")){
								document.getElementsByClassName("tag")[0].classList.remove("active");
							}*/
							if(value.toLowerCase() == avtiveTabName.toLowerCase()){
								var a=document.createElement("a");
								a.className="tag nav-link active";
								a.setAttribute("data-value",value);
								a.innerText=value;
								document.getElementById("tagListOfferFilter").appendChild(a)
								if(document.getElementsByClassName("tag")[0].classList.contains("active")){
									document.getElementsByClassName("tag")[0].classList.remove("active");
								}
							}
							else{
								var a=document.createElement("a");
								a.className="tag nav-link";
								a.setAttribute("data-value",value);
								a.innerText=value;
								if(value == a){
									console.log(a);
								}else{
									
									document.getElementById("tagListOfferFilter").appendChild(a);	
								}
								if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
									document.getElementsByClassName("tag")[0].classList.add("active");
								}
							}
						})
					}
					else{
						tagList=response.payload.offerDetailsResponse.offerDetails.map(function(offerObj){
							return offerObj.offerFeatures.tag;
						}).getUnique();
						
						tagList.forEach(function(value){
							var a= document.createElement("a");
							a.className="tag nav-link";
							a.setAttribute("data-value",value);
							a.innerText=value;
							if(value == a){
								console.log(a);
							}else{
								document.getElementById("tagListOfferFilter").appendChild(a);	
							}
						})
					}
				})
				var newArray = new Array();
				var listItems = $("#tagListOfferFilter a");
				listItems.each(function(idx, i) {
						var updatedArray = newArray.push(i.getAttribute('data-value'));
						console.log(updatedArray);
				});
				$("#tagListOfferFilter").empty();
				var unique = newArray.filter( onlyUnique );
				for(var i =0 ; i<unique.length; i++){
					var a= document.createElement("a");
					if(avtiveTabName == unique[i]){
						a.className="tag nav-link active";
						document.getElementsByClassName("")
					}
					else{
						a.className="tag nav-link";
					}
					
					a.setAttribute("data-value",unique[i]);
					a.innerText=unique[i];
					document.getElementById("tagListOfferFilter").appendChild(a);
				}
				if(avtiveTabName !=""){
					if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
						document.getElementsByClassName("tag")[0].classList.remove("active");
					}
				}
				else{
					if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
						document.getElementsByClassName("tag")[0].classList.add("active");
					}
				}
				
			
				offersSwiper(response.payload.offerDetailsResponse);
				if(avtiveTabName !=""){
					filterOnLoadFAQ();
				}
				btnRedirect();
				filterFaq();
	            toggleLoader(false)
			}
			/*var tagList;
			var offerList = response.payload.offerDetailsResponse.offerDetails;
			offerList.forEach(function(items){
				if(items.productCode == "GTL"){
					tagList=response.payload.offerDetailsResponse.offerDetails.map(function(offerObj){
						return offerObj.offerFeatures.tag;
					}).getUnique();
					
					tagList.forEach(function(value){
						if(document.getElementsByClassName("tag")[0].classList.contains("active")){
							document.getElementsByClassName("tag")[0].classList.remove("active");
						}
						if(value.toLowerCase() == avtiveTabName.toLowerCase()){
							var a=document.createElement("a");
							a.className="tag nav-link active";
							a.setAttribute("data-value",value);
							a.innerText=value;
							document.getElementById("tagListOfferFilter").appendChild(a)
							if(document.getElementsByClassName("tag")[0].classList.contains("active")){
								document.getElementsByClassName("tag")[0].classList.remove("active");
							}
						}
						else{
							var a=document.createElement("a");
							a.className="tag nav-link";
							a.setAttribute("data-value",value);
							a.innerText=value;
							if(value == a){
								console.log(a);
							}else{
								
								document.getElementById("tagListOfferFilter").appendChild(a);	
							}
							if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
								document.getElementsByClassName("tag")[0].classList.add("active");
							}
						}
					})
				}
				else{
					tagList=response.payload.offerDetailsResponse.offerDetails.map(function(offerObj){
						return offerObj.offerFeatures.tag;
					}).getUnique();
					
					tagList.forEach(function(value){
						var a= document.createElement("a");
						a.className="tag nav-link";
						a.setAttribute("data-value",value);
						a.innerText=value;
						if(value == a){
							console.log(a);
						}else{
							document.getElementById("tagListOfferFilter").appendChild(a);	
						}
					})
				}
			})
			var newArray = new Array();
			var listItems = $("#tagListOfferFilter a");
			listItems.each(function(idx, i) {
					var updatedArray = newArray.push(i.getAttribute('data-value'));
					console.log(updatedArray);
			});
			$("#tagListOfferFilter").empty();
			var unique = newArray.filter( onlyUnique );
			for(var i =0 ; i<unique.length; i++){
				var a= document.createElement("a");
				if(avtiveTabName == unique[i]){
					a.className="tag nav-link active";
					document.getElementsByClassName("")
				}
				else{
					a.className="tag nav-link";
				}
				
				a.setAttribute("data-value",unique[i]);
				a.innerText=unique[i];
				document.getElementById("tagListOfferFilter").appendChild(a);
			}
			if(avtiveTabName !=""){
				if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
					document.getElementsByClassName("tag")[0].classList.remove("active");
				}
			}
			else{
				if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
					document.getElementsByClassName("tag")[0].classList.add("active");
				}
			}
			
		
			offersSwiper(response.payload.offerDetailsResponse);
			if(avtiveTabName !=""){
				filterOnLoadFAQ();
			}
			btnRedirect();
			filterFaq();
            toggleLoader(false)*/

		/*})*/
	}
	else if(window.localStorage.getItem("myOfferResponse")){
		var response=JSON.parse(window.localStorage.getItem("myOfferResponse"))
		var tagList=response.payload.offerDetailsResponse.offerDetails.map(function(offerObj){
				return offerObj.offerFeatures.tag;
			}).getUnique();
		tagList.forEach(function(value){
			var a= document.createElement("a");
			a.className="tag nav-link";
			a.setAttribute("data-value",value);
			a.innerText=value;
			if(value == a){
				console.log(a);
			}else{
				document.getElementById("tagListOfferFilter").appendChild(a);	
			}
			
			
		})
		$("#tagListOfferFilter").empty();
		var unique = newArray.filter( onlyUnique );
		for(var i =0 ; i<unique.length; i++){
			var a= document.createElement("a");
			a.className="tag nav-link";
			a.setAttribute("data-value",unique[i]);
			a.innerText=unique[i];
			document.getElementById("tagListOfferFilter").appendChild(a);
		}
		if(!document.getElementsByClassName("tag")[0].classList.contains("active")){
			document.getElementsByClassName("tag")[0].classList.add("active");
		}
		offersSwiper(response.payload.offerDetailsResponse);
		btnRedirect();
		filterFaq()
	}
})
}
function onlyUnique(value, index, self) { 
    return self.indexOf(value) === index;
}
//filterOnLoadFAQ();
function filterOnLoadFAQ(){
    try {
        $(".js-filter-wrapper .js-filter-nav .tag .bs-offers").ready(function(e){ 
        	
//            var faqSelected = $(this).attr("data-value");
//            $(".js-filter-wrapper .tag").removeClass("active");
//            $(this).addClass("active");
//
//            if (faqSelected == "all") {
//                $(".js-filter-content  .filter-element").fadeIn();
//            } else {
//                $(".js-filter-content  .filter-element:not([data-filter='" + faqSelected + "'])").fadeOut();
//                setTimeout(function () {
//                    $(".js-filter-content .filter-element[data-filter='" + faqSelected + "'").fadeIn();
//                }, 400);
//            }
        	var status;
        	var selectedCard;
        	var activeEle = $(".filter-nav.js-filter-nav .tag.nav-link");
        	activeEle.each(function(index){
        		status = $(this).hasClass("active");
        		if(status == true){
        		selectedCard = $(this).attr("data-value");
        	}
        		
        	});
        	$(".swiper-slide.filter-element").each(function(){
        		
        		if($(this).attr("data-filter") == selectedCard){
        			$(this).css("display","block");
        		}
        		else{
        			$(this).css("display","none");
        		}
        	});
            // if (winWidth > breakpoint_xs) {
            setTimeout(function () {
                if ($(".offers-swiper").length) {
                    offerSwiper.update();
                    offerSwiper.slideTo(0);
                }
                if ($(".search-swiper").length) {
                    searchSwiperSlider.update();
                    searchSwiperSlider.slideTo(0);
                }


            }, 500);
            //}
        });
        $(".js-filter-wrapper .js-filter-nav .tag.default-active").trigger('load');
    } catch (err) {
        console.log(err);
    }
}
function formCreation()
{
	var carpetarea = document.getElementById("carpetdiv");
	var ownership = document.getElementById("ownershipdiv");
	var beneficiary = document.getElementById("beneficiarydiv");
	var familyIncome = parseInt(document.getElementById("famincome").value);
	var scheme = document.getElementById("scheme");
	if(familyIncome>600000)
		{
		beneficiary.classList.add("hidefield");
		carpetarea.classList.remove("hidefield");
		ownership.classList.add("hidefield");
		
		}
	else if(familyIncome>300000 && familyIncome<=600000)
	{
		if(document.getElementById("rb-ownership-n").checked)
		{
		beneficiary.classList.remove("hidefield");
		}
		else
		{
		
		beneficiary.classList.add("hidefield");
		}
		
		carpetarea.classList.add("hidefield");
		ownership.classList.remove("hidefield");
	}
	else
		{
		if(document.getElementById("rb-ownership-n").checked)
		{
		beneficiary.classList.remove("hidefield");
		}
		else
		{
		
		beneficiary.classList.add("hidefield");
		}
		
		ownership.classList.remove("hidefield");
		carpetarea.classList.add("hidefield");
		}
	}

function pmayOnCalculate(event)
{
  event.preventDefault();
  var status=true;
  var parentContainer = findSelectorParent(event.target, "FORM");
  var annualFamilyIncome = parseInt(document.getElementById("famincome").value) || "";
  var loanAmount = parseInt(document.getElementById("loanamount").value) || "";
  var tenure = parseInt(document.getElementById("tenure").value) || "";
 
  
  var minAnnualFamilyIncome = parseInt(document.getElementById("minAnnualFamilyIncome").value) || "";
  var maxAnnualFamilyIncome = parseInt(document.getElementById("maxAnnualFamilyIncome").value) || "";
  var minloanAmount = parseInt(document.getElementById("minloanAmount").value) || "";
  var maxloanAmount = parseInt(document.getElementById("maxloanAmount").value) || "";
  var mintenure = parseInt(document.getElementById("mintenure").value) || "";
  var maxtenure = parseInt(document.getElementById("maxtenure").value) || "";
  var mincarpetarea = parseInt(document.getElementById("mincarpetarea").value) || "";
  var maxcarpetarea = parseInt(document.getElementById("maxcarpetarea").value) || "";
  
  
  var puccaHouse;
  	if(document.querySelector('input[name="pucca-radio"]:checked')){
  		puccaHouse= document.querySelector('input[name="pucca-radio"]:checked').value;;
  	}
  	
  	var ownership;
  	if(!document.getElementById("ownershipdiv").classList.contains("hidefield")){
  		if(document.querySelector('input[name="ownership-radio"]:checked')){
  			ownership = document.querySelector('input[name="ownership-radio"]:checked').value;;
  	  	}
  	}
  	else{
  		ownership = "";
  	}
  	
  	var beneficiary;
  	if(!document.getElementById("beneficiarydiv").classList.contains("hidefield")){
  		if(document.querySelector('input[name="beneficiary-radio"]:checked')){
  			beneficiary = document.querySelector('input[name="beneficiary-radio"]:checked').value;;
  	  	}
  	}
  	else{
  		beneficiary = "";
  	}
  	
  var carpetArea = 323;
  if((annualFamilyIncome < minAnnualFamilyIncome) || (annualFamilyIncome > maxAnnualFamilyIncome))
    {
    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "famincomeErrorMsg"), "Please enter a valid number between "+minAnnualFamilyIncome+" and "+maxAnnualFamilyIncome, true);
    status = false;
    }
 
  if((loanAmount < minloanAmount) || (loanAmount > maxloanAmount))
    {
    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "loanamountErrorMsg"), "Please enter a valid number between "+minloanAmount+" and "+maxloanAmount, true);
    status=false;
    }
  
  
  if((tenure < mintenure) || (tenure > maxtenure))
    {
    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tenureErrorMsg"), "Please enter a valid number between "+mintenure+" and "+maxtenure, true);
    status=false;
    }
  
  
  if(annualFamilyIncome > 600000)
    {
    carpetArea=parseInt(document.getElementById("carpetarea").value) || "";
    if((carpetArea < mincarpetarea) || (carpetArea > maxcarpetarea))
      {
      showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "carpetareaErrorMsg"), "Please enter a valid number between "+mincarpetarea+" and "+maxcarpetarea, true);
      status=false;
      }
    }
  
  var sendData = {
		  "annualFamilyIncome": annualFamilyIncome,
		  "loanAmount": loanAmount,
		  "tenure": tenure,
		  "carpetArea": carpetArea,
		  "pmayQuestions": [
			  {
				  "questionCode": "PMAYQ01",
				  "questionAnswer": puccaHouse
			  },
			  {
				  "questionCode": "PMAYQ02",
				  "questionAnswer": ownership
			  },
			  {
				  "questionCode": "PMAYQ03",
				  "questionAnswer": beneficiary
			  }
		  ]
  }
 if(status==true){
	 pmaysendAPICall(AppConstants.API_SELECTOR.PMAY_CALCULATOR.name,sendData);
 }
}

function pmaysendAPICall(selector,sendData){
	/*var formData = new FormData();
	formData.append("annualFamilyIncome", annualFamilyIncome);
	formData.append("loanAmount", loanAmount);
	formData.append("tenure", tenure);
	formData.append("carpetArea", carpetArea);
	formData.append("puccaHouse",puccaHouse);
	formData.append("ownership",ownership);
	formData.append("beneficiary",beneficiary);
	
	var sendData = new URLSearchParams(formData).toString();*/
	
	 
	 AppEvent.trigger(selector,
		        sendData).then(function (response) {
		            toggleLoader(false);
		            if (response.status == 'SUCCESS' && response.errorBean == null) {
	
		            	loadPMAYCalculateData(response);
		            } else {
		                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
		                    timeOut: 5000,
		                    "closeButton": true,
		                    "preventDuplicates": true
		                });
		            }
		        }).catch(function (err) {
		            toggleLoader(false);
		        })
	
}


function loadPMAYCalculateData(responseData){
	if(responseData.payload){
			document.getElementById("pmay-lyt").style.display = "block";
			document.getElementById("pmay-scheme").innerHTML = responseData.payload.subsidyCategory;
			document.getElementById("pmay-amount").innerHTML ="₹"+   Math.round(responseData.payload.subsidyAmount).toLocaleString("en-IN");
			document.getElementById("pmayCalculateNow").scrollIntoView();
	}
	else if(responseData.errorBean[0].errorCode){
		toastr.error(responseData.errorBean[0].errorCode + " : " + responseData.errorBean[0].errorMessage, '', {
            timeOut: 5000,
            "closeButton": true,
            "preventDuplicates": true
        });
	}
}
var familydropContent = document.getElementById("familydrop");
var individualdropContent = document.getElementById("individualdrop");
var healthcarestatus;


if (document.getElementById("extracareradio")) {
    document.addEventListener("DOMContentLoaded", triggerSetProduct(window.productName));

}

function HealthCareValidation(event, isFamily, type) {
    $(this).closest('.toast').remove();
    var parentElement = findSelectorParent(event.target, ".bs-form");

    var parentContainer;
    if (document.getElementById("individualradio").checked) {

        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
        console.log($(parentContainer).find("#insuringFor").val());
    } else if (document.getElementById("familyradio").checked) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Family form : family");
        console.log($(parentContainer).find("#insuringFor").val());
    }

    var insureRelation = [];

    if (document.getElementById("individualradio").checked) {
        document.getElementById("individualdrop").querySelectorAll(".checkbox-list").forEach(function (ele) {

            var checkbox = ele.querySelector("input[type=radio]").checked;

            var age = ele.querySelector("input[type=tel]").value;
            var relationship = ele.querySelector("label").innerText.toUpperCase().trim();
            if (checkbox == true && age != "") {
                insureRelation.push({
                    "no": null,
                    "relationship": relationship,
                    "age": age
                })
                healthcarestatus = true;
            } else if (checkbox == true && age == "") {
                toastr.error('Please enter age of ' + relationship + '.', '', {
                    timeOut: 5000,
                    "closeButton": true,
                    "preventDuplicates": true
                });
                healthcarestatus = false;
            } else {
                ele.querySelector("input[type=tel]").value = "";
            }
        })
    } else if (document.getElementById("familyradio").checked) {
        document.getElementById("familydrop").querySelectorAll(".checkbox-list").forEach(function (ele) {

            var checkbox = ele.querySelector("input[type=checkbox]").checked;

            var age = ele.querySelector("input[type=tel]").value;
            var relationship = ele.querySelector("label").innerText.toUpperCase().trim();
            if (checkbox == true && age != "") {
                insureRelation.push({
                    "no": null,
                    "relationship": relationship,
                    "age": age
                })
                healthcarestatus = true;
            } else if (checkbox == true && age == "") {
                toastr.error('Please enter age of ' + relationship + '.', '', {
                    timeOut: 5000,
                    "closeButton": true,
                    "preventDuplicates": true
                });
                healthcarestatus = false;
            } else {
                ele.querySelector("input[type=tel]").value = "";
            }
        })
    }

    //checkboxListsArr.pop();
    if (isFamily) {
        var checkboxListsEle = document.getElementById("familydrop").querySelectorAll(".checkbox-list");
        var checkboxListsArr = Object.keys(checkboxListsEle)
        var checkboxListsEleLength = checkboxListsArr.filter(function (ele) {
            return checkboxListsEle[ele].querySelector("input[type=checkbox]").checked;
        }).length
    } else {
        var checkboxListsEle = document.getElementById("individualdrop").querySelectorAll(".checkbox-list");
        var checkboxListsArr = Object.keys(checkboxListsEle)
        var checkboxListsEleLength = checkboxListsArr.filter(function (ele) {
            return checkboxListsEle[ele].querySelector("input[type=radio]").checked;
        }).length
    }
    if (checkboxListsEleLength == 0) {
        toastr.error('Please select Insuring.', '', {
            timeOut: 5000,
            "closeButton": true,
            "preventDuplicates": true
        });
    }
    var insuredStatus = true;
    var ageAdultMax, ageAdultMin, ageChildMax, ageChildMin;


    if (document.getElementById("healthType")) {
        var healthproductValue = document.getElementById("healthType").value;
        if (healthproductValue == "1" || healthproductValue == "2" || healthproductValue == "3") {
            type = (Number.isInteger(type)) ? type : parseInt(type);
            switch (type) {
                case 1:
                    ageAdultMax = 80;
                    ageAdultMin = 18;
                    ageChildMax = 25;
                    ageChildMin = 0;
                    break;
                case 2:
                    ageAdultMax = 80;
                    ageAdultMin = 18;
                    ageChildMax = 25;
                    ageChildMin = 0;
                    break;
                case 3:
                    ageAdultMax = 80;
                    ageAdultMin = 18;
                    ageChildMax = 25;
                    ageChildMin = 0;
                    break;
            }

        }

    }
    var errorStatus = true;
    $(parentElement).find(".typ-insuring .checkbox-list").each(function (index, ele) {
        if ($(ele).find("[type=tel]").val() != "") {
            errorStatus = true;
            if (/([cC][hH][iI][lL][dD]|[Ss][Oo][nN]|[Dd][Aa][Uu][Gg][Hh][Tt][Ee][Rr]|[Bb][Rr][Oo][Tt][Hh][Ee][Rr]|[Ss][Ii][Ss][Tt][Ee][Rr])/g.test($(ele).find("[type=checkbox],[type=radio]").parent().text().trim())) {
                if ($(ele).find("[type=tel]").val() > ageChildMax) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageChildMin + ' to ' + ageChildMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else if ($(ele).find("[type=tel]").val() < ageChildMin) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageChildMin + ' to ' + ageChildMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else {
                    errorStatus = false;
                }
            } else {
                if ($(ele).find("[type=tel]").val() > ageAdultMax) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageAdultMin + ' to ' + ageAdultMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else if ($(ele).find("[type=tel]").val() < ageAdultMin) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageAdultMin + ' to ' + ageAdultMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else {
                    errorStatus = false;
                }
            }
        } else {
            if (errorStatus) {

                showError("insuringListInnerTextErrorMsg", "", true)
            } else {
                showError("insuringListInnerTextErrorMsg", "", false)
            }
        }
    })
    if (insuredStatus == false) {
        return false;
    }
    if (healthcarestatus == false) {
        return healthcarestatus;
    }
    if (insureRelation.length != 0) {
        healthcarestatus = true;

        if (isFamily) {
            if (insureRelation.length > 6) {
                toastr.error('Only a maximum of 6 members allowed.', '', {
                    timeOut: 5000,
                    "closeButton": true,
                    "preventDuplicates": true
                });
                return false;
            } else if (insureRelation.length > 1) {
                if (insureRelation.filter(function (insureObj) {
                        return (insureObj.relationship != "CHILD" && insureObj.relationship != "SON" && insureObj.relationship != "DAUGHTER")
                    }).length < 1) {

                    toastr.error('select atleast 1 Adult insuring .', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    return false;
                }
            } else {
                toastr.error('Select aleast 2 insuring .', '', {
                    timeOut: 5000,
                    "closeButton": true,
                    "preventDuplicates": true
                });
                return false;
            }
        }
    } else {
        return false;
    }
    showError("insuringListInnerTextErrorMsg", "select Insuring", false);
    var insuringListInnerText = $(parentElement).find("#insuringListInnerText");
    var insureData = function (data) {
        if (insuringListInnerText) {
            insuringListInnerText.html(" ");
            var updatedInsureDetails = data.map(function (insureDetails, index, self) {
                insureDetails.ages = []
                insureDetails.index = self.filter(function (insureDetailsObj) {
                    if (insureDetailsObj.relationship == insureDetails.relationship) {
                        insureDetails.ages.push(insureDetailsObj.age)
                    }

                    return (insureDetailsObj.relationship == insureDetails.relationship)
                }).length
                return insureDetails;
            })
            updatedInsureDetails = removeDuplicatesFromObj(updatedInsureDetails, "relationship");
            var insuringListInnerTextStr = "";
            updatedInsureDetails.forEach(function (insuredDetail) {
                insuringListInnerTextStr += ((insuredDetail.index > 1) ? insuredDetail.index : "") + " " + insuredDetail.relationship + "," + " ";
            })
            insuringListInnerText.html(insuringListInnerTextStr.slice(0, -2));
            data.forEach(function (obj) {
                delete obj.ages;
                delete obj.index;
            })
            return data;
        }
    }(insureRelation)
    close_dropdown(".typ-insuring.bs-dropdown");
    return insureData;

}
//healthcareextra
function healthcarextra(selector, data) {
    //var data = new FormData();

    AppEvent.trigger(selector, data).then(function (response) {
        console.log(response);

        if (response.status == "SUCCESS") {

            var url = handoverEndpointURL + healthCareHandoverURL;
            url += "apcantid=" + response.payload.applicantId + "&";
            url += "aptionid=" + response.payload.applicationId + "&";
            url += "apcaptid=" + response.payload.applicationApplicantId + "&";
            url += "skipLogin=true";
            //	         		    	url += "utm_source=" + "WEBSITE_PRODUCT_PAGE";

            response.responseURL = url;
            if (window.location.href.includes("is-mobile")) {
                url += "&isMobile=1";
            }
            if (response.payload.authToken) {
                window.sessionStorage.setItem("SS_1", response.payload.authToken)
                window.sessionStorage.setItem("SS_4", response.payload.guardKey)
                document.cookie = "SS_1=" + response.payload.authToken
                document.cookie = "SS_4=" + response.payload.guardKey
            }
            var responsevalue = response.responseURL;
            var searchParams = new URLSearchParams(responsevalue);
            var applicationId = response.payload.applicationId || "";
            var mobileno;
            if (localStorage.hasOwnProperty("defaultUserValue")) {
                var isMob = JSON.parse(localStorage.getItem("defaultUserValue"));
                if (isMob.hasOwnProperty("mobileNumber")) {
                    mobileno = isMob.mobileNumber;
                } else {
                    mobileno = ""
                }
            }
            var appStage = "NA";
            var dob = "NA";
            var trafficType = "No Offer";
            if (response.payload.existingApplicationFound == true) {
                var resumeAppStage = productName + "_LEAD_PROD_INFO" || "";
                var resumePage = digitalData.page.name;
                triggerToResumeCalls(applicationId, mobileno, appStage, dob, trafficType, resumeAppStage, resumePage);
            } else {
                    /*triggerCreateLead(applicationId, response.payload.insProductType);*/
            	triggerToCreatApplication(applicationId, mobileno, appStage, dob, trafficType);
            }

            UTMGenerate(response.responseURL);
            //location.href = response.responseURL;
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false)
        }
    }).catch(function (err) {
        toggleLoader(false);
    })
}


//healthcareextra

function HealthCareApply(event) {
    var parentContainer;
    if (document.getElementById("individualradio").checked) {
        isFamily = false;
        parentContainer = findSelectorParent(event.target, "FORM");

        console.log("Individual form : individual");

    } else if (document.getElementById("familyradio").checked) {
        isFamily = true;
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Family form : family");
    }

    var hasMobileNumber;
    if (document.getElementById("mobileNumber")) {
        hasMobileNumber = true;
    } else
        hasMobileNumber = false;

    var mobileNumber;

    if (hasMobileNumber) {
        mobileNumber = $(parentContainer).find("#mobileNumber").val();
    }


    var checkInsureringValidation;

    if (document.getElementById("insuringFor").value == "3") {
        checkInsureringValidation = HealthCareValidation(event, isFamily, 2)
    } else {
        checkInsureringValidation = HealthCareValidation(event, isFamily, 1)
    }
    if (hasMobileNumber) {
        if (mobileNumber) {
            if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Valid Mobile Number.", true);
                if (healthcarestatus) {
                    healthcarestatus = false;
                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", false);
                healthcarestatus = true;
            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", true);
            if (healthcarestatus) {
                healthcarestatus = false;
            }
        }
    }


    //write AJAX Call
    var formdata = new FormData();
    var insuringFor = $(parentContainer).find("#insuringFor").val();
    // console.log(insuringFor);
    var email = "";
    var mobileNumber = document.getElementById("mobileNumber").value;
    formdata.append("mobileNumber", mobileNumber || "");
    formdata.append("insuredDetails", JSON.stringify(checkInsureringValidation));
    formdata.append("utmParams", JSON.stringify(window.utmParams));
    formdata.append("insuringFor", insuringFor);

    if (healthcarestatus == true) {
        var IndFam;
        if (insuringFor == 2) {
            IndFam = "Individual";
        } else if (insuringFor == 3) {
            IndFam = "Family";
        }


        var analyticsInsuringForStr = "";
        JSON.parse(formdata.get("insuredDetails")).forEach(function (obj) {
            analyticsInsuringForStr += obj.relationship + ":" + obj.age + ",";
        })


        var sendData = new URLSearchParams(formdata).toString();
        var send = {
            "businessType": "1",
            "userAction": "callme",
            "channelType": "Web",
            "insuringFor": insuringFor,
            "selectedPlanDetails": null,
            "utmParams": window.utmParams,
            "proposerDetails": {
                "mobileNumber": mobileNumber,
                "gender": "M"
            },
            "insuredDetails": checkInsureringValidation
        }
       
        triggerHealthTopUpGetQuote(IndFam, analyticsInsuringForStr, mobileNumber, email);
        healthcarextra(AppConstants.API_SELECTOR.HEALTH_CARE_EXTRA.name, send)
    }

}

function radioset() {
    document.getElementById("insuringListInnerText").innerHTML = "Self";

    if (document.getElementById("individualradio").checked) {
        document.getElementById("insuringFor").value = "2";

        isFamily = false;

        $("#familydrop").remove();
        $("#dropparent").append(individualdropContent);
        hide_textbox();
    } else if (document.getElementById("familyradio").checked) {
        isFamily = true;
        document.getElementById("insuringFor").value = "3";

        $("#individualdrop").remove();
        $("#dropparent").append(familydropContent);

    }
    // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.HEALTH[1]);
    triggerSetProduct(window.productName);

}
var count = 0;

function displaydrop() {
    if (document.getElementById("individualradio").checked && count == 0) {
        $("#familydrop").remove();
        count++;
    }
}
function gpgApply(event) {
    var status = true;
    //var data = new FormData();
    var string;
    if (parentDiv == undefined) {
        string = $("#gpgName").val();
    } else {
        string = $(parentDiv).find("#gpgName").val();
    }

    string = string.split(" ");
    console.log(string);
    console.log(string[0]);
    console.log(string[1]);

    var gpgfirstName = string[0];
    var gpglastName = string[1];


    var existingInfirmity;
    if (parentDiv == undefined) {
        existingInfirmity = $("input[name='gp_qustn']:checked").val();
    } else {
        existingInfirmity = $(parentDiv + " input[name='gp_qustn']:checked").val();
    }


    var parentContainer;
    if (document.getElementById("gpgquote")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
    }

    if (string == "") {
        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter Valid Full name", true);
        status = false;
    } else if (gpgfirstName == undefined || gpgfirstName == "") {
        gpgfirstName = "";
        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter First name", true);
        status = false;
    } else if (gpglastName == undefined || "") {
        gpglastName = "";
        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter Last name", true);
        status = false;
    } else {


        if (/^[a-zA-Z]+$/.test(gpgfirstName)) {

            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter Valid First name", false);

        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter Valid First name", true);
            if (status)
                status = false;

        }
        if (/^[a-zA-Z]+$/.test(gpglastName)) {

            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter Valid Last name", false);

        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "gpgNameErrorMsg"), "Enter Valid Last name", true);
            if (status)
                status = false;

        }
    }



    var parentContainer;
    if (document.getElementById("gpgquote")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
    }


    var hasMobileNumber;
    if (document.getElementById("mobileNumber")) {
        hasMobileNumber = true;
    } else
        hasMobileNumber = false;
    // console.log(hasMobileNumber);

    var mobileNumber;

    if (hasMobileNumber) {
        mobileNumber = $(parentContainer).find("#mobileNumber").val();
    }
    if (hasMobileNumber) {
        if (mobileNumber) {
            if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Valid Mobile Number.", true);
                if (status) {
                    status = false;
                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", false);

            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", true);
            if (status) {
                status = false;
            }
        }
    }


    var formdata = new FormData();
    var planCode;
    var mobileNumber;
    if (parentDiv == undefined) {
        mobileNumber = document.getElementById("mobileNumber").value;
    } else {
        mobileNumber = $(parentDiv).find("#mobileNumber").val();
    }

    if ($("#planCodePopup").length) {
        planCode = $(parentDiv).find("#planCodePopup").val();
    } else {
        planCode = $("#planCode").val();
    }

    var gclID;
    try {
        gclID = _satellite.getVisitorId().getMarketingCloudVisitorID()
    } catch (err) {
        console.log(err);
    }


    var sendData = {
        "businessType": "1",
        "userAction": "buynow",
        "channelType": window.channelType.channelType,
        "selectedPlanDetails": {
            "planCode": planCode,
            "variants": {
                "selected": "Y"
            }
        },
        "utmParams": window.utmParams,
        "proposerDetails": {
            "mobileNumber": mobileNumber,
            "firstName": "Name",
            "middleName": null,
            "lastName": "Surname"

        }
    }

    if (gpgfirstName != null && gpgfirstName.length > 0) {
        sendData.proposerDetails.firstName = gpgfirstName;
    }

    if (gpglastName != null && gpglastName.length > 0) {
        sendData.proposerDetails.lastName = gpglastName;
    }


    if (gclID != undefined) {
        sendData.utmParams.gclId = gclID;
    } else {
        sendData.utmParams.gclId = "";
    }

    if (status == true) {
        triggerSetProduct(planCode);
        triggerGPGPBuyNow(planCode, mobileNumber, existingInfirmity)

        GPGPBuyNowCall(AppConstants.API_SELECTOR.GPGP_CALL_US.name, sendData);
    }
}

function GPGPBuyNowCall(selector, sendData) {
    AppEvent.trigger(selector, sendData).then(function (response) {
        console.log(response);
        var URL = handoverEndpointURL + gpgpHandoverURL;
        URL = URL + "apcantid=" + response.payload.applicantId + "&";
        URL = URL + "aptionid=" + response.payload.applicationId + "&";
        URL = URL + "apcaptid=" + response.payload.applicationApplicantId + "&";
        URL = URL + "skipLogin=true";
        //			URL = URL + "utm_source=" + "WEBSITE_PRODUCT_PAGE";

        response.responseURL = URL;

        if (response.responseURL && response.status == "SUCCESS") {
            if (response.payload.authToken) {
                window.sessionStorage.setItem("SS_1", response.payload.authToken)
                window.sessionStorage.setItem("SS_4", response.payload.guardKey)
                document.cookie = "SS_1=" + response.payload.authToken
                document.cookie = "SS_4=" + response.payload.guardKey
            }
            var responsevalue = response.responseURL;
            var searchParams = new URLSearchParams(responsevalue);

            if ($("#planCodePopup").length) {
                planCode = $(parentDiv).find("#planCodePopup").val();
            } else {
                planCode = $("#planCode").val();
            }

            var applicationId = response.payload.applicationId || "";
            var mobileno;
            if (localStorage.hasOwnProperty("defaultUserValue")) {
                var isMob = JSON.parse(localStorage.getItem("defaultUserValue"));
                if (isMob.hasOwnProperty("mobileNumber")) {
                    mobileno = isMob.mobileNumber;
                } else {
                    mobileno = ""
                }
            }
            var appStage = "NA";
            var dob = "NA";
            var trafficType = "No Offer";
            if (response.payload.existingApplicationFound) {
                var resumeAppStage = productName + "_LEAD_PROD_INFO" || "";
                var resumePage = digitalData.page.name;
                triggerToResumeCalls(applicationId, mobileno, appStage, dob, trafficType, resumeAppStage, resumePage);
            } else {
                /*triggerCreateLead(applicationId, planCode);*/
                triggerToCreatApplication(applicationId, mobileno, appStage, dob, trafficType);
            }
            if (parentDiv == undefined) {
                existingInfirmity = $("input[name='gp_qustn']:checked").val();
            } else {
                existingInfirmity = $(parentDiv + " input[name='gp_qustn']:checked").val();
            }
            if (existingInfirmity == "No") {
                location.href = response.responseURL;
            } else {
                toggleLoader(false);
                if (parentDiv == undefined) {
                    $('#popup-gpgp-form').fadeOut().removeClass("active");
                    $('#existingInfiramityPopup').fadeIn().addClass("active");
                } else {
                    $(parentDiv + ' #popup-gpgp-form').fadeOut().removeClass("active");
                    $(parentDiv + ' #existingInfiramityPopup').fadeIn().addClass("active");
                }
            }
            //location.href = response.responseURL;
        } else {
            if (response.errorBean) {
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            }
            toggleLoader(false)
        }
    }).catch(function (err) {
        toggleLoader(false);
    })
}
var x;
var statusForInterval = true;
var parentContainer=""; 
var timer;
var inputlabel;
var timeoutHandle;
var countdownhandle;
var activetab;
var campaign = false;
if(document.getElementById("buyTab") || document.getElementById("sellTab"))
	{
	campaign = true;
	}
else
	{
	campaign = false;
	}
function onmultitab()
		
		{
	if(document.getElementsByClassName("goldloader").length > 0){
	document.getElementsByClassName("goldloader")[0].style.display="none";

	document.getElementsByClassName("goldloader")[1].style.display="none";

		clearInterval(x);
		$(parentContainer).find("#counter").html(""); 

		statusForInterval=false;
	
		
		$('.label-input-group').removeClass('focus');
	
	if(campaign)
		{
		activetab=document.getElementsByClassName("tab-link tag active")[0];
		}
	else
		{
		activetab=document.getElementsByClassName("resp-tab-active")[0];
		}

	if(activetab.innerHTML=="Buy")
	{
    inputlabel="How much you want to Buy?";
    parentContainer = "#buyform";
    console.log("buyform form : buyform");
	}
else if(activetab.innerHTML=="Sell")
{
inputlabel="How much you want to sell?";
parentContainer = "#sellform";
console.log("sellform form : sellform");
}

	  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "", false);

//			$('#buyform #counter').remove();
	
					//$(parentContainer).find('#counter').remove();

					$(parentContainer).find('#rupees').prop("checked",true);
					$(parentContainer).find("#inputlabel").html; //(inputlabel+" (Rs."+$(parentContainer).find('#rupeesmin').val()+" - Rs."+$(parentContainer).find('#rupeesmax').val()+")");
					$(parentContainer).find('#gold-amount').val("");
					apicall();
		}
		}

//document.getElementsByClassName("resp-tabs-list")[0].addEventListener("click",onmultitab);
$(function(){
	$('.resp-tabs-list').click(onmultitab);
	$('.tabs').click(onmultitab);
}
);


function addamount(val)
{
	
	//var activetab=document.getElementsByClassName("resp-tab-active")[0];
//	if(activetab.innerHTML=="Buy")
//		{
	var rupeesmin=parseFloat($(parentContainer).find("#rupeesmin").val());
	var rupeesmax=parseFloat($(parentContainer).find("#rupeesmax").val());
	var gramsmin=parseFloat($(parentContainer).find("#gramsmin").val());
	var gramsmax=parseFloat($(parentContainer).find("#gramsmax").val());

  if($(parentContainer).find("#rupees").prop('checked'))
  {
  var amount;
  if($(parentContainer).find("#gold-amount").val()=="")
    amount=0;
  else
    amount=parseFloat($(parentContainer).find("#gold-amount").val());
  
  console.log("Value: "+amount);
  if(amount<rupeesmax)
	 {
	  amount=amount + val;
	  if(amount<=rupeesmax)
	  {
		  $(parentContainer).find("#gold-amount").val(amount);
		  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "", false);
		  status=true;
	  }
	  else
	  {
		  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter amount between ("+rupeesmin+" - "+rupeesmax+")", true);
		  status=false;
	  }
	 
	 }
  else
	  {
	  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter amount between ("+rupeesmin+" - "+rupeesmax+")", true);
	  status=false;
	  }
  
  }
  else if($(parentContainer).find("#grams").prop('checked'))
    {
    var amount;
    if($(parentContainer).find("#gold-amount").val()=="")
      amount=0;
    else
      amount=parseFloat($(parentContainer).find("#gold-amount").val());
    
    console.log("Value: "+amount);
    if(amount<gramsmax)
    {
    	  if (val==1000){
    		  amount=(amount + 1).toFixed(2);
    	  }
    	      else
    	      {
    	    	  amount=(amount + 5).toFixed(2);    	    	  	  
    	      }
    	  if(amount<=gramsmax)
    		  {
    		  $(parentContainer).find("#gold-amount").val(amount);
    	  	  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "", false);
    		  status=true;
    		  }
    	  else{
    		  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter amount between "+gramsmin+"gm - "+gramsmax+"gm", true);
    		  status=false;

    	    }
    	  
    }
    else{
  	  showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter amount between "+gramsmin+"gm - "+gramsmax+"gm", true);
	  status=false;

    }
   }
//}
	
}

function goldradioset()
{
	if(parentContainer.includes("buy"))
			{
			inputlabel="How much you want to buy?"
			}

	
	 showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "", false);
	
	if($(parentContainer).find('#rupees').prop("checked"))
    {
	//document.querySelector("#buyform #gold-amount").addEventListener= ("input", isNumberWithDecimal(event,2));
		$(parentContainer).find("#gold-amount").val("");
		$(parentContainer).find("#minvalue").html("+ &#8377; 1000");
		$(parentContainer).find("#maxvalue").html("+ &#8377; 2000");
		$(parentContainer).find("#inputlabel").html //(inputlabel+" (Rs."+$(parentContainer).find('#rupeesmin').val()+" - Rs."+$(parentContainer).find('#rupeesmax').val()+")");
    
    }
  else
  {
	  $(parentContainer).find("#gold-amount").val("");
	  $(parentContainer).find("#minvalue").html("+1 gms");
	  $(parentContainer).find("#maxvalue").html("+5 gms");
	  $(parentContainer).find("#inputlabel").html(inputlabel) //+ " ("+$(parentContainer).find('#gramsmin').val()+"gm - "+$(parentContainer).find('#gramsmax').val()+"gm)");
	    


  
  }
		
	
}

var digitalJsonData;
if(document.getElementById("digitalgoldContainer"))
	{
	document.getElementsByClassName("gold_form")[0].id="buyform";
	document.getElementsByClassName("gold_form")[1].id="sellform";
    parentContainer = "#buyform";
document.addEventListener("DOMContentLoaded",apicall());
	}



function apicall(){
	document.getElementsByClassName("goldloader")[0].style.display="block";

	document.getElementsByClassName("goldloader")[1].style.display="block";

	$(parentContainer).find("#goldbuy").prop("disabled",true);
	clearInterval(x);
	if(campaign)
	{
	activetab=document.getElementsByClassName("tab-link tag active")[0];
	}
	else
	{
	activetab=document.getElementsByClassName("resp-tab-active")[0];
	}
//	if(typeof activetab=='undefined')
//	{
//   
//    parentContainer = "#buyform";
//    console.log("buyform form : buyform");
//	}
	
	if(document.getElementById("termsquote"))
		{
		setTermsQuote();
		}
	
//	if($(parentContainer).find("#counter"))
//	{
//	$(parentContainer).find("#counter").remove();
//	var counter=document.createElement("span");
//	counter.setAttribute("id",parentContainer.split("#")[1]+"counter");
//	$(parentContainer).find("#counterparent").append(counter);
//	//document.getElementById("counterparent").appendChild(counter);
//	 $(parentContainer).find("#counter").html("");
//
//	}else{
//		var counter=document.createElement("span");
//		counter.setAttribute("id",parentContainer.split("#")[1]+"counter");
//		$(parentContainer).find("#counterparent").append(counter);
//		//document.getElementById("counterparent").appendChild(counter);
//		 $(parentContainer).find("#counter").html("");
//		
//	}
	digitaltoggleLoader(true);

	if(parentContainer.includes("buy"))
		{
	if($(parentContainer).find('#rupees').prop("checked"))
		{
	$(parentContainer).find("#inputlabel").html("How much you want to buy?") // (Rs."+$(parentContainer).find("#rupeesmin").val()+" - Rs."+$(parentContainer).find("#rupeesmax").val()+")");
	$(parentContainer).find("#minvalue").html("+ &#8377; 1000");
	  $(parentContainer).find("#maxvalue").html("+ &#8377; 2000");
		}
	else
		{

		$(parentContainer).find("#inputlabel").html("How much you want to buy?") // ("+$(parentContainer).find("#gramsmin").val()+"gm - "+$(parentContainer).find("#gramsmax").val()+"gm)");
		$(parentContainer).find("#minvalue").html("+1 gms");
		  $(parentContainer).find("#maxvalue").html("+5 gms");
		}
		}
	else
		{
		if($(parentContainer).find('#rupees').prop("checked"))
		{
			$(parentContainer).find("#inputlabel").html("How much you want to sell?"); // (Rs."+$(parentContainer).find("#rupeesmin").val()+" - Rs."+$(parentContainer).find("#rupeesmax").val()+")");
			$(parentContainer).find("#minvalue").html("+ &#8377; 1000");
			$(parentContainer).find("#maxvalue").html("+ &#8377; 2000");
		}
	else
		{
			$(parentContainer).find("#inputlabel").html("How much you want to sell?"); // ("+$(parentContainer).find("#gramsmin").val()+"gm - "+$(parentContainer).find("#gramsmax").val()+"gm)");
			$(parentContainer).find("#minvalue").html("+1 gms");
			$(parentContainer).find("#maxvalue").html("+5 gms");
		}
		}
	//$("#sellform #inputlabel").html("How much you want to sell? (Rs.500 - Rs.100000)");
	
  var reqtype = $(parentContainer).find("#reqType").val();
  var vendorID = $(parentContainer).find("#vendorID").val();
      var formData = new FormData();
      formData.append("reqtype", reqtype);
      formData.append("vendorID", vendorID);
     // var sendData = new URLSearchParams(formData).toString();     
      //var apiurl= ""+AppConstants.API_URI +"."+ AppConstants.API_SELECTOR.DIGITAL_GOLD.name +"."+ AppConstants.EXTENSION;
      var apiurl = AppConstants.API_SELECTOR.DIGITAL_GOLD.url + "?reqtype="+reqtype + "&vendorID=" + vendorID;
//"/v1/dg/price?reqtype="+reqtype+"&vendorID="+vendorID;
    	
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function(){
          if(this.readyState == 4 && this.status == 200){
        		document.getElementsByClassName("goldloader")[0].style.display="none";
      		document.getElementsByClassName("goldloader")[1].style.display="none";

              var responseData = JSON.parse(this.responseText);
              console.log("This is the new api response: "+responseData);
              digitalJsonData = responseData;
          //    digitaltoggleLoader(false);

              $(parentContainer).find("#price").html("Rs. "+responseData.payload[0].current_price+"/g");
              var pricetext=$(parentContainer).find("#price").text();
              if(pricetext!="")
               	{
               	$(parentContainer).find("#goldbuy").prop("disabled",false);
               	}
              clearTimeout(timeoutHandle);
              clearTimeout(countdownhandle);
              var counter=document.createElement("span");
              counter.setAttribute("id","counter");
  			$('#buyform #counterparent').append(counter);
  			var dt = responseData.payload[0].rate_validity.split(/[- :]/);
  			var timelimit=new Date(dt[0], dt[1], dt[2], dt[3], dt[4], dt[5]);
  			//var timelimit=new Date(responseData.payload[0].rate_validity);

              countdown(timelimit);
          	  
          }
         
      };
      xhttp.open("GET",apiurl,true);
      xhttp.setRequestHeader("authtoken",sessionStorage.getItem("SS_1"));
      xhttp.setRequestHeader("Content-Type","application/json")
      xhttp.send();
}
     /* AppEvent
        .trigger(
          AppConstants.API_SELECTOR.DIGITAL_GOLD.name, sendData)
        .then(
          function (response) {
          digitalJsonData = response;
            toggleLoader(false);
            console.log(response);
            $(parentContainer).find("#price").html("Rs. "+digitalJsonData.payload[0].current_price+"/g");
            var pricetext=$(parentContainer).find("#price").text();
           if(pricetext!="")
            	{
            	$(parentContainer).find("#goldbuy").prop("disabled",false);
            	}
            	clearTimeout(timeoutHandle);
            	clearTimeout(countdownhandle);
            
                var counter=document.createElement("span");
                counter.setAttribute("id","counter");
    			$('#buyform #counterparent').append(counter);
    			var timelimit=new Date(digitalJsonData.payload[0].rate_validity);
    			
    			countdown(timelimit);
          })
}*/


  
	
	
	
	function countdown(timelimit) {
		
		var deadline = timelimit.getTime(); 
		x = setInterval(function() { 
		var now = new Date().getTime(); 
		var t = deadline - now; 
		
		var minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60)) - 2; 
		var seconds = Math.floor((t % (1000 * 60)) / 1000); 
		$(parentContainer).find("#counter").html(minutes + "m:" +seconds + "s"); 
		    if (minutes == 0 && seconds==0) { 
				$(parentContainer).find("#counter").html(""); 
		        clearInterval(x); 
		        apicall(); 
		       // digitaltoggleLoader(false);
		    } 
		}, 1000); 
		
		//if(statusForInterval){
	    /*var seconds = 60;
	    var mins = minutes;
	    function tick() {
	       
	        var current_minutes = mins-1;
	        seconds--;
	        timer=current_minutes.toString() + "m:" + (seconds < 10 ? "0" : "") + String(seconds)+"s";
	        $(parentContainer).find("#counter").html(timer);
	        if( seconds > 0 ) {
	           
	            	if(statusForInterval){
	            		 timeoutHandle=setTimeout(function(){
	            		tick();
	            		 }, 1000);
	            	}
	            	else{
	            		clearTimeout(timeoutHandle);
	            		statusForInterval = true;
	            		countdown(mins);
	            		return;
	            		}
	            	
	        }
	        else if(seconds<=0 && current_minutes<=0)
	        	{
	        	apicall();
	        	}
	        	
	        	
	        	else {

	            if(mins > 1){

	               // countdown(mins-1);   never reach “00? issue solved:Contributed by Victor Streithorst
	            	
	            	   if(statusForInterval){ 
	            		   countdownhandle = setTimeout(function () { 
	            		   countdown(mins - 1);
	            		   }, 1000);
		            	}
		            	else{
		            		statusForInterval = true;
		            		clearTimeout(countdownhandle);
		            		countdown(mins);
		            		return;
		            	}  
	            	   
	              
	               
	            }
	            //$(parentContainer).find("#counter").html(current_minutes+" m: "+seconds+"");
	        }
	       
	    }
	    tick();*/
	}

function generateurl()
{
	
  var url=$(parentContainer).find("#buyurl").val();
  var unit=$(parentContainer).find("#rupees").prop("checked") ? "rupees" : "grams";
  var amount=parseFloat($(parentContainer).find("#gold-amount").val());
  var type;
  var rate=digitalJsonData.payload[0].current_price;
 // var productName = AppConstants.ANALYTICS_DATA.PRODUCT_NAME.DIGI_GOLD.DG;
  if($(parentContainer).find('#reqType').val().includes("buy"))
	  {
	  type="buy";
	  triggerDigiGoldBuyNow(window.productName,rate,unit,amount);
	  }
  else
	  {
	  triggerDigiGoldSellNow(window.productName,rate,unit,amount);
	  type="sell";
	  }
  url+="product=digital_gold&partner=safegold&transaction_type="+type+"&unit="+unit+"&amount="+amount+"&live_rate="+rate;

  UTMGenerate(url);
  event.preventDefault();
}


function validategold()
{
	
		
  //  event.preventDefault();
	
var activetab=document.getElementsByClassName("resp-tab-active")[0];
var status;
var amount;
var rupeesmin=parseFloat($(parentContainer).find("#rupeesmin").val());
var rupeesmax=parseFloat($(parentContainer).find("#rupeesmax").val());
var gramsmin=parseFloat($(parentContainer).find("#gramsmin").val());
var gramsmax=parseFloat($(parentContainer).find("#gramsmax").val());

if($(parentContainer).find("#gold-amount").val() !="")
	{
	var rupval=$(parentContainer).find("#gold-amount").val();
	var str=rupval.split(".");
	if(str.length>1)
		{
	var goldamountcount=str[1].length;
		}
	else
		{
		goldamountcount=0;
		}
	console.log(str);
	amount=parseFloat($(parentContainer).find("#gold-amount").val());
	}
else
	{
	amount=0;
	}

if($(parentContainer).find("#rupees").prop("checked"))
{
if(amount>rupeesmax || amount<rupeesmin)
	  {
	showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter amount between Rs."+rupeesmin+" - Rs."+rupeesmax, true);
		status=false;
	  }
else if(goldamountcount>4)
	{
	showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter decimal only upto 4 places", true);
	status=false;
	}
else
	{
	showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "", false);
		status=true;
	}

}
else if($(parentContainer).find("#grams").prop("checked"))
{
if(amount>gramsmax || amount<gramsmin)
{
	showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter amount between "+gramsmin+"gm - "+gramsmax+"gm", true);
	status=false;
}
else if(goldamountcount>2)
{
showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "Enter decimal only upto 2 places", true);
status=false;
}
else
	{
	showErrorByQuerySelector(createFormLabelQuery(parentContainer.split("#")[1],"goldamounterrormsg"), "", false);
	status=true;
	}

}
if(status==true)
	{
	generateurl();
	}
}


function setTermsQuote()
{
	var activeCampaignTab=document.querySelector(".tab-content.active").id;
	if(activeCampaignTab=="tab-1")
	{
	document.getElementById("termsquote").innerHTML='"Buy Now"';
	}
	else
		{
		document.getElementById("termsquote").innerHTML='"Sell Now"';

		}
}

if(document.getElementById("termsquote"))
{
document.getElementsByClassName("tabs")[0].addEventListener('click',setTermsQuote());
}


$("#buyform #goldbuy").click(function(event){
	  event.preventDefault();
	});

$("#sellform #goldbuy").click(function(event){
	  event.preventDefault();
	});

$('.label-input-group').click(function()
		{
	
			$('.label-input-group').addClass('focus');
			$('#sellform #gold-amount').focus();
		}
);

$('.price-tab').click(function()
		
		{
			$('.label-input-group').addClass('focus');
		}
);
		
$('.price-tab.min-value').mousedown(function()
		{
			$('.price-tab.min-value').css({'color':'#ffffff', 'background':'#ff5928'});
		});

$('.price-tab.min-value').mouseup(function()
		{
			$('.price-tab.min-value').css({'color':'#ff5928', 'background':'#ffffff'});
		});
$('.price-tab.max-value').mousedown(function()
		{
			$('.price-tab.max-value').css({'color':'#ffffff', 'background':'#ff5928'});
		});

$('.price-tab.max-value').mouseup(function()
		{
			$('.price-tab.max-value').css({'color':'#ff5928', 'background':'#ffffff'});
		});

function UTMGenerate(url) {
    var utm_params;
    var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
    var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
    if (urlParams) {
        utm_params = window.urlObj.search;
        if ($(this).attr("target")) {
            if (url.includes('?')) {
                if (utm_params.includes('&nav_src')) {
                    window.open(url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                    return false;
                }
                else {
                    window.open(url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                    return false;
                }
            }
            else {
                window.open(url + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                return false;
            }
        }
        else {
            if (url.includes('?')) {
                if (utm_params.includes('&nav_src')) {
                    window.location.href = url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                    return false;
                }
                else {
                    window.location.href = url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                    return false;
                }
            }
            else {
                if (utm_params.includes('&nav_src')) {
                    window.location.href = url + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                    return false;
                }
                else {
                    window.location.href = url + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                    return false;
                }
            }
        }
    }
    else {
        utm_params = utm;
        if ($(this).attr("target")) {
            if (url.includes('?')) {
                if (utm_params.includes('&nav_src')) {
                    window.open(url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                    return false;
                }
                else {
                    window.open(url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                    return false;
                }
            }
            else {
                window.open(url + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                return false;
            }
        }
        else {
            if (url.includes('?')) {
                if (utm_params.includes('&nav_src')) {
                    window.location.href = url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                    return false;
                }
                else {
                    if (utm_params.length > 0) {
                        window.location.href = url + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                        return false;
                    }
                    else {
                        window.location.href = url;
                        return false;
                    }
	                /* window.location.href = url+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
	                return false; */
                }
            }
            else {
                if (utm_params.includes('&nav_src')) {
                    window.location.href = url + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                    return false;
                }
                else {
                    if (utm_params.length > 0) {
                        window.location.href = url + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                        return false;
                    }
                    else {
                        window.location.href = url;
                        return false;
                    }
	                /* window.location.href = url+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
	                return false; */
                }
            }
        }

    }
}

function digitaltoggleLoader(loaderstatus) {
	 
		if (loaderstatus == true) {
			$("#digitalgold-loader").css('display','block');
		}
		else {
			$("#digitalgold-loader").css('display','none');
		}
	}

$(window).bind("load", function() {
	if(document.getElementById("digitalgoldContainer")){
		var tab = $(".resp-tab-item.hor_1");
		if(tab[0].classList.contains("resp-tab-active")){
			parentContainer = "#buyform";
		}else if(tab[1].classList.contains("resp-tab-active")){
			parentContainer = "#sellform";
		}else{
			parentContainer = "#buyform";
		}
		apicall();
	}
	});




/*var requestUrl = "";
function getBlogJson(response){
	var blogData =JSON.parse(response); 
	var createHTML = "";
	$('.blogtabparent').html('');
for(i=blogData.blogs.length-1;i>=0;i--){
createHTML ='<div class="blogcards blog-all blog-loan"> <div class="blogmain"> <a href="'+blogData.blogs[i].url+".html"+'" class="blogimage"> <img src="'+blogData.blogs[i].img+'"> </a> <div class="blogcontent"> <a href="'+blogData.blogs[i].url+".html"+'" class="blogtitle"><h2 class="blog-head-2">'+blogData.blogs[i].title+ '</h2></a> <div class="dateauthorparent"> <div class="dateauthor">'+blogData.blogs[i].articleDate+'</div><div class="views"><img src="/content/dam/bajajfinserv/views.png">'+blogData.blogs[i].viewsCount+'</div></div><div class="blogdesc"> <p>'+blogData.blogs[i].desc+'</p></div><a href="'+blogData.blogs[i].url+".html"+'" class="readblog">READ MORE</a> <div class="sharesection"> <span class="sharespan"><img src="/content/dam/bajajfinserv/sharing.png"></span> <ul><li><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?kid_directed_site=0&u='+blogData.blogs[i].url+'.html"><img src="/content/dam/bajajfinserv/facebook.png"></a></li><li><a href="https://twitter.com/share?url='+blogData.blogs[i].url+'.html" target="_blank"><img src="/content/dam/bajajfinserv/twitter.png"></a></li>'+
        '<li><a href="https:/web.whatsapp.com:/send?text='+blogData.blogs[i].url+'.html" target="_blank"><img src="/content/dam/bajajfinserv/whatsapp.png"></a></li> </ul> </div></div></div></div>';
	    $('.blogtabparent').append(createHTML); 
	}
}
if(document.getElementById("blog-card"))
{
	var requestUrl = "";
	var pageURl = window.location.href;
	var urlSplitOrigin = pageURl.split(location.origin);
	var urlSplitHTML = urlSplitOrigin[1].substring(0,urlSplitOrigin[1].lastIndexOf(".html"));
	if(urlSplitHTML.includes("/content")){
	 requestUrl = urlSplitHTML + "/articlenode.json";
	}else{
    requestUrl = urlSplitHTML + "/articlenode.json";
	}
	executeRequest(requestUrl,getBlogJson);
}
function executeRequest(requestUrl,callBack) {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
    if(callBack)
          callBack(this.responseText);
    }
  };
  xhttp.open("GET", requestUrl, true);
  xhttp.send();
}

*/
$(window).on('load', function () {

	
    $('.sharespan').on('click', function () {
        $(this).parent().children('ul').toggle("slide");
    });

    $('.articletabs ul li').on('click', function () {
        $('.articletabs ul li').removeClass('current');
        $(this).addClass('current');
        var showitem = $(this).attr('data-list');
        console.log(showitem);
        $('.blogcards').hide();
        $('.' + showitem).fadeIn();

        var items = $("." + showitem);
        var numItems = items.length;
        var perPage = 10;

        items.slice(perPage).hide();

        $('#pagination-container').pagination('destroy');

        $('#pagination-container').pagination({
            items: numItems,
            itemsOnPage: perPage,
            prevText: '<img class="arrowimg" src="/content/dam/bajajfinserv/back.png">',
            nextText: '<img class="arrowimg" src="/content/dam/bajajfinserv/right-arrow.png">',
            onPageClick: function (pageNumber) {
                var showFrom = perPage * (pageNumber - 1);
                var showTo = showFrom + perPage;
                items.hide().slice(showFrom, showTo).fadeIn();
            }
        });

    });


    if($(".blogcards").length > 0){
    var items = $(".blogtabparent .blog-all");
    var numItems = items.length;
    var perPage = 10;

    items.slice(perPage).hide();

    $('.blogcards #pagination-container').pagination('destroy');
    if(numItems > 10){
    $('.blogcards #pagination-container').pagination({
        items: numItems,
        itemsOnPage: perPage,
        prevText: '<img class="arrowimg" src="/content/dam/bajajfinserv/back.png">',
        nextText: '<img class="arrowimg" src="/content/dam/bajajfinserv/right-arrow.png">',
        onPageClick: function (pageNumber) {
            var showFrom = perPage * (pageNumber - 1);
            var showTo = showFrom + perPage;
            items.hide().slice(showFrom, showTo).fadeIn();
        }
    });
    }
	}
});

$("a[href]").on("click", function (e) {
	var utm_params;
	var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
	var confParams= window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
	if(urlParams){
		utm_params = window.urlObj.search;
		if($(this).attr("target")){
			if($(this).attr("href").includes('?')){
				if(utm_params.includes('&nav_src')){
					window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
					return false;
				}
				else{
					window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.length), $(this).attr("target"));
					return false;
				}
			}
			else{
				window.open($(this).attr("href")+ '?' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
				return false;
			}
		}
		else{
			if($(this).attr("href").includes('?')){
				if(utm_params.includes('&nav_src')){
					window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
					return false;
				}
				else{
					window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
					return false;
				}
			}
			else{
				if(utm_params.includes('&nav_src')){
					window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
					return false;
				}
				else{
					if($(this).attr("href").indexOf("#") != 0){
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false;
					}
					/*window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
					return false;*/
				}
			}
		}
	}
	else{
		utm_params = utm;
		if($(this).attr("target")){
			if($(this).attr("href").includes('?')){
				if(utm_params.includes('&nav_src')){
					window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
					return false;
				}
				else{
					window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.length), $(this).attr("target"));
					return false;
				}
			}
			else{
				window.open($(this).attr("href")+ '?' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
				return false;
			}
		}
		else{
			if($(this).attr("href").includes('?')){
				if(utm_params.includes('&nav_src')){
					window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
					return false;
				}
				else{
					if(utm_params.length > 0){
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false;
					}
					else{
						window.location.href = $(this).attr("href");
						return false;
					}
					/* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
					return false; */
				}
			}
			else{
				if(utm_params.includes('&nav_src')){
					window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
					return false;
				}
				else{
					if(utm_params.length > 0){
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false;
					}
					else{
						window.location.href = $(this).attr("href");
						return false;
					}
					/* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
					return false; */
				}
			}
		}
	}
});
/**
* simplePagination.js v1.6
* A simple jQuery pagination plugin.
* http://flaviusmatis.github.com/simplePagination.js/
*
* Copyright 2012, Flavius Matis
* Released under the MIT license.
* http://flaviusmatis.github.com/license.html
*/

(function($){
	var methods = {
		init: function(options) {
			var o = $.extend({
				items: 1,
				itemsOnPage: 1,
				pages: 0,
				displayedPages: 5,
				edges: 2,
				currentPage: 0,
				useAnchors: true,
				hrefTextPrefix: '#page-',
				hrefTextSuffix: '',
				prevText: 'Prev',
				nextText: 'Next',
				ellipseText: '&hellip;',
				ellipsePageSet: true,
				cssStyle: 'light-theme',
				listStyle: '',
				labelMap: [],
				selectOnClick: true,
				nextAtFront: false,
				invertPageOrder: false,
				useStartEdge : true,
				useEndEdge : true,
				onPageClick: function(pageNumber, event) {
					// Callback triggered when a page is clicked
					// Page number is given as an optional parameter
				},
				onInit: function() {
					// Callback triggered immediately after initialization
				}
			}, options || {});

			var self = this;

			o.pages = o.pages ? o.pages : Math.ceil(o.items / o.itemsOnPage) ? Math.ceil(o.items / o.itemsOnPage) : 1;
			if (o.currentPage)
				o.currentPage = o.currentPage - 1;
			else
				o.currentPage = !o.invertPageOrder ? 0 : o.pages - 1;
			o.halfDisplayed = o.displayedPages / 2;

			this.each(function() {
				self.addClass(o.cssStyle + ' simple-pagination').data('pagination', o);
				methods._draw.call(self);
			});

			o.onInit();

			return this;
		},

		selectPage: function(page) {
			methods._selectPage.call(this, page - 1);
			return this;
		},

		prevPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			} else {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			}
			return this;
		},

		nextPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			} else {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			}
			return this;
		},

		getPagesCount: function() {
			return this.data('pagination').pages;
		},

		setPagesCount: function(count) {
			this.data('pagination').pages = count;
		},

		getCurrentPage: function () {
			return this.data('pagination').currentPage + 1;
		},

		destroy: function(){
			this.empty();
			return this;
		},

		drawPage: function (page) {
			var o = this.data('pagination');
			o.currentPage = page - 1;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		redraw: function(){
			methods._draw.call(this);
			return this;
		},

		disable: function(){
			var o = this.data('pagination');
			o.disabled = true;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		enable: function(){
			var o = this.data('pagination');
			o.disabled = false;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		updateItems: function (newItems) {
			var o = this.data('pagination');
			o.items = newItems;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._draw.call(this);
		},

		updateItemsOnPage: function (itemsOnPage) {
			var o = this.data('pagination');
			o.itemsOnPage = itemsOnPage;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._selectPage.call(this, 0);
			return this;
		},

		getItemsOnPage: function() {
			return this.data('pagination').itemsOnPage;
		},

		_draw: function() {
			var	o = this.data('pagination'),
				interval = methods._getInterval(o),
				i,
				tagName;

			methods.destroy.call(this);

			tagName = (typeof this.prop === 'function') ? this.prop('tagName') : this.attr('tagName');

			var $panel = tagName === 'UL' ? this : $('<ul' + (o.listStyle ? ' class="' + o.listStyle + '"' : '') + '></ul>').appendTo(this);

			// Generate Prev link
			if (o.prevText) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage - 1 : o.currentPage + 1, {text: o.prevText, classes: 'prev'});
			}

			// Generate Next link (if option set for at front)
			if (o.nextText && o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}

			// Generate start edges
			if (!o.invertPageOrder) {
				if (interval.start > 0 && o.edges > 0) {
					if(o.useStartEdge) {
						var end = Math.min(o.edges, interval.start);
						for (i = 0; i < end; i++) {
							methods._appendItem.call(this, i);
						}
					}
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
				}
			} else {
				if (interval.end < o.pages && o.edges > 0) {
					if(o.useStartEdge) {
						var begin = Math.max(o.pages - o.edges, interval.end);
						for (i = o.pages - 1; i >= begin; i--) {
							methods._appendItem.call(this, i);
						}
					}

					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
				}
			}

			// Generate interval links
			if (!o.invertPageOrder) {
				for (i = interval.start; i < interval.end; i++) {
					methods._appendItem.call(this, i);
				}
			} else {
				for (i = interval.end - 1; i >= interval.start; i--) {
					methods._appendItem.call(this, i);
				}
			}

			// Generate end edges
			if (!o.invertPageOrder) {
				if (interval.end < o.pages && o.edges > 0) {
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
					if(o.useEndEdge) {
						var begin = Math.max(o.pages - o.edges, interval.end);
						for (i = begin; i < o.pages; i++) {
							methods._appendItem.call(this, i);
						}
					}
				}
			} else {
				if (interval.start > 0 && o.edges > 0) {
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}

					if(o.useEndEdge) {
						var end = Math.min(o.edges, interval.start);
						for (i = end - 1; i >= 0; i--) {
							methods._appendItem.call(this, i);
						}
					}
				}
			}

			// Generate Next link (unless option is set for at front)
			if (o.nextText && !o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}

			if (o.ellipsePageSet && !o.disabled) {
				methods._ellipseClick.call(this, $panel);
			}

		},

		_getPages: function(o) {
			var pages = Math.ceil(o.items / o.itemsOnPage);
			return pages || 1;
		},

		_getInterval: function(o) {
			return {
				start: Math.ceil(o.currentPage > o.halfDisplayed ? Math.max(Math.min(o.currentPage - o.halfDisplayed, (o.pages - o.displayedPages)), 0) : 0),
				end: Math.ceil(o.currentPage > o.halfDisplayed ? Math.min(o.currentPage + o.halfDisplayed, o.pages) : Math.min(o.displayedPages, o.pages))
			};
		},

		_appendItem: function(pageIndex, opts) {
			var self = this, options, $link, o = self.data('pagination'), $linkWrapper = $('<li></li>'), $ul = self.find('ul');

			pageIndex = pageIndex < 0 ? 0 : (pageIndex < o.pages ? pageIndex : o.pages - 1);

			options = {
				text: pageIndex + 1,
				classes: ''
			};

			if (o.labelMap.length && o.labelMap[pageIndex]) {
				options.text = o.labelMap[pageIndex];
			}

			options = $.extend(options, opts || {});

			if (pageIndex == o.currentPage || o.disabled) {
				if (o.disabled || options.classes === 'prev' || options.classes === 'next') {
					$linkWrapper.addClass('disabled');
				} else {
					$linkWrapper.addClass('active');
				}
				$link = $('<span class="current">' + (options.text) + '</span>');
			} else {
				if (o.useAnchors) {
					$link = $('<a href="' + o.hrefTextPrefix + (pageIndex + 1) + o.hrefTextSuffix + '" class="page-link">' + (options.text) + '</a>');
				} else {
					$link = $('<span >' + (options.text) + '</span>');
				}
				$link.click(function(event){
					return methods._selectPage.call(self, pageIndex, event);
				});
			}

			if (options.classes) {
				$link.addClass(options.classes);
			}

			$linkWrapper.append($link);

			if ($ul.length) {
				$ul.append($linkWrapper);
			} else {
				self.append($linkWrapper);
			}
		},

		_selectPage: function(pageIndex, event) {
			var o = this.data('pagination');
			o.currentPage = pageIndex;
			if (o.selectOnClick) {
				methods._draw.call(this);
			}
			return o.onPageClick(pageIndex + 1, event);
		},


		_ellipseClick: function($panel) {
			var self = this,
				o = this.data('pagination'),
				$ellip = $panel.find('.ellipse');
			$ellip.addClass('clickable').parent().removeClass('disabled');
			$ellip.click(function(event) {
				if (!o.disable) {
					var $this = $(this),
						val = (parseInt($this.parent().prev().text(), 10) || 0) + 1;
					$this
						.html('<input type="number" min="1" max="' + o.pages + '" step="1" value="' + val + '">')
						.find('input')
						.focus()
						.click(function(event) {
							// prevent input number arrows from bubbling a click event on $ellip
							event.stopPropagation();
						})
						.keyup(function(event) {
							var val = $(this).val();
							if (event.which === 13 && val !== '') {
								// enter to accept
								if ((val>0)&&(val<=o.pages))
								methods._selectPage.call(self, val - 1);
							} else if (event.which === 27) {
								// escape to cancel
								$ellip.empty().html(o.ellipseText);
							}
						})
						.bind('blur', function(event) {
							var val = $(this).val();
							if (val !== '') {
								methods._selectPage.call(self, val - 1);
							}
							$ellip.empty().html(o.ellipseText);
							return false;
						});
				}
				return false;
			});
		}

	};

	$.fn.pagination = function(method) {

		// Method calling logic
		if (methods[method] && method.charAt(0) != '_') {
			return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(this, arguments);
		} else {
			$.error('Method ' +  method + ' does not exist on jQuery.pagination');
		}

	};

})(jQuery);

var category;
var subcategory;
var categories;
var funds;
var investnowurl;
$(document).ready(function() {
	$('.trcategory').select2({
		minimumResultsForSearch : -1
	});
	$('.trsubcategory').select2({
		minimumResultsForSearch : -1
	});
});

if (document.getElementById("mutualFundsContainer")) {
	investnowurl = $("#investnow").val();
	document.addEventListener("DOMContentLoaded", getCategoryApiCall());
}

function getCategoryApiCall()
{
	/*var sendData = "";*/

AppEvent
.trigger(
  AppConstants.API_SELECTOR.MUTUAL_FUNDS_CATEGORY.name)
.then(
  function (response) {
  categories = response;
    toggleLoader(false);
    console.log(response); 
    getMutualFundCategory(categories);
   

  }).catch(function (err) {
      toggleLoader(false);
  })
}

function getFundsApiCall()
{
//	var category = $(parentContainer).find("#reqType").val();
//	  var subcategory = $(parentContainer).find("#vendorID").val();
	  	
	      var formData = new FormData();
	      formData.append("category", category);
	      formData.append("subcategory", subcategory);
	      formData.append("type","SIP");
	      //var sendData = new URLSearchParams(formData).toString();
	     
	      
	      if(AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.url.indexOf("?") > -1){
	    	  AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.url = AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.url.substring(0,AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.url.indexOf("?"))
	      }
	      AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.url= AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.url+"?category=" + category + "&sub-category=" + subcategory + "&type=SIP";
	      AppEvent
	        .trigger(
	          AppConstants.API_SELECTOR.MUTUAL_FUNDS_PLAN_DATA.name)
	        .then(
	          function (response) {
	          funds = response;
	            toggleLoader(false);
	            console.log(response); 
	            populateCards(funds);

	          }).catch(function (err) {
	              toggleLoader(false);
	          })
}

$("#category")
		.change(
				function() {
					$("#sub_category").empty();
					for (var i = 0; i < categories.payload.pfwresponse.result.result.length; i++) {
						if ($("#category").val() == categories.payload.pfwresponse.result.result[i].category) {
							for (var j = 0; j < categories.payload.pfwresponse.result.result[i].sub_categories.length; j++) {
								$("#sub_category")
										.append(
												"<option value='"
														+ categories.payload.pfwresponse.result.result[i].sub_categories[j].key
														+ "'> "
														+ categories.payload.pfwresponse.result.result[i].sub_categories[j].name
														+ "</option>");
							}
						}

					}
					category = $("#category").val();
					subcategory = $("#sub_category").val();
					getFundsApiCall()

				});

$("#sub_category").change(function() {
	subcategory = $("#sub_category").val();
	getFundsApiCall();
});

function populateCards(funds) {
	$("#fund_detail").empty();
	var fundstr = "";
	var funddetdata = funds.payload.pfwresponse.result.funds;
	var ratings = [ "", "Poor", "Fair", "Good", "Excellent", "WOW!!!" ];

	for (var i = 0; i < funddetdata.length; i++) {
		var star = parseInt(funddetdata[i].morning_star_rating);
		var starcount;
		if (star == 5) {
			starcount = "five";
		} else if (star == 4) {
			starcount = "four";
		} else if (star == 3) {
			starcount = "three";
		} else if (star == 2) {
			starcount = "two";
		} else {
			starcount = "one";
		}
		fundstr += '<div class="cardsinside aem-GridColumn aem-GridColumn--default--6 aem-GridColumn--tablet--6 aem-GridColumn--phone--1 demo-GridColumn demo-GridColumn--image">';
		fundstr += '<div class="categcards uclearfix">';
		fundstr += '<div class="imagesect"><img src="'
				+ funddetdata[i].amc_logo_small + '"></div>';
		fundstr += '<div class="descsect" fund-name="' + funddetdata[i].isin
				+ '">';
		fundstr += '<h3>' + funddetdata[i].legal_name + '</h3>';
		fundstr += '<div class="ratereturn clearfix">';
		fundstr += '<div class="ratingsect">';
		fundstr += '<span>Morningstar</span>';
		fundstr += '<div class="rating-stars">';
		fundstr += '<ul id="stars" class="' + starcount + '">';

		fundstr += '<li class="star" title="Poor" data-value="1">';
		fundstr += '<i class="fa fa-star fa-fw"></i>';
		fundstr += '</li>';
		fundstr += '<li class="star" title="Fair" data-value="2">';
		fundstr += '<i class="fa fa-star fa-fw"></i>';
		fundstr += '</li>';
		fundstr += '<li class="star" title="Good" data-value="3">';
		fundstr += '<i class="fa fa-star fa-fw"></i>';
		fundstr += '</li>';
		fundstr += '<li class="star" title="Excellent" data-value="4">';
		fundstr += '<i class="fa fa-star fa-fw"></i>';
		fundstr += '</li>';
		fundstr += '<li class="star" title="WOW!!!" data-value="5">';
		fundstr += '<i class="fa fa-star fa-fw"></i>';
		fundstr += '</li>';

		fundstr += '</ul>';
		fundstr += '</div>';
		fundstr += '</div>';
		if (!(funddetdata[i].one_year_return == null)) {
			fundstr += '<div class="returnsect">';
			fundstr += '<span>Return</span>';
			if (funddetdata[i].one_year_return > 0) {
				fundstr += '<span>+' + funddetdata[i].one_year_return
						+ '%</span>';
			} else {
				fundstr += '<span>' + funddetdata[i].one_year_return
						+ '%</span>';
			}

			fundstr += '</div>';
		}
		var url = investnowurl + "product=MF&isin=" + funddetdata[i].isin;
		var newurl = UTMReturnUrl(url);
		fundstr += '</div>';
		fundstr += '<div class="ctasect">';
		fundstr += '<a name=""mf-btn" target="_blank" href="'
				+ newurl
				+ '"><button class="btn get-quote-btn" type="submit">Invest now</button></a>';
		fundstr += '<a name="mf-btn" target="_blank" href="' + newurl
				+ '" class="btn btn-link">Know More</a>';
		fundstr += '</div>';
		fundstr += '</div>';
		fundstr += '</div>';
		fundstr += '</div>';
		if (i == funddetdata.length - 1) {
			fundstr += '<div id="pagination-category"></div>';
			fundstr += '</div>';
		}
	}

	$("#fund_detail").html(fundstr);
	var items = $(".categorycontentmaininner .cardsinside");
	var numItems = items.length;
	var perPage = 6;
	console.log(items + "===" + numItems);

	items.slice(perPage).hide();
	$('#pagination-category')
			.pagination(
					{
						items : numItems,
						itemsOnPage : perPage,
						prevText : '<img class="arrowimg" src="/content/dam/bajajfinserv/back.png">',
						nextText : '<img class="arrowimg" src="/content/dam/bajajfinserv/right-arrow.png">',
						onPageClick : function(pageNumber) {
							var showFrom = perPage * (pageNumber - 1);
							var showTo = showFrom + perPage;
							items.hide().slice(showFrom, showTo).fadeIn();
						}
					});

}

function getMutualFundCategory(categories) {

	console.log(categories.payload.pfwresponse.result.result);
	$("#category").empty();
	for (var i = 0; i < categories.payload.pfwresponse.result.result.length; i++) {

		$("#category")
				.append(
						"<option value='"
								+ categories.payload.pfwresponse.result.result[i].category
								+ "'> "
								+ categories.payload.pfwresponse.result.result[i].category
								+ "</option>");

	}

	$("#sub_category").empty();

	for (var i = 0; i < categories.payload.pfwresponse.result.result.length; i++) {
		if ($("#category").val() == categories.payload.pfwresponse.result.result[i].category) {
			for (var j = 0; j < categories.payload.pfwresponse.result.result[i].sub_categories.length; j++) {
				$("#sub_category")
						.append(
								"<option value='"
										+ categories.payload.pfwresponse.result.result[i].sub_categories[j].key
										+ "'> "
										+ categories.payload.pfwresponse.result.result[i].sub_categories[j].name
										+ "</option>");
			}
		}

	}
	category = $("#category").val();
	subcategory = $("#sub_category").val();
	getFundsApiCall();
}

function UTMReturnUrl(url) {
	var utm_params;
	var urlParams = window.urlObj.search.includes("src_30")
			|| window.urlObj.search.includes("src_60")
			|| window.urlObj.search.includes("src_90")
			|| window.urlObj.search.includes("pid")
			|| window.urlObj.search.includes("utm_source");
	var confParams = window.urlObj.search.includes("prodCode")
			|| window.urlObj.search.includes(" ");
	if (urlParams) {
		utm_params = window.urlObj.search;
		if ($(this).attr("target")) {
			if (url.includes('?')) {
				if (utm_params.includes('&nav_src')) {
					window.open(url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.indexOf('&nav_src')), $(this)
							.attr("target"));

				} else {
					window.open(url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.length), $(this).attr("target"));
				}
			} else {
				window.open(url
						+ '?'
						+ utm_params.substring(utm_params.indexOf('?') + 1,
								utm_params.indexOf('&nav_src')), $(this).attr(
						"target"));
			}
		} else {
			if (url.includes('?')) {
				if (utm_params.includes('&nav_src')) {
					url = url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.indexOf('&nav_src'));
				} else {
					url = url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.length);
				}
			} else {
				if (utm_params.includes('&nav_src')) {
					url = url
							+ '?'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.indexOf('&nav_src'));
				} else {
					url = url
							+ '?'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.length);
				}
			}
		}
	} else {
		utm_params = utm;
		if ($(this).attr("target")) {
			if (url.includes('?')) {
				if (utm_params.includes('&nav_src')) {
					window.open(url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.indexOf('&nav_src')), $(this)
							.attr("target"));
				} else {
					window.open(url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.length), $(this).attr("target"));
				}
			} else {
				window.open(url
						+ '?'
						+ utm_params.substring(utm_params.indexOf('?') + 1,
								utm_params.indexOf('&nav_src')), $(this).attr(
						"target"));
			}
		} else {
			if (url.includes('?')) {
				if (utm_params.includes('&nav_src')) {
					url = url
							+ '&'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.indexOf('&nav_src'));
				} else {
					if (utm_params.length > 0) {
						url = url
								+ '&'
								+ utm_params.substring(
										utm_params.indexOf('?') + 1,
										utm_params.length);
					}

					/*
					 * window.location.href = url+ '&' +
					 * utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
					 * return false;
					 */
				}
			} else {
				if (utm_params.includes('&nav_src')) {
					url = url
							+ '?'
							+ utm_params.substring(utm_params.indexOf('?') + 1,
									utm_params.indexOf('&nav_src'));
				} else {
					if (utm_params.length > 0) {
						url = url
								+ '?'
								+ utm_params.substring(
										utm_params.indexOf('?') + 1,
										utm_params.length);
					}

					/*
					 * window.location.href = url+ '?' +
					 * utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
					 * return false;
					 */
				}
			}
		}

	}
	return url;
}
$(window).on(
		'load',
		function() {
			$(".categcards")
					.on(
							'click',
							function() {
								var investNowBtn = this
										.querySelector('a[name=mf-btn]');
								if (investNowBtn) {
									var fundName = this.querySelector(
											'.descsect').getAttribute(
											'fund-name');
									triggerMFTopFundsInvestNow(
											window.productName, fundName);
								}
							});
		});

var jsonDataReturnROI = "";
var validationStatusInvest = true;
var validationStatusTenure = true;
var FdReturnUIController = (function (fdReturnLogicCtrl, fdReturnAJAXCtrl, fdReturnValidationUICtrl) {
    return {
        getInput: function () {
            return {
                custType: document.getElementById("cust-type").value,
                investmentAmount: document.getElementById("investment-amnt").value,
                tenure: document.getElementById("tenure").value
            }
        },
        returnFDMasterJson: function () {
            if (document.getElementById("return-calc")) {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        jsonDataReturnROI = JSON.parse(xhttp.responseText);
                    }
                };
                xhttp.open("GET", "/content/bajajfinserv/masters.fixed-deposit.json", false);
                xhttp.send();
                return jsonDataReturnROI;
            }
        },
        creatCardforCommulative: function (fetchedCalculatedDataCum) {
            var commulativeContainer = document.getElementById("commulativeContainer");
            commulativeContainer.innerHTML = "";
            var cardCommulativeTemplate = document.getElementById("cardCommulativeTemplate").cloneNode(true);
            var contentElement = cardCommulativeTemplate.content;
            contentElement.querySelector("#title").innerHTML = "Cumulative";
            contentElement.querySelector("#totalIntrestCom").innerHTML = "₹ " + Math.round(fetchedCalculatedDataCum.intrestEarned).toLocaleString("en-IN");
            contentElement.querySelector("#principalAmountCom").innerHTML = "₹ " + fetchedCalculatedDataCum.principalAmount;
            contentElement.querySelector("#rateOfIntrestCom").innerHTML = parseFloat((fetchedCalculatedDataCum.rateOfIntrest)).toFixed(2) + "%";
            contentElement.querySelector("#tenureCom").innerHTML = fetchedCalculatedDataCum.timePeriod + " Months";
            contentElement.querySelector("#maturityAmountCom").innerHTML = "₹ " + Math.round(fetchedCalculatedDataCum.maturityAmount).toLocaleString("en-IN");
            commulativeContainer.appendChild(contentElement)
        },
        creatCardforNonCommulative: function (fetchedCalculatedDataNomCum, c_targetID) {
            var clickTarget = c_targetID;
            var nonCommulativeContainer = document.getElementById("nonCommulativeContainer");
            nonCommulativeContainer.innerHTML = "";
            var cardNonCommulativeTemplate = document.getElementById("cardNonCommulativeTemplate").cloneNode(true);
            var contentElement = cardNonCommulativeTemplate.content;
            contentElement.querySelector("#title").innerHTML = "Non-cumulative";
            contentElement.querySelector("#totalIntrestNonCom").innerHTML = "₹ " + Math.round(fetchedCalculatedDataNomCum.intrestEarned).toLocaleString("en-IN");
            contentElement.querySelector("#principalAmountNonCom").innerHTML = "₹ " + fetchedCalculatedDataNomCum.principalAmount;
            contentElement.querySelector("#rateofIntrestNonCom").innerHTML = parseFloat((fetchedCalculatedDataNomCum.rateOfIntrest)).toFixed(2) + "%";
            contentElement.querySelector("#tenureNonCom").innerHTML = fetchedCalculatedDataNomCum.timePeriod + " Months";
            contentElement.querySelector("#maturityAmountNonCom").innerHTML = "₹ " + Math.round(fetchedCalculatedDataNomCum.maturityAmount).toLocaleString("en-IN");
            nonCommulativeContainer.appendChild(contentElement);
            if (clickTarget != undefined) {
                document.getElementById(clickTarget).checked = true;
            } else {
                document.querySelectorAll('#nonCommulativeContainer .bs-radio input[type="radio"]')[0].checked = true
            }
            document.querySelectorAll(".input-label-fd").forEach(function (items) {
                items.addEventListener("click", function (e) {
                    var fdFetchedData = FdReturnUIController.getInput();
                    var nonCumData = FdReturnLogicController.getCalculatedDataNonCum(fdFetchedData, e);
                    FdReturnUIController.creatCardforNonCommulative(nonCumData, e.target.parentElement.getElementsByTagName('input')[0].id);
                });
            });
        }
    }
})(FdReturnLogicController, FdReturnAjaxController, FdReturnValidationUIController);
var FdReturnLogicController = (function () {
    return {
        returnRateOfIntrestForCum: function (fetchedCalculatedDataCum, jsonDataReturnROI) {
            filterCondition = function (i) {
                return i.planType == "Cumulative" && i.customerType == fetchedCalculatedDataCum.custType && i.tenure == fetchedCalculatedDataCum.tenure;
            }
            var filteredROICum = jsonDataReturnROI.fixedDeposit.filter(filterCondition);
            return {
                monthlyIntrest: filteredROICum[0].monthly,
                quarterlyIntrest: filteredROICum[0].quarterly,
                halfYearlyIntrest: filteredROICum[0].halfYearly,
                yearlyIntrest: filteredROICum[0].yearly
            }
        },
        returnRateOfIntrestForNonCum: function (fetchedCalculatedDataNomCum, jsonDataReturnROI) {
            filterConditionNonCum = function (i) {
                return i.planType == "Non-Cumulative" && i.customerType == fetchedCalculatedDataNomCum.custType && i.tenure == fetchedCalculatedDataNomCum.tenure;
            }
            var filteredROI = jsonDataReturnROI.fixedDeposit.filter(filterConditionNonCum);
            return {
                monthlyIntrest: filteredROI[0].monthly,
                quarterlyIntrest: filteredROI[0].quarterly,
                halfYearlyIntrest: filteredROI[0].halfYearly,
                yearlyIntrest: filteredROI[0].yearly
            }
        },
        getCalculatedDataCum: function (fdFetchedData) {
            var principalAmount = fdFetchedData.investmentAmount;
            var timePeriod = fdFetchedData.tenure;
            var n = timePeriod / 12;
            var rateOfIntrestArray = FdReturnLogicController.returnRateOfIntrestForCum(fdFetchedData, jsonDataReturnROI);
            var rateOfIntrest = parseFloat(rateOfIntrestArray.yearlyIntrest);
            var r = rateOfIntrest / 100;
            var maturityAmount = principalAmount * Math.pow(1 + r, n);
            var intrestEarned = (maturityAmount - principalAmount) / 1;
            return {
                principalAmount: principalAmount,
                timePeriod: timePeriod,
                rateOfIntrest: rateOfIntrest,
                maturityAmount: maturityAmount,
                intrestEarned: intrestEarned
            }
        },
        getCalculatedDataNonCum: function (fdFetchedData, e) {
            var principalAmount = fdFetchedData.investmentAmount;
            var timePeriod = fdFetchedData.tenure;
            var n = timePeriod / 12;
            var rateOfIntrestArray = FdReturnLogicController.returnRateOfIntrestForNonCum(fdFetchedData, jsonDataReturnROI);
            var rateOfIntrest = parseFloat(rateOfIntrestArray.monthlyIntrest);
            var r = rateOfIntrest / 100;
            var N = 12;
            try {
                if (document.getElementById("monthly")) {
                    if (e.target.getAttribute("data-tenor") == 12) {
                        N = 12;
                        document.querySelector("#IHG20").checked = true;
                        rateOfIntrest = parseFloat(rateOfIntrestArray.monthlyIntrest);
                    } else if (e.target.getAttribute("data-tenor") == 4) {
                        N = 4;
                        document.querySelector("#IHG21").checked = true;
                        rateOfIntrest = parseFloat(rateOfIntrestArray.quarterlyIntrest);
                    } else if (e.target.getAttribute("data-tenor") == 2) {
                        N = 2;
                        document.querySelector("#IHG22").checked = true;
                        rateOfIntrest = parseFloat(rateOfIntrestArray.halfYearlyIntrest);
                    } else if (e.target.getAttribute("data-tenor") == 1) {
                        N = 1;
                        document.querySelector("#IHG23").checked = true;
                        rateOfIntrest = parseFloat(rateOfIntrestArray.yearlyIntrest);
                    }
                    r = rateOfIntrest / 100;
                }
            } catch (e) {}
            var maturityAmount = principalAmount * Math.pow(1 + r, n);
            var intrestEarned = (maturityAmount - principalAmount) / N;
            return {
                principalAmount: principalAmount,
                timePeriod: timePeriod,
                rateOfIntrest: rateOfIntrest,
                maturityAmount: maturityAmount,
                intrestEarned: intrestEarned
            }
        }
    }
})();
var FdReturnAjaxController = (function () {})();
var FdReturnValidationUIController = (function () {
    return {
        validateReturnCalcInvestment: function (fdFetchedData) {
            if (fdFetchedData.investmentAmount == "") {
                showError("investmentAmountErrorMsg", "Please Enter Investment Amount", true);
                validationStatusInvest = false;
                return validationStatusInvest;
            } else if (fdFetchedData.investmentAmount < 25000 || fdFetchedData.investmentAmount > 500000) {
                showError("investmentAmountErrorMsg", "Investment Amount should be between 25000 and 500000", true);
                validationStatusInvest = false;
                return validationStatusInvest;
            } else {
                showError("investmentAmountErrorMsg", "", false);
                validationStatusInvest = true;
                return validationStatusInvest;
            }
        },
        validateReturnCalcTenure: function (fdFetchedData) {
            if (fdFetchedData.tenure == "") {
                showError("tenureErrorMsg", "Please Enter Tenure", true);
                validationStatusTenure = false;
                return validationStatusTenure;
            } else if (fdFetchedData.tenure < 12 || fdFetchedData.tenure > 60) {
                showError("tenureErrorMsg", "Please Enter Tenure between 12 to 60", true);
                validationStatusTenure = false;
                return validationStatusTenure;
            } else {
                showError("tenureErrorMsg", "", false);
                validationStatusTenure = true;
                return validationStatusTenure;
            }
        }
    }
})();
var FdReturnGlobalController = (function (fdReturnUICtrl, fdReturnLogicCtrl, fdReturnAJAXCtrl, fdReturnValidationUICtrl) {
    if (document.getElementById('return-calc')) {
        var fdFetchedData = fdReturnUICtrl.getInput();
        var FDReturnInputData = function () {
            fdFetchedData = fdReturnUICtrl.getInput();
            event.preventDefault();
            if (jsonDataReturnROI == "") {
                jsonDataReturnROI = fdReturnUICtrl.returnFDMasterJson();
            }
            fdReturnValidationUICtrl.validateReturnCalcInvestment(fdFetchedData);
            fdReturnValidationUICtrl.validateReturnCalcTenure(fdFetchedData);
            var fetchedCalculatedDataCum = fdReturnLogicCtrl.getCalculatedDataCum(fdFetchedData);
            var fetchedCalculatedDataNonCum = fdReturnLogicCtrl.getCalculatedDataNonCum(fdFetchedData);
            fdReturnUICtrl.creatCardforCommulative(fetchedCalculatedDataCum);
            fdReturnUICtrl.creatCardforNonCommulative(fetchedCalculatedDataNonCum);
            callForRegisterFDEvent();
        }
        window.onload = function () {
            FDReturnInputData();
            document.querySelector("#calculateNowReturn").onclick = function () {
                fdFetchedData = fdReturnUICtrl.getInput();
                fdReturnValidationUICtrl.validateReturnCalcInvestment(fdFetchedData);
                fdReturnValidationUICtrl.validateReturnCalcTenure(fdFetchedData);
                if (validationStatusInvest == true && validationStatusTenure == true) {
                    fdFetchedData = fdReturnUICtrl.getInput();
                    FDReturnInputData();
                }
                $('html,body').animate({
                    scrollTop: $("#scrollTo").offset().top
                }, 'slow');
            };
            document.querySelectorAll(".input-label-fd").forEach(function (items) {
                items.addEventListener("click", function (e) {
                    var nonCumData = fdReturnLogicCtrl.getCalculatedDataNonCum(fdFetchedData, e);
                    fdReturnUICtrl.creatCardforNonCommulative(nonCumData, e.target.parentElement.getElementsByTagName('input')[0].id);
                });
            });
        };
    }
})(FdReturnUIController, FdReturnLogicController, FdReturnAjaxController, FdReturnValidationUIController);
function callForRegisterFDEvent() {
    $('#NonCumulativeBuyNow, #cumulativeBuyNow').on("click", function (e) {
    	var utm_params;
        var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
        var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
        if (urlParams) {
            utm_params = window.urlObj.search;
            if ($(this).attr("target")) {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                    } else {
                        if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                } else {
                    if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
            } else {
                if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        } else {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        }
                    } else {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        } else {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        }
                    }
                }
            }
        } else {
            if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                utm_params = utm;
                if ($(this).attr("target")) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        } else {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    } else {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                } else {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        } else {
                            if (utm_params.length > 0) {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            } else {
                                window.location.href = $(this).attr("href");
                                return false;
                            } /* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length); return false; */
                        }
                    } else {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        } else {
                            if (utm_params.length > 0) {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            } else {
                                window.location.href = $(this).attr("href");
                                return false;
                            } /* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length); return false; */
                        }
                    }
                }
            }
        }
    });
}
var jsonDataROI = "";
var validationStatusROITenure = true;
//Logic Contoller

var FdROILogicController = (function(){
	return{
		getCalculatedROIData : function(fdFetchedROIData,jsonDataROI){
			filterCondition = function(i){
			    return i.planType==fdFetchedROIData.PlanType && i.customerType==fdFetchedROIData.CustomerType && i.tenure==fdFetchedROIData.Tenure;
			  }
			var filteredROI = jsonDataROI.fixedDeposit.filter(filterCondition);
			return {
				monthlyIntrest :  filteredROI[0].monthly,
				quarterlyIntrest : filteredROI[0].quarterly,
				halfYearlyIntrest : filteredROI[0].halfYearly ,
				yearlyIntrest : filteredROI[0].yearly
				}
		}
		
	
	}
	
})();

//UI Controller
var FdROIUIController = (function(){
	return {
		getInputROI : function() {
			var custType;
			if(document.getElementById('roiFDNewCust').checked){
				custType = "New Customer";
			}else if(document.getElementById('roiFDOldCust').checked){
				custType = "Existing Customer";
			}else if(document.getElementById('roiFDSeniorCust').checked){
				custType = "Senior citizen";
			}else if(document.getElementById('roiFDEmployeeCust').checked){
				custType = "Bajaj Employee";
			}
			return {
				CustomerType : custType,
				Tenure : document.getElementById("roiFDTenure").value,
				PlanType : document.getElementById("roiFDPlantype").value

			}
		},
		
		updateValOnUIforROI : function(fetchedCalculatedDataROI){
			document.getElementsByClassName("bs-rates-non-cum")[0].style.display = "block";
			document.getElementsByClassName("bs-rates-cum")[0].style.display = "none";
			document.getElementById('intrestRateforROIMonthly').innerHTML = fetchedCalculatedDataROI.monthlyIntrest + "%";
			document.getElementById('intrestRateforROIQuarterly').innerHTML = fetchedCalculatedDataROI.quarterlyIntrest + "%";
			document.getElementById('intrestRateforROIHalfYearly').innerHTML = fetchedCalculatedDataROI.halfYearlyIntrest + "%";
			document.getElementById('intrestRateforROIYearly').innerHTML = fetchedCalculatedDataROI.yearlyIntrest + "%";
		},
		
		updateValOnUIforROICum : function(fetchedCalculatedDataROI){
			document.getElementsByClassName("bs-rates-cum")[0].style.display = "block";
			document.getElementsByClassName("bs-rates-non-cum")[0].style.display = "none";
			document.getElementById('intrestRateforROICumYearly').innerHTML = fetchedCalculatedDataROI.yearlyIntrest + "%";
		},
		returnFDMasterJson : function(){
			if(document.getElementById("roi-calc")){
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
				    if (this.readyState == 4 && this.status == 200) {
				    	jsonDataROI = JSON.parse( xhttp.responseText);
				    }
				};
				xhttp.open("GET", "/content/bajajfinserv/masters.fixed-deposit.json", false);
				xhttp.send();
			}
		}
	 
	}
	
})();



//Ajax Controller
var FdROIAjaxController = (function(){
	
})();

//ValidationController
var FdROIValidationUIController = (function() {
	return{
	
	validateROICalcTenure : function(fdFetchedROIData){
		if(fdFetchedROIData.Tenure == ""){
			showError("tenureErrorMsgROI", "Please Enter Tenure", true);
			validationStatusROITenure = false;
			return validationStatusROITenure;
		}else if(fdFetchedROIData.Tenure < 12 || fdFetchedROIData.Tenure > 60){
			showError("tenureErrorMsgROI", "Please Enter Tenure between 12 to 60", true);
			validationStatusROITenure = false;
			return validationStatusROITenure;
		}else{
			showError("tenureErrorMsgROI", "", false);
			validationStatusROITenure = true;
			return validationStatusROITenure;
		}
	  }
	}

})();

//Global Controller

var FdROIGlobalController = (function(fdROIUICtrl,fdROILogicCtrl,fdROIAJAXCtrl,fdROIValidationUIController){
	if(document.getElementById('roi-calc')){
	var fdFetchedROIData = fdROIUICtrl.getInputROI();
	var FDReturnInputROIData = function(){
		event.preventDefault();
		if (jsonDataROI == ""){
			var masterResData = fdROIUICtrl.returnFDMasterJson();
		}
		fdROIValidationUIController.validateROICalcTenure(fdFetchedROIData);
		var fetchedCalculatedDataROI = fdROILogicCtrl.getCalculatedROIData(fdFetchedROIData,jsonDataROI);
		if(fdFetchedROIData.PlanType == "Non-Cumulative"){
		fdROIUICtrl.updateValOnUIforROI(fetchedCalculatedDataROI);
		}else{
		fdROIUICtrl.updateValOnUIforROICum(fetchedCalculatedDataROI);
	}
	}
	
	

	
	window.onload = function(){ 
		FDReturnInputROIData();
		fdFetchedROIData =	fdROIUICtrl.getInputROI();
		document.querySelector("#calculateNowROI").onclick=function(){
			fdFetchedROIData =	fdROIUICtrl.getInputROI();
			fdROIValidationUIController.validateROICalcTenure(fdFetchedROIData);
		if(validationStatusROITenure == true){
			fdFetchedROIData =	fdROIUICtrl.getInputROI();
			FDReturnInputROIData();
		}
			};
//			
//			document.querySelector("#roiFDPlantype").onchange=function(){
//				fdFetchedROIData =	fdROIUICtrl.getInputROI();
//				FDReturnInputROIData()
//				};
//			
//		
//		document.getElementById("roiFDPlantype").addEventListener("change", FDReturnInputROIData);
//		document.getElementById("roiFDTenure").addEventListener("change", FDReturnInputROIData);
	
//		document.getElementById("calculateNowROI").addEventListener("click", FDReturnInputROIData);
//		var radios = document.getElementsByName('custTypeFd');
//		for (var i = 0; i < radios.length; i++) {
//		    radios[i].addEventListener('change', function(e) {
//				console.log("change"+this.value);
//				fdFetchedROIData = fdROIUICtrl.getInputROI();
//				FDReturnInputROIData();
//		    });
//		}
	}
	}
})(FdROIUIController,FdROILogicController,FdROIAjaxController,FdROIValidationUIController);




function onFunction()
{
	console.log(on);
	}

function offFunction()
{
	console.log(off);
	}
function relatedArticlesSwiper() {
            var quoteSwiper = new Swiper('.articlecard-swiper', {
                nextButton: '.swiper-button-next',
                prevButton: '.swiper-button-prev',
                slidesPerView: 3,
                speed: 600,
                slidesPerGroup: 1,
                //slideWidth: '660',
                spaceBetween: 30,
                initialSlide: 0,
                slideToClickedSlide: true,
                centeredSlides: false,
                
                breakpoints: {
                    992: {
                      slidesPerView: 1,
                      spaceBetween: 20,
                    }
                }
               
            });
}



$(window).on('load', function() {
	setTimeout(function(){ console.log('Loaded ater 5sec'); relatedArticlesSwiper(); }, 100);
	
});


var communityTabName;
function generateGTLOTP() {
    var mobNo = document.getElementById("gtl-mob-no").value;
    window.localStorage.setItem("mobileNumber", mobNo);
    if (/^[6-9][0-9]{9}$/.test(mobNo)) {
        showError("gtl-mob-noErrorMsg", "Please Enter Valid Mobile Number", false);
    } else {
        showError("gtl-mob-noErrorMsg", "Please Enter Valid Mobile Number", true);
    }

    var gtl_DD = document.getElementById("gtl-dobDt").value;
    var gtl_MM = document.getElementById("gtl-dobMonth").value;
    var gtl_YY = document.getElementById("gtl-dobYear").value;
    //var dt = new Date();
    //var currentYear = dt.getFullYear();
    var gtl_DOB = gtl_DD + "/" + gtl_MM + "/" + gtl_YY;
    var age = calculateAge(gtl_DD, gtl_MM, gtl_YY);
    //var endDateVal = getFormattedDate(gtl_DD, gtl_MM, gtl_YY);
    document.getElementById("gtl-dob").value = gtl_DOB;


    if (/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/.test(gtl_DOB)) {
        showError("gtl-dobErrorMsg", "Enter Valid Date of Birth", false);
    } else {
        showError("gtl-dobErrorMsg", "Enter Valid Date of Birth", true);
    }


    if (age < 23) {
        showError("gtl-dobErrorMsg", "Minimum Age Should be 23 years", true);
        return;
    } else {
        if (/^[6-9][0-9]{9}$/.test(mobNo) && /^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{4})$/.test(gtl_DOB)) {} else {
            return;
        }
    }
    gtl_DOB =  gtl_DD+ "-" + gtl_MM + "-" + gtl_YY;
    var sendGTLData = {
    		"dateOfBirth": gtl_DOB,
    		"mobileNumber": mobNo,
    		"source": "resend"
    }
    triggerOfferGenerateOtp(gtl_DOB, mobNo);
    generateOtpAPICall(AppConstants.API_SELECTOR.OTP_GENERATE.name, sendGTLData);
  
}

function setValueinGTLFormPage(mobNo) {

    var gtlDOB = document.getElementById("gtl-dob").value;
    document.getElementById("gtlMobilePlaceHolder").innerHTML = mobNo;
    document.getElementById("gtlDOBPlaceHolder").innerHTML = gtlDOB;
}

function validateGTLOTP() {
    var mobile = document.getElementById("gtl-mob-no").value;
    var gtlOTPValue = document.getElementById("gtl-password").value;


    var formData = new FormData();
    formData.append("policyName", "PL");
    formData.append("mobile", mobile);
    formData.append("otp", gtlOTPValue);

    var sendData = new URLSearchParams(formData).toString();
    AppEvent.trigger(AppConstants.API_SELECTOR.OTP_VALIDATE.name, sendData).then(function (response) {
        toggleLoader(false);
        if (response.status == "SUCCESS") {
            if (document.getElementById("")) {
                GTLformOfferPage(mobile, gtlOTPValue);
                popup_close();
                toggleLoader(false);
            }
            return true;
        } else if (response.errorOtpcode == "OTP_809") {
            toggleLoader(false);
            document.getElementById("gtl-password").value = "";
            document.getElementById("gtlOTPValidatebutton").disabled = true;
            setTimeout(function () {
                document.getElementById("gtlOTPValidatebutton").disabled = false;
            }, 5000);

            toastr.error(response.errorOtpcode + " : " + response.description,
                '', {
                    timeOut: 5000,
                    "closeButton": true,
                    "preventDuplicates": true
                });
        }
    });
}

if (document.getElementById("gtlResendOtp")) {
    var button = document.getElementById("gtlResendOtp");
    count = 0;
    button.onclick = function () {
        generateGTLOTP();
        document.getElementById("gtl-password").disabled = false;
        document.getElementById("gtlOTPValidatebutton").disabled = false;
        inputInvalidCount = 0;
        count += 1;

        showError("passwordErrorMsg", "", false);
        showError("sendOTPErorMsg", "", false);

    };

}

function GTLformOfferPage() {

    var GTLformOfferPage = document.getElementById("gtlOffersPage");
    var prodType;

    if (document.getElementById("gtlProductType")) {
        prodType = document.getElementById("gtlProductType").value;
    }

    if (document.getElementById("gtlCommunityTab")) {
        communityTabName = document.getElementById("gtlCommunityTab").value;
    }

    if (GTLformOfferPage) {
        var mobile = document.getElementById("gtl-mob-no").value;
        var gtlOTPValue = document.getElementById("gtl-password").value;
        var status = true;
        if (/^[0-9]{1,6}$/.test(gtlOTPValue)) {
            showError("gtlpasswordErrorMsg", "Enter Valid OTP Number", false);
        } else {
            showError("gtlpasswordErrorMsg", "Enter Valid OTP Number", true);
        }

        if (/^[0-9]{1,6}$/.test(gtlOTPValue)) {} else {
            return;
        }
        if (!status) {
            return;
        }
        var dateOfBirth = document.querySelector("#gtlDOBPlaceHolder").innerText.trim().split("/").join("-");
        var sendData = {
        		"dateOfBirth": dateOfBirth,
        		"mobileNumber": mobile,
        		"otp": gtlOTPValue,
        		"source": "website"
        };
        otpValidationAPICall(AppConstants.API_SELECTOR.OTP_VALIDATE.name, sendData);
    }
}



document.addEventListener("DOMContentLoaded", function () {
	
	var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
	/*var utmData = window.utmParams;
	var utmString = "utm_source="+utmData.utmSource+"&utm_medium="+utmData.utmMedium+"&utm_campaign="+utmData.utmCampaign+"&utm_term="+utmData.utmTerm+"&utm_content="+utmData.utmContent;*/
	var utmString = utm;
	var utm_params = window.urlObj.search; 
	
    if (window.localStorage) {
        var mobileNumber = window.localStorage.getItem("mobileNumber");
        if (document.getElementById("gtl-mob-no")) {
            document.getElementById("gtl-mob-no").value = (mobileNumber == "undefined") ? "" : mobileNumber;
        }
    } else {
        document.getElementById("gtl-mob-no").value = "";
        document.getElementById("gtl-dobDt").value = "";
        document.getElementById("gtl-dobMonth").value = "";
        document.getElementById("gtl-dobYear").value = "";

    }
    inputFocus();
    if (document.getElementById("gtlCommunityTab")) {
        communityTabName = document.getElementById("gtlCommunityTab").value;
    }
    var prodType;
    if (document.getElementById("gtlProductType")) {
        prodType = document.getElementById("gtlProductType").value;
    }

    if (document.getElementById('gtlSendOtpButton')) {
        var buttonExpiryTime;
        if (window.localStorage.getItem("otpExpireTime") == null) {
            buttonExpiryTime = new Date().addDays(-1);
        } else {
            buttonExpiryTime = new Date(window.localStorage.getItem("otpExpireTime"));
        }
        if (formatDate(new Date()) > formatDate(buttonExpiryTime)) {
            document.getElementById('gtlSendOtpButton').disabled = false;
            //		      window.localStorage.removeItem("otpExpireTime");
            console.log("REMOVE THE Disabled button")
        } else if (formatDate(new Date()) === formatDate(buttonExpiryTime) || formatDate(new Date()) > formatDate(buttonExpiryTime)) {
            document.getElementById('gtlSendOtpButton').disabled = true;
            showError("gtlSendOTPErorMsg", "You have exceeded maximum number of attempts. Please try after 24 hours", true);
            document.getElementById('gtlSendOTPErorMsg').style.display = "block";
        } else {
            console.log("send otp not disabled Offer");
            //document.getElementById('sendOtpButton').disabled = true;
        }
    }

    var offerExpiryDate = new Date(window.localStorage.getItem("expiryTime"))
    if ((offerExpiryDate.getTime() + (24 * 60 * 60 * 1000 * 7)) < (new Date()).getTime()) {
        window.localStorage.removeItem("myOfferRequest");
        window.localStorage.removeItem("myOfferResponse");
        window.localStorage.removeItem("myOfferError");
        window.localStorage.removeItem("expiryTime");
        console.log("new Offer")
    } else {
        console.log("Default Offer")
    }
    var gtlofferFormRedirecrURL = document.getElementById("gtlofferFormRedirecrURL");
    var redirectLink = document.getElementById("gtl-link");
    if (window.localStorage.getItem("myOfferError")) {
        window.myOfferError = JSON.parse(window.localStorage.getItem("myOfferError"))
        $(".form1.offer-inner").removeClass("active");
        $(".form5.offer-inner").addClass("active");
        $("#offerRateContainer").hide();

        if (window.location.pathname.indexOf('.is-mobile') > -1) {
            var offerismobiletrue = "1";
        } else {
            var offerismobilefalse = "0";
        }

        try{
        	if (offerismobiletrue == 1) {
        		if(urlParams){
        			if(utm_params.includes("&nav_src")){
        				window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
        			}
        			else{
        				window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params;
        			}
        		}
        		else{
        			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utmString;
        		}
            } else {
            	if(urlParams){
            		if(utm_params.includes("&nav_src")){
            			window.location.href = gtlofferFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
            		}
            		else{
            			window.location.href = gtlofferFormRedirecrURL.value + utm_params;
            		}            		
            	}
            	else{
            		window.location.href = gtlofferFormRedirecrURL.value + utmString;
            	}
            }
        }
        catch(err){
        	console.log(err);
        }
        

    }


    if (window.localStorage.getItem("myOfferResponse")) {
    	
        window.myOfferResponse = JSON.parse(window.localStorage.getItem("myOfferResponse"))
        if(window.myOfferResponse.payload.offerDetailsResponse.offerDetails.length > 0){
        	$(".form1.offer-inner").removeClass("active");
            $(".form3.offer-inner").addClass("active");
            $("#offerRateContainer").hide();
        }
        else{
			$(".form1.offer-inner").removeClass("active");
		}

        if (window.myOfferResponse.payload && window.myOfferResponse.payload.offerDetailsResponse.offerDetails.length > 0) {
            var offerItems = window.myOfferResponse.payload.offerDetailsResponse.offerDetails;
            var offerRedirectUrl;
            offerItems.forEach(function (items) {
                if (items.offerStatus == 1 || items.offerStatus == 2) {
                    if (items.productCode == prodType) {
                        if (communityTabName) {
                            if (window.isMobile == 1) {
                            	if(urlParams){
                            		if(utm_params.includes("&nav_src")){
                            			window.location.href = redirectLink.value + ".is-mobile." + window.myOfferResponse.payload.offerQID + '.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                            		}
                            		else{
                            			window.location.href = redirectLink.value + ".is-mobile." + window.myOfferResponse.payload.offerQID + '.html' + utm_params;
                            		}
                            	}
                            	else{
                            		window.location.href = redirectLink.value + ".is-mobile." + window.myOfferResponse.payload.offerQID + '.html' + utmString;
                            	}
                                //window.location.href = redirectLink.value + ".is-mobile." + window.myOfferResponse.payload.offerQID + '.html' + urlParams;
                            } else {
                            	if(urlParams){
                            		if(utm_parmas.includes("&nav_src")){
                            			window.location.href = redirectLink.value + "." + window.myOfferResponse.payload.offerQID + ".html" + utm_params.substring(0,utm_params.indexOf("&nav_Src"));
                            		}
                            		else{
                            			window.location.href = redirectLink.value + "." + window.myOfferResponse.payload.offerQID + ".html" + utm_params;
                            		}
                            	}
                            	else{
                            		window.location.href = redirectLink.value + "." + window.myOfferResponse.payload.offerQID + ".html" + utmString;
                            	}
                                //window.location.href = redirectLink.value + "." + window.myOfferResponse.payload.offerQID + ".html" + urlParams;
                            }
                        } else {
                        	if(urlParams){
                        		if(utm_params.includes("&nav_src")){
                        			offerRedirectUrl = items.offerURL + "&" + utm_params.substring(1,utm_params.indexOf("&nav_src")) + "&offerId=" + items.offerId;
                                    window.location.href = offerRedirectUrl;
                        		}
                        		else{
                        			offerRedirectUrl = items.offerURL + "&" + utm_params.substring(1,utm_params.length) + "&offerId=" + items.offerId;
                                    window.location.href = offerRedirectUrl;
                        		}
                        		/*offerRedirectUrl = items.offerURL + "&" + urlParams.substring(1,urlParams.length) + "&offerId=" + items.offerId;
                                window.location.href = offerRedirectUrl;*/
                        	}
                        	else{
                        		if(utmString.length > 0){
                        			offerRedirectUrl = items.offerURL + "&" + utmString.substring(1,utmString.length) + "&offerId=" + items.offerId;
                        		}
                        		else{
                        			offerRedirectUrl = items.offerURL + "&offerId=" + items.offerId;
                        		}
                        		
                                window.location.href = offerRedirectUrl;
                        	}
                        }
                    } else {
                        var gtlofferFormRedirecrURL;
                        if (document.getElementById("gtlofferFormRedirecrURL")) {
                            gtlofferFormRedirecrURL = document.getElementById("gtlofferFormRedirecrURL");

                            if (window.isMobile == 1) {
                            	if(urlParams){
                            		if(utm_params.includes("&nav_src")){
                            			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                            		}
                            		else{
                            			window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utm_params;
                            		}
                            	}
                            	else{
                            		window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html' + utmString;
                            	}
                                //window.location.href = gtlofferFormRedirecrURL.value.substring(0, gtlofferFormRedirecrURL.value.indexOf('.html')) + '.is-mobile.html';
                            } else {
                            	if(urlParams){
                            		if(utm_params.includes("&nav_src")){
                            			window.location.href = gtlofferFormRedirecrURL.value + utm_params.substring(0,utm_params.indexOf("&nav_src"));
                            		}
                            		else{
                            			window.location.href = gtlofferFormRedirecrURL.value + utm_params;
                            		}
                            	}
                            	else{
                            		window.location.href = gtlofferFormRedirecrURL.value + utmString;
                            	}
                            }
                        }

                    }
                }
                /*if(items.productCode == prodType){
                	//offerRedirectUrl = items.offerURL + "&offerId=" + items.offerId;
                }*/
            });
            /*if(offerRedirectUrl){
            	window.location.href = offerRedirectUrl;
            }
            else{
            	if(redirectLink){
            		window.location.href = redirectLink.value + "." + window.myOfferResponse.payload.offerQID + ".html";
            	}
            }*/


            /*Check for product value from pageConfig and Update the Match the offer*/
            var pageproductVal = $("#productType").val();

            var items = window.myOfferResponse.payload.offerDetailsResponse.offerDetails;
            //for (const item of items) {
            for (var i = 0; i < items.length; i++) {
                if (pageproductVal && items[i].productCode === pageproductVal) {

                    var data = items[i];
                    if(window.location.pathname.indexOf('.is-mobile') > -1){
						   var offerismobiletrue = "1";
						   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
						}else
						{
							   var offerismobilefalse = "0";
							   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
						}
                    break;
                } else {
                    /*This will set the ByDeafult value of the Offer page*/
                    var data = window.myOfferResponse.payload.offerDetailsResponse.offerDetails[0]
                    if(window.location.pathname.indexOf('.is-mobile') > -1){
						   var offerismobiletrue = "1";
						   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
						}else
						{
							   var offerismobilefalse = "0";
							   offerFeatureTemplate(data,offerismobiletrue,urlParams,utmString);
						}
                    }
            }

            if (window.location.pathname.indexOf('.is-mobile') > -1) {
                var offerismobiletrue = "1";
            } else {
                var offerismobilefalse = "0";
            }


            /*if(offerismobiletrue == 1){
            	oldurl = $("#viewAllOffersBtn").attr("href") + ".is-mobile." + window.myOfferResponse.payload.offerQID + ".html"
            }else {
            	oldurl = $("#viewAllOffersBtn").attr("href") + "." + window.myOfferResponse.payload.offerQID + ".html";
            }
            $("#viewAllOffersBtn").attr("href",oldurl);*/
            btnRedirect();
            $("#noOfferMsg").hide();
            $("#offerDetails").show();
        } else {
            $(".form2.offer-inner").removeClass("active");
            $(".form5.offer-inner").addClass("active");
            $("#noOfferMsg").show();
            $("#offerDetails").hide();
            $("#viewAllOffersBtn").hide();
        }
    }
    // formOfferWidget();


    $("#noOfferState").hide()
    $("#refreshIcon").css("width", "15px");
    var myOffersPageForm = document.getElementById("myOffersPage")
    if (myOffersPageForm) {
    	try{
        if (response.payload.offerQID) {
            window.sessionStorage.setItem("SS_1", response.authToken)
            window.sessionStorage.setItem("SS_4", response.guardKey)
            document.cookie = "SS_1=" + response.authToken
            document.cookie = "SS_4=" + response.guardKey

            window.localStorage.setItem("myOfferRequest", sendData)
            window.localStorage.setItem("expiryTime", new Date())
            window.localStorage.setItem("myOfferResponse", JSON.stringify(response))
            window.location.href = link + "." + response.payload.offerQID + ".html";
        }
        var jsonData = response;
        /*personalDetails(jsonData);*/
        offersSwiper(jsonData);
        toggleLoader(false)
    	}
    	catch(err){
    		console.log(err);
    	}
        
    }


    function personalDetails(JsonData) {
        var offerNav = document.getElementById("offerNav");
        var personalDetailsTemplate = document.getElementById("personalDetailsTemplate").cloneNode(true);
        var cloneElement = personalDetailsTemplate.content;
        cloneElement.querySelector("#personname").innerHTML = JsonData.personalDetails.firstName || "";
        // cloneElement.querySelector("#personname").innerHTML=JsonData.username;
        offerNav.appendChild(contentElement);
    }
});

function inputFocus() {
    if ($(".mob-no").val() == "") {
        $(".mob-no").parent().removeClass("focus");
    } else {
        $(".mob-no").parent().addClass("focus");
    }
    $(".mob-no").focus(function () {
        $(this).parent().addClass("focus");
    });
    $(".mob-no").blur(function () {
        if ($(this).val() == "") {
            $(this).parent().removeClass("focus");
        }
    });

}



/*$(document).on("ready", function () {
    setTimeout(inputFocus,2000);
    //inputFocus();
});*/


function calculateAge(birth_day, birth_month, birth_year) {
    today_date = new Date();
    today_year = today_date.getFullYear();
    today_month = today_date.getMonth();
    today_day = today_date.getDate();
    age = today_year - birth_year;

    if (today_month < (birth_month - 1)) {
        age--;
    }
    if (((birth_month - 1) == today_month) && (today_day < birth_day)) {
        age--;
    }
    return age;
}

function UTMCheckMultiTab(){
	$(".resp-tabs-list li").on("click", function (e) {
	window.urlObj = new URL(window.location.href);
		try{
		var utm_params;
		var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
		var confParams= window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
		if(urlParams){
			utm_params = window.urlObj.search;
			if($(this).attr("target")){
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
						return false;
					}
					else{
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.length), $(this).attr("target"));
						return false;
					}
				}
				else{
					window.open($(this).attr("href")+ '?' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
					return false;
				}
			}
			else{
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href", $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						$(this).attr("href", $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
						return false;
					}
				}
				else{
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href",$(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						$(this).attr("href", $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
						return false;
					}
				}
			}
		}
		else{
			utm_params = utm;
			if($(this).attr("target")){
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
						return false;
					}
					else{
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.length), $(this).attr("target"));
						return false;
					}
				}
				else{
					window.open($(this).attr("href")+ '?' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
					return false;
				}
			}
			else{
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href" ,$(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						if(utm_params.length > 0){
							window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
							$(this).attr("href", $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
							return false;
						}
						else{
							window.location.href = $(this).attr("href");
							$(this).attr("href", $(this).attr("href"));
							return false;
						}
						/* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false; */
					}
				}
				else{
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href", $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						if(utm_params.length > 0){
							window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
							$(this).attr("href", $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
							return false;
						}
						else{
							window.location.href = $(this).attr("href");
							$(this).attr("href", $(this).attr("href"))
							return false;
						}
						/* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false; */
					}
				}
			}
		}
	}
	catch(err){
		console.log(err);
	}
	});
}


$(window).on('load', function() {
	setTimeout(function(){ UTMCheckMultiTab(); }, 900);
});


function UTMCheckMultiTab(){
    window.urlObj = new URL(window.location.href);
	$(".resp-tabs-list li").on("click", function (e) {
		try{
		var utm_params;
		var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
		var confParams= window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
		if(urlParams){
			utm_params = window.urlObj.search;
			if($(this).attr("target")){
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
						return false;
					}
					else{
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.length), $(this).attr("target"));
						return false;
					}
				}
				else{
					window.open($(this).attr("href")+ '?' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
					return false;
				}
			}
			else{
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href", $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						$(this).attr("href", $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
						return false;
					}
				}
				else{
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href",$(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						$(this).attr("href", $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
						return false;
					}
				}
			}
		}
		else{
			utm_params = utm;
			if($(this).attr("target")){
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
						return false;
					}
					else{
						window.open($(this).attr("href")+ '&' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.length), $(this).attr("target"));
						return false;
					}
				}
				else{
					window.open($(this).attr("href")+ '?' +utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')), $(this).attr("target"));
					return false;
				}
			}
			else{
				if($(this).attr("href").includes('?')){
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href" ,$(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						if(utm_params.length > 0){
							window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
							$(this).attr("href", $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
							return false;
						}
						else{
							window.location.href = $(this).attr("href");
							$(this).attr("href", $(this).attr("href"));
							return false;
						}
						/* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false; */
					}
				}
				else{
					if(utm_params.includes('&nav_src')){
						window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src'));
						$(this).attr("href", $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.indexOf('&nav_src')));
						return false;
					}
					else{
						if(utm_params.length > 0){
							window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
							$(this).attr("href", $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
							return false;
						}
						else{
							window.location.href = $(this).attr("href");
							$(this).attr("href", $(this).attr("href"))
							return false;
						}
						/* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
						return false; */
					}
				}
			}
		}
	}
	catch(err){
		console.log(err);
	}
	});
}


$(window).on('load', function() {
	setTimeout(function(){ UTMCheckMultiTab(); }, 900);
});


var custvideo;
if(document.getElementById("ytvideourl")){
	custvideo = document.getElementById("ytvideourl").value;
}

function toggleLoaderVideo(status) {
	if (document.getElementById("loader-video")) {
		if (status == true) {
			document.getElementById("loader-video").style.display = "block";
		}
		else {
			document.getElementById("loader-video").style.display = "none";
		}
	}
}



var videourl = "https://www.youtube.com/watch?v=" + custvideo;

$(window).on("load", function () {
    $(".player-overlay-btn").on('click', function () {
        var playcustbtn =$(this).attr('data-stat');
        if (playcustbtn == "resume") {
        	// toggleLoaderVideo(true);
            $(".video-player-demo").YTPlayer({
                videoURL: videourl,
                containment: '.video-player-demo',
                autoPlay: true,
                loop: false,
                useOnMobile: true,
                realfullscreen: true,


            });

            $('.player-overlay-btn').attr('data-stat', 'stopp');
            $(".page-loader-circle").addClass("right-circle");

        }


        if (window.innerWidth > 767) {
            $('.video-player-demo').on("YTPReady", function (e) {
                $(".page-loader-circle").hide();
                 $(".page-loader-circle").removeClass("right-circle");
            //	toggleLoaderVideo(false);
                var temp = $(".player-overlay").attr('data-play');
                if (temp == 'play') {
                    $(".player-overlay").css('display', 'none');
                    $('.cover-image').css('display', 'none');
                    $(".video-player-demo").attr('style', 'height: 576px !important');
                    $('.buttonBar').show();
                    $(".mb_YTPBar").addClass('persist');
                    $('.player-overlay').attr('data-play', 'pause');

                }

                if (temp == 'pause') {
                    $(".video-player-demo").YTPPause();
                    $(".player-overlay-btn").show();
                    $(".player-overlay").css('display', 'block');
                    $(".video-player-demo").attr('style', 'height: 370px !important');
                    $('.cover-image').css('display', 'block');
                    $('.buttonBar').hide();
                    $(".mb_YTPBar").removeClass('persist');
                    $('.player-overlay').attr('data-play', 'play');

                }

                $(".video-player-demo").on("YTPPlay", function () {
                    $(".player-overlay").css('display', 'none');
                    $('.cover-image').css('display', 'none');
                    $(".video-player-demo").attr('style', 'height: 576px !important');
                    $('.buttonBar').show();
                    $(".mb_YTPBar").addClass('persist');
                    $('.player-overlay').attr('data-play', 'pause');
                });

                $(".video-player-demo").on("YTPPause", function () {
                	$(".player-overlay-btn").show();
                    $(".player-overlay").css('display', 'block');
                    $(".video-player-demo").attr('style', 'height: 370px !important');
                    $('.cover-image').css('display', 'block');
                    $('.buttonBar').hide();
                    $(".mb_YTPBar").removeClass('persist');

                    $(".player-overlay").on("click", function () {
                        $(".video-player-demo").YTPPlay();
                        $(this).css('display', 'none');
                        $('.buttonBar').show();
                        $('.cover-image').css('display', 'none');
                        $(".mb_YTPBar").addClass('persist');
                        $('.player-overlay').attr('data-play', 'pause');
                    });
                });

                $('.video-player-demo').on("YTPEnd", function () {
                    $(".video-player-demo").attr('style', 'height: 370px !important');
                    $('.cover-image').css('display', 'block');
                });

            });
        }
        else {
            $('.video-player-demo').on("YTPReady", function (e) {
                var temp = $(".player-overlay").attr('data-play');
                if (temp == 'play') {
                    $(".player-overlay").css('display', 'none');
                    $('.cover-image').css('display', 'none');
                    $('.buttonBar').show();
                    $(".mb_YTPBar").addClass('persist');
                    $('.player-overlay').attr('data-play', 'pause');
                }

                if (temp == 'pause') {
                    $(".video-player-demo").YTPPause();
                    $(".player-overlay-btn").show();
                    $('.cover-image').css('display', 'block');
                    $(".player-overlay").css('display', 'block');
                    $('.buttonBar').hide();
                    $(".mb_YTPBar").removeClass('persist');
                    $('.player-overlay').attr('data-play', 'play');
                }

                $(".video-player-demo").on("YTPPlay", function () {
                    $(".player-overlay").css('display', 'none');
                    $('.buttonBar').show();
                    $('.cover-image').css('display', 'none');
                    $(".mb_YTPBar").addClass('persist');
                    $('.player-overlay').attr('data-play', 'pause');
                });

                $(".video-player-demo").on("YTPPause", function () {
                	$(".player-overlay-btn").show();
                    $(".player-overlay").css('display', 'block');
                    $('.cover-image').css('display', 'block');
                    $('.buttonBar').hide();
                    $(".mb_YTPBar").removeClass('persist');
                    $(".player-overlay").on("click", function () {
                        $(".video-player-demo").YTPPlay();
                        $(this).css('display', 'none');
                        $('.buttonBar').show();
                        $('.cover-image').css('display', 'none');
                        $(".mb_YTPBar").addClass('persist');
                        $('.player-overlay').attr('data-play', 'pause');

                    });

                });
                $('.video-player-demo').on("YTPEnd", function () {
                    $('.cover-image').css('display', 'block');
                });
            });
        }
    });

});

$(window).on('load', function(){
	
if($(".queries").length > 0){
var items = $(".faq-wrapper #FAQContainer .bs-queries-li");
    var numItems = items.length;
    var perPage = 10;

    items.slice(perPage).hide();

    try{
    	$('.queries #pagination-container').pagination('destroy');
    }
    catch(err){
    	console.log(err);
    }
    
    if(numItems > 10){
    $('.queries #pagination-container').pagination({
        items: numItems,
        itemsOnPage: perPage,
        prevText: '<img class="arrowimg" src="/content/dam/bajajfinserv/back.png">',
        nextText: '<img class="arrowimg" src="/content/dam/bajajfinserv/right-arrow.png">',
        onPageClick: function (pageNumber) {
            var showFrom = perPage * (pageNumber - 1);
            var showTo = showFrom + perPage;
            items.hide().slice(showFrom, showTo).fadeIn();
        }
    });
}else{
	$('.queries #pagination-container').css('display','none');
}
}
});
function showPlan(){
	//document.getElementById("propertyValuation-get-otp").style.display = "block";
	var name=document.getElementById("propertyName").value
	if(name==""){
		showError("propertyNameErrorMsg","Enter Valid Name",true)
		
	}else{
		showError("propertyNameErrorMsg","Enter Valid Name",false)
		
	}
	var pincode=document.getElementById("propertyPinCode").value
	if(pincode==""){
		showError("propertyPinCodeErrorMsg","Enter Valid Pin Code",true)
	}else if(pincode.length<6){
		showError("propertyPinCodeErrorMsg","Enter 6 Digit Pin Code",true)
	}else{
		showError("propertyPinCodeErrorMsg","Enter Valid Pin Code",false)
	}
	
	var area=document.getElementById("propertyArea").value
	if(area==""){
		showError("cyberfullNameErrorMsg","Enter Valid Area",true)
	}else if(area<=300){
		showError("cyberfullNameErrorMsg","Mininmum Area is 300 Sq.Ft.",true)
	}else{
		showError("cyberfullNameErrorMsg","Enter Valid Area",false)
	}
	
	cardShow();
	//generateGTLOTP();
	//calculateAge(birth_day,birth_month,birth_year);
}

function cardShow(){
	document.getElementById("propertyValuation-lyt").style.display= "block";
}


var gpgpUniqueItemId;
function openPopup(item) {
	gpgpUniqueItemId = item.id;
	var cardid = item.id.substring(item.id.indexOf('_') + 1, item.id.length);
	var card = document.querySelector(parentDiv
			+ ' .gpgpcard .gpgp-card-wrap-main #' + cardid);
	var heading = card.querySelector(".gpgp-card-title h3").innerText;
	var premiumplan = card
			.querySelector(".gpgp-card-premium .gpgp-card-premium-price").innerText;
	var duration = card
			.querySelector(".gpgp-card-premium .gpgp-card-premium-period").innerText;
	var cardDiv = parentDiv + " .gpgp-card-head .gpgp-card-title #planCode-"
			+ cardid;
	var planCode = document.querySelector(cardDiv).value;
	var knowMore = card.querySelectorAll(".gpgp-card-button a")[0].href;
	var cardContentlength = card.querySelector(".gpgp-card-list-main").children.length;
	var cardContent = []
	card.querySelectorAll(parentDiv + " .gpgp-card-list p").forEach(
			function(item, index) {
				cardContent.push(item.innerText);
			});
	addPopupData(heading, premiumplan, duration, cardContent, planCode,
			knowMore);
	popup_open('#' + item.closest(".active").id + " #popup-gpgp-form");

}

function addPopupData(heading, premiumplan, duration, cardContent, planCode,
		knowMore) {
	$(parentDiv + " #gpgp-title h3").text(heading);
	$(parentDiv + " #premium-plan").text(premiumplan);
	$(parentDiv + " #premium-period").text(duration);
	$(parentDiv + " #planCodePopup").val(planCode);
	$(parentDiv + " #gpgp-content-list li p").each(function(index) {
		$(this).text(cardContent[index]);
	});
}

var parentDiv;
if (document.querySelector(".tab-link.active-link-tab")) {
	parentDiv = '#'
			+ document.querySelector(".tab-link.active-link-tab").getAttribute(
					"data-tab");
	$(".tab-link").on("click", function() {
		parentDiv = '#' + $(this).attr("data-tab");
	});
}

if (document.getElementsByClassName("gpgpcard")) {
	$(".gpgp-card-button a")
			.on(
					"click",
					function(e) {
						var utm_params;
						var urlParams = window.urlObj.search.includes("src_30")
								|| window.urlObj.search.includes("src_60")
								|| window.urlObj.search.includes("src_90")
								|| window.urlObj.search.includes("pid")
								|| window.urlObj.search.includes("utm_source");
						var confParams = window.urlObj.search
								.includes("prodCode")
								|| window.urlObj.search.includes(" ");
						if (urlParams) {
							utm_params = window.urlObj.search;
							if ($(this).attr("target")) {
								if ($(this).attr("href").includes('?')) {
									if (utm_params.includes('&nav_src')) {
										window
												.open(
														$(this).attr("href")
																+ '&'
																+ utm_params
																		.substring(
																				utm_params
																						.indexOf('?') + 1,
																				utm_params
																						.indexOf('&nav_src')),
														$(this).attr("target"));
										return false;
									} else {
										window
												.open(
														$(this).attr("href")
																+ '&'
																+ utm_params
																		.substring(
																				utm_params
																						.indexOf('?') + 1,
																				utm_params.length),
														$(this).attr("target"));
										return false;
									}
								} else {
									window
											.open(
													$(this).attr("href")
															+ '?'
															+ utm_params
																	.substring(
																			utm_params
																					.indexOf('?') + 1,
																			utm_params
																					.indexOf('&nav_src')),
													$(this).attr("target"));
									return false;
								}
							} else {
								if ($(this).attr("href").includes('?')) {
									if (utm_params.includes('&nav_src')) {
										window.location.href = $(this).attr(
												"href")
												+ '&'
												+ utm_params
														.substring(
																utm_params
																		.indexOf('?') + 1,
																utm_params
																		.indexOf('&nav_src'));
										return false;
									} else {
										window.location.href = $(this).attr(
												"href")
												+ '&'
												+ utm_params
														.substring(
																utm_params
																		.indexOf('?') + 1,
																utm_params.length);
										return false;
									}
								} else {
									if (utm_params.includes('&nav_src')) {
										window.location.href = $(this).attr(
												"href")
												+ '?'
												+ utm_params
														.substring(
																utm_params
																		.indexOf('?') + 1,
																utm_params
																		.indexOf('&nav_src'));
										return false;
									} else {
										window.location.href = $(this).attr(
												"href")
												+ '?'
												+ utm_params
														.substring(
																utm_params
																		.indexOf('?') + 1,
																utm_params.length);
										return false;
									}
								}
							}
						} else {
							utm_params = utm;
							if ($(this).attr("target")) {
								if ($(this).attr("href").includes('?')) {
									if (utm_params.includes('&nav_src')) {
										window
												.open(
														$(this).attr("href")
																+ '&'
																+ utm_params
																		.substring(
																				utm_params
																						.indexOf('?') + 1,
																				utm_params
																						.indexOf('&nav_src')),
														$(this).attr("target"));
										return false;
									} else {
										window
												.open(
														$(this).attr("href")
																+ '&'
																+ utm_params
																		.substring(
																				utm_params
																						.indexOf('?') + 1,
																				utm_params.length),
														$(this).attr("target"));
										return false;
									}
								} else {
									window
											.open(
													$(this).attr("href")
															+ '?'
															+ utm_params
																	.substring(
																			utm_params
																					.indexOf('?') + 1,
																			utm_params
																					.indexOf('&nav_src')),
													$(this).attr("target"));
									return false;
								}
							} else {
								if ($(this).attr("href").includes('?')) {
									if (utm_params.includes('&nav_src')) {
										window.location.href = $(this).attr(
												"href")
												+ '&'
												+ utm_params
														.substring(
																utm_params
																		.indexOf('?') + 1,
																utm_params
																		.indexOf('&nav_src'));
										return false;
									} else {
										if (utm_params.length > 0) {
											window.location.href = $(this)
													.attr("href")
													+ '&'
													+ utm_params
															.substring(
																	utm_params
																			.indexOf('?') + 1,
																	utm_params.length);
											return false;
										} else {
											window.location.href = $(this)
													.attr("href");
											return false;
										}
										/*
										 * window.location.href =
										 * $(this).attr("href")+ '&' +
										 * utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
										 * return false;
										 */
									}
								} else {
									if (utm_params.includes('&nav_src')) {
										window.location.href = $(this).attr(
												"href")
												+ '?'
												+ utm_params
														.substring(
																utm_params
																		.indexOf('?') + 1,
																utm_params
																		.indexOf('&nav_src'));
										return false;
									} else {
										if (utm_params.length > 0) {
											window.location.href = $(this)
													.attr("href")
													+ '?'
													+ utm_params
															.substring(
																	utm_params
																			.indexOf('?') + 1,
																	utm_params.length);
											return false;
										} else {
											window.location.href = $(this)
													.attr("href");
											return false;
										}
										/*
										 * window.location.href =
										 * $(this).attr("href")+ '?' +
										 * utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
										 * return false;
										 */
									}
								}
							}
						}
					});
}

// Featured Products js

$(document).ready(function() {

    $(".show-more-show-arrow-wrap").on("click", function() {
        // $(".fp-grid-show-more").slideToggle();
        $(".feature-grid").toggleClass("view-full-grid")
        $(".show-more-show-arrow").toggleClass("rotate-arr");

        if ($(".show-more-show-arrow").hasClass("rotate-arr")) {
            $(".show-more-show-arrow span").text("View Less");
        } else {
            $(".show-more-show-arrow span").text("View More");
        }

    })
});

$('.offerwidget .btn-md').on("click", function (e) {
    var utm_params;
    var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
    var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");

    if (urlParams) {
        utm_params = window.urlObj.search;
        if ($(this).attr("target")) {
            if ($(this).attr("href").includes('?')) {
                if (utm_params.includes('&nav_src')) {
                    if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                    }
                } else {
                    if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                }
            } else {
                if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                    if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
            }
        } else {
            if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            $(this).attr("href", $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')));
                            return false;
                        }
                    } else {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            $(this).attr("href", $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length));
                            return false;
                        }
                        /*$(this).attr("href",$(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length));
                        return false;*/
                    }
                } else {
                    if (utm_params.includes('&nav_src')) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            $(this).attr("href", $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')));
                            return false;
                        }
                    } else {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            $(this).attr("href", $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length));
                            return false;
                        }
                    }
                }
            }
        }
    } else if (utm.length > 0) {

        if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
            utm_params = utm;
            if ($(this).attr("target")) {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                    } else {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                } else {
                    if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
            } else {

                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                    } else {
                        if (utm_params.length > 0) {
                            if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                        } else {
                            if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                                window.location.href = $(this).attr("href");
                                return false;
                            }
                        }
                        /* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                        return false; */
                    }
                } else {
                    if (utm_params.includes('&nav_src')) {
                        if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                    } else {
                        if (utm_params.length > 0) {
                            if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                        } else {
                            if (!($(this).attr("href").includes("src_30") || $(this).attr("href").includes("src_60") || $(this).attr("href").includes("src_90") || $(this).attr("href").includes("utm_source") || $(this).attr("href").includes("pid"))) {
                                window.location.href = $(this).attr("href");
                                return false;
                            }
                        }
                    }
                }
            }
        }
    }
    btnRedirect();
});

var checkValResultStr = generateRandom();
function merchantForm(){

	var mobile = document.getElementById("upi-mobile").value;
	var email = document.getElementById("upi-email").value;
	var string = document.getElementById("upi-name").value;
	var name = document.getElementById("upi-name").value;
	 string = string.split(" ");
	 console.log(string);
	 console.log(string[0]);
	 console.log(string[1]);
	 var firstName = string[0];
	 var lastName = string[1];
	
	 if (string == "") {
		   showError("upiFullNameErrorMsg", "Enter Valid Full name", true);
		   nameValidate = false;
		 } else {
		   if (lastName == undefined || "") {
			   lastName = "";
		     showError("upiFullNameErrorMsg", "Enter Valid last name", false);
		     nameValidate = true;
		   }
		   else {
		     showError("upiFullNameErrorMsg", "Enter Valid last name", true);
		     nameValidate = false;
		   }
		 
		   if (/^[a-zA-Z]+$/.test(firstName)) {
		     showError("upiFullNameErrorMsg", "Enter Valid First name", false);
		     nameValidate = true;
		   } else {
		     showError("upiFullNameErrorMsg", "Enter Valid First name", true);
		     nameValidate = false;
		   }

		   if (/^[a-zA-Z]+$/.test(lastName)) {
		     showError("upiFullNameErrorMsg", "Enter Valid Last name", false);
		     nameValidate = true;
		   } else {
		     showError("upiFullNameErrorMsg", "Enter Valid Last name", true);
		     nameValidate = false;
		   }
		 }	 
	
	
	if (/^[6-9][0-9]{9}$/.test(mobile)) {
        showError("upiMobnoErrorMsg", "Enter Valid Mobile Number", false);
        mobileValidate = true;
    }
    else {
        showError("upiMobnoErrorMsg", "Enter Valid Mobile Number", true);
        mobileValidate = false;
    }
	
	 if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)) {
	     showError("upiEmailErrorMsg", "Insert Valid Email Id.", false);
	     emailValidate = true;
	   } else {
	     showError("upiEmailErrorMsg", "Insert Valid Email Id.", true);
	     emailValidate = false;
	}
	 
	 if(nameValidate && mobileValidate && emailValidate == true){
		 
		 /*document.getElementById("merchant-success-div").style.display = "block";
		 document.getElementById("get-a-quote").style.display = "none";*/
		 
		 var notificationTypeCode = "WS_UPIMERCHANT_EMAIL";
		 
		 /*var formData = new FormData();
		 formData.append("notificationTypeCode",notificationTypeCode || " ");
		 formData.append("customerName",name);
		 formData.append("customerMobile",mobile);
		 formData.append("customerEmail",email);
		 formData.append("recipientEmailId","merchantonboard@supportbfsmarkets.in");
		 
		 var sendData = new URLSearchParams(formData).toString();*/
		 
		 var sendData = {
				 "notificationTypeCode": notificationTypeCode,
				 "templateDataMap": {
					 "requestID": checkValue(checkValResultStr),
					 "merchantName": name,
					 "merchantMobile": mobile,
					 "merchantEmail": email,
					 "recipientEmailId": "merchantonboard@supportbfsmarkets.in"
				 }
		 }

		 upiMerchantAPICall(AppConstants.API_SELECTOR.CONTACT_US_EMAIL.name, sendData);
		 /*AppEvent.trigger(AppConstants.API_SELECTOR.CONTACT_US_EMAIL.name, sendData).then(function (response) {
			 
			 if (response.sts == "SUCCESS") {
				 toggleLoader(false);
				 document.getElementById("merchant-success-div").style.display = "block";
				 document.getElementById("get-a-quote").style.display = "none";
				 $("#upi-merch-ref-id").text("Reference ID: "+response.caseId);
				 toastr.remove();
			 }
		 })*/
	 }
}

function upiMerchantAPICall(selector,sendData) {
	AppEvent.trigger(selector, sendData).then(function (response) {
		 
		if(response.status == "SUCCESS") {
			response.sts = "SUCCESS";
			response.msg = "Registered";
			response.caseId = checkValResultStr;
			localStorage.setItem("ResponseData", JSON.stringify(response));
		}
		else {
			response.status = 422;
			response.sts = "FAIL";
			response.msg = "Something went wrong. Please try again later";
			localStorage.setItem("ResponseData", JSON.stringify(response));
		}
		
		response = JSON.parse(localStorage.getItem("ResponseData"));
		
		 if (response.sts == "SUCCESS") {
			 toggleLoader(false);
			 document.getElementById("merchant-success-div").style.display = "block";
			 document.getElementById("get-a-quote").style.display = "none";
			 $("#upi-merch-ref-id").text("Reference ID: "+response.caseId);
			 toastr.remove();
		 }
		 else{
			 toggleLoader(false);
			 toastr.error(response.status + " : " + response.msg, '', {
                 timeOut: 5000,
                 "closeButton": true,
                 "preventDuplicates": true
             });
		 }
		 
	 }).catch(function (err) {
	        toggleLoader(false);
	    })
}

function checkValue(value) {
	
	if(checkValResultStr == "" || checkValResultStr == checkValResultStr) {
		return checkValResultStr;
	}
	return value;
}
function generateRandom() {
    return Math.floor(100000 + Math.random() * 900000);
}

function cardNext() {
    $('.credit-cards-sw-wrap').slick('slickNext');
}

function cardPrev() {
    $('.credit-cards-sw-wrap').slick('slickPrev');
}

function creditCardContentHeight() {
    var creditImageTextHeight = $(".back-cr-img-text").outerHeight();
    return creditImageTextHeight + 70;
}

document.addEventListener('DOMContentLoaded', function (event) {
    $(".credit-cards-sw-wrap").slick({
            slidesToShow: 3,
            dots: false,
            arrows: false,
            adaptiveHeight: false,
            autoplay: false,
            infinite:false,
            responsive: [{
                breakpoint: 992,
                settings: {
                    slidesToShow: 2,
                    slidesToScroll: 1
                }
            }, {
                breakpoint: 768,
                settings: {
                    slidesToShow: 1.1,
                    dots: false,
                    centerMode: false,
                    slidesToScroll: 1
                }
            }]
        });
        if ($(window).innerWidth() > 991) {}
        console.log(creditCardContentHeight());
        $('.back-cr-benefits-m').css({
            'height': 'calc(100% - ' + creditCardContentHeight() + 'px)'
        });
        $('.sl-next-btn').on("click", function () {
            cardNext();
        });
        $('.sl-prev-btn').on("click", function () {
            cardPrev();
        });
        $(".flip-btn-icon").on("click", function () {
            $(this).parents(".credit-cards-inner-front-w").addClass("credit-card-inner-flip");
            $(this).parents(".credit-cards-inner-front-main").find(".credit-card-img").fadeOut(300);
        });
        $(".flip-bck-btn-w").on("click", function () {
            $(this).parents(".credit-cards-inner-front-w").removeClass("credit-card-inner-flip");
            $(this).parents(".credit-cards-inner-front-main").find(".credit-card-img").fadeIn(300);
        });
        $(".back-cr-benefits-head-w").on("click", function () {
            $(this).siblings(".cr-benefits-details-ul").slideToggle();
            $(this).toggleClass("rotate-cr-arrow").parents(".back-cr-benfits-li").siblings().find(".back-cr-benefits-head-w").removeClass("rotate-cr-arrow");
            $(this).parents(".back-cr-benfits-li").siblings().find(".cr-benefits-details-ul").slideUp();
        });
        $('.flip-btn-txt').on("click", function (e) {
            var utm_params;
            var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
            var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
            if (urlParams) {
                utm_params = window.urlObj.search;
                if ($(this).attr("target")) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                                window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                                return false;
                            }
                        } else {
                            if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                                window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                                return false;
                            }
                        }
                    } else {
                        if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                            window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                    }
                } else {
                    if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                        if ($(this).attr("href").includes('?')) {
                            if (utm_params.includes('&nav_src')) {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                                return false;
                            } else {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                        } else {
                            if (utm_params.includes('&nav_src')) {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                                return false;
                            } else {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                        }
                    }
                }
            } else {
                if (typeof $(this).attr("href") !== typeof undefined && $(this).attr("href") !== false) {
                    utm_params = utm;
                    if ($(this).attr("target")) {
                        if ($(this).attr("href").includes('?')) {
                            if (utm_params.includes('&nav_src')) {
                                window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                                return false;
                            } else {
                                window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                                return false;
                            }
                        } else {
                            window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                    } else {
                        if ($(this).attr("href").includes('?')) {
                            if (utm_params.includes('&nav_src')) {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                                return false;
                            } else {
                                if (utm_params.length > 0) {
                                    window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                    return false;
                                } else {
                                    window.location.href = $(this).attr("href");
                                    return false;
                                } /* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length); return false; */
                            }
                        } else {
                            if (utm_params.includes('&nav_src')) {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                                return false;
                            } else {
                                if (utm_params.length > 0) {
                                    window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                    return false;
                                } else {
                                    window.location.href = $(this).attr("href");
                                    return false;
                                } /* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length); return false; */
                            }
                        }
                    }
                }
            }
        });
});
function offerDealsUTM() {
        $("button[href]").on("click", function (e) {
            var utm_params;
            var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
            var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
            if (urlParams) {
                utm_params = window.urlObj.search;
                if ($(this).attr("target")) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                        else {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                    else {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
                else {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        }
                    }
                    else {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        }
                    }
                }
            }
            else {
                utm_params = utm;
                if ($(this).attr("target")) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                        else {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                    else {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
                else {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            if (utm_params.length > 0) {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                            else {
                                window.location.href = $(this).attr("href");
                                return false;
                            }
                            /* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                            return false; */
                        }
                    }
                    else {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            if (utm_params.length > 0) {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                            else {
                                window.location.href = $(this).attr("href");
                                return false;
                            }
                            /* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                            return false; */
                        }
                    }
                }
            }
        });
}


$(document).ready(function () {
    $(".ulip-cards-wrapper").slick({
        slidesToShow: 3,
        dots: false,
        arrows: false,
        adaptiveHeight: false,
        autoplay: false,
        nextArrow: '<i class="ulip-card-arrows ulip-card-arrows-next"></i>',
        prevArrow: '<i class="ulip-card-arrows ulip-card-arrows-prev"></i>',


        responsive: [{
                breakpoint: 992,
                settings: {
                    slidesToShow: 2,
                    slidesToScroll: 2,
                    dots: true,
                    arrows: true,


                }
            },
            {
                breakpoint: 768,
                settings: {
                    slidesToShow: 1,
                    dots: true,
                    slidesToScroll: 1,
                    arrows: true


                }
            }

        ]
    });


    $(".ulip-card-btn").on("click", function (e) {
        var utm_params;
        var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
        var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
        if (urlParams) {
            utm_params = window.urlObj.search;
            if ($(this).attr("target")) {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    } else {
                        window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                        return false;
                    }
                } else {
                    window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                    return false;
                }
            } else {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                        return false;
                    }
                } else {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                        return false;
                    }
                }
            }
        } else {
            utm_params = utm;
            if ($(this).attr("target")) {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    } else {
                        window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                        return false;
                    }
                } else {
                    window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                    return false;
                }
            } else {
                if ($(this).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        if (utm_params.length > 0) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        } else {
                            window.location.href = $(this).attr("href");
                            return false;
                        }
                        /* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                        return false; */
                    }
                } else {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        if (utm_params.length > 0) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        } else {
                            window.location.href = $(this).attr("href");
                            return false;
                        }
                        /* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                        return false; */
                    }
                }
            }
        }
    });

});
function UTMCheck(ele) {
    try {
        triggerLoanApplyNow();
    } catch (error) {
        console.log(error)
    }
    glUTMCheck(ele);
}
function topProductSlick(ele) {
    ele.slick({
        dots: false,
        infinite: false,
        speed: 300,
        slidesToShow: 4,
        arrows: true,
        slidesToScroll: 4,


        responsive: [{
                breakpoint: 992,
                settings: {
                    slidesToShow: 2,
                    slidesToScroll: 2,
                    dots: false,
                    arrows: true,


                }
            },
            {
                breakpoint: 768,
                settings: {
                    slidesToShow: 4,

                    dots: true,
                    infinite: true,

                    slidesToScroll: 4,
                    arrows: false


                }
            },
            {
                breakpoint: 480,
                settings: {
                    slidesToShow: 3,
                    infinite: true,

                    dots: true,
                    slidesToScroll: 3,
                    arrows: false


                }
            }

        ]
    });
}

function topProductSlickOa(ele) {
    ele.slick({
        dots: false,
        infinite: false,
        speed: 300,
        slidesToShow: 4,
        arrows: true,
        slidesToScroll: 4,


        responsive: [{
                breakpoint: 992,
                settings: {
                    slidesToShow: 2,
                    slidesToScroll: 2,
                    dots: false,
                    arrows: true,


                }
            },
            {
                breakpoint: 768,
                settings: "unslick"
            }
        ]
    });
}

function tabsSlick(ele) {
    ele.slick({
        dots: false,
        infinite: false,
        speed: 300,
        variableWidth: true,
        arrows: false,
        draggable: true,
        swipeToSlide: true,
    })
}

function textEllipsis() {
    var textMaxLength = 200;
    $(".ins-top-content-text").each(function() {
        var paraText = $(this).text();
        if (paraText.length > textMaxLength) {
            var shortPara = paraText.substring(0, textMaxLength) + '...'
            $(this).text(shortPara)
        }
    })
}


$(document).ready(function() {
    $(".ins-tab-slick-init").each(function() {
        var sliderInit = $(this);
        topProductSlick(sliderInit);
    });

    $(".ins-tab-slick-init-oa").each(function() {
        var sliderInit = $(this);
        topProductSlickOa(sliderInit);
    })

    topProductSlick($(".ins-top-slick-init"));

    tabsSlick($(".ins-prod-tabs-ul"));
 //   textEllipsis();


/*    $(document).on("click", ".view-more-fn", function() {
        var _this = $(this);
        var toDo = _this.attr("data-view");
        var textMaxLength = 200;
        if (toDo == "viewmore") {
            _this.text("Click to View Less");
            var fullText = _this.parents(".ins-top-slides-w").find(".ins-top-content-text").data("fulltext");
            _this.parents(".ins-top-slides-w").find(".ins-top-content-text").text(fullText);
            _this.attr("data-view", "viewless");
        } else if (toDo == "viewless") {
            _this.text("Click to View More");
            var paraText = _this.parents(".ins-top-slides-w").find(".ins-top-content-text").text();
            if (paraText.length > textMaxLength) {
                var shortPara = paraText.substring(0, textMaxLength) + '...'
                _this.parents(".ins-top-slides-w").find(".ins-top-content-text").text(shortPara);
            }
            _this.attr("data-view", "viewmore");
        }
    });
*/
    $(document).on("click", ".ins-prod-tabs-li", function() {
        $(this).addClass("ins-prod-tabs-li-active").parents(".slick-slide").siblings().find(".ins-prod-tabs-li").removeClass("ins-prod-tabs-li-active");
        var divToShow = $(this).attr("data-show");
        $("#" + divToShow).removeClass("dsp-none").siblings().addClass("dsp-none");

    })
});
function UTMPersistency(ele){
	glUTMCheck(ele);
}


function ageRangeSlider(_this) {
    var rangeValue = parseInt(_this.val());
    var minPos = 0;
    var maxPos = 100;
    var minRange = 18;
    var maxRange = 65;
    var toSlideValue = minPos + [((rangeValue - minRange) / (maxRange - minRange)) * (maxPos - minPos)];
    _this.next().find(".bfl-agerangevalue-text").text(rangeValue);
    _this.next().css({
        'left': toSlideValue + '%',
        'transform': 'translateX(-' + toSlideValue + '%'
    });
}
$(document).ready(function () {
    try {
        $(".bfl-agerange-slider-fn").on("input", function () {
            ageRangeSlider($(this));
        })
        document.querySelector(".cta-get-a-term-plan").addEventListener("click", function (event) {
        	toggleLoader(true);
            var redirectURL = window.location.origin + event.currentTarget.getAttribute("data-href");
            setTimeout(function () {
            	window.location.href=redirectURL;
            }, 500);
        })
    } catch (error) {
        console.log("error:" + error);
    }

})
if (document.querySelector(".bfl-agerange-slider")) {
    document.getElementsByClassName("bfl-agerange-slider")[0].onchange = function () {
        getAgeData(AppConstants.API_SELECTOR.AGE_WISE_CALCULATOR.name, "");
    }
}
document.addEventListener("DOMContentLoaded", function () {
    if (localStorage.getItem("agewisedata")) {
        localStorage.removeItem("agewisedata");
    }
    if (document.querySelector(".bfl-age-wcalculator-card-w")) {
        getAgeData(AppConstants.API_SELECTOR.AGE_WISE_CALCULATOR.name, "");
    }
});

function getAgeData(selector, reqData) {
    var ageWiseData;
    if (localStorage.getItem("agewisedata")) {
        ageWiseData = JSON.parse(localStorage.getItem("agewisedata"));
        var data = ageWiseData.ageWise;
        var ageslider = document.getElementsByClassName("bfl-agerange-slider")[0].value;
        for (var i = 0; i < data.length; i++) {
            if (data[i].age == ageslider) {
                document.getElementById("calcvalue").innerText = " ₹" + data[i].annual_premium;
            }
        }
    } else {
        AppEvent.trigger(selector, reqData).then(function (responseText) {
            localStorage.setItem("agewisedata", JSON.stringify(responseText));
            var data = responseText.ageWise;
            var ageslider = document.getElementsByClassName("bfl-agerange-slider")[0].value;
            for (var i = 0; i < data.length; i++) {
                if (data[i].age == ageslider) {
                    document.getElementById("calcvalue").innerText = " ₹" + data[i].annual_premium;
                }
            }
            toggleLoader(false);
        }).catch(function (error) {
            console.log(error);
        })
    }
}
function calcInterpolate(minPos, maxPos, minRange, maxRange, currentValue) {
    return minPos + ((currentValue - minRange) / (maxRange - minRange)) * (maxPos - minPos);
}

function bmiNeedleRotate(valRange) {
    var bmiCalculatedValue = valRange;
    var rangeValue = valRange;
    var minPos = 270;
    var maxPos = 450;
    var minRange = 13.5;
    var maxRange = 30;
    rangeValue = rangeValue > maxRange ? maxRange : rangeValue;
    rangeValue = rangeValue < minRange ? minRange : rangeValue;
    var needleValue = calcInterpolate(minPos, maxPos, minRange, maxRange, rangeValue);
    $(".bmi-status-needle-w").css({
        'transform': 'translateX(-50%) rotate(' + needleValue + 'deg)'
    });
    $(".bmi-calc-value-fn").text(bmiCalculatedValue);
}

function calculateBMI() {
    if (isBmiValidate()) return;
    var weight = document.getElementById("weight").value;
    var heightforfeet = document.getElementById("feetheight").value;
    var heightforinch = document.getElementById("inchheight").value;
    var totalfeethight = (heightforfeet * 0.3048) + (heightforinch * 0.0254);
    var bmivalue = weight / (totalfeethight * totalfeethight);
    bmivalue = Math.round(bmivalue);
    $('.bmi-card-details-form').addClass("dsp-none");
    $('.bmi-card-result-form').removeClass("dsp-none");
    $('.bmi-card-instr-m-wrapper').addClass("dsp-none");
    $('.bmi-card-healthins-m-wrapper').removeClass("dsp-none");
    bmiNeedleRotate(bmivalue);
    if (bmivalue < 18.5) {
        $(".bmi-normalweight-desc").css("display", "none");
        $(".bmi-overweight-desc").css("display", "none");
        $(".bmi-underweight-desc").css("display", "block");
    } else if (bmivalue >= 18.5 && bmivalue <= 25) {
        $(".bmi-underweight-desc").css("display", "none");
        $(".bmi-overweight-desc").css("display", "none");
        $(".bmi-normalweight-desc").css("display", "block");
    } else if (bmivalue > 25) {
        $(".bmi-underweight-desc").css("display", "none");
        $(".bmi-normalweight-desc").css("display", "none");
        $(".bmi-overweight-desc").css("display", "block");
    }
    $('#bmistatusbartext').text(getDescription(bmivalue));
}

function reCalculate() {
    $('.bmi-card-details-form input').val("");
    $('.bmi-card-details-form').removeClass("dsp-none");
    $('.bmi-card-result-form').addClass("dsp-none");
    $('.bmi-card-instr-m-wrapper').removeClass("dsp-none");
    $('.bmi-card-healthins-m-wrapper').addClass("dsp-none");
}

function getDescription(bmivalue) {
    var information = "";
    if (bmivalue < 16) {
        information = "Severe Thinness";
    } else if (bmivalue >= 16 && bmivalue <= 17) {
        information = "Moderate Thinness";
    } else if (bmivalue >= 17 && bmivalue <= 18.5) {
        information = "Mild Thinness";
    } else if (bmivalue >= 18.5 && bmivalue <= 25) {
        information = "Normal";
    } else if (bmivalue >= 25 && bmivalue <= 30) {
        information = "Overweight";
    } else if (bmivalue >= 30 && bmivalue <= 35) {
        information = "Obese Class I";
    } else if (bmivalue >= 35 && bmivalue <= 40) {
        information = "Obese Class II";
    } else if (bmivalue >= 40) {
        information = "Obese Class III"
    } else {
        information = "Enter Proper Height and Weight";
    }
    return information;
}
$(document).ready(function () {
    if (document.querySelector(".bmi-radio-act")) {
        $(".bmi-radio-act[name='bmi-gender']").on("change", function () {
            var _this = $(this);
            _this.parent().find(".bmi-gendertext").addClass("bmi-radio-active ");
            _this.parents(".radiodiv").siblings().find(".bmi-gendertext").removeClass("bmi-radio-active ");
        });
    }
});

function isBmiValidate() {
    var status = false;
    var age = document.getElementById("ageBmi").value;
    if (isNaN(age) || age < 18 || age > 75) {
        showError("ageBmiErrorMsg", "Enter age between 18 to 75", true);
        status = true;
    } else {
        showError("ageBmiErrorMsg", "Enter age between 18 to 75", false);
    }
    var ftHeight = document.getElementById("feetheight").value;
    if (isNaN(ftHeight) || ftHeight < 3 || ftHeight > 7) {
        showError("feetheightErrorMsg", "Between 3 to 7", true);
        status = true;
    } else {
        showError("feetheightErrorMsg", "Between 3 to 7", false);
    }
    var inHeight = document.getElementById("inchheight").value;
    if (isNaN(inHeight) || inHeight < 0 || inHeight >= 12) {
        showError("inchheightErrorMsg", "Inch 0 to 11", true);
        status = true;
    } else {
        showError("inchheightErrorMsg", "Inch 0 to 11", false);
    }
    var bmiWeight = document.getElementById("weight").value;
    if (bmiWeight == 0) {
        showError("weightErrorMsg", "Weight is not a zero", true);
        status = true;
    } else {
        showError("weightErrorMsg", "Weight is not a zero", false);
    }
    return status;
}
function stickBlogCta() {
    try {
        var topHeight = $(".bfs-header-wrap").outerHeight();
        if ($(".bfl-blogbanner-cta-w-wrapper").length > 0) {
            var window_top = $(window).scrollTop();
            var div_top = $(".bfl-blogbanner-cta-w-wrapper").offset().top;
            if (window_top > div_top) {
                $(".bfl-blogbanner-cta-w").addClass('blog-cta-stick');
                $(".bfl-blogbanner-cta-w").css('top', topHeight + "px");
            } else {
                $(".bfl-blogbanner-cta-w").removeClass('blog-cta-stick');
                $(".bfl-blogbanner-cta-w").css('top', "auto");
            }
        }
    } catch (error) {
        console.log("error: " + error);
    }
}
$(document).ready(function () {
    $(window).scroll(function () {
        if ($(window).innerWidth() > 767) {
            stickBlogCta();
        }
    });
    
    if(document.querySelector(".bfl-blogbanner-btn-m") && window.innerWidth < 768){
    	if(document.querySelectorAll(".bfl-blogbanner-btn-m").length === 1){
    		document.querySelector(".bfl-blogbanner-btn-m").style.width="100%";
    	}
    }else if(document.querySelector(".bfl-blogbanner-btn-m") && window.innerWidth > 767){
    	if(document.querySelectorAll(".bfl-blogbanner-btn-m").length === 1){
    		document.querySelector(".bfl-blogbanner-btn-w").style.textAlign="right";
    	}
    }
})
function offerDealsUTM() {
        $("button[href]").on("click", function (e) {
            var utm_params;
            var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
            var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
            if (urlParams) {
                utm_params = window.urlObj.search;
                if ($(this).attr("target")) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                        else {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                    else {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
                else {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        }
                    }
                    else {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        }
                    }
                }
            }
            else {
                utm_params = utm;
                if ($(this).attr("target")) {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                            return false;
                        }
                        else {
                            window.open($(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(this).attr("target"));
                            return false;
                        }
                    }
                    else {
                        window.open($(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(this).attr("target"));
                        return false;
                    }
                }
                else {
                    if ($(this).attr("href").includes('?')) {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            if (utm_params.length > 0) {
                                window.location.href = $(this).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                            else {
                                window.location.href = $(this).attr("href");
                                return false;
                            }
                            /* window.location.href = $(this).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                            return false; */
                        }
                    }
                    else {
                        if (utm_params.includes('&nav_src')) {
                            window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                            return false;
                        }
                        else {
                            if (utm_params.length > 0) {
                                window.location.href = $(this).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                                return false;
                            }
                            else {
                                window.location.href = $(this).attr("href");
                                return false;
                            }
                            /* window.location.href = $(this).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length);
                            return false; */
                        }
                    }
                }
            }
        });
}
$(document).ready(function () {
    $('.bfl-hp-slider-ul').slick({
        dots: true,
        slidesToShow: 2,
        centerMode: true,
        centerPadding: '100px',
        slideToScroll: 1,
        responsive: [{
            breakpoint: 767,
            settings: {
                slidesToShow: 1,
                centerPadding: '25px',
                centerMode: true,
            }
        }, ]
    });
})
function getBlogsData(response) {
    try {
        var data = response;
        for (var i = 0; i < data.length; i++) {
            var li = document.createElement("li");
            li.classList.add("bfl-tb-cards-li");
            var tb_cards_content_div = document.createElement("div");
            tb_cards_content_div.classList.add("bfl-tb-cards-content-w");
            var tb_card_topimage_div = document.createElement("a");
            tb_card_topimage_div.classList.add("bfl-tb-card-topimage-w");
            tb_card_topimage_div.href = data[i].link;
            var img = document.createElement("img");
            img.classList.add("img-cover100");
            img.classList.add("c-lozad");
            img.setAttribute("data-src", data[i].better_featured_image.source_url);
            // img.src = data[i].better_featured_image.source_url;
            tb_card_topimage_div.appendChild(img);
            var tbcard_btmcontent_div = document.createElement("div");
            tbcard_btmcontent_div.classList.add("bfl-tbcard-btmcontent-w");
            var tbcard_title_div = document.createElement("div");
            tbcard_title_div.classList.add("bfl-tbcard-title-w");
            tbcard_title_div.classList.add("mb-8");
            var tbcard_title_text_div = document.createElement("a");
            tbcard_title_text_div.classList.add("bfl-tbcard-title-redirect");
            tbcard_title_text_div.href = data[i].link;
            var tb_card_inner_title = document.createElement("h3");
            tb_card_inner_title.classList.add("bfl-tbcard-title-text");
            tb_card_inner_title.innerText = (data[i].title.rendered).split("&#038;").join("&");
            var tbcard_rating_div = document.createElement("div");
            tbcard_rating_div.classList.add("bfl-tbcard-ratings-w");
            tbcard_rating_div.classList.add("mb-8");
            var tb_card_rating_ul = document.createElement("div");
            tb_card_rating_ul.classList.add("bs-rating");
            tb_card_rating_ul.classList.add("clear-fix");
            if (data[i].acf.total_average == "1") {
                tb_card_rating_ul.classList.add("rating-1");
            } else if (data[i].acf.total_average == "2") {
                tb_card_rating_ul.classList.add("rating-2");
            } else if (data[i].acf.total_average == "3") {
                tb_card_rating_ul.classList.add("rating-3");
            } else if (data[i].acf.total_average == "4") {
                tb_card_rating_ul.classList.add("rating-4");
            } else if (data[i].acf.total_average == "5") {
                tb_card_rating_ul.classList.add("rating-5");
            }
            for (var j = 0; j < 5; j++) {
                var tb_card_rating_li = document.createElement("span");
                tb_card_rating_li.classList.add("star");
                var tb_card_rating_li_inner = document.createElement("i");
                tb_card_rating_li_inner.classList.add("icon");
                tb_card_rating_li_inner.classList.add("icon-rating-star");
                tb_card_rating_li.appendChild(tb_card_rating_li_inner);
                tb_card_rating_ul.appendChild(tb_card_rating_li);
            }
            var tbcard_para_div = document.createElement("div");
            tbcard_para_div.classList.add("bfl-tbcard-para-w");
            tbcard_para_div.classList.add("mb-8");
            var p = document.createElement("p");
            p.classList.add("bfl-tbcard-paratext");
            p.innerHTML = data[i].excerpt.rendered;
            var tb_readmore_seen_div = document.createElement("div");
            tb_readmore_seen_div.classList.add("bfl-tb-readmore-seen");
            tb_readmore_seen_div.classList.add("clear-fix");
            var tb_readmore_cta_div = document.createElement("div");
            tb_readmore_cta_div.classList.add("bfl-tb-readmore-cta");
            var anchor = document.createElement("a");
            anchor.classList.add("bfl-tb-rm-cta");
            anchor.href = data[i].link;
            anchor.innerText = "Read More";
            var tb_share_seen_div = document.createElement("div");
            tb_share_seen_div.classList.add("bfl-tb-share-seen-w");
            var tb_seen_div = document.createElement("div");
            tb_seen_div.classList.add("bfl-tb-seen-w");
            var tb_seen_text_span = document.createElement("span");
            tb_seen_text_span.classList.add("bfl-tb-seen-text");
            tb_seen_text_span.innerText = data[i].acf.views;
            var tb_seen_img_span = document.createElement("span");
            tb_seen_img_span.classList.add("bfl-tb-seen-img");
            var span_img = document.createElement("img");
            span_img.classList.add("img-contain100");
            span_img.classList.add("c-lozad");
            span_img.setAttribute("data-src", seenicon);
            // span_img.src = seenicon;
            var tb_share_btn_div = document.createElement("div");
            tb_share_btn_div.classList.add("bf-tb-share-btn");
            var share_btn_img = document.createElement("img");
            share_btn_img.classList.add("img-contain100");
            share_btn_img.classList.add("c-lozad");
            share_btn_img.setAttribute("data-src", shareicon);
            // share_btn_img.src = shareicon;
            var share_btn_inr_icon = document.createElement("div");
            share_btn_inr_icon.classList.add("sharesection");
            var share_span = document.createElement("span");
            share_span.classList.add("bfl-sharespan");
            var share_span_inr_image = document.createElement("img");
            share_span_inr_image.src = shareicon;
            var share_btn_ul = document.createElement("ul");
            share_btn_ul.setAttribute("id", "shareIcon");
            share_btn_ul.classList.add("social-share-ul");
            var social_share_li = "<li class='social-share-li'><a class='share-url' target='_blank' href='https://www.facebook.com/sharer/sharer.php?kid_directed_site=0&u=" + data[i].link + "'><img class='img-contain100' src='/content/dam/bajajfinserv/facebook.png'></a></li>" + "<li class='social-share-li'><a class='share-url' target='_blank' href='https://twitter.com/share?url=" + data[i].link + "'><img class='img-contain100' src='/content/dam/bajajfinserv/twitter.png'></a></li>" + "<li class='social-share-li'><a class='share-url' target='_blank' href='https://web.whatsapp.com:/send?text=" + data[i].link + "'><img class='img-contain100' src='/content/dam/bajajfinserv/whatsapp.png'></a></li>";
            share_btn_ul.innerHTML = social_share_li;
            share_span.appendChild(share_span_inr_image);
            share_btn_inr_icon.appendChild(share_span);
            share_btn_inr_icon.appendChild(share_btn_ul);
            tb_readmore_cta_div.appendChild(anchor);
            tb_readmore_seen_div.appendChild(tb_readmore_cta_div);
            tb_seen_img_span.appendChild(span_img);
            tb_seen_text_span.appendChild(tb_seen_img_span);
            tb_seen_div.appendChild(tb_seen_text_span);
            tb_share_seen_div.appendChild(tb_seen_div);
            tb_share_btn_div.appendChild(share_btn_img);
            tb_share_seen_div.appendChild(share_btn_inr_icon);
            tb_readmore_seen_div.appendChild(tb_share_seen_div);
            tbcard_para_div.appendChild(p);
            tbcard_title_text_div.appendChild(tb_card_inner_title);
            tbcard_title_div.appendChild(tbcard_title_text_div);
            tb_cards_content_div.appendChild(tb_card_topimage_div);
            tbcard_btmcontent_div.appendChild(tbcard_title_div);
            tbcard_rating_div.appendChild(tb_card_rating_ul);
            tbcard_btmcontent_div.appendChild(tbcard_rating_div);
            tbcard_btmcontent_div.appendChild(tbcard_para_div);
            tbcard_btmcontent_div.appendChild(tb_readmore_seen_div);
            tb_cards_content_div.appendChild(tbcard_btmcontent_div);
            li.appendChild(tb_cards_content_div);
            var ul = document.getElementsByClassName("bfl-tb-cards-ul")[0];
            ul.append(li);
        }
        document.querySelector(".bfl-trending-blogs").style.display = "block";
    } catch (error) {
        console.log("error: " + error);
        toggleLoader(false);
    }
}
$(document).ready(function () {
    if (document.querySelector(".bfl-trending-blogs")) {
        var trendingQueryParam = "?";
        if (trendingBlogsTags != "") {
            trendingQueryParam += "tags=" + trendingBlogsTags;
        }
        if (trendingBlogsProductType != "" && trendingQueryParam.length > 5) {
            trendingQueryParam += "&product_type=" + trendingBlogsProductType;
        } else if (trendingBlogsProductType != "") {
            trendingQueryParam += "product_type=" + trendingBlogsProductType;
        }
        trendingQueryParam = (trendingQueryParam.length > 2) ? trendingQueryParam : "";
        var baseURL = 'https://www.bajajfinservmarkets.in/discover/wp-json/wp/v2/posts' + trendingQueryParam;
        trendingBlogsAjax("GET", baseURL).then(function (data) {
            getBlogsData(data);
            var dynObserver = lozad('.c-lozad', {
                threshold: 0.3
            });
            dynObserver.observe();
            $('.bfl-tb-cards-slick-fn').slick({
                dots: false,
                infinite: false,
                speed: 300,
                slidesToShow: 3.8,
                arrows: true,
                slidesToScroll: 1,
                responsive: [{
                    breakpoint: 1024,
                    settings: {
                        slidesToShow: 3,
                    }
                }, {
                    breakpoint: 767,
                    settings: {
                        slidesToShow: 1.2,
                        arrows: false,
                        dots: true
                    }
                },]
            });
        }).catch(function (error) {
            console.log(error);
        })
        $(document).on('click', '.bfl-sharespan', function () {
            $(this).parent().children('ul').toggle("slide");
        });
    }
})

function trendingBlogsAjax(method, url) {
    try {
        return new Promise(function (resolve, reject) {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    resolve(JSON.parse(this.responseText));
                } else if (this.readyState == 4 && this.status != 200) {
                    reject(this.responseText);
                }
            };
            xhttp.open(method, url, true);
            xhttp.setRequestHeader("Content-type", "application/json");
            xhttp.send();
        })
    } catch (e) {
        console.error(e);
    }
}
$(document).ready(function(){
    $('.bfl-tb-cards-slick-fn-st').slick({
        dots: false,
        infinite: false,
        speed: 300,
        slidesToShow: 3.8,
        arrows: true,
        slidesToScroll: 1,
        responsive: [{
            breakpoint: 1024,
            settings: {
                slidesToShow: 3,
            }
        }, {
            breakpoint: 767,
            settings: {
                slidesToShow: 1.2,
                arrows: false,
                dots: true
            }
        },]
    });
    $(document).off('click', '.bfl-sharespan');
    $(document).on('click', '.bfl-sharespan', function () {
        $(this).parent().children('ul').toggle("slide");
    });
});
$(document).ready(function() {
    var swiper = new Swiper('.testimonial-comm-cards-main', {
        /*pagination: '.swiper-pagination', */
        /*paginationClickable: true,*/
        pagination: {
            el: '.swiper-pagination',
            dynamicBullets: true,
            clickable: true,
            dynamicMainBullets: 1
        },
        slidesPerView: 'auto',
        nextButton: '.review-swiper-button-next',
        prevButton: '.review-swiper-button-prev',
        /*navigation: {
            nextEl: '.review-swiper-button-next',
            prevEl: '.review-swiper-button-prev'
        },*/
        loop: true,

        coverflow: {
            rotate: 0,
            stretch: 0,
            depth: 150,
            modifier: 1.5,
            slideShadows: false,
        },

        breakpoints: {
            767: {
                slidesPerView: '1',
                effect: 'coverflow',
                loopFillGroupWithBlank: true,
            },

            991: {
                slidesPerView: '1',
            },

            1140: {
                slidesPerView: '2',
            },
        }
    });
})

/*!
 * Chart.js v2.9.4
 * https://www.chartjs.org
 * (c) 2020 Chart.js Contributors
 * Released under the MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(function(){try{return require("moment")}catch(t){}}()):"function"==typeof define&&define.amd?define(["require"],(function(t){return e(function(){try{return t("moment")}catch(t){}}())})):(t=t||self).Chart=e(t.moment)}(this,(function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},n=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[e[i]]=i);var a=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var r in a)if(a.hasOwnProperty(r)){if(!("channels"in a[r]))throw new Error("missing channels property: "+r);if(!("labels"in a[r]))throw new Error("missing channel labels property: "+r);if(a[r].labels.length!==a[r].channels)throw new Error("channel and label counts mismatch: "+r);var o=a[r].channels,s=a[r].labels;delete a[r].channels,delete a[r].labels,Object.defineProperty(a[r],"channels",{value:o}),Object.defineProperty(a[r],"labels",{value:s})}a.rgb.hsl=function(t){var e,n,i=t[0]/255,a=t[1]/255,r=t[2]/255,o=Math.min(i,a,r),s=Math.max(i,a,r),l=s-o;return s===o?e=0:i===s?e=(a-r)/l:a===s?e=2+(r-i)/l:r===s&&(e=4+(i-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(o+s)/2,[e,100*(s===o?0:n<=.5?l/(s+o):l/(2-s-o)),100*n]},a.rgb.hsv=function(t){var e,n,i,a,r,o=t[0]/255,s=t[1]/255,l=t[2]/255,u=Math.max(o,s,l),d=u-Math.min(o,s,l),h=function(t){return(u-t)/6/d+.5};return 0===d?a=r=0:(r=d/u,e=h(o),n=h(s),i=h(l),o===u?a=i-n:s===u?a=1/3+e-i:l===u&&(a=2/3+n-e),a<0?a+=1:a>1&&(a-=1)),[360*a,100*r,100*u]},a.rgb.hwb=function(t){var e=t[0],n=t[1],i=t[2];return[a.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(n,i))),100*(i=1-1/255*Math.max(e,Math.max(n,i)))]},a.rgb.cmyk=function(t){var e,n=t[0]/255,i=t[1]/255,a=t[2]/255;return[100*((1-n-(e=Math.min(1-n,1-i,1-a)))/(1-e)||0),100*((1-i-e)/(1-e)||0),100*((1-a-e)/(1-e)||0),100*e]},a.rgb.keyword=function(t){var i=n[t];if(i)return i;var a,r,o,s=1/0;for(var l in e)if(e.hasOwnProperty(l)){var u=e[l],d=(r=t,o=u,Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2)+Math.pow(r[2]-o[2],2));d<s&&(s=d,a=l)}return a},a.keyword.rgb=function(t){return e[t]},a.rgb.xyz=function(t){var e=t[0]/255,n=t[1]/255,i=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*e+.7152*n+.0722*i),100*(.0193*e+.1192*n+.9505*i)]},a.rgb.lab=function(t){var e=a.rgb.xyz(t),n=e[0],i=e[1],r=e[2];return i/=100,r/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(n-i),200*(i-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},a.hsl.rgb=function(t){var e,n,i,a,r,o=t[0]/360,s=t[1]/100,l=t[2]/100;if(0===s)return[r=255*l,r,r];e=2*l-(n=l<.5?l*(1+s):l+s-l*s),a=[0,0,0];for(var u=0;u<3;u++)(i=o+1/3*-(u-1))<0&&i++,i>1&&i--,r=6*i<1?e+6*(n-e)*i:2*i<1?n:3*i<2?e+(n-e)*(2/3-i)*6:e,a[u]=255*r;return a},a.hsl.hsv=function(t){var e=t[0],n=t[1]/100,i=t[2]/100,a=n,r=Math.max(i,.01);return n*=(i*=2)<=1?i:2-i,a*=r<=1?r:2-r,[e,100*(0===i?2*a/(r+a):2*n/(i+n)),100*((i+n)/2)]},a.hsv.rgb=function(t){var e=t[0]/60,n=t[1]/100,i=t[2]/100,a=Math.floor(e)%6,r=e-Math.floor(e),o=255*i*(1-n),s=255*i*(1-n*r),l=255*i*(1-n*(1-r));switch(i*=255,a){case 0:return[i,l,o];case 1:return[s,i,o];case 2:return[o,i,l];case 3:return[o,s,i];case 4:return[l,o,i];case 5:return[i,o,s]}},a.hsv.hsl=function(t){var e,n,i,a=t[0],r=t[1]/100,o=t[2]/100,s=Math.max(o,.01);return i=(2-r)*o,n=r*s,[a,100*(n=(n/=(e=(2-r)*s)<=1?e:2-e)||0),100*(i/=2)]},a.hwb.rgb=function(t){var e,n,i,a,r,o,s,l=t[0]/360,u=t[1]/100,d=t[2]/100,h=u+d;switch(h>1&&(u/=h,d/=h),i=6*l-(e=Math.floor(6*l)),0!=(1&e)&&(i=1-i),a=u+i*((n=1-d)-u),e){default:case 6:case 0:r=n,o=a,s=u;break;case 1:r=a,o=n,s=u;break;case 2:r=u,o=n,s=a;break;case 3:r=u,o=a,s=n;break;case 4:r=a,o=u,s=n;break;case 5:r=n,o=u,s=a}return[255*r,255*o,255*s]},a.cmyk.rgb=function(t){var e=t[0]/100,n=t[1]/100,i=t[2]/100,a=t[3]/100;return[255*(1-Math.min(1,e*(1-a)+a)),255*(1-Math.min(1,n*(1-a)+a)),255*(1-Math.min(1,i*(1-a)+a))]},a.xyz.rgb=function(t){var e,n,i,a=t[0]/100,r=t[1]/100,o=t[2]/100;return n=-.9689*a+1.8758*r+.0415*o,i=.0557*a+-.204*r+1.057*o,e=(e=3.2406*a+-1.5372*r+-.4986*o)>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,[255*(e=Math.min(Math.max(0,e),1)),255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1))]},a.xyz.lab=function(t){var e=t[0],n=t[1],i=t[2];return n/=100,i/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(e-n),200*(n-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},a.lab.xyz=function(t){var e,n,i,a=t[0];e=t[1]/500+(n=(a+16)/116),i=n-t[2]/200;var r=Math.pow(n,3),o=Math.pow(e,3),s=Math.pow(i,3);return n=r>.008856?r:(n-16/116)/7.787,e=o>.008856?o:(e-16/116)/7.787,i=s>.008856?s:(i-16/116)/7.787,[e*=95.047,n*=100,i*=108.883]},a.lab.lch=function(t){var e,n=t[0],i=t[1],a=t[2];return(e=360*Math.atan2(a,i)/2/Math.PI)<0&&(e+=360),[n,Math.sqrt(i*i+a*a),e]},a.lch.lab=function(t){var e,n=t[0],i=t[1];return e=t[2]/360*2*Math.PI,[n,i*Math.cos(e),i*Math.sin(e)]},a.rgb.ansi16=function(t){var e=t[0],n=t[1],i=t[2],r=1 in arguments?arguments[1]:a.rgb.hsv(t)[2];if(0===(r=Math.round(r/50)))return 30;var o=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(e/255));return 2===r&&(o+=60),o},a.hsv.ansi16=function(t){return a.rgb.ansi16(a.hsv.rgb(t),t[2])},a.rgb.ansi256=function(t){var e=t[0],n=t[1],i=t[2];return e===n&&n===i?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(i/255*5)},a.ansi16.rgb=function(t){var e=t%10;if(0===e||7===e)return t>50&&(e+=3.5),[e=e/10.5*255,e,e];var n=.5*(1+~~(t>50));return[(1&e)*n*255,(e>>1&1)*n*255,(e>>2&1)*n*255]},a.ansi256.rgb=function(t){if(t>=232){var e=10*(t-232)+8;return[e,e,e]}var n;return t-=16,[Math.floor(t/36)/5*255,Math.floor((n=t%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},a.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var n=e[0];3===e[0].length&&(n=n.split("").map((function(t){return t+t})).join(""));var i=parseInt(n,16);return[i>>16&255,i>>8&255,255&i]},a.rgb.hcg=function(t){var e,n=t[0]/255,i=t[1]/255,a=t[2]/255,r=Math.max(Math.max(n,i),a),o=Math.min(Math.min(n,i),a),s=r-o;return e=s<=0?0:r===n?(i-a)/s%6:r===i?2+(a-n)/s:4+(n-i)/s+4,e/=6,[360*(e%=1),100*s,100*(s<1?o/(1-s):0)]},a.hsl.hcg=function(t){var e=t[1]/100,n=t[2]/100,i=1,a=0;return(i=n<.5?2*e*n:2*e*(1-n))<1&&(a=(n-.5*i)/(1-i)),[t[0],100*i,100*a]},a.hsv.hcg=function(t){var e=t[1]/100,n=t[2]/100,i=e*n,a=0;return i<1&&(a=(n-i)/(1-i)),[t[0],100*i,100*a]},a.hcg.rgb=function(t){var e=t[0]/360,n=t[1]/100,i=t[2]/100;if(0===n)return[255*i,255*i,255*i];var a,r=[0,0,0],o=e%1*6,s=o%1,l=1-s;switch(Math.floor(o)){case 0:r[0]=1,r[1]=s,r[2]=0;break;case 1:r[0]=l,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=s;break;case 3:r[0]=0,r[1]=l,r[2]=1;break;case 4:r[0]=s,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=l}return a=(1-n)*i,[255*(n*r[0]+a),255*(n*r[1]+a),255*(n*r[2]+a)]},a.hcg.hsv=function(t){var e=t[1]/100,n=e+t[2]/100*(1-e),i=0;return n>0&&(i=e/n),[t[0],100*i,100*n]},a.hcg.hsl=function(t){var e=t[1]/100,n=t[2]/100*(1-e)+.5*e,i=0;return n>0&&n<.5?i=e/(2*n):n>=.5&&n<1&&(i=e/(2*(1-n))),[t[0],100*i,100*n]},a.hcg.hwb=function(t){var e=t[1]/100,n=e+t[2]/100*(1-e);return[t[0],100*(n-e),100*(1-n)]},a.hwb.hcg=function(t){var e=t[1]/100,n=1-t[2]/100,i=n-e,a=0;return i<1&&(a=(n-i)/(1-i)),[t[0],100*i,100*a]},a.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},a.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},a.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},a.gray.hsl=a.gray.hsv=function(t){return[0,0,t[0]]},a.gray.hwb=function(t){return[0,100,t[0]]},a.gray.cmyk=function(t){return[0,0,0,t[0]]},a.gray.lab=function(t){return[t[0],0,0]},a.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),n=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}}));n.rgb,n.hsl,n.hsv,n.hwb,n.cmyk,n.xyz,n.lab,n.lch,n.hex,n.keyword,n.ansi16,n.ansi256,n.hcg,n.apple,n.gray;function i(t){var e=function(){for(var t={},e=Object.keys(n),i=e.length,a=0;a<i;a++)t[e[a]]={distance:-1,parent:null};return t}(),i=[t];for(e[t].distance=0;i.length;)for(var a=i.pop(),r=Object.keys(n[a]),o=r.length,s=0;s<o;s++){var l=r[s],u=e[l];-1===u.distance&&(u.distance=e[a].distance+1,u.parent=a,i.unshift(l))}return e}function a(t,e){return function(n){return e(t(n))}}function r(t,e){for(var i=[e[t].parent,t],r=n[e[t].parent][t],o=e[t].parent;e[o].parent;)i.unshift(e[o].parent),r=a(n[e[o].parent][o],r),o=e[o].parent;return r.conversion=i,r}var o={};Object.keys(n).forEach((function(t){o[t]={},Object.defineProperty(o[t],"channels",{value:n[t].channels}),Object.defineProperty(o[t],"labels",{value:n[t].labels});var e=function(t){for(var e=i(t),n={},a=Object.keys(e),o=a.length,s=0;s<o;s++){var l=a[s];null!==e[l].parent&&(n[l]=r(l,e))}return n}(t);Object.keys(e).forEach((function(n){var i=e[n];o[t][n]=function(t){var e=function(e){if(null==e)return e;arguments.length>1&&(e=Array.prototype.slice.call(arguments));var n=t(e);if("object"==typeof n)for(var i=n.length,a=0;a<i;a++)n[a]=Math.round(n[a]);return n};return"conversion"in t&&(e.conversion=t.conversion),e}(i),o[t][n].raw=function(t){var e=function(e){return null==e?e:(arguments.length>1&&(e=Array.prototype.slice.call(arguments)),t(e))};return"conversion"in t&&(e.conversion=t.conversion),e}(i)}))}));var s=o,l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},u={getRgba:d,getHsla:h,getRgb:function(t){var e=d(t);return e&&e.slice(0,3)},getHsl:function(t){var e=h(t);return e&&e.slice(0,3)},getHwb:c,getAlpha:function(t){var e=d(t);if(e)return e[3];if(e=h(t))return e[3];if(e=c(t))return e[3]},hexString:function(t,e){e=void 0!==e&&3===t.length?e:t[3];return"#"+v(t[0])+v(t[1])+v(t[2])+(e>=0&&e<1?v(Math.round(255*e)):"")},rgbString:function(t,e){if(e<1||t[3]&&t[3]<1)return f(t,e);return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},rgbaString:f,percentString:function(t,e){if(e<1||t[3]&&t[3]<1)return g(t,e);var n=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),a=Math.round(t[2]/255*100);return"rgb("+n+"%, "+i+"%, "+a+"%)"},percentaString:g,hslString:function(t,e){if(e<1||t[3]&&t[3]<1)return p(t,e);return"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"},hslaString:p,hwbString:function(t,e){void 0===e&&(e=void 0!==t[3]?t[3]:1);return"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"},keyword:function(t){return b[t.slice(0,3)]}};function d(t){if(t){var e=[0,0,0],n=1,i=t.match(/^#([a-fA-F0-9]{3,4})$/i),a="";if(i){a=(i=i[1])[3];for(var r=0;r<e.length;r++)e[r]=parseInt(i[r]+i[r],16);a&&(n=Math.round(parseInt(a+a,16)/255*100)/100)}else if(i=t.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){a=i[2],i=i[1];for(r=0;r<e.length;r++)e[r]=parseInt(i.slice(2*r,2*r+2),16);a&&(n=Math.round(parseInt(a,16)/255*100)/100)}else if(i=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<e.length;r++)e[r]=parseInt(i[r+1]);n=parseFloat(i[4])}else if(i=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<e.length;r++)e[r]=Math.round(2.55*parseFloat(i[r+1]));n=parseFloat(i[4])}else if(i=t.match(/(\w+)/)){if("transparent"==i[1])return[0,0,0,0];if(!(e=l[i[1]]))return}for(r=0;r<e.length;r++)e[r]=m(e[r],0,255);return n=n||0==n?m(n,0,1):1,e[3]=n,e}}function h(t){if(t){var e=t.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var n=parseFloat(e[4]);return[m(parseInt(e[1]),0,360),m(parseFloat(e[2]),0,100),m(parseFloat(e[3]),0,100),m(isNaN(n)?1:n,0,1)]}}}function c(t){if(t){var e=t.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var n=parseFloat(e[4]);return[m(parseInt(e[1]),0,360),m(parseFloat(e[2]),0,100),m(parseFloat(e[3]),0,100),m(isNaN(n)?1:n,0,1)]}}}function f(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function g(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function p(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function m(t,e,n){return Math.min(Math.max(e,t),n)}function v(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var b={};for(var x in l)b[l[x]]=x;var y=function(t){return t instanceof y?t:this instanceof y?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof t?(e=u.getRgba(t))?this.setValues("rgb",e):(e=u.getHsla(t))?this.setValues("hsl",e):(e=u.getHwb(t))&&this.setValues("hwb",e):"object"==typeof t&&(void 0!==(e=t).r||void 0!==e.red?this.setValues("rgb",e):void 0!==e.l||void 0!==e.lightness?this.setValues("hsl",e):void 0!==e.v||void 0!==e.value?this.setValues("hsv",e):void 0!==e.w||void 0!==e.whiteness?this.setValues("hwb",e):void 0===e.c&&void 0===e.cyan||this.setValues("cmyk",e)))):new y(t);var e};y.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t=(t%=360)<0?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return u.hexString(this.values.rgb)},rgbString:function(){return u.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return u.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return u.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return u.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return u.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return u.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return u.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],n=0;n<t.length;n++){var i=t[n]/255;e[n]=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),n=t.luminosity();return e>n?(e+.05)/(n+.05):(n+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;e<3;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,n=(e[0]+t)%360;return e[0]=n<0?360+n:n,this.setValues("hsl",e),this},mix:function(t,e){var n=t,i=void 0===e?.5:e,a=2*i-1,r=this.alpha()-n.alpha(),o=((a*r==-1?a:(a+r)/(1+a*r))+1)/2,s=1-o;return this.rgb(o*this.red()+s*n.red(),o*this.green()+s*n.green(),o*this.blue()+s*n.blue()).alpha(this.alpha()*i+n.alpha()*(1-i))},toJSON:function(){return this.rgb()},clone:function(){var t,e,n=new y,i=this.values,a=n.values;for(var r in i)i.hasOwnProperty(r)&&(t=i[r],"[object Array]"===(e={}.toString.call(t))?a[r]=t.slice(0):"[object Number]"===e?a[r]=t:console.error("unexpected color value:",t));return n}},y.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},y.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},y.prototype.getValues=function(t){for(var e=this.values,n={},i=0;i<t.length;i++)n[t.charAt(i)]=e[t][i];return 1!==e.alpha&&(n.a=e.alpha),n},y.prototype.setValues=function(t,e){var n,i,a=this.values,r=this.spaces,o=this.maxes,l=1;if(this.valid=!0,"alpha"===t)l=e;else if(e.length)a[t]=e.slice(0,t.length),l=e[t.length];else if(void 0!==e[t.charAt(0)]){for(n=0;n<t.length;n++)a[t][n]=e[t.charAt(n)];l=e.a}else if(void 0!==e[r[t][0]]){var u=r[t];for(n=0;n<t.length;n++)a[t][n]=e[u[n]];l=e.alpha}if(a.alpha=Math.max(0,Math.min(1,void 0===l?a.alpha:l)),"alpha"===t)return!1;for(n=0;n<t.length;n++)i=Math.max(0,Math.min(o[t][n],a[t][n])),a[t][n]=Math.round(i);for(var d in r)d!==t&&(a[d]=s[t][d](a[t]));return!0},y.prototype.setSpace=function(t,e){var n=e[0];return void 0===n?this.getValues(t):("number"==typeof n&&(n=Array.prototype.slice.call(e)),this.setValues(t,n),this)},y.prototype.setChannel=function(t,e,n){var i=this.values[t];return void 0===n?i[e]:n===i[e]?this:(i[e]=n,this.setValues(t,i),this)},"undefined"!=typeof window&&(window.Color=y);var _=y;function k(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}var w,M={noop:function(){},uid:(w=0,function(){return w++}),isNullOrUndef:function(t){return null==t},isArray:function(t){if(Array.isArray&&Array.isArray(t))return!0;var e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)},isObject:function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},isFinite:function(t){return("number"==typeof t||t instanceof Number)&&isFinite(t)},valueOrDefault:function(t,e){return void 0===t?e:t},valueAtIndexOrDefault:function(t,e,n){return M.valueOrDefault(M.isArray(t)?t[e]:t,n)},callback:function(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)},each:function(t,e,n,i){var a,r,o;if(M.isArray(t))if(r=t.length,i)for(a=r-1;a>=0;a--)e.call(n,t[a],a);else for(a=0;a<r;a++)e.call(n,t[a],a);else if(M.isObject(t))for(r=(o=Object.keys(t)).length,a=0;a<r;a++)e.call(n,t[o[a]],o[a])},arrayEquals:function(t,e){var n,i,a,r;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(a=t[n],r=e[n],a instanceof Array&&r instanceof Array){if(!M.arrayEquals(a,r))return!1}else if(a!==r)return!1;return!0},clone:function(t){if(M.isArray(t))return t.map(M.clone);if(M.isObject(t)){for(var e=Object.create(t),n=Object.keys(t),i=n.length,a=0;a<i;++a)e[n[a]]=M.clone(t[n[a]]);return e}return t},_merger:function(t,e,n,i){if(k(t)){var a=e[t],r=n[t];M.isObject(a)&&M.isObject(r)?M.merge(a,r,i):e[t]=M.clone(r)}},_mergerIf:function(t,e,n){if(k(t)){var i=e[t],a=n[t];M.isObject(i)&&M.isObject(a)?M.mergeIf(i,a):e.hasOwnProperty(t)||(e[t]=M.clone(a))}},merge:function(t,e,n){var i,a,r,o,s,l=M.isArray(e)?e:[e],u=l.length;if(!M.isObject(t))return t;for(i=(n=n||{}).merger||M._merger,a=0;a<u;++a)if(e=l[a],M.isObject(e))for(s=0,o=(r=Object.keys(e)).length;s<o;++s)i(r[s],t,e,n);return t},mergeIf:function(t,e){return M.merge(t,e,{merger:M._mergerIf})},extend:Object.assign||function(t){return M.merge(t,[].slice.call(arguments,1),{merger:function(t,e,n){e[t]=n[t]}})},inherits:function(t){var e=this,n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i=function(){this.constructor=n};return i.prototype=e.prototype,n.prototype=new i,n.extend=M.inherits,t&&M.extend(n.prototype,t),n.__super__=e.prototype,n},_deprecated:function(t,e,n,i){void 0!==e&&console.warn(t+': "'+n+'" is deprecated. Please use "'+i+'" instead')}},S=M;M.callCallback=M.callback,M.indexOf=function(t,e,n){return Array.prototype.indexOf.call(t,e,n)},M.getValueOrDefault=M.valueOrDefault,M.getValueAtIndexOrDefault=M.valueAtIndexOrDefault;var C={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1===t?1:(n||(n=.3),i<1?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n))},easeOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1===t?1:(n||(n=.3),i<1?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1)},easeInOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:2==(t/=.5)?1:(n||(n=.45),i<1?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-C.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*C.easeInBounce(2*t):.5*C.easeOutBounce(2*t-1)+.5}},P={effects:C};S.easingEffects=C;var A=Math.PI,D=A/180,T=2*A,I=A/2,F=A/4,O=2*A/3,L={clear:function(t){t.ctx.clearRect(0,0,t.width,t.height)},roundedRect:function(t,e,n,i,a,r){if(r){var o=Math.min(r,a/2,i/2),s=e+o,l=n+o,u=e+i-o,d=n+a-o;t.moveTo(e,l),s<u&&l<d?(t.arc(s,l,o,-A,-I),t.arc(u,l,o,-I,0),t.arc(u,d,o,0,I),t.arc(s,d,o,I,A)):s<u?(t.moveTo(s,n),t.arc(u,l,o,-I,I),t.arc(s,l,o,I,A+I)):l<d?(t.arc(s,l,o,-A,0),t.arc(s,d,o,0,A)):t.arc(s,l,o,-A,A),t.closePath(),t.moveTo(e,n)}else t.rect(e,n,i,a)},drawPoint:function(t,e,n,i,a,r){var o,s,l,u,d,h=(r||0)*D;if(e&&"object"==typeof e&&("[object HTMLImageElement]"===(o=e.toString())||"[object HTMLCanvasElement]"===o))return t.save(),t.translate(i,a),t.rotate(h),t.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),void t.restore();if(!(isNaN(n)||n<=0)){switch(t.beginPath(),e){default:t.arc(i,a,n,0,T),t.closePath();break;case"triangle":t.moveTo(i+Math.sin(h)*n,a-Math.cos(h)*n),h+=O,t.lineTo(i+Math.sin(h)*n,a-Math.cos(h)*n),h+=O,t.lineTo(i+Math.sin(h)*n,a-Math.cos(h)*n),t.closePath();break;case"rectRounded":u=n-(d=.516*n),s=Math.cos(h+F)*u,l=Math.sin(h+F)*u,t.arc(i-s,a-l,d,h-A,h-I),t.arc(i+l,a-s,d,h-I,h),t.arc(i+s,a+l,d,h,h+I),t.arc(i-l,a+s,d,h+I,h+A),t.closePath();break;case"rect":if(!r){u=Math.SQRT1_2*n,t.rect(i-u,a-u,2*u,2*u);break}h+=F;case"rectRot":s=Math.cos(h)*n,l=Math.sin(h)*n,t.moveTo(i-s,a-l),t.lineTo(i+l,a-s),t.lineTo(i+s,a+l),t.lineTo(i-l,a+s),t.closePath();break;case"crossRot":h+=F;case"cross":s=Math.cos(h)*n,l=Math.sin(h)*n,t.moveTo(i-s,a-l),t.lineTo(i+s,a+l),t.moveTo(i+l,a-s),t.lineTo(i-l,a+s);break;case"star":s=Math.cos(h)*n,l=Math.sin(h)*n,t.moveTo(i-s,a-l),t.lineTo(i+s,a+l),t.moveTo(i+l,a-s),t.lineTo(i-l,a+s),h+=F,s=Math.cos(h)*n,l=Math.sin(h)*n,t.moveTo(i-s,a-l),t.lineTo(i+s,a+l),t.moveTo(i+l,a-s),t.lineTo(i-l,a+s);break;case"line":s=Math.cos(h)*n,l=Math.sin(h)*n,t.moveTo(i-s,a-l),t.lineTo(i+s,a+l);break;case"dash":t.moveTo(i,a),t.lineTo(i+Math.cos(h)*n,a+Math.sin(h)*n)}t.fill(),t.stroke()}},_isPointInArea:function(t,e){return t.x>e.left-1e-6&&t.x<e.right+1e-6&&t.y>e.top-1e-6&&t.y<e.bottom+1e-6},clipArea:function(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()},unclipArea:function(t){t.restore()},lineTo:function(t,e,n,i){var a=n.steppedLine;if(a){if("middle"===a){var r=(e.x+n.x)/2;t.lineTo(r,i?n.y:e.y),t.lineTo(r,i?e.y:n.y)}else"after"===a&&!i||"after"!==a&&i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}else n.tension?t.bezierCurveTo(i?e.controlPointPreviousX:e.controlPointNextX,i?e.controlPointPreviousY:e.controlPointNextY,i?n.controlPointNextX:n.controlPointPreviousX,i?n.controlPointNextY:n.controlPointPreviousY,n.x,n.y):t.lineTo(n.x,n.y)}},R=L;S.clear=L.clear,S.drawRoundedRectangle=function(t){t.beginPath(),L.roundedRect.apply(L,arguments)};var z={_set:function(t,e){return S.merge(this[t]||(this[t]={}),e)}};z._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var N=z,B=S.valueOrDefault;var E={toLineHeight:function(t,e){var n=(""+t).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t},toPadding:function(t){var e,n,i,a;return S.isObject(t)?(e=+t.top||0,n=+t.right||0,i=+t.bottom||0,a=+t.left||0):e=n=i=a=+t||0,{top:e,right:n,bottom:i,left:a,height:e+i,width:a+n}},_parseFont:function(t){var e=N.global,n=B(t.fontSize,e.defaultFontSize),i={family:B(t.fontFamily,e.defaultFontFamily),lineHeight:S.options.toLineHeight(B(t.lineHeight,e.defaultLineHeight),n),size:n,style:B(t.fontStyle,e.defaultFontStyle),weight:null,string:""};return i.string=function(t){return!t||S.isNullOrUndef(t.size)||S.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(i),i},resolve:function(t,e,n,i){var a,r,o,s=!0;for(a=0,r=t.length;a<r;++a)if(void 0!==(o=t[a])&&(void 0!==e&&"function"==typeof o&&(o=o(e),s=!1),void 0!==n&&S.isArray(o)&&(o=o[n],s=!1),void 0!==o))return i&&!s&&(i.cacheable=!1),o}},W={_factorize:function(t){var e,n=[],i=Math.sqrt(t);for(e=1;e<i;e++)t%e==0&&(n.push(e),n.push(t/e));return i===(0|i)&&n.push(i),n.sort((function(t,e){return t-e})).pop(),n},log10:Math.log10||function(t){var e=Math.log(t)*Math.LOG10E,n=Math.round(e);return t===Math.pow(10,n)?n:e}},V=W;S.log10=W.log10;var H=S,j=P,q=R,U=E,Y=V,G={getRtlAdapter:function(t,e,n){return t?function(t,e){return{x:function(n){return t+t+e-n},setWidth:function(t){e=t},textAlign:function(t){return"center"===t?t:"right"===t?"left":"right"},xPlus:function(t,e){return t-e},leftForLtr:function(t,e){return t-e}}}(e,n):{x:function(t){return t},setWidth:function(t){},textAlign:function(t){return t},xPlus:function(t,e){return t+e},leftForLtr:function(t,e){return t}}},overrideTextDirection:function(t,e){var n,i;"ltr"!==e&&"rtl"!==e||(i=[(n=t.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)},restoreTextDirection:function(t){var e=t.prevTextDirection;void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}};H.easing=j,H.canvas=q,H.options=U,H.math=Y,H.rtl=G;var X=function(t){H.extend(this,t),this.initialize.apply(this,arguments)};H.extend(X.prototype,{_type:void 0,initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=H.extend({},t._model)),t._start={},t},transition:function(t){var e=this,n=e._model,i=e._start,a=e._view;return n&&1!==t?(a||(a=e._view={}),i||(i=e._start={}),function(t,e,n,i){var a,r,o,s,l,u,d,h,c,f=Object.keys(n);for(a=0,r=f.length;a<r;++a)if(u=n[o=f[a]],e.hasOwnProperty(o)||(e[o]=u),(s=e[o])!==u&&"_"!==o[0]){if(t.hasOwnProperty(o)||(t[o]=s),(d=typeof u)===typeof(l=t[o]))if("string"===d){if((h=_(l)).valid&&(c=_(u)).valid){e[o]=c.mix(h,i).rgbString();continue}}else if(H.isFinite(l)&&H.isFinite(u)){e[o]=l+(u-l)*i;continue}e[o]=u}}(i,a,n,t),e):(e._view=H.extend({},n),e._start=null,e)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return H.isNumber(this._model.x)&&H.isNumber(this._model.y)}}),X.extend=H.inherits;var K=X,Z=K.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),$=Z;Object.defineProperty(Z.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(Z.prototype,"chartInstance",{get:function(){return this.chart},set:function(t){this.chart=t}}),N._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:H.noop,onComplete:H.noop}});var J={animations:[],request:null,addAnimation:function(t,e,n,i){var a,r,o=this.animations;for(e.chart=t,e.startTime=Date.now(),e.duration=n,i||(t.animating=!0),a=0,r=o.length;a<r;++a)if(o[a].chart===t)return void(o[a]=e);o.push(e),1===o.length&&this.requestAnimationFrame()},cancelAnimation:function(t){var e=H.findIndex(this.animations,(function(e){return e.chart===t}));-1!==e&&(this.animations.splice(e,1),t.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=H.requestAnimFrame.call(window,(function(){t.request=null,t.startDigest()})))},startDigest:function(){this.advance(),this.animations.length>0&&this.requestAnimationFrame()},advance:function(){for(var t,e,n,i,a=this.animations,r=0;r<a.length;)e=(t=a[r]).chart,n=t.numSteps,i=Math.floor((Date.now()-t.startTime)/t.duration*n)+1,t.currentStep=Math.min(i,n),H.callback(t.render,[e,t],e),H.callback(t.onAnimationProgress,[t],e),t.currentStep>=n?(H.callback(t.onAnimationComplete,[t],e),e.animating=!1,a.splice(r,1)):++r}},Q=H.options.resolve,tt=["push","pop","shift","splice","unshift"];function et(t,e){var n=t._chartjs;if(n){var i=n.listeners,a=i.indexOf(e);-1!==a&&i.splice(a,1),i.length>0||(tt.forEach((function(e){delete t[e]})),delete t._chartjs)}}var nt=function(t,e){this.initialize(t,e)};H.extend(nt.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(t,e){var n=this;n.chart=t,n.index=e,n.linkScales(),n.addElements(),n._type=n.getMeta().type},updateIndex:function(t){this.index=t},linkScales:function(){var t=this.getMeta(),e=this.chart,n=e.scales,i=this.getDataset(),a=e.options.scales;null!==t.xAxisID&&t.xAxisID in n&&!i.xAxisID||(t.xAxisID=i.xAxisID||a.xAxes[0].id),null!==t.yAxisID&&t.yAxisID in n&&!i.yAxisID||(t.yAxisID=i.yAxisID||a.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(!0)},destroy:function(){this._data&&et(this._data,this)},createMetaDataset:function(){var t=this.datasetElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(t){var e=this.dataElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index,_index:t})},addElements:function(){var t,e,n=this.getMeta(),i=this.getDataset().data||[],a=n.data;for(t=0,e=i.length;t<e;++t)a[t]=a[t]||this.createMetaData(t);n.dataset=n.dataset||this.createMetaDataset()},addElementAndReset:function(t){var e=this.createMetaData(t);this.getMeta().data.splice(t,0,e),this.updateElement(e,t,!0)},buildOrUpdateElements:function(){var t,e,n=this,i=n.getDataset(),a=i.data||(i.data=[]);n._data!==a&&(n._data&&et(n._data,n),a&&Object.isExtensible(a)&&(e=n,(t=a)._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),tt.forEach((function(e){var n="onData"+e.charAt(0).toUpperCase()+e.slice(1),i=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),a=i.apply(this,e);return H.each(t._chartjs.listeners,(function(t){"function"==typeof t[n]&&t[n].apply(t,e)})),a}})})))),n._data=a),n.resyncElements()},_configure:function(){this._config=H.merge(Object.create(null),[this.chart.options.datasets[this._type],this.getDataset()],{merger:function(t,e,n){"_meta"!==t&&"data"!==t&&H._merger(t,e,n)}})},_update:function(t){this._configure(),this._cachedDataOpts=null,this.update(t)},update:H.noop,transition:function(t){for(var e=this.getMeta(),n=e.data||[],i=n.length,a=0;a<i;++a)n[a].transition(t);e.dataset&&e.dataset.transition(t)},draw:function(){var t=this.getMeta(),e=t.data||[],n=e.length,i=0;for(t.dataset&&t.dataset.draw();i<n;++i)e[i].draw()},getStyle:function(t){var e,n=this.getMeta(),i=n.dataset;return this._configure(),i&&void 0===t?e=this._resolveDatasetElementOptions(i||{}):(t=t||0,e=this._resolveDataElementOptions(n.data[t]||{},t)),!1!==e.fill&&null!==e.fill||(e.backgroundColor=e.borderColor),e},_resolveDatasetElementOptions:function(t,e){var n,i,a,r,o=this,s=o.chart,l=o._config,u=t.custom||{},d=s.options.elements[o.datasetElementType.prototype._type]||{},h=o._datasetElementOptions,c={},f={chart:s,dataset:o.getDataset(),datasetIndex:o.index,hover:e};for(n=0,i=h.length;n<i;++n)a=h[n],r=e?"hover"+a.charAt(0).toUpperCase()+a.slice(1):a,c[a]=Q([u[r],l[r],d[r]],f);return c},_resolveDataElementOptions:function(t,e){var n=this,i=t&&t.custom,a=n._cachedDataOpts;if(a&&!i)return a;var r,o,s,l,u=n.chart,d=n._config,h=u.options.elements[n.dataElementType.prototype._type]||{},c=n._dataElementOptions,f={},g={chart:u,dataIndex:e,dataset:n.getDataset(),datasetIndex:n.index},p={cacheable:!i};if(i=i||{},H.isArray(c))for(o=0,s=c.length;o<s;++o)f[l=c[o]]=Q([i[l],d[l],h[l]],g,e,p);else for(o=0,s=(r=Object.keys(c)).length;o<s;++o)f[l=r[o]]=Q([i[l],d[c[l]],d[l],h[l]],g,e,p);return p.cacheable&&(n._cachedDataOpts=Object.freeze(f)),f},removeHoverStyle:function(t){H.merge(t._model,t.$previousStyle||{}),delete t.$previousStyle},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],n=t._index,i=t.custom||{},a=t._model,r=H.getHoverColor;t.$previousStyle={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth},a.backgroundColor=Q([i.hoverBackgroundColor,e.hoverBackgroundColor,r(a.backgroundColor)],void 0,n),a.borderColor=Q([i.hoverBorderColor,e.hoverBorderColor,r(a.borderColor)],void 0,n),a.borderWidth=Q([i.hoverBorderWidth,e.hoverBorderWidth,a.borderWidth],void 0,n)},_removeDatasetHoverStyle:function(){var t=this.getMeta().dataset;t&&this.removeHoverStyle(t)},_setDatasetHoverStyle:function(){var t,e,n,i,a,r,o=this.getMeta().dataset,s={};if(o){for(r=o._model,a=this._resolveDatasetElementOptions(o,!0),t=0,e=(i=Object.keys(a)).length;t<e;++t)s[n=i[t]]=r[n],r[n]=a[n];o.$previousStyle=s}},resyncElements:function(){var t=this.getMeta(),e=this.getDataset().data,n=t.data.length,i=e.length;i<n?t.data.splice(i,n-i):i>n&&this.insertElements(n,i-n)},insertElements:function(t,e){for(var n=0;n<e;++n)this.addElementAndReset(t+n)},onDataPush:function(){var t=arguments.length;this.insertElements(this.getDataset().data.length-t,t)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(t,e){this.getMeta().data.splice(t,e),this.insertElements(t,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),nt.extend=H.inherits;var it=nt,at=2*Math.PI;function rt(t,e){var n=e.startAngle,i=e.endAngle,a=e.pixelMargin,r=a/e.outerRadius,o=e.x,s=e.y;t.beginPath(),t.arc(o,s,e.outerRadius,n-r,i+r),e.innerRadius>a?(r=a/e.innerRadius,t.arc(o,s,e.innerRadius-a,i+r,n-r,!0)):t.arc(o,s,a,i+Math.PI/2,n-Math.PI/2),t.closePath(),t.clip()}function ot(t,e,n){var i="inner"===e.borderAlign;i?(t.lineWidth=2*e.borderWidth,t.lineJoin="round"):(t.lineWidth=e.borderWidth,t.lineJoin="bevel"),n.fullCircles&&function(t,e,n,i){var a,r=n.endAngle;for(i&&(n.endAngle=n.startAngle+at,rt(t,n),n.endAngle=r,n.endAngle===n.startAngle&&n.fullCircles&&(n.endAngle+=at,n.fullCircles--)),t.beginPath(),t.arc(n.x,n.y,n.innerRadius,n.startAngle+at,n.startAngle,!0),a=0;a<n.fullCircles;++a)t.stroke();for(t.beginPath(),t.arc(n.x,n.y,e.outerRadius,n.startAngle,n.startAngle+at),a=0;a<n.fullCircles;++a)t.stroke()}(t,e,n,i),i&&rt(t,n),t.beginPath(),t.arc(n.x,n.y,e.outerRadius,n.startAngle,n.endAngle),t.arc(n.x,n.y,n.innerRadius,n.endAngle,n.startAngle,!0),t.closePath(),t.stroke()}N._set("global",{elements:{arc:{backgroundColor:N.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var st=K.extend({_type:"arc",inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,e){var n=this._view;if(n){for(var i=H.getAngleFromPoint(n,{x:t,y:e}),a=i.angle,r=i.distance,o=n.startAngle,s=n.endAngle;s<o;)s+=at;for(;a>s;)a-=at;for(;a<o;)a+=at;var l=a>=o&&a<=s,u=r>=n.innerRadius&&r<=n.outerRadius;return l&&u}return!1},getCenterPoint:function(){var t=this._view,e=(t.startAngle+t.endAngle)/2,n=(t.innerRadius+t.outerRadius)/2;return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}},getArea:function(){var t=this._view;return Math.PI*((t.endAngle-t.startAngle)/(2*Math.PI))*(Math.pow(t.outerRadius,2)-Math.pow(t.innerRadius,2))},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,n=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}},draw:function(){var t,e=this._chart.ctx,n=this._view,i="inner"===n.borderAlign?.33:0,a={x:n.x,y:n.y,innerRadius:n.innerRadius,outerRadius:Math.max(n.outerRadius-i,0),pixelMargin:i,startAngle:n.startAngle,endAngle:n.endAngle,fullCircles:Math.floor(n.circumference/at)};if(e.save(),e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,a.fullCircles){for(a.endAngle=a.startAngle+at,e.beginPath(),e.arc(a.x,a.y,a.outerRadius,a.startAngle,a.endAngle),e.arc(a.x,a.y,a.innerRadius,a.endAngle,a.startAngle,!0),e.closePath(),t=0;t<a.fullCircles;++t)e.fill();a.endAngle=a.startAngle+n.circumference%at}e.beginPath(),e.arc(a.x,a.y,a.outerRadius,a.startAngle,a.endAngle),e.arc(a.x,a.y,a.innerRadius,a.endAngle,a.startAngle,!0),e.closePath(),e.fill(),n.borderWidth&&ot(e,n,a),e.restore()}}),lt=H.valueOrDefault,ut=N.global.defaultColor;N._set("global",{elements:{line:{tension:.4,backgroundColor:ut,borderWidth:3,borderColor:ut,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var dt=K.extend({_type:"line",draw:function(){var t,e,n,i=this,a=i._view,r=i._chart.ctx,o=a.spanGaps,s=i._children.slice(),l=N.global,u=l.elements.line,d=-1,h=i._loop;if(s.length){if(i._loop){for(t=0;t<s.length;++t)if(e=H.previousItem(s,t),!s[t]._view.skip&&e._view.skip){s=s.slice(t).concat(s.slice(0,t)),h=o;break}h&&s.push(s[0])}for(r.save(),r.lineCap=a.borderCapStyle||u.borderCapStyle,r.setLineDash&&r.setLineDash(a.borderDash||u.borderDash),r.lineDashOffset=lt(a.borderDashOffset,u.borderDashOffset),r.lineJoin=a.borderJoinStyle||u.borderJoinStyle,r.lineWidth=lt(a.borderWidth,u.borderWidth),r.strokeStyle=a.borderColor||l.defaultColor,r.beginPath(),(n=s[0]._view).skip||(r.moveTo(n.x,n.y),d=0),t=1;t<s.length;++t)n=s[t]._view,e=-1===d?H.previousItem(s,t):s[d],n.skip||(d!==t-1&&!o||-1===d?r.moveTo(n.x,n.y):H.canvas.lineTo(r,e._view,n),d=t);h&&r.closePath(),r.stroke(),r.restore()}}}),ht=H.valueOrDefault,ct=N.global.defaultColor;function ft(t){var e=this._view;return!!e&&Math.abs(t-e.x)<e.radius+e.hitRadius}N._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:ct,borderColor:ct,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var gt=K.extend({_type:"point",inRange:function(t,e){var n=this._view;return!!n&&Math.pow(t-n.x,2)+Math.pow(e-n.y,2)<Math.pow(n.hitRadius+n.radius,2)},inLabelRange:ft,inXRange:ft,inYRange:function(t){var e=this._view;return!!e&&Math.abs(t-e.y)<e.radius+e.hitRadius},getCenterPoint:function(){var t=this._view;return{x:t.x,y:t.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(t){var e=this._view,n=this._chart.ctx,i=e.pointStyle,a=e.rotation,r=e.radius,o=e.x,s=e.y,l=N.global,u=l.defaultColor;e.skip||(void 0===t||H.canvas._isPointInArea(e,t))&&(n.strokeStyle=e.borderColor||u,n.lineWidth=ht(e.borderWidth,l.elements.point.borderWidth),n.fillStyle=e.backgroundColor||u,H.canvas.drawPoint(n,i,r,o,s,a))}}),pt=N.global.defaultColor;function mt(t){return t&&void 0!==t.width}function vt(t){var e,n,i,a,r;return mt(t)?(r=t.width/2,e=t.x-r,n=t.x+r,i=Math.min(t.y,t.base),a=Math.max(t.y,t.base)):(r=t.height/2,e=Math.min(t.x,t.base),n=Math.max(t.x,t.base),i=t.y-r,a=t.y+r),{left:e,top:i,right:n,bottom:a}}function bt(t,e,n){return t===e?n:t===n?e:t}function xt(t,e,n){var i,a,r,o,s=t.borderWidth,l=function(t){var e=t.borderSkipped,n={};return e?(t.horizontal?t.base>t.x&&(e=bt(e,"left","right")):t.base<t.y&&(e=bt(e,"bottom","top")),n[e]=!0,n):n}(t);return H.isObject(s)?(i=+s.top||0,a=+s.right||0,r=+s.bottom||0,o=+s.left||0):i=a=r=o=+s||0,{t:l.top||i<0?0:i>n?n:i,r:l.right||a<0?0:a>e?e:a,b:l.bottom||r<0?0:r>n?n:r,l:l.left||o<0?0:o>e?e:o}}function yt(t,e,n){var i=null===e,a=null===n,r=!(!t||i&&a)&&vt(t);return r&&(i||e>=r.left&&e<=r.right)&&(a||n>=r.top&&n<=r.bottom)}N._set("global",{elements:{rectangle:{backgroundColor:pt,borderColor:pt,borderSkipped:"bottom",borderWidth:0}}});var _t=K.extend({_type:"rectangle",draw:function(){var t=this._chart.ctx,e=this._view,n=function(t){var e=vt(t),n=e.right-e.left,i=e.bottom-e.top,a=xt(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i},inner:{x:e.left+a.l,y:e.top+a.t,w:n-a.l-a.r,h:i-a.t-a.b}}}(e),i=n.outer,a=n.inner;t.fillStyle=e.backgroundColor,t.fillRect(i.x,i.y,i.w,i.h),i.w===a.w&&i.h===a.h||(t.save(),t.beginPath(),t.rect(i.x,i.y,i.w,i.h),t.clip(),t.fillStyle=e.borderColor,t.rect(a.x,a.y,a.w,a.h),t.fill("evenodd"),t.restore())},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){return yt(this._view,t,e)},inLabelRange:function(t,e){var n=this._view;return mt(n)?yt(n,t,null):yt(n,null,e)},inXRange:function(t){return yt(this._view,t,null)},inYRange:function(t){return yt(this._view,null,t)},getCenterPoint:function(){var t,e,n=this._view;return mt(n)?(t=n.x,e=(n.y+n.base)/2):(t=(n.x+n.base)/2,e=n.y),{x:t,y:e}},getArea:function(){var t=this._view;return mt(t)?t.width*Math.abs(t.y-t.base):t.height*Math.abs(t.x-t.base)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}}),kt={},wt=st,Mt=dt,St=gt,Ct=_t;kt.Arc=wt,kt.Line=Mt,kt.Point=St,kt.Rectangle=Ct;var Pt=H._deprecated,At=H.valueOrDefault;function Dt(t,e,n){var i,a,r=n.barThickness,o=e.stackCount,s=e.pixels[t],l=H.isNullOrUndef(r)?function(t,e){var n,i,a,r,o=t._length;for(a=1,r=e.length;a<r;++a)o=Math.min(o,Math.abs(e[a]-e[a-1]));for(a=0,r=t.getTicks().length;a<r;++a)i=t.getPixelForTick(a),o=a>0?Math.min(o,Math.abs(i-n)):o,n=i;return o}(e.scale,e.pixels):-1;return H.isNullOrUndef(r)?(i=l*n.categoryPercentage,a=n.barPercentage):(i=r*o,a=1),{chunk:i/o,ratio:a,start:s-i/2}}N._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),N._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});var Tt=it.extend({dataElementType:kt.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var t,e,n=this;it.prototype.initialize.apply(n,arguments),(t=n.getMeta()).stack=n.getDataset().stack,t.bar=!0,e=n._getIndexScale().options,Pt("bar chart",e.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage"),Pt("bar chart",e.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness"),Pt("bar chart",e.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage"),Pt("bar chart",n._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength"),Pt("bar chart",e.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(t){var e,n,i=this.getMeta().data;for(this._ruler=this.getRuler(),e=0,n=i.length;e<n;++e)this.updateElement(i[e],e,t)},updateElement:function(t,e,n){var i=this,a=i.getMeta(),r=i.getDataset(),o=i._resolveDataElementOptions(t,e);t._xScale=i.getScaleForId(a.xAxisID),t._yScale=i.getScaleForId(a.yAxisID),t._datasetIndex=i.index,t._index=e,t._model={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth,datasetLabel:r.label,label:i.chart.data.labels[e]},H.isArray(r.data[e])&&(t._model.borderSkipped=null),i._updateElementGeometry(t,e,n,o),t.pivot()},_updateElementGeometry:function(t,e,n,i){var a=this,r=t._model,o=a._getValueScale(),s=o.getBasePixel(),l=o.isHorizontal(),u=a._ruler||a.getRuler(),d=a.calculateBarValuePixels(a.index,e,i),h=a.calculateBarIndexPixels(a.index,e,u,i);r.horizontal=l,r.base=n?s:d.base,r.x=l?n?s:d.head:h.center,r.y=l?h.center:n?s:d.head,r.height=l?h.size:void 0,r.width=l?void 0:h.size},_getStacks:function(t){var e,n,i=this._getIndexScale(),a=i._getMatchingVisibleMetas(this._type),r=i.options.stacked,o=a.length,s=[];for(e=0;e<o&&(n=a[e],(!1===r||-1===s.indexOf(n.stack)||void 0===r&&void 0===n.stack)&&s.push(n.stack),n.index!==t);++e);return s},getStackCount:function(){return this._getStacks().length},getStackIndex:function(t,e){var n=this._getStacks(t),i=void 0!==e?n.indexOf(e):-1;return-1===i?n.length-1:i},getRuler:function(){var t,e,n=this._getIndexScale(),i=[];for(t=0,e=this.getMeta().data.length;t<e;++t)i.push(n.getPixelForValue(null,t,this.index));return{pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this.getStackCount(),scale:n}},calculateBarValuePixels:function(t,e,n){var i,a,r,o,s,l,u,d=this.chart,h=this._getValueScale(),c=h.isHorizontal(),f=d.data.datasets,g=h._getMatchingVisibleMetas(this._type),p=h._parseValue(f[t].data[e]),m=n.minBarLength,v=h.options.stacked,b=this.getMeta().stack,x=void 0===p.start?0:p.max>=0&&p.min>=0?p.min:p.max,y=void 0===p.start?p.end:p.max>=0&&p.min>=0?p.max-p.min:p.min-p.max,_=g.length;if(v||void 0===v&&void 0!==b)for(i=0;i<_&&(a=g[i]).index!==t;++i)a.stack===b&&(r=void 0===(u=h._parseValue(f[a.index].data[e])).start?u.end:u.min>=0&&u.max>=0?u.max:u.min,(p.min<0&&r<0||p.max>=0&&r>0)&&(x+=r));return o=h.getPixelForValue(x),l=(s=h.getPixelForValue(x+y))-o,void 0!==m&&Math.abs(l)<m&&(l=m,s=y>=0&&!c||y<0&&c?o-m:o+m),{size:l,base:o,head:s,center:s+l/2}},calculateBarIndexPixels:function(t,e,n,i){var a="flex"===i.barThickness?function(t,e,n){var i,a=e.pixels,r=a[t],o=t>0?a[t-1]:null,s=t<a.length-1?a[t+1]:null,l=n.categoryPercentage;return null===o&&(o=r-(null===s?e.end-e.start:s-r)),null===s&&(s=r+r-o),i=r-(r-Math.min(o,s))/2*l,{chunk:Math.abs(s-o)/2*l/e.stackCount,ratio:n.barPercentage,start:i}}(e,n,i):Dt(e,n,i),r=this.getStackIndex(t,this.getMeta().stack),o=a.start+a.chunk*r+a.chunk/2,s=Math.min(At(i.maxBarThickness,1/0),a.chunk*a.ratio);return{base:o-s/2,head:o+s/2,center:o,size:s}},draw:function(){var t=this.chart,e=this._getValueScale(),n=this.getMeta().data,i=this.getDataset(),a=n.length,r=0;for(H.canvas.clipArea(t.ctx,t.chartArea);r<a;++r){var o=e._parseValue(i.data[r]);isNaN(o.min)||isNaN(o.max)||n[r].draw()}H.canvas.unclipArea(t.ctx)},_resolveDataElementOptions:function(){var t=this,e=H.extend({},it.prototype._resolveDataElementOptions.apply(t,arguments)),n=t._getIndexScale().options,i=t._getValueScale().options;return e.barPercentage=At(n.barPercentage,e.barPercentage),e.barThickness=At(n.barThickness,e.barThickness),e.categoryPercentage=At(n.categoryPercentage,e.categoryPercentage),e.maxBarThickness=At(n.maxBarThickness,e.maxBarThickness),e.minBarLength=At(i.minBarLength,e.minBarLength),e}}),It=H.valueOrDefault,Ft=H.options.resolve;N._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var n=e.datasets[t.datasetIndex].label||"",i=e.datasets[t.datasetIndex].data[t.index];return n+": ("+t.xLabel+", "+t.yLabel+", "+i.r+")"}}}});var Ot=it.extend({dataElementType:kt.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(t){var e=this,n=e.getMeta().data;H.each(n,(function(n,i){e.updateElement(n,i,t)}))},updateElement:function(t,e,n){var i=this,a=i.getMeta(),r=t.custom||{},o=i.getScaleForId(a.xAxisID),s=i.getScaleForId(a.yAxisID),l=i._resolveDataElementOptions(t,e),u=i.getDataset().data[e],d=i.index,h=n?o.getPixelForDecimal(.5):o.getPixelForValue("object"==typeof u?u:NaN,e,d),c=n?s.getBasePixel():s.getPixelForValue(u,e,d);t._xScale=o,t._yScale=s,t._options=l,t._datasetIndex=d,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:n?0:l.radius,skip:r.skip||isNaN(h)||isNaN(c),x:h,y:c},t.pivot()},setHoverStyle:function(t){var e=t._model,n=t._options,i=H.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=It(n.hoverBackgroundColor,i(n.backgroundColor)),e.borderColor=It(n.hoverBorderColor,i(n.borderColor)),e.borderWidth=It(n.hoverBorderWidth,n.borderWidth),e.radius=n.radius+n.hoverRadius},_resolveDataElementOptions:function(t,e){var n=this,i=n.chart,a=n.getDataset(),r=t.custom||{},o=a.data[e]||{},s=it.prototype._resolveDataElementOptions.apply(n,arguments),l={chart:i,dataIndex:e,dataset:a,datasetIndex:n.index};return n._cachedDataOpts===s&&(s=H.extend({},s)),s.radius=Ft([r.radius,o.r,n._config.radius,i.options.elements.point.radius],l,e),s}}),Lt=H.valueOrDefault,Rt=Math.PI,zt=2*Rt,Nt=Rt/2;N._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(t){var e,n,i,a=document.createElement("ul"),r=t.data,o=r.datasets,s=r.labels;if(a.setAttribute("class",t.id+"-legend"),o.length)for(e=0,n=o[0].data.length;e<n;++e)(i=a.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=o[0].backgroundColor[e],s[e]&&i.appendChild(document.createTextNode(s[e]));return a.outerHTML},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map((function(n,i){var a=t.getDatasetMeta(0),r=a.controller.getStyle(i);return{text:n,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,hidden:isNaN(e.datasets[0].data[i])||a.data[i].hidden,index:i}})):[]}},onClick:function(t,e){var n,i,a,r=e.index,o=this.chart;for(n=0,i=(o.data.datasets||[]).length;n<i;++n)(a=o.getDatasetMeta(n)).data[r]&&(a.data[r].hidden=!a.data[r].hidden);o.update()}},cutoutPercentage:50,rotation:-Nt,circumference:zt,tooltips:{callbacks:{title:function(){return""},label:function(t,e){var n=e.labels[t.index],i=": "+e.datasets[t.datasetIndex].data[t.index];return H.isArray(n)?(n=n.slice())[0]+=i:n+=i,n}}}});var Bt=it.extend({dataElementType:kt.Arc,linkScales:H.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(t){for(var e=0,n=0;n<t;++n)this.chart.isDatasetVisible(n)&&++e;return e},update:function(t){var e,n,i,a,r=this,o=r.chart,s=o.chartArea,l=o.options,u=1,d=1,h=0,c=0,f=r.getMeta(),g=f.data,p=l.cutoutPercentage/100||0,m=l.circumference,v=r._getRingWeight(r.index);if(m<zt){var b=l.rotation%zt,x=(b+=b>=Rt?-zt:b<-Rt?zt:0)+m,y=Math.cos(b),_=Math.sin(b),k=Math.cos(x),w=Math.sin(x),M=b<=0&&x>=0||x>=zt,S=b<=Nt&&x>=Nt||x>=zt+Nt,C=b<=-Nt&&x>=-Nt||x>=Rt+Nt,P=b===-Rt||x>=Rt?-1:Math.min(y,y*p,k,k*p),A=C?-1:Math.min(_,_*p,w,w*p),D=M?1:Math.max(y,y*p,k,k*p),T=S?1:Math.max(_,_*p,w,w*p);u=(D-P)/2,d=(T-A)/2,h=-(D+P)/2,c=-(T+A)/2}for(i=0,a=g.length;i<a;++i)g[i]._options=r._resolveDataElementOptions(g[i],i);for(o.borderWidth=r.getMaxBorderWidth(),e=(s.right-s.left-o.borderWidth)/u,n=(s.bottom-s.top-o.borderWidth)/d,o.outerRadius=Math.max(Math.min(e,n)/2,0),o.innerRadius=Math.max(o.outerRadius*p,0),o.radiusLength=(o.outerRadius-o.innerRadius)/(r._getVisibleDatasetWeightTotal()||1),o.offsetX=h*o.outerRadius,o.offsetY=c*o.outerRadius,f.total=r.calculateTotal(),r.outerRadius=o.outerRadius-o.radiusLength*r._getRingWeightOffset(r.index),r.innerRadius=Math.max(r.outerRadius-o.radiusLength*v,0),i=0,a=g.length;i<a;++i)r.updateElement(g[i],i,t)},updateElement:function(t,e,n){var i=this,a=i.chart,r=a.chartArea,o=a.options,s=o.animation,l=(r.left+r.right)/2,u=(r.top+r.bottom)/2,d=o.rotation,h=o.rotation,c=i.getDataset(),f=n&&s.animateRotate?0:t.hidden?0:i.calculateCircumference(c.data[e])*(o.circumference/zt),g=n&&s.animateScale?0:i.innerRadius,p=n&&s.animateScale?0:i.outerRadius,m=t._options||{};H.extend(t,{_datasetIndex:i.index,_index:e,_model:{backgroundColor:m.backgroundColor,borderColor:m.borderColor,borderWidth:m.borderWidth,borderAlign:m.borderAlign,x:l+a.offsetX,y:u+a.offsetY,startAngle:d,endAngle:h,circumference:f,outerRadius:p,innerRadius:g,label:H.valueAtIndexOrDefault(c.label,e,a.data.labels[e])}});var v=t._model;n&&s.animateRotate||(v.startAngle=0===e?o.rotation:i.getMeta().data[e-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},calculateTotal:function(){var t,e=this.getDataset(),n=this.getMeta(),i=0;return H.each(n.data,(function(n,a){t=e.data[a],isNaN(t)||n.hidden||(i+=Math.abs(t))})),i},calculateCircumference:function(t){var e=this.getMeta().total;return e>0&&!isNaN(t)?zt*(Math.abs(t)/e):0},getMaxBorderWidth:function(t){var e,n,i,a,r,o,s,l,u=0,d=this.chart;if(!t)for(e=0,n=d.data.datasets.length;e<n;++e)if(d.isDatasetVisible(e)){t=(i=d.getDatasetMeta(e)).data,e!==this.index&&(r=i.controller);break}if(!t)return 0;for(e=0,n=t.length;e<n;++e)a=t[e],r?(r._configure(),o=r._resolveDataElementOptions(a,e)):o=a._options,"inner"!==o.borderAlign&&(s=o.borderWidth,u=(l=o.hoverBorderWidth)>(u=s>u?s:u)?l:u);return u},setHoverStyle:function(t){var e=t._model,n=t._options,i=H.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=Lt(n.hoverBackgroundColor,i(n.backgroundColor)),e.borderColor=Lt(n.hoverBorderColor,i(n.borderColor)),e.borderWidth=Lt(n.hoverBorderWidth,n.borderWidth)},_getRingWeightOffset:function(t){for(var e=0,n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e},_getRingWeight:function(t){return Math.max(Lt(this.chart.data.datasets[t].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});N._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}}),N._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var Et=Tt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Wt=H.valueOrDefault,Vt=H.options.resolve,Ht=H.canvas._isPointInArea;function jt(t,e){var n=t&&t.options.ticks||{},i=n.reverse,a=void 0===n.min?e:0,r=void 0===n.max?e:0;return{start:i?r:a,end:i?a:r}}function qt(t,e,n){var i=n/2,a=jt(t,i),r=jt(e,i);return{top:r.end,right:a.end,bottom:r.start,left:a.start}}function Ut(t){var e,n,i,a;return H.isObject(t)?(e=t.top,n=t.right,i=t.bottom,a=t.left):e=n=i=a=t,{top:e,right:n,bottom:i,left:a}}N._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var Yt=it.extend({datasetElementType:kt.Line,dataElementType:kt.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(t){var e,n,i=this,a=i.getMeta(),r=a.dataset,o=a.data||[],s=i.chart.options,l=i._config,u=i._showLine=Wt(l.showLine,s.showLines);for(i._xScale=i.getScaleForId(a.xAxisID),i._yScale=i.getScaleForId(a.yAxisID),u&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=i._yScale,r._datasetIndex=i.index,r._children=o,r._model=i._resolveDatasetElementOptions(r),r.pivot()),e=0,n=o.length;e<n;++e)i.updateElement(o[e],e,t);for(u&&0!==r._model.tension&&i.updateBezierControlPoints(),e=0,n=o.length;e<n;++e)o[e].pivot()},updateElement:function(t,e,n){var i,a,r=this,o=r.getMeta(),s=t.custom||{},l=r.getDataset(),u=r.index,d=l.data[e],h=r._xScale,c=r._yScale,f=o.dataset._model,g=r._resolveDataElementOptions(t,e);i=h.getPixelForValue("object"==typeof d?d:NaN,e,u),a=n?c.getBasePixel():r.calculatePointY(d,e,u),t._xScale=h,t._yScale=c,t._options=g,t._datasetIndex=u,t._index=e,t._model={x:i,y:a,skip:s.skip||isNaN(i)||isNaN(a),radius:g.radius,pointStyle:g.pointStyle,rotation:g.rotation,backgroundColor:g.backgroundColor,borderColor:g.borderColor,borderWidth:g.borderWidth,tension:Wt(s.tension,f?f.tension:0),steppedLine:!!f&&f.steppedLine,hitRadius:g.hitRadius}},_resolveDatasetElementOptions:function(t){var e=this,n=e._config,i=t.custom||{},a=e.chart.options,r=a.elements.line,o=it.prototype._resolveDatasetElementOptions.apply(e,arguments);return o.spanGaps=Wt(n.spanGaps,a.spanGaps),o.tension=Wt(n.lineTension,r.tension),o.steppedLine=Vt([i.steppedLine,n.steppedLine,r.stepped]),o.clip=Ut(Wt(n.clip,qt(e._xScale,e._yScale,o.borderWidth))),o},calculatePointY:function(t,e,n){var i,a,r,o,s,l,u,d=this.chart,h=this._yScale,c=0,f=0;if(h.options.stacked){for(s=+h.getRightValue(t),u=(l=d._getSortedVisibleDatasetMetas()).length,i=0;i<u&&(r=l[i]).index!==n;++i)a=d.data.datasets[r.index],"line"===r.type&&r.yAxisID===h.id&&((o=+h.getRightValue(a.data[e]))<0?f+=o||0:c+=o||0);return s<0?h.getPixelForValue(f+s):h.getPixelForValue(c+s)}return h.getPixelForValue(t)},updateBezierControlPoints:function(){var t,e,n,i,a=this.chart,r=this.getMeta(),o=r.dataset._model,s=a.chartArea,l=r.data||[];function u(t,e,n){return Math.max(Math.min(t,n),e)}if(o.spanGaps&&(l=l.filter((function(t){return!t._model.skip}))),"monotone"===o.cubicInterpolationMode)H.splineCurveMonotone(l);else for(t=0,e=l.length;t<e;++t)n=l[t]._model,i=H.splineCurve(H.previousItem(l,t)._model,n,H.nextItem(l,t)._model,o.tension),n.controlPointPreviousX=i.previous.x,n.controlPointPreviousY=i.previous.y,n.controlPointNextX=i.next.x,n.controlPointNextY=i.next.y;if(a.options.elements.line.capBezierPoints)for(t=0,e=l.length;t<e;++t)n=l[t]._model,Ht(n,s)&&(t>0&&Ht(l[t-1]._model,s)&&(n.controlPointPreviousX=u(n.controlPointPreviousX,s.left,s.right),n.controlPointPreviousY=u(n.controlPointPreviousY,s.top,s.bottom)),t<l.length-1&&Ht(l[t+1]._model,s)&&(n.controlPointNextX=u(n.controlPointNextX,s.left,s.right),n.controlPointNextY=u(n.controlPointNextY,s.top,s.bottom)))},draw:function(){var t,e=this.chart,n=this.getMeta(),i=n.data||[],a=e.chartArea,r=e.canvas,o=0,s=i.length;for(this._showLine&&(t=n.dataset._model.clip,H.canvas.clipArea(e.ctx,{left:!1===t.left?0:a.left-t.left,right:!1===t.right?r.width:a.right+t.right,top:!1===t.top?0:a.top-t.top,bottom:!1===t.bottom?r.height:a.bottom+t.bottom}),n.dataset.draw(),H.canvas.unclipArea(e.ctx));o<s;++o)i[o].draw(a)},setHoverStyle:function(t){var e=t._model,n=t._options,i=H.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Wt(n.hoverBackgroundColor,i(n.backgroundColor)),e.borderColor=Wt(n.hoverBorderColor,i(n.borderColor)),e.borderWidth=Wt(n.hoverBorderWidth,n.borderWidth),e.radius=Wt(n.hoverRadius,n.radius)}}),Gt=H.options.resolve;N._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(t){var e,n,i,a=document.createElement("ul"),r=t.data,o=r.datasets,s=r.labels;if(a.setAttribute("class",t.id+"-legend"),o.length)for(e=0,n=o[0].data.length;e<n;++e)(i=a.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=o[0].backgroundColor[e],s[e]&&i.appendChild(document.createTextNode(s[e]));return a.outerHTML},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map((function(n,i){var a=t.getDatasetMeta(0),r=a.controller.getStyle(i);return{text:n,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,hidden:isNaN(e.datasets[0].data[i])||a.data[i].hidden,index:i}})):[]}},onClick:function(t,e){var n,i,a,r=e.index,o=this.chart;for(n=0,i=(o.data.datasets||[]).length;n<i;++n)(a=o.getDatasetMeta(n)).data[r].hidden=!a.data[r].hidden;o.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}});var Xt=it.extend({dataElementType:kt.Arc,linkScales:H.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(t){var e,n,i,a=this,r=a.getDataset(),o=a.getMeta(),s=a.chart.options.startAngle||0,l=a._starts=[],u=a._angles=[],d=o.data;for(a._updateRadius(),o.count=a.countVisibleElements(),e=0,n=r.data.length;e<n;e++)l[e]=s,i=a._computeAngle(e),u[e]=i,s+=i;for(e=0,n=d.length;e<n;++e)d[e]._options=a._resolveDataElementOptions(d[e],e),a.updateElement(d[e],e,t)},_updateRadius:function(){var t=this,e=t.chart,n=e.chartArea,i=e.options,a=Math.min(n.right-n.left,n.bottom-n.top);e.outerRadius=Math.max(a/2,0),e.innerRadius=Math.max(i.cutoutPercentage?e.outerRadius/100*i.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),t.outerRadius=e.outerRadius-e.radiusLength*t.index,t.innerRadius=t.outerRadius-e.radiusLength},updateElement:function(t,e,n){var i=this,a=i.chart,r=i.getDataset(),o=a.options,s=o.animation,l=a.scale,u=a.data.labels,d=l.xCenter,h=l.yCenter,c=o.startAngle,f=t.hidden?0:l.getDistanceFromCenterForValue(r.data[e]),g=i._starts[e],p=g+(t.hidden?0:i._angles[e]),m=s.animateScale?0:l.getDistanceFromCenterForValue(r.data[e]),v=t._options||{};H.extend(t,{_datasetIndex:i.index,_index:e,_scale:l,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,x:d,y:h,innerRadius:0,outerRadius:n?m:f,startAngle:n&&s.animateRotate?c:g,endAngle:n&&s.animateRotate?c:p,label:H.valueAtIndexOrDefault(u,e,u[e])}}),t.pivot()},countVisibleElements:function(){var t=this.getDataset(),e=this.getMeta(),n=0;return H.each(e.data,(function(e,i){isNaN(t.data[i])||e.hidden||n++})),n},setHoverStyle:function(t){var e=t._model,n=t._options,i=H.getHoverColor,a=H.valueOrDefault;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=a(n.hoverBackgroundColor,i(n.backgroundColor)),e.borderColor=a(n.hoverBorderColor,i(n.borderColor)),e.borderWidth=a(n.hoverBorderWidth,n.borderWidth)},_computeAngle:function(t){var e=this,n=this.getMeta().count,i=e.getDataset(),a=e.getMeta();if(isNaN(i.data[t])||a.data[t].hidden)return 0;var r={chart:e.chart,dataIndex:t,dataset:i,datasetIndex:e.index};return Gt([e.chart.options.elements.arc.angle,2*Math.PI/n],r,t)}});N._set("pie",H.clone(N.doughnut)),N._set("pie",{cutoutPercentage:0});var Kt=Bt,Zt=H.valueOrDefault;N._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var $t=it.extend({datasetElementType:kt.Line,dataElementType:kt.Point,linkScales:H.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(t){var e,n,i=this,a=i.getMeta(),r=a.dataset,o=a.data||[],s=i.chart.scale,l=i._config;for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=s,r._datasetIndex=i.index,r._children=o,r._loop=!0,r._model=i._resolveDatasetElementOptions(r),r.pivot(),e=0,n=o.length;e<n;++e)i.updateElement(o[e],e,t);for(i.updateBezierControlPoints(),e=0,n=o.length;e<n;++e)o[e].pivot()},updateElement:function(t,e,n){var i=this,a=t.custom||{},r=i.getDataset(),o=i.chart.scale,s=o.getPointPositionForValue(e,r.data[e]),l=i._resolveDataElementOptions(t,e),u=i.getMeta().dataset._model,d=n?o.xCenter:s.x,h=n?o.yCenter:s.y;t._scale=o,t._options=l,t._datasetIndex=i.index,t._index=e,t._model={x:d,y:h,skip:a.skip||isNaN(d)||isNaN(h),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:Zt(a.tension,u?u.tension:0),hitRadius:l.hitRadius}},_resolveDatasetElementOptions:function(){var t=this,e=t._config,n=t.chart.options,i=it.prototype._resolveDatasetElementOptions.apply(t,arguments);return i.spanGaps=Zt(e.spanGaps,n.spanGaps),i.tension=Zt(e.lineTension,n.elements.line.tension),i},updateBezierControlPoints:function(){var t,e,n,i,a=this.getMeta(),r=this.chart.chartArea,o=a.data||[];function s(t,e,n){return Math.max(Math.min(t,n),e)}for(a.dataset._model.spanGaps&&(o=o.filter((function(t){return!t._model.skip}))),t=0,e=o.length;t<e;++t)n=o[t]._model,i=H.splineCurve(H.previousItem(o,t,!0)._model,n,H.nextItem(o,t,!0)._model,n.tension),n.controlPointPreviousX=s(i.previous.x,r.left,r.right),n.controlPointPreviousY=s(i.previous.y,r.top,r.bottom),n.controlPointNextX=s(i.next.x,r.left,r.right),n.controlPointNextY=s(i.next.y,r.top,r.bottom)},setHoverStyle:function(t){var e=t._model,n=t._options,i=H.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Zt(n.hoverBackgroundColor,i(n.backgroundColor)),e.borderColor=Zt(n.hoverBorderColor,i(n.borderColor)),e.borderWidth=Zt(n.hoverBorderWidth,n.borderWidth),e.radius=Zt(n.hoverRadius,n.radius)}});N._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}}),N._set("global",{datasets:{scatter:{showLine:!1}}});var Jt={bar:Tt,bubble:Ot,doughnut:Bt,horizontalBar:Et,line:Yt,polarArea:Xt,pie:Kt,radar:$t,scatter:Yt};function Qt(t,e){return t.native?{x:t.x,y:t.y}:H.getRelativePosition(t,e)}function te(t,e){var n,i,a,r,o,s,l=t._getSortedVisibleDatasetMetas();for(i=0,r=l.length;i<r;++i)for(a=0,o=(n=l[i].data).length;a<o;++a)(s=n[a])._view.skip||e(s)}function ee(t,e){var n=[];return te(t,(function(t){t.inRange(e.x,e.y)&&n.push(t)})),n}function ne(t,e,n,i){var a=Number.POSITIVE_INFINITY,r=[];return te(t,(function(t){if(!n||t.inRange(e.x,e.y)){var o=t.getCenterPoint(),s=i(e,o);s<a?(r=[t],a=s):s===a&&r.push(t)}})),r}function ie(t){var e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){var a=e?Math.abs(t.x-i.x):0,r=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(r,2))}}function ae(t,e,n){var i=Qt(e,t);n.axis=n.axis||"x";var a=ie(n.axis),r=n.intersect?ee(t,i):ne(t,i,!1,a),o=[];return r.length?(t._getSortedVisibleDatasetMetas().forEach((function(t){var e=t.data[r[0]._index];e&&!e._view.skip&&o.push(e)})),o):[]}var re={modes:{single:function(t,e){var n=Qt(e,t),i=[];return te(t,(function(t){if(t.inRange(n.x,n.y))return i.push(t),i})),i.slice(0,1)},label:ae,index:ae,dataset:function(t,e,n){var i=Qt(e,t);n.axis=n.axis||"xy";var a=ie(n.axis),r=n.intersect?ee(t,i):ne(t,i,!1,a);return r.length>0&&(r=t.getDatasetMeta(r[0]._datasetIndex).data),r},"x-axis":function(t,e){return ae(t,e,{intersect:!1})},point:function(t,e){return ee(t,Qt(e,t))},nearest:function(t,e,n){var i=Qt(e,t);n.axis=n.axis||"xy";var a=ie(n.axis);return ne(t,i,n.intersect,a)},x:function(t,e,n){var i=Qt(e,t),a=[],r=!1;return te(t,(function(t){t.inXRange(i.x)&&a.push(t),t.inRange(i.x,i.y)&&(r=!0)})),n.intersect&&!r&&(a=[]),a},y:function(t,e,n){var i=Qt(e,t),a=[],r=!1;return te(t,(function(t){t.inYRange(i.y)&&a.push(t),t.inRange(i.x,i.y)&&(r=!0)})),n.intersect&&!r&&(a=[]),a}}},oe=H.extend;function se(t,e){return H.where(t,(function(t){return t.pos===e}))}function le(t,e){return t.sort((function(t,n){var i=e?n:t,a=e?t:n;return i.weight===a.weight?i.index-a.index:i.weight-a.weight}))}function ue(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function de(t,e,n){var i,a,r=n.box,o=t.maxPadding;if(n.size&&(t[n.pos]-=n.size),n.size=n.horizontal?r.height:r.width,t[n.pos]+=n.size,r.getPadding){var s=r.getPadding();o.top=Math.max(o.top,s.top),o.left=Math.max(o.left,s.left),o.bottom=Math.max(o.bottom,s.bottom),o.right=Math.max(o.right,s.right)}if(i=e.outerWidth-ue(o,t,"left","right"),a=e.outerHeight-ue(o,t,"top","bottom"),i!==t.w||a!==t.h){t.w=i,t.h=a;var l=n.horizontal?[i,t.w]:[a,t.h];return!(l[0]===l[1]||isNaN(l[0])&&isNaN(l[1]))}}function he(t,e){var n=e.maxPadding;function i(t){var i={left:0,top:0,right:0,bottom:0};return t.forEach((function(t){i[t]=Math.max(e[t],n[t])})),i}return i(t?["left","right"]:["top","bottom"])}function ce(t,e,n){var i,a,r,o,s,l,u=[];for(i=0,a=t.length;i<a;++i)(o=(r=t[i]).box).update(r.width||e.w,r.height||e.h,he(r.horizontal,e)),de(e,n,r)&&(l=!0,u.length&&(s=!0)),o.fullWidth||u.push(r);return s&&ce(u,e,n)||l}function fe(t,e,n){var i,a,r,o,s=n.padding,l=e.x,u=e.y;for(i=0,a=t.length;i<a;++i)o=(r=t[i]).box,r.horizontal?(o.left=o.fullWidth?s.left:e.left,o.right=o.fullWidth?n.outerWidth-s.right:e.left+e.w,o.top=u,o.bottom=u+o.height,o.width=o.right-o.left,u=o.bottom):(o.left=l,o.right=l+o.width,o.top=e.top,o.bottom=e.top+e.h,o.height=o.bottom-o.top,l=o.right);e.x=l,e.y=u}N._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var ge,pe={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),e.fullWidth=e.fullWidth||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw:function(){e.draw.apply(e,arguments)}}]},t.boxes.push(e)},removeBox:function(t,e){var n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure:function(t,e,n){for(var i,a=["fullWidth","position","weight"],r=a.length,o=0;o<r;++o)i=a[o],n.hasOwnProperty(i)&&(e[i]=n[i])},update:function(t,e,n){if(t){var i=t.options.layout||{},a=H.options.toPadding(i.padding),r=e-a.width,o=n-a.height,s=function(t){var e=function(t){var e,n,i,a=[];for(e=0,n=(t||[]).length;e<n;++e)i=t[e],a.push({index:e,box:i,pos:i.position,horizontal:i.isHorizontal(),weight:i.weight});return a}(t),n=le(se(e,"left"),!0),i=le(se(e,"right")),a=le(se(e,"top"),!0),r=le(se(e,"bottom"));return{leftAndTop:n.concat(a),rightAndBottom:i.concat(r),chartArea:se(e,"chartArea"),vertical:n.concat(i),horizontal:a.concat(r)}}(t.boxes),l=s.vertical,u=s.horizontal,d=Object.freeze({outerWidth:e,outerHeight:n,padding:a,availableWidth:r,vBoxMaxWidth:r/2/l.length,hBoxMaxHeight:o/2}),h=oe({maxPadding:oe({},a),w:r,h:o,x:a.left,y:a.top},a);!function(t,e){var n,i,a;for(n=0,i=t.length;n<i;++n)(a=t[n]).width=a.horizontal?a.box.fullWidth&&e.availableWidth:e.vBoxMaxWidth,a.height=a.horizontal&&e.hBoxMaxHeight}(l.concat(u),d),ce(l,h,d),ce(u,h,d)&&ce(l,h,d),function(t){var e=t.maxPadding;function n(n){var i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(h),fe(s.leftAndTop,h,d),h.x+=h.w,h.y+=h.h,fe(s.rightAndBottom,h,d),t.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h},H.each(s.chartArea,(function(e){var n=e.box;oe(n,t.chartArea),n.update(h.w,h.h)}))}}},me=(ge=Object.freeze({__proto__:null,default:"@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}"}))&&ge.default||ge,ve="$chartjs",be="chartjs-size-monitor",xe="chartjs-render-monitor",ye="chartjs-render-animation",_e=["animationstart","webkitAnimationStart"],ke={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function we(t,e){var n=H.getStyle(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?Number(i[1]):void 0}var Me=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0};function Se(t,e,n){t.addEventListener(e,n,Me)}function Ce(t,e,n){t.removeEventListener(e,n,Me)}function Pe(t,e,n,i,a){return{type:t,chart:e,native:a||null,x:void 0!==n?n:null,y:void 0!==i?i:null}}function Ae(t){var e=document.createElement("div");return e.className=t||"",e}function De(t,e,n){var i,a,r,o,s=t[ve]||(t[ve]={}),l=s.resizer=function(t){var e=Ae(be),n=Ae(be+"-expand"),i=Ae(be+"-shrink");n.appendChild(Ae()),i.appendChild(Ae()),e.appendChild(n),e.appendChild(i),e._reset=function(){n.scrollLeft=1e6,n.scrollTop=1e6,i.scrollLeft=1e6,i.scrollTop=1e6};var a=function(){e._reset(),t()};return Se(n,"scroll",a.bind(n,"expand")),Se(i,"scroll",a.bind(i,"shrink")),e}((i=function(){if(s.resizer){var i=n.options.maintainAspectRatio&&t.parentNode,a=i?i.clientWidth:0;e(Pe("resize",n)),i&&i.clientWidth<a&&n.canvas&&e(Pe("resize",n))}},r=!1,o=[],function(){o=Array.prototype.slice.call(arguments),a=a||this,r||(r=!0,H.requestAnimFrame.call(window,(function(){r=!1,i.apply(a,o)})))}));!function(t,e){var n=t[ve]||(t[ve]={}),i=n.renderProxy=function(t){t.animationName===ye&&e()};H.each(_e,(function(e){Se(t,e,i)})),n.reflow=!!t.offsetParent,t.classList.add(xe)}(t,(function(){if(s.resizer){var e=t.parentNode;e&&e!==l.parentNode&&e.insertBefore(l,e.firstChild),l._reset()}}))}function Te(t){var e=t[ve]||{},n=e.resizer;delete e.resizer,function(t){var e=t[ve]||{},n=e.renderProxy;n&&(H.each(_e,(function(e){Ce(t,e,n)})),delete e.renderProxy),t.classList.remove(xe)}(t),n&&n.parentNode&&n.parentNode.removeChild(n)}var Ie={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(t){if(!this.disableCSSInjection){var e=t.getRootNode?t.getRootNode():document;!function(t,e){var n=t[ve]||(t[ve]={});if(!n.containsStyles){n.containsStyles=!0,e="/* Chart.js */\n"+e;var i=document.createElement("style");i.setAttribute("type","text/css"),i.appendChild(document.createTextNode(e)),t.appendChild(i)}}(e.host?e:document.head,me)}},acquireContext:function(t,e){"string"==typeof t?t=document.getElementById(t):t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas);var n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(this._ensureLoaded(t),function(t,e){var n=t.style,i=t.getAttribute("height"),a=t.getAttribute("width");if(t[ve]={initial:{height:i,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",null===a||""===a){var r=we(t,"width");void 0!==r&&(t.width=r)}if(null===i||""===i)if(""===t.style.height)t.height=t.width/(e.options.aspectRatio||2);else{var o=we(t,"height");void 0!==r&&(t.height=o)}}(t,e),n):null},releaseContext:function(t){var e=t.canvas;if(e[ve]){var n=e[ve].initial;["height","width"].forEach((function(t){var i=n[t];H.isNullOrUndef(i)?e.removeAttribute(t):e.setAttribute(t,i)})),H.each(n.style||{},(function(t,n){e.style[n]=t})),e.width=e.width,delete e[ve]}},addEventListener:function(t,e,n){var i=t.canvas;if("resize"!==e){var a=n[ve]||(n[ve]={});Se(i,e,(a.proxies||(a.proxies={}))[t.id+"_"+e]=function(e){n(function(t,e){var n=ke[t.type]||t.type,i=H.getRelativePosition(t,e);return Pe(n,e,i.x,i.y,t)}(e,t))})}else De(i,n,t)},removeEventListener:function(t,e,n){var i=t.canvas;if("resize"!==e){var a=((n[ve]||{}).proxies||{})[t.id+"_"+e];a&&Ce(i,e,a)}else Te(i)}};H.addEvent=Se,H.removeEvent=Ce;var Fe=Ie._enabled?Ie:{acquireContext:function(t){return t&&t.canvas&&(t=t.canvas),t&&t.getContext("2d")||null}},Oe=H.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},Fe);N._set("global",{plugins:{}});var Le={_plugins:[],_cacheId:0,register:function(t){var e=this._plugins;[].concat(t).forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),this._cacheId++},unregister:function(t){var e=this._plugins;[].concat(t).forEach((function(t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)})),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e,n){var i,a,r,o,s,l=this.descriptors(t),u=l.length;for(i=0;i<u;++i)if("function"==typeof(s=(r=(a=l[i]).plugin)[e])&&((o=[t].concat(n||[])).push(a.options),!1===s.apply(r,o)))return!1;return!0},descriptors:function(t){var e=t.$plugins||(t.$plugins={});if(e.id===this._cacheId)return e.descriptors;var n=[],i=[],a=t&&t.config||{},r=a.options&&a.options.plugins||{};return this._plugins.concat(a.plugins||[]).forEach((function(t){if(-1===n.indexOf(t)){var e=t.id,a=r[e];!1!==a&&(!0===a&&(a=H.clone(N.global.plugins[e])),n.push(t),i.push({plugin:t,options:a||{}}))}})),e.descriptors=i,e.id=this._cacheId,i},_invalidate:function(t){delete t.$plugins}},Re={constructors:{},defaults:{},registerScaleType:function(t,e,n){this.constructors[t]=e,this.defaults[t]=H.clone(n)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?H.merge(Object.create(null),[N.scale,this.defaults[t]]):{}},updateScaleDefaults:function(t,e){this.defaults.hasOwnProperty(t)&&(this.defaults[t]=H.extend(this.defaults[t],e))},addScalesToLayout:function(t){H.each(t.scales,(function(e){e.fullWidth=e.options.fullWidth,e.position=e.options.position,e.weight=e.options.weight,pe.addBox(t,e)}))}},ze=H.valueOrDefault,Ne=H.rtl.getRtlAdapter;N._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:H.noop,title:function(t,e){var n="",i=e.labels,a=i?i.length:0;if(t.length>0){var r=t[0];r.label?n=r.label:r.xLabel?n=r.xLabel:a>0&&r.index<a&&(n=i[r.index])}return n},afterTitle:H.noop,beforeBody:H.noop,beforeLabel:H.noop,label:function(t,e){var n=e.datasets[t.datasetIndex].label||"";return n&&(n+=": "),H.isNullOrUndef(t.value)?n+=t.yLabel:n+=t.value,n},labelColor:function(t,e){var n=e.getDatasetMeta(t.datasetIndex).data[t.index]._view;return{borderColor:n.borderColor,backgroundColor:n.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:H.noop,afterBody:H.noop,beforeFooter:H.noop,footer:H.noop,afterFooter:H.noop}}});var Be={average:function(t){if(!t.length)return!1;var e,n,i=0,a=0,r=0;for(e=0,n=t.length;e<n;++e){var o=t[e];if(o&&o.hasValue()){var s=o.tooltipPosition();i+=s.x,a+=s.y,++r}}return{x:i/r,y:a/r}},nearest:function(t,e){var n,i,a,r=e.x,o=e.y,s=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){var l=t[n];if(l&&l.hasValue()){var u=l.getCenterPoint(),d=H.distanceBetweenPoints(e,u);d<s&&(s=d,a=l)}}if(a){var h=a.tooltipPosition();r=h.x,o=h.y}return{x:r,y:o}}};function Ee(t,e){return e&&(H.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function We(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function Ve(t){var e=N.global;return{xPadding:t.xPadding,yPadding:t.yPadding,xAlign:t.xAlign,yAlign:t.yAlign,rtl:t.rtl,textDirection:t.textDirection,bodyFontColor:t.bodyFontColor,_bodyFontFamily:ze(t.bodyFontFamily,e.defaultFontFamily),_bodyFontStyle:ze(t.bodyFontStyle,e.defaultFontStyle),_bodyAlign:t.bodyAlign,bodyFontSize:ze(t.bodyFontSize,e.defaultFontSize),bodySpacing:t.bodySpacing,titleFontColor:t.titleFontColor,_titleFontFamily:ze(t.titleFontFamily,e.defaultFontFamily),_titleFontStyle:ze(t.titleFontStyle,e.defaultFontStyle),titleFontSize:ze(t.titleFontSize,e.defaultFontSize),_titleAlign:t.titleAlign,titleSpacing:t.titleSpacing,titleMarginBottom:t.titleMarginBottom,footerFontColor:t.footerFontColor,_footerFontFamily:ze(t.footerFontFamily,e.defaultFontFamily),_footerFontStyle:ze(t.footerFontStyle,e.defaultFontStyle),footerFontSize:ze(t.footerFontSize,e.defaultFontSize),_footerAlign:t.footerAlign,footerSpacing:t.footerSpacing,footerMarginTop:t.footerMarginTop,caretSize:t.caretSize,cornerRadius:t.cornerRadius,backgroundColor:t.backgroundColor,opacity:0,legendColorBackground:t.multiKeyBackground,displayColors:t.displayColors,borderColor:t.borderColor,borderWidth:t.borderWidth}}function He(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}function je(t){return Ee([],We(t))}var qe=K.extend({initialize:function(){this._model=Ve(this._options),this._lastActive=[]},getTitle:function(){var t=this,e=t._options,n=e.callbacks,i=n.beforeTitle.apply(t,arguments),a=n.title.apply(t,arguments),r=n.afterTitle.apply(t,arguments),o=[];return o=Ee(o,We(i)),o=Ee(o,We(a)),o=Ee(o,We(r))},getBeforeBody:function(){return je(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(t,e){var n=this,i=n._options.callbacks,a=[];return H.each(t,(function(t){var r={before:[],lines:[],after:[]};Ee(r.before,We(i.beforeLabel.call(n,t,e))),Ee(r.lines,i.label.call(n,t,e)),Ee(r.after,We(i.afterLabel.call(n,t,e))),a.push(r)})),a},getAfterBody:function(){return je(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var t=this,e=t._options.callbacks,n=e.beforeFooter.apply(t,arguments),i=e.footer.apply(t,arguments),a=e.afterFooter.apply(t,arguments),r=[];return r=Ee(r,We(n)),r=Ee(r,We(i)),r=Ee(r,We(a))},update:function(t){var e,n,i,a,r,o,s,l,u,d,h=this,c=h._options,f=h._model,g=h._model=Ve(c),p=h._active,m=h._data,v={xAlign:f.xAlign,yAlign:f.yAlign},b={x:f.x,y:f.y},x={width:f.width,height:f.height},y={x:f.caretX,y:f.caretY};if(p.length){g.opacity=1;var _=[],k=[];y=Be[c.position].call(h,p,h._eventPosition);var w=[];for(e=0,n=p.length;e<n;++e)w.push((i=p[e],a=void 0,r=void 0,o=void 0,s=void 0,l=void 0,u=void 0,d=void 0,a=i._xScale,r=i._yScale||i._scale,o=i._index,s=i._datasetIndex,l=i._chart.getDatasetMeta(s).controller,u=l._getIndexScale(),d=l._getValueScale(),{xLabel:a?a.getLabelForIndex(o,s):"",yLabel:r?r.getLabelForIndex(o,s):"",label:u?""+u.getLabelForIndex(o,s):"",value:d?""+d.getLabelForIndex(o,s):"",index:o,datasetIndex:s,x:i._model.x,y:i._model.y}));c.filter&&(w=w.filter((function(t){return c.filter(t,m)}))),c.itemSort&&(w=w.sort((function(t,e){return c.itemSort(t,e,m)}))),H.each(w,(function(t){_.push(c.callbacks.labelColor.call(h,t,h._chart)),k.push(c.callbacks.labelTextColor.call(h,t,h._chart))})),g.title=h.getTitle(w,m),g.beforeBody=h.getBeforeBody(w,m),g.body=h.getBody(w,m),g.afterBody=h.getAfterBody(w,m),g.footer=h.getFooter(w,m),g.x=y.x,g.y=y.y,g.caretPadding=c.caretPadding,g.labelColors=_,g.labelTextColors=k,g.dataPoints=w,x=function(t,e){var n=t._chart.ctx,i=2*e.yPadding,a=0,r=e.body,o=r.reduce((function(t,e){return t+e.before.length+e.lines.length+e.after.length}),0);o+=e.beforeBody.length+e.afterBody.length;var s=e.title.length,l=e.footer.length,u=e.titleFontSize,d=e.bodyFontSize,h=e.footerFontSize;i+=s*u,i+=s?(s-1)*e.titleSpacing:0,i+=s?e.titleMarginBottom:0,i+=o*d,i+=o?(o-1)*e.bodySpacing:0,i+=l?e.footerMarginTop:0,i+=l*h,i+=l?(l-1)*e.footerSpacing:0;var c=0,f=function(t){a=Math.max(a,n.measureText(t).width+c)};return n.font=H.fontString(u,e._titleFontStyle,e._titleFontFamily),H.each(e.title,f),n.font=H.fontString(d,e._bodyFontStyle,e._bodyFontFamily),H.each(e.beforeBody.concat(e.afterBody),f),c=e.displayColors?d+2:0,H.each(r,(function(t){H.each(t.before,f),H.each(t.lines,f),H.each(t.after,f)})),c=0,n.font=H.fontString(h,e._footerFontStyle,e._footerFontFamily),H.each(e.footer,f),{width:a+=2*e.xPadding,height:i}}(this,g),b=function(t,e,n,i){var a=t.x,r=t.y,o=t.caretSize,s=t.caretPadding,l=t.cornerRadius,u=n.xAlign,d=n.yAlign,h=o+s,c=l+s;return"right"===u?a-=e.width:"center"===u&&((a-=e.width/2)+e.width>i.width&&(a=i.width-e.width),a<0&&(a=0)),"top"===d?r+=h:r-="bottom"===d?e.height+h:e.height/2,"center"===d?"left"===u?a+=h:"right"===u&&(a-=h):"left"===u?a-=c:"right"===u&&(a+=c),{x:a,y:r}}(g,x,v=function(t,e){var n,i,a,r,o,s=t._model,l=t._chart,u=t._chart.chartArea,d="center",h="center";s.y<e.height?h="top":s.y>l.height-e.height&&(h="bottom");var c=(u.left+u.right)/2,f=(u.top+u.bottom)/2;"center"===h?(n=function(t){return t<=c},i=function(t){return t>c}):(n=function(t){return t<=e.width/2},i=function(t){return t>=l.width-e.width/2}),a=function(t){return t+e.width+s.caretSize+s.caretPadding>l.width},r=function(t){return t-e.width-s.caretSize-s.caretPadding<0},o=function(t){return t<=f?"top":"bottom"},n(s.x)?(d="left",a(s.x)&&(d="center",h=o(s.y))):i(s.x)&&(d="right",r(s.x)&&(d="center",h=o(s.y)));var g=t._options;return{xAlign:g.xAlign?g.xAlign:d,yAlign:g.yAlign?g.yAlign:h}}(this,x),h._chart)}else g.opacity=0;return g.xAlign=v.xAlign,g.yAlign=v.yAlign,g.x=b.x,g.y=b.y,g.width=x.width,g.height=x.height,g.caretX=y.x,g.caretY=y.y,h._model=g,t&&c.custom&&c.custom.call(h,g),h},drawCaret:function(t,e){var n=this._chart.ctx,i=this._view,a=this.getCaretPosition(t,e,i);n.lineTo(a.x1,a.y1),n.lineTo(a.x2,a.y2),n.lineTo(a.x3,a.y3)},getCaretPosition:function(t,e,n){var i,a,r,o,s,l,u=n.caretSize,d=n.cornerRadius,h=n.xAlign,c=n.yAlign,f=t.x,g=t.y,p=e.width,m=e.height;if("center"===c)s=g+m/2,"left"===h?(a=(i=f)-u,r=i,o=s+u,l=s-u):(a=(i=f+p)+u,r=i,o=s-u,l=s+u);else if("left"===h?(i=(a=f+d+u)-u,r=a+u):"right"===h?(i=(a=f+p-d-u)-u,r=a+u):(i=(a=n.caretX)-u,r=a+u),"top"===c)s=(o=g)-u,l=o;else{s=(o=g+m)+u,l=o;var v=r;r=i,i=v}return{x1:i,x2:a,x3:r,y1:o,y2:s,y3:l}},drawTitle:function(t,e,n){var i,a,r,o=e.title,s=o.length;if(s){var l=Ne(e.rtl,e.x,e.width);for(t.x=He(e,e._titleAlign),n.textAlign=l.textAlign(e._titleAlign),n.textBaseline="middle",i=e.titleFontSize,a=e.titleSpacing,n.fillStyle=e.titleFontColor,n.font=H.fontString(i,e._titleFontStyle,e._titleFontFamily),r=0;r<s;++r)n.fillText(o[r],l.x(t.x),t.y+i/2),t.y+=i+a,r+1===s&&(t.y+=e.titleMarginBottom-a)}},drawBody:function(t,e,n){var i,a,r,o,s,l,u,d,h=e.bodyFontSize,c=e.bodySpacing,f=e._bodyAlign,g=e.body,p=e.displayColors,m=0,v=p?He(e,"left"):0,b=Ne(e.rtl,e.x,e.width),x=function(e){n.fillText(e,b.x(t.x+m),t.y+h/2),t.y+=h+c},y=b.textAlign(f);for(n.textAlign=f,n.textBaseline="middle",n.font=H.fontString(h,e._bodyFontStyle,e._bodyFontFamily),t.x=He(e,y),n.fillStyle=e.bodyFontColor,H.each(e.beforeBody,x),m=p&&"right"!==y?"center"===f?h/2+1:h+2:0,s=0,u=g.length;s<u;++s){for(i=g[s],a=e.labelTextColors[s],r=e.labelColors[s],n.fillStyle=a,H.each(i.before,x),l=0,d=(o=i.lines).length;l<d;++l){if(p){var _=b.x(v);n.fillStyle=e.legendColorBackground,n.fillRect(b.leftForLtr(_,h),t.y,h,h),n.lineWidth=1,n.strokeStyle=r.borderColor,n.strokeRect(b.leftForLtr(_,h),t.y,h,h),n.fillStyle=r.backgroundColor,n.fillRect(b.leftForLtr(b.xPlus(_,1),h-2),t.y+1,h-2,h-2),n.fillStyle=a}x(o[l])}H.each(i.after,x)}m=0,H.each(e.afterBody,x),t.y-=c},drawFooter:function(t,e,n){var i,a,r=e.footer,o=r.length;if(o){var s=Ne(e.rtl,e.x,e.width);for(t.x=He(e,e._footerAlign),t.y+=e.footerMarginTop,n.textAlign=s.textAlign(e._footerAlign),n.textBaseline="middle",i=e.footerFontSize,n.fillStyle=e.footerFontColor,n.font=H.fontString(i,e._footerFontStyle,e._footerFontFamily),a=0;a<o;++a)n.fillText(r[a],s.x(t.x),t.y+i/2),t.y+=i+e.footerSpacing}},drawBackground:function(t,e,n,i){n.fillStyle=e.backgroundColor,n.strokeStyle=e.borderColor,n.lineWidth=e.borderWidth;var a=e.xAlign,r=e.yAlign,o=t.x,s=t.y,l=i.width,u=i.height,d=e.cornerRadius;n.beginPath(),n.moveTo(o+d,s),"top"===r&&this.drawCaret(t,i),n.lineTo(o+l-d,s),n.quadraticCurveTo(o+l,s,o+l,s+d),"center"===r&&"right"===a&&this.drawCaret(t,i),n.lineTo(o+l,s+u-d),n.quadraticCurveTo(o+l,s+u,o+l-d,s+u),"bottom"===r&&this.drawCaret(t,i),n.lineTo(o+d,s+u),n.quadraticCurveTo(o,s+u,o,s+u-d),"center"===r&&"left"===a&&this.drawCaret(t,i),n.lineTo(o,s+d),n.quadraticCurveTo(o,s,o+d,s),n.closePath(),n.fill(),e.borderWidth>0&&n.stroke()},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var n={width:e.width,height:e.height},i={x:e.x,y:e.y},a=Math.abs(e.opacity<.001)?0:e.opacity,r=e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length;this._options.enabled&&r&&(t.save(),t.globalAlpha=a,this.drawBackground(i,e,t,n),i.y+=e.yPadding,H.rtl.overrideTextDirection(t,e.textDirection),this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),H.rtl.restoreTextDirection(t,e.textDirection),t.restore())}},handleEvent:function(t){var e,n=this,i=n._options;return n._lastActive=n._lastActive||[],"mouseout"===t.type?n._active=[]:(n._active=n._chart.getElementsAtEventForMode(t,i.mode,i),i.reverse&&n._active.reverse()),(e=!H.arrayEquals(n._active,n._lastActive))&&(n._lastActive=n._active,(i.enabled||i.custom)&&(n._eventPosition={x:t.x,y:t.y},n.update(!0),n.pivot())),e}}),Ue=Be,Ye=qe;Ye.positioners=Ue;var Ge=H.valueOrDefault;function Xe(){return H.merge(Object.create(null),[].slice.call(arguments),{merger:function(t,e,n,i){if("xAxes"===t||"yAxes"===t){var a,r,o,s=n[t].length;for(e[t]||(e[t]=[]),a=0;a<s;++a)o=n[t][a],r=Ge(o.type,"xAxes"===t?"category":"linear"),a>=e[t].length&&e[t].push({}),!e[t][a].type||o.type&&o.type!==e[t][a].type?H.merge(e[t][a],[Re.getScaleDefaults(r),o]):H.merge(e[t][a],o)}else H._merger(t,e,n,i)}})}function Ke(){return H.merge(Object.create(null),[].slice.call(arguments),{merger:function(t,e,n,i){var a=e[t]||Object.create(null),r=n[t];"scales"===t?e[t]=Xe(a,r):"scale"===t?e[t]=H.merge(a,[Re.getScaleDefaults(r.type),r]):H._merger(t,e,n,i)}})}function Ze(t){var e=t.options;H.each(t.scales,(function(e){pe.removeBox(t,e)})),e=Ke(N.global,N[t.config.type],e),t.options=t.config.options=e,t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),t.tooltip._options=e.tooltips,t.tooltip.initialize()}function $e(t,e,n){var i,a=function(t){return t.id===i};do{i=e+n++}while(H.findIndex(t,a)>=0);return i}function Je(t){return"top"===t||"bottom"===t}function Qe(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}N._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var tn=function(t,e){return this.construct(t,e),this};H.extend(tn.prototype,{construct:function(t,e){var n=this;e=function(t){var e=(t=t||Object.create(null)).data=t.data||{};return e.datasets=e.datasets||[],e.labels=e.labels||[],t.options=Ke(N.global,N[t.type],t.options||{}),t}(e);var i=Oe.acquireContext(t,e),a=i&&i.canvas,r=a&&a.height,o=a&&a.width;n.id=H.uid(),n.ctx=i,n.canvas=a,n.config=e,n.width=o,n.height=r,n.aspectRatio=r?o/r:null,n.options=e.options,n._bufferedRender=!1,n._layers=[],n.chart=n,n.controller=n,tn.instances[n.id]=n,Object.defineProperty(n,"data",{get:function(){return n.config.data},set:function(t){n.config.data=t}}),i&&a?(n.initialize(),n.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var t=this;return Le.notify(t,"beforeInit"),H.retinaScale(t,t.options.devicePixelRatio),t.bindEvents(),t.options.responsive&&t.resize(!0),t.initToolTip(),Le.notify(t,"afterInit"),t},clear:function(){return H.canvas.clear(this),this},stop:function(){return J.cancelAnimation(this),this},resize:function(t){var e=this,n=e.options,i=e.canvas,a=n.maintainAspectRatio&&e.aspectRatio||null,r=Math.max(0,Math.floor(H.getMaximumWidth(i))),o=Math.max(0,Math.floor(a?r/a:H.getMaximumHeight(i)));if((e.width!==r||e.height!==o)&&(i.width=e.width=r,i.height=e.height=o,i.style.width=r+"px",i.style.height=o+"px",H.retinaScale(e,n.devicePixelRatio),!t)){var s={width:r,height:o};Le.notify(e,"resize",[s]),n.onResize&&n.onResize(e,s),e.stop(),e.update({duration:n.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var t=this.options,e=t.scales||{},n=t.scale;H.each(e.xAxes,(function(t,n){t.id||(t.id=$e(e.xAxes,"x-axis-",n))})),H.each(e.yAxes,(function(t,n){t.id||(t.id=$e(e.yAxes,"y-axis-",n))})),n&&(n.id=n.id||"scale")},buildOrUpdateScales:function(){var t=this,e=t.options,n=t.scales||{},i=[],a=Object.keys(n).reduce((function(t,e){return t[e]=!1,t}),{});e.scales&&(i=i.concat((e.scales.xAxes||[]).map((function(t){return{options:t,dtype:"category",dposition:"bottom"}})),(e.scales.yAxes||[]).map((function(t){return{options:t,dtype:"linear",dposition:"left"}})))),e.scale&&i.push({options:e.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),H.each(i,(function(e){var i=e.options,r=i.id,o=Ge(i.type,e.dtype);Je(i.position)!==Je(e.dposition)&&(i.position=e.dposition),a[r]=!0;var s=null;if(r in n&&n[r].type===o)(s=n[r]).options=i,s.ctx=t.ctx,s.chart=t;else{var l=Re.getScaleConstructor(o);if(!l)return;s=new l({id:r,type:o,options:i,ctx:t.ctx,chart:t}),n[s.id]=s}s.mergeTicksOptions(),e.isDefault&&(t.scale=s)})),H.each(a,(function(t,e){t||delete n[e]})),t.scales=n,Re.addScalesToLayout(this)},buildOrUpdateControllers:function(){var t,e,n=this,i=[],a=n.data.datasets;for(t=0,e=a.length;t<e;t++){var r=a[t],o=n.getDatasetMeta(t),s=r.type||n.config.type;if(o.type&&o.type!==s&&(n.destroyDatasetMeta(t),o=n.getDatasetMeta(t)),o.type=s,o.order=r.order||0,o.index=t,o.controller)o.controller.updateIndex(t),o.controller.linkScales();else{var l=Jt[o.type];if(void 0===l)throw new Error('"'+o.type+'" is not a chart type.');o.controller=new l(n,t),i.push(o.controller)}}return i},resetElements:function(){var t=this;H.each(t.data.datasets,(function(e,n){t.getDatasetMeta(n).controller.reset()}),t)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var e,n,i=this;if(t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]}),Ze(i),Le._invalidate(i),!1!==Le.notify(i,"beforeUpdate")){i.tooltip._data=i.data;var a=i.buildOrUpdateControllers();for(e=0,n=i.data.datasets.length;e<n;e++)i.getDatasetMeta(e).controller.buildOrUpdateElements();i.updateLayout(),i.options.animation&&i.options.animation.duration&&H.each(a,(function(t){t.reset()})),i.updateDatasets(),i.tooltip.initialize(),i.lastActive=[],Le.notify(i,"afterUpdate"),i._layers.sort(Qe("z","_idx")),i._bufferedRender?i._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:i.render(t)}},updateLayout:function(){var t=this;!1!==Le.notify(t,"beforeLayout")&&(pe.update(this,this.width,this.height),t._layers=[],H.each(t.boxes,(function(e){e._configure&&e._configure(),t._layers.push.apply(t._layers,e._layers())}),t),t._layers.forEach((function(t,e){t._idx=e})),Le.notify(t,"afterScaleUpdate"),Le.notify(t,"afterLayout"))},updateDatasets:function(){if(!1!==Le.notify(this,"beforeDatasetsUpdate")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);Le.notify(this,"afterDatasetsUpdate")}},updateDataset:function(t){var e=this.getDatasetMeta(t),n={meta:e,index:t};!1!==Le.notify(this,"beforeDatasetUpdate",[n])&&(e.controller._update(),Le.notify(this,"afterDatasetUpdate",[n]))},render:function(t){var e=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var n=e.options.animation,i=Ge(t.duration,n&&n.duration),a=t.lazy;if(!1!==Le.notify(e,"beforeRender")){var r=function(t){Le.notify(e,"afterRender"),H.callback(n&&n.onComplete,[t],e)};if(n&&i){var o=new $({numSteps:i/16.66,easing:t.easing||n.easing,render:function(t,e){var n=H.easing.effects[e.easing],i=e.currentStep,a=i/e.numSteps;t.draw(n(a),a,i)},onAnimationProgress:n.onProgress,onAnimationComplete:r});J.addAnimation(e,o,i,a)}else e.draw(),r(new $({numSteps:0,chart:e}));return e}},draw:function(t){var e,n,i=this;if(i.clear(),H.isNullOrUndef(t)&&(t=1),i.transition(t),!(i.width<=0||i.height<=0)&&!1!==Le.notify(i,"beforeDraw",[t])){for(n=i._layers,e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(i.chartArea);for(i.drawDatasets(t);e<n.length;++e)n[e].draw(i.chartArea);i._drawTooltip(t),Le.notify(i,"afterDraw",[t])}},transition:function(t){for(var e=0,n=(this.data.datasets||[]).length;e<n;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},_getSortedDatasetMetas:function(t){var e,n,i=[];for(e=0,n=(this.data.datasets||[]).length;e<n;++e)t&&!this.isDatasetVisible(e)||i.push(this.getDatasetMeta(e));return i.sort(Qe("order","index")),i},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(!0)},drawDatasets:function(t){var e,n;if(!1!==Le.notify(this,"beforeDatasetsDraw",[t])){for(n=(e=this._getSortedVisibleDatasetMetas()).length-1;n>=0;--n)this.drawDataset(e[n],t);Le.notify(this,"afterDatasetsDraw",[t])}},drawDataset:function(t,e){var n={meta:t,index:t.index,easingValue:e};!1!==Le.notify(this,"beforeDatasetDraw",[n])&&(t.controller.draw(e),Le.notify(this,"afterDatasetDraw",[n]))},_drawTooltip:function(t){var e=this.tooltip,n={tooltip:e,easingValue:t};!1!==Le.notify(this,"beforeTooltipDraw",[n])&&(e.draw(),Le.notify(this,"afterTooltipDraw",[n]))},getElementAtEvent:function(t){return re.modes.single(this,t)},getElementsAtEvent:function(t){return re.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return re.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,n){var i=re.modes[e];return"function"==typeof i?i(this,t,n):[]},getDatasetAtEvent:function(t){return re.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var n=e._meta[this.id];return n||(n=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e.order||0,index:t}),n},getVisibleDatasetCount:function(){for(var t=0,e=0,n=this.data.datasets.length;e<n;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,n=this.data.datasets[t],i=n._meta&&n._meta[e];i&&(i.controller.destroy(),delete n._meta[e])},destroy:function(){var t,e,n=this,i=n.canvas;for(n.stop(),t=0,e=n.data.datasets.length;t<e;++t)n.destroyDatasetMeta(t);i&&(n.unbindEvents(),H.canvas.clear(n),Oe.releaseContext(n.ctx),n.canvas=null,n.ctx=null),Le.notify(n,"destroy"),delete tn.instances[n.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var t=this;t.tooltip=new Ye({_chart:t,_chartInstance:t,_data:t.data,_options:t.options.tooltips},t)},bindEvents:function(){var t=this,e=t._listeners={},n=function(){t.eventHandler.apply(t,arguments)};H.each(t.options.events,(function(i){Oe.addEventListener(t,i,n),e[i]=n})),t.options.responsive&&(n=function(){t.resize()},Oe.addEventListener(t,"resize",n),e.resize=n)},unbindEvents:function(){var t=this,e=t._listeners;e&&(delete t._listeners,H.each(e,(function(e,n){Oe.removeEventListener(t,n,e)})))},updateHoverStyle:function(t,e,n){var i,a,r,o=n?"set":"remove";for(a=0,r=t.length;a<r;++a)(i=t[a])&&this.getDatasetMeta(i._datasetIndex).controller[o+"HoverStyle"](i);"dataset"===e&&this.getDatasetMeta(t[0]._datasetIndex).controller["_"+o+"DatasetHoverStyle"]()},eventHandler:function(t){var e=this,n=e.tooltip;if(!1!==Le.notify(e,"beforeEvent",[t])){e._bufferedRender=!0,e._bufferedRequest=null;var i=e.handleEvent(t);n&&(i=n._start?n.handleEvent(t):i|n.handleEvent(t)),Le.notify(e,"afterEvent",[t]);var a=e._bufferedRequest;return a?e.render(a):i&&!e.animating&&(e.stop(),e.render({duration:e.options.hover.animationDuration,lazy:!0})),e._bufferedRender=!1,e._bufferedRequest=null,e}},handleEvent:function(t){var e,n=this,i=n.options||{},a=i.hover;return n.lastActive=n.lastActive||[],"mouseout"===t.type?n.active=[]:n.active=n.getElementsAtEventForMode(t,a.mode,a),H.callback(i.onHover||i.hover.onHover,[t.native,n.active],n),"mouseup"!==t.type&&"click"!==t.type||i.onClick&&i.onClick.call(n,t.native,n.active),n.lastActive.length&&n.updateHoverStyle(n.lastActive,a.mode,!1),n.active.length&&a.mode&&n.updateHoverStyle(n.active,a.mode,!0),e=!H.arrayEquals(n.active,n.lastActive),n.lastActive=n.active,e}}),tn.instances={};var en=tn;tn.Controller=tn,tn.types={},H.configMerge=Ke,H.scaleMerge=Xe;function nn(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function an(t){this.options=t||{}}H.extend(an.prototype,{formats:nn,parse:nn,format:nn,add:nn,diff:nn,startOf:nn,endOf:nn,_create:function(t){return t}}),an.override=function(t){H.extend(an.prototype,t)};var rn={_date:an},on={formatters:{values:function(t){return H.isArray(t)?t:""+t},linear:function(t,e,n){var i=n.length>3?n[2]-n[1]:n[1]-n[0];Math.abs(i)>1&&t!==Math.floor(t)&&(i=t-Math.floor(t));var a=H.log10(Math.abs(i)),r="";if(0!==t)if(Math.max(Math.abs(n[0]),Math.abs(n[n.length-1]))<1e-4){var o=H.log10(Math.abs(t)),s=Math.floor(o)-Math.floor(a);s=Math.max(Math.min(s,20),0),r=t.toExponential(s)}else{var l=-1*Math.floor(a);l=Math.max(Math.min(l,20),0),r=t.toFixed(l)}else r="0";return r},logarithmic:function(t,e,n){var i=t/Math.pow(10,Math.floor(H.log10(t)));return 0===t?"0":1===i||2===i||5===i||0===e||e===n.length-1?t.toExponential():""}}},sn=H.isArray,ln=H.isNullOrUndef,un=H.valueOrDefault,dn=H.valueAtIndexOrDefault;function hn(t,e,n){var i,a=t.getTicks().length,r=Math.min(e,a-1),o=t.getPixelForTick(r),s=t._startPixel,l=t._endPixel;if(!(n&&(i=1===a?Math.max(o-s,l-o):0===e?(t.getPixelForTick(1)-o)/2:(o-t.getPixelForTick(r-1))/2,(o+=r<e?i:-i)<s-1e-6||o>l+1e-6)))return o}function cn(t,e,n,i){var a,r,o,s,l,u,d,h,c,f,g,p,m,v=n.length,b=[],x=[],y=[],_=0,k=0;for(a=0;a<v;++a){if(s=n[a].label,l=n[a].major?e.major:e.minor,t.font=u=l.string,d=i[u]=i[u]||{data:{},gc:[]},h=l.lineHeight,c=f=0,ln(s)||sn(s)){if(sn(s))for(r=0,o=s.length;r<o;++r)g=s[r],ln(g)||sn(g)||(c=H.measureText(t,d.data,d.gc,c,g),f+=h)}else c=H.measureText(t,d.data,d.gc,c,s),f=h;b.push(c),x.push(f),y.push(h/2),_=Math.max(c,_),k=Math.max(f,k)}function w(t){return{width:b[t]||0,height:x[t]||0,offset:y[t]||0}}return function(t,e){H.each(t,(function(t){var n,i=t.gc,a=i.length/2;if(a>e){for(n=0;n<a;++n)delete t.data[i[n]];i.splice(0,a)}}))}(i,v),p=b.indexOf(_),m=x.indexOf(k),{first:w(0),last:w(v-1),widest:w(p),highest:w(m)}}function fn(t){return t.drawTicks?t.tickMarkLength:0}function gn(t){var e,n;return t.display?(e=H.options._parseFont(t),n=H.options.toPadding(t.padding),e.lineHeight+n.height):0}function pn(t,e){return H.extend(H.options._parseFont({fontFamily:un(e.fontFamily,t.fontFamily),fontSize:un(e.fontSize,t.fontSize),fontStyle:un(e.fontStyle,t.fontStyle),lineHeight:un(e.lineHeight,t.lineHeight)}),{color:H.options.resolve([e.fontColor,t.fontColor,N.global.defaultFontColor])})}function mn(t){var e=pn(t,t.minor);return{minor:e,major:t.major.enabled?pn(t,t.major):e}}function vn(t){var e,n,i,a=[];for(n=0,i=t.length;n<i;++n)void 0!==(e=t[n])._index&&a.push(e);return a}function bn(t,e,n,i){var a,r,o,s,l=un(n,0),u=Math.min(un(i,t.length),t.length),d=0;for(e=Math.ceil(e),i&&(e=(a=i-n)/Math.floor(a/e)),s=l;s<0;)d++,s=Math.round(l+d*e);for(r=Math.max(l,0);r<u;r++)o=t[r],r===s?(o._index=r,d++,s=Math.round(l+d*e)):delete o.label}N._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:on.formatters.values,minor:{},major:{}}});var xn=K.extend({zeroLineIndex:0,getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){H.callback(this.options.beforeUpdate,[this])},update:function(t,e,n){var i,a,r,o,s,l=this,u=l.options.ticks,d=u.sampleSize;if(l.beforeUpdate(),l.maxWidth=t,l.maxHeight=e,l.margins=H.extend({left:0,right:0,top:0,bottom:0},n),l._ticks=null,l.ticks=null,l._labelSizes=null,l._maxLabelLines=0,l.longestLabelWidth=0,l.longestTextCache=l.longestTextCache||{},l._gridLineItems=null,l._labelItems=null,l.beforeSetDimensions(),l.setDimensions(),l.afterSetDimensions(),l.beforeDataLimits(),l.determineDataLimits(),l.afterDataLimits(),l.beforeBuildTicks(),o=l.buildTicks()||[],(!(o=l.afterBuildTicks(o)||o)||!o.length)&&l.ticks)for(o=[],i=0,a=l.ticks.length;i<a;++i)o.push({value:l.ticks[i],major:!1});return l._ticks=o,s=d<o.length,r=l._convertTicksToLabels(s?function(t,e){for(var n=[],i=t.length/e,a=0,r=t.length;a<r;a+=i)n.push(t[Math.floor(a)]);return n}(o,d):o),l._configure(),l.beforeCalculateTickRotation(),l.calculateTickRotation(),l.afterCalculateTickRotation(),l.beforeFit(),l.fit(),l.afterFit(),l._ticksToDraw=u.display&&(u.autoSkip||"auto"===u.source)?l._autoSkip(o):o,s&&(r=l._convertTicksToLabels(l._ticksToDraw)),l.ticks=r,l.afterUpdate(),l.minSize},_configure:function(){var t,e,n=this,i=n.options.ticks.reverse;n.isHorizontal()?(t=n.left,e=n.right):(t=n.top,e=n.bottom,i=!i),n._startPixel=t,n._endPixel=e,n._reversePixels=i,n._length=e-t},afterUpdate:function(){H.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){H.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){H.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){H.callback(this.options.beforeDataLimits,[this])},determineDataLimits:H.noop,afterDataLimits:function(){H.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){H.callback(this.options.beforeBuildTicks,[this])},buildTicks:H.noop,afterBuildTicks:function(t){var e=this;return sn(t)&&t.length?H.callback(e.options.afterBuildTicks,[e,t]):(e.ticks=H.callback(e.options.afterBuildTicks,[e,e.ticks])||e.ticks,t)},beforeTickToLabelConversion:function(){H.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this.options.ticks;this.ticks=this.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){H.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){H.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t,e,n,i,a,r,o,s=this,l=s.options,u=l.ticks,d=s.getTicks().length,h=u.minRotation||0,c=u.maxRotation,f=h;!s._isVisible()||!u.display||h>=c||d<=1||!s.isHorizontal()?s.labelRotation=h:(e=(t=s._getLabelSizes()).widest.width,n=t.highest.height-t.highest.offset,i=Math.min(s.maxWidth,s.chart.width-e),e+6>(a=l.offset?s.maxWidth/d:i/(d-1))&&(a=i/(d-(l.offset?.5:1)),r=s.maxHeight-fn(l.gridLines)-u.padding-gn(l.scaleLabel),o=Math.sqrt(e*e+n*n),f=H.toDegrees(Math.min(Math.asin(Math.min((t.highest.height+6)/a,1)),Math.asin(Math.min(r/o,1))-Math.asin(n/o))),f=Math.max(h,Math.min(c,f))),s.labelRotation=f)},afterCalculateTickRotation:function(){H.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){H.callback(this.options.beforeFit,[this])},fit:function(){var t=this,e=t.minSize={width:0,height:0},n=t.chart,i=t.options,a=i.ticks,r=i.scaleLabel,o=i.gridLines,s=t._isVisible(),l="bottom"===i.position,u=t.isHorizontal();if(u?e.width=t.maxWidth:s&&(e.width=fn(o)+gn(r)),u?s&&(e.height=fn(o)+gn(r)):e.height=t.maxHeight,a.display&&s){var d=mn(a),h=t._getLabelSizes(),c=h.first,f=h.last,g=h.widest,p=h.highest,m=.4*d.minor.lineHeight,v=a.padding;if(u){var b=0!==t.labelRotation,x=H.toRadians(t.labelRotation),y=Math.cos(x),_=Math.sin(x),k=_*g.width+y*(p.height-(b?p.offset:0))+(b?0:m);e.height=Math.min(t.maxHeight,e.height+k+v);var w,M,S=t.getPixelForTick(0)-t.left,C=t.right-t.getPixelForTick(t.getTicks().length-1);b?(w=l?y*c.width+_*c.offset:_*(c.height-c.offset),M=l?_*(f.height-f.offset):y*f.width+_*f.offset):(w=c.width/2,M=f.width/2),t.paddingLeft=Math.max((w-S)*t.width/(t.width-S),0)+3,t.paddingRight=Math.max((M-C)*t.width/(t.width-C),0)+3}else{var P=a.mirror?0:g.width+v+m;e.width=Math.min(t.maxWidth,e.width+P),t.paddingTop=c.height/2,t.paddingBottom=f.height/2}}t.handleMargins(),u?(t.width=t._length=n.width-t.margins.left-t.margins.right,t.height=e.height):(t.width=e.width,t.height=t._length=n.height-t.margins.top-t.margins.bottom)},handleMargins:function(){var t=this;t.margins&&(t.margins.left=Math.max(t.paddingLeft,t.margins.left),t.margins.top=Math.max(t.paddingTop,t.margins.top),t.margins.right=Math.max(t.paddingRight,t.margins.right),t.margins.bottom=Math.max(t.paddingBottom,t.margins.bottom))},afterFit:function(){H.callback(this.options.afterFit,[this])},isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(ln(t))return NaN;if(("number"==typeof t||t instanceof Number)&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},_convertTicksToLabels:function(t){var e,n,i,a=this;for(a.ticks=t.map((function(t){return t.value})),a.beforeTickToLabelConversion(),e=a.convertTicksToLabels(t)||a.ticks,a.afterTickToLabelConversion(),n=0,i=t.length;n<i;++n)t[n].label=e[n];return e},_getLabelSizes:function(){var t=this,e=t._labelSizes;return e||(t._labelSizes=e=cn(t.ctx,mn(t.options.ticks),t.getTicks(),t.longestTextCache),t.longestLabelWidth=e.widest.width),e},_parseValue:function(t){var e,n,i,a;return sn(t)?(e=+this.getRightValue(t[0]),n=+this.getRightValue(t[1]),i=Math.min(e,n),a=Math.max(e,n)):(e=void 0,n=t=+this.getRightValue(t),i=t,a=t),{min:i,max:a,start:e,end:n}},_getScaleLabel:function(t){var e=this._parseValue(t);return void 0!==e.start?"["+e.start+", "+e.end+"]":+this.getRightValue(t)},getLabelForIndex:H.noop,getPixelForValue:H.noop,getValueForPixel:H.noop,getPixelForTick:function(t){var e=this.options.offset,n=this._ticks.length,i=1/Math.max(n-(e?0:1),1);return t<0||t>n-1?null:this.getPixelForDecimal(t*i+(e?i/2:0))},getPixelForDecimal:function(t){return this._reversePixels&&(t=1-t),this._startPixel+t*this._length},getDecimalForPixel:function(t){var e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this.min,e=this.max;return this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0},_autoSkip:function(t){var e,n,i,a,r=this.options.ticks,o=this._length,s=r.maxTicksLimit||o/this._tickSize()+1,l=r.major.enabled?function(t){var e,n,i=[];for(e=0,n=t.length;e<n;e++)t[e].major&&i.push(e);return i}(t):[],u=l.length,d=l[0],h=l[u-1];if(u>s)return function(t,e,n){var i,a,r=0,o=e[0];for(n=Math.ceil(n),i=0;i<t.length;i++)a=t[i],i===o?(a._index=i,o=e[++r*n]):delete a.label}(t,l,u/s),vn(t);if(i=function(t,e,n,i){var a,r,o,s,l=function(t){var e,n,i=t.length;if(i<2)return!1;for(n=t[0],e=1;e<i;++e)if(t[e]-t[e-1]!==n)return!1;return n}(t),u=(e.length-1)/i;if(!l)return Math.max(u,1);for(o=0,s=(a=H.math._factorize(l)).length-1;o<s;o++)if((r=a[o])>u)return r;return Math.max(u,1)}(l,t,0,s),u>0){for(e=0,n=u-1;e<n;e++)bn(t,i,l[e],l[e+1]);return a=u>1?(h-d)/(u-1):null,bn(t,i,H.isNullOrUndef(a)?0:d-a,d),bn(t,i,h,H.isNullOrUndef(a)?t.length:h+a),vn(t)}return bn(t,i),vn(t)},_tickSize:function(){var t=this.options.ticks,e=H.toRadians(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),a=this._getLabelSizes(),r=t.autoSkipPadding||0,o=a?a.widest.width+r:0,s=a?a.highest.height+r:0;return this.isHorizontal()?s*n>o*i?o/n:s/i:s*i<o*n?s/n:o/i},_isVisible:function(){var t,e,n,i=this.chart,a=this.options.display;if("auto"!==a)return!!a;for(t=0,e=i.data.datasets.length;t<e;++t)if(i.isDatasetVisible(t)&&((n=i.getDatasetMeta(t)).xAxisID===this.id||n.yAxisID===this.id))return!0;return!1},_computeGridLineItems:function(t){var e,n,i,a,r,o,s,l,u,d,h,c,f,g,p,m,v,b=this,x=b.chart,y=b.options,_=y.gridLines,k=y.position,w=_.offsetGridLines,M=b.isHorizontal(),S=b._ticksToDraw,C=S.length+(w?1:0),P=fn(_),A=[],D=_.drawBorder?dn(_.lineWidth,0,0):0,T=D/2,I=H._alignPixel,F=function(t){return I(x,t,D)};for("top"===k?(e=F(b.bottom),s=b.bottom-P,u=e-T,h=F(t.top)+T,f=t.bottom):"bottom"===k?(e=F(b.top),h=t.top,f=F(t.bottom)-T,s=e+T,u=b.top+P):"left"===k?(e=F(b.right),o=b.right-P,l=e-T,d=F(t.left)+T,c=t.right):(e=F(b.left),d=t.left,c=F(t.right)-T,o=e+T,l=b.left+P),n=0;n<C;++n)i=S[n]||{},ln(i.label)&&n<S.length||(n===b.zeroLineIndex&&y.offset===w?(g=_.zeroLineWidth,p=_.zeroLineColor,m=_.zeroLineBorderDash||[],v=_.zeroLineBorderDashOffset||0):(g=dn(_.lineWidth,n,1),p=dn(_.color,n,"rgba(0,0,0,0.1)"),m=_.borderDash||[],v=_.borderDashOffset||0),void 0!==(a=hn(b,i._index||n,w))&&(r=I(x,a,g),M?o=l=d=c=r:s=u=h=f=r,A.push({tx1:o,ty1:s,tx2:l,ty2:u,x1:d,y1:h,x2:c,y2:f,width:g,color:p,borderDash:m,borderDashOffset:v})));return A.ticksLength=C,A.borderValue=e,A},_computeLabelItems:function(){var t,e,n,i,a,r,o,s,l,u,d,h,c=this,f=c.options,g=f.ticks,p=f.position,m=g.mirror,v=c.isHorizontal(),b=c._ticksToDraw,x=mn(g),y=g.padding,_=fn(f.gridLines),k=-H.toRadians(c.labelRotation),w=[];for("top"===p?(r=c.bottom-_-y,o=k?"left":"center"):"bottom"===p?(r=c.top+_+y,o=k?"right":"center"):"left"===p?(a=c.right-(m?0:_)-y,o=m?"left":"right"):(a=c.left+(m?0:_)+y,o=m?"right":"left"),t=0,e=b.length;t<e;++t)i=(n=b[t]).label,ln(i)||(s=c.getPixelForTick(n._index||t)+g.labelOffset,u=(l=n.major?x.major:x.minor).lineHeight,d=sn(i)?i.length:1,v?(a=s,h="top"===p?((k?1:.5)-d)*u:(k?0:.5)*u):(r=s,h=(1-d)*u/2),w.push({x:a,y:r,rotation:k,label:i,font:l,textOffset:h,textAlign:o}));return w},_drawGrid:function(t){var e=this,n=e.options.gridLines;if(n.display){var i,a,r,o,s,l=e.ctx,u=e.chart,d=H._alignPixel,h=n.drawBorder?dn(n.lineWidth,0,0):0,c=e._gridLineItems||(e._gridLineItems=e._computeGridLineItems(t));for(r=0,o=c.length;r<o;++r)i=(s=c[r]).width,a=s.color,i&&a&&(l.save(),l.lineWidth=i,l.strokeStyle=a,l.setLineDash&&(l.setLineDash(s.borderDash),l.lineDashOffset=s.borderDashOffset),l.beginPath(),n.drawTicks&&(l.moveTo(s.tx1,s.ty1),l.lineTo(s.tx2,s.ty2)),n.drawOnChartArea&&(l.moveTo(s.x1,s.y1),l.lineTo(s.x2,s.y2)),l.stroke(),l.restore());if(h){var f,g,p,m,v=h,b=dn(n.lineWidth,c.ticksLength-1,1),x=c.borderValue;e.isHorizontal()?(f=d(u,e.left,v)-v/2,g=d(u,e.right,b)+b/2,p=m=x):(p=d(u,e.top,v)-v/2,m=d(u,e.bottom,b)+b/2,f=g=x),l.lineWidth=h,l.strokeStyle=dn(n.color,0),l.beginPath(),l.moveTo(f,p),l.lineTo(g,m),l.stroke()}}},_drawLabels:function(){var t=this;if(t.options.ticks.display){var e,n,i,a,r,o,s,l,u=t.ctx,d=t._labelItems||(t._labelItems=t._computeLabelItems());for(e=0,i=d.length;e<i;++e){if(o=(r=d[e]).font,u.save(),u.translate(r.x,r.y),u.rotate(r.rotation),u.font=o.string,u.fillStyle=o.color,u.textBaseline="middle",u.textAlign=r.textAlign,s=r.label,l=r.textOffset,sn(s))for(n=0,a=s.length;n<a;++n)u.fillText(""+s[n],0,l),l+=o.lineHeight;else u.fillText(s,0,l);u.restore()}}},_drawTitle:function(){var t=this,e=t.ctx,n=t.options,i=n.scaleLabel;if(i.display){var a,r,o=un(i.fontColor,N.global.defaultFontColor),s=H.options._parseFont(i),l=H.options.toPadding(i.padding),u=s.lineHeight/2,d=n.position,h=0;if(t.isHorizontal())a=t.left+t.width/2,r="bottom"===d?t.bottom-u-l.bottom:t.top+u+l.top;else{var c="left"===d;a=c?t.left+u+l.top:t.right-u-l.top,r=t.top+t.height/2,h=c?-.5*Math.PI:.5*Math.PI}e.save(),e.translate(a,r),e.rotate(h),e.textAlign="center",e.textBaseline="middle",e.fillStyle=o,e.font=s.string,e.fillText(i.labelString,0,0),e.restore()}},draw:function(t){this._isVisible()&&(this._drawGrid(t),this._drawTitle(),this._drawLabels())},_layers:function(){var t=this,e=t.options,n=e.ticks&&e.ticks.z||0,i=e.gridLines&&e.gridLines.z||0;return t._isVisible()&&n!==i&&t.draw===t._draw?[{z:i,draw:function(){t._drawGrid.apply(t,arguments),t._drawTitle.apply(t,arguments)}},{z:n,draw:function(){t._drawLabels.apply(t,arguments)}}]:[{z:n,draw:function(){t.draw.apply(t,arguments)}}]},_getMatchingVisibleMetas:function(t){var e=this,n=e.isHorizontal();return e.chart._getSortedVisibleDatasetMetas().filter((function(i){return(!t||i.type===t)&&(n?i.xAxisID===e.id:i.yAxisID===e.id)}))}});xn.prototype._draw=xn.prototype.draw;var yn=xn,_n=H.isNullOrUndef,kn=yn.extend({determineDataLimits:function(){var t,e=this,n=e._getLabels(),i=e.options.ticks,a=i.min,r=i.max,o=0,s=n.length-1;void 0!==a&&(t=n.indexOf(a))>=0&&(o=t),void 0!==r&&(t=n.indexOf(r))>=0&&(s=t),e.minIndex=o,e.maxIndex=s,e.min=n[o],e.max=n[s]},buildTicks:function(){var t=this._getLabels(),e=this.minIndex,n=this.maxIndex;this.ticks=0===e&&n===t.length-1?t:t.slice(e,n+1)},getLabelForIndex:function(t,e){var n=this.chart;return n.getDatasetMeta(e).controller._getValueScaleId()===this.id?this.getRightValue(n.data.datasets[e].data[t]):this._getLabels()[t]},_configure:function(){var t=this,e=t.options.offset,n=t.ticks;yn.prototype._configure.call(t),t.isHorizontal()||(t._reversePixels=!t._reversePixels),n&&(t._startValue=t.minIndex-(e?.5:0),t._valueRange=Math.max(n.length-(e?0:1),1))},getPixelForValue:function(t,e,n){var i,a,r,o=this;return _n(e)||_n(n)||(t=o.chart.data.datasets[n].data[e]),_n(t)||(i=o.isHorizontal()?t.x:t.y),(void 0!==i||void 0!==t&&isNaN(e))&&(a=o._getLabels(),t=H.valueOrDefault(i,t),e=-1!==(r=a.indexOf(t))?r:e,isNaN(e)&&(e=t)),o.getPixelForDecimal((e-o._startValue)/o._valueRange)},getPixelForTick:function(t){var e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t],t+this.minIndex)},getValueForPixel:function(t){var e=Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange);return Math.min(Math.max(e,0),this.ticks.length-1)},getBasePixel:function(){return this.bottom}}),wn={position:"bottom"};kn._defaults=wn;var Mn=H.noop,Sn=H.isNullOrUndef;var Cn=yn.extend({getRightValue:function(t){return"string"==typeof t?+t:yn.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;if(e.beginAtZero){var n=H.sign(t.min),i=H.sign(t.max);n<0&&i<0?t.max=0:n>0&&i>0&&(t.min=0)}var a=void 0!==e.min||void 0!==e.suggestedMin,r=void 0!==e.max||void 0!==e.suggestedMax;void 0!==e.min?t.min=e.min:void 0!==e.suggestedMin&&(null===t.min?t.min=e.suggestedMin:t.min=Math.min(t.min,e.suggestedMin)),void 0!==e.max?t.max=e.max:void 0!==e.suggestedMax&&(null===t.max?t.max=e.suggestedMax:t.max=Math.max(t.max,e.suggestedMax)),a!==r&&t.min>=t.max&&(a?t.max=t.min+1:t.min=t.max-1),t.min===t.max&&(t.max++,e.beginAtZero||t.min--)},getTickLimit:function(){var t,e=this.options.ticks,n=e.stepSize,i=e.maxTicksLimit;return n?t=Math.ceil(this.max/n)-Math.floor(this.min/n)+1:(t=this._computeTickLimit(),i=i||11),i&&(t=Math.min(i,t)),t},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:Mn,buildTicks:function(){var t=this,e=t.options.ticks,n=t.getTickLimit(),i={maxTicks:n=Math.max(2,n),min:e.min,max:e.max,precision:e.precision,stepSize:H.valueOrDefault(e.fixedStepSize,e.stepSize)},a=t.ticks=function(t,e){var n,i,a,r,o=[],s=t.stepSize,l=s||1,u=t.maxTicks-1,d=t.min,h=t.max,c=t.precision,f=e.min,g=e.max,p=H.niceNum((g-f)/u/l)*l;if(p<1e-14&&Sn(d)&&Sn(h))return[f,g];(r=Math.ceil(g/p)-Math.floor(f/p))>u&&(p=H.niceNum(r*p/u/l)*l),s||Sn(c)?n=Math.pow(10,H._decimalPlaces(p)):(n=Math.pow(10,c),p=Math.ceil(p*n)/n),i=Math.floor(f/p)*p,a=Math.ceil(g/p)*p,s&&(!Sn(d)&&H.almostWhole(d/p,p/1e3)&&(i=d),!Sn(h)&&H.almostWhole(h/p,p/1e3)&&(a=h)),r=(a-i)/p,r=H.almostEquals(r,Math.round(r),p/1e3)?Math.round(r):Math.ceil(r),i=Math.round(i*n)/n,a=Math.round(a*n)/n,o.push(Sn(d)?i:d);for(var m=1;m<r;++m)o.push(Math.round((i+m*p)*n)/n);return o.push(Sn(h)?a:h),o}(i,t);t.handleDirectionalChanges(),t.max=H.max(a),t.min=H.min(a),e.reverse?(a.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),yn.prototype.convertTicksToLabels.call(t)},_configure:function(){var t,e=this,n=e.getTicks(),i=e.min,a=e.max;yn.prototype._configure.call(e),e.options.offset&&n.length&&(i-=t=(a-i)/Math.max(n.length-1,1)/2,a+=t),e._startValue=i,e._endValue=a,e._valueRange=a-i}}),Pn={position:"left",ticks:{callback:on.formatters.linear}};function An(t,e,n,i){var a,r,o=t.options,s=function(t,e,n){var i=[n.type,void 0===e&&void 0===n.stack?n.index:"",n.stack].join(".");return void 0===t[i]&&(t[i]={pos:[],neg:[]}),t[i]}(e,o.stacked,n),l=s.pos,u=s.neg,d=i.length;for(a=0;a<d;++a)r=t._parseValue(i[a]),isNaN(r.min)||isNaN(r.max)||n.data[a].hidden||(l[a]=l[a]||0,u[a]=u[a]||0,o.relativePoints?l[a]=100:r.min<0||r.max<0?u[a]+=r.min:l[a]+=r.max)}function Dn(t,e,n){var i,a,r=n.length;for(i=0;i<r;++i)a=t._parseValue(n[i]),isNaN(a.min)||isNaN(a.max)||e.data[i].hidden||(t.min=Math.min(t.min,a.min),t.max=Math.max(t.max,a.max))}var Tn=Cn.extend({determineDataLimits:function(){var t,e,n,i,a=this,r=a.options,o=a.chart.data.datasets,s=a._getMatchingVisibleMetas(),l=r.stacked,u={},d=s.length;if(a.min=Number.POSITIVE_INFINITY,a.max=Number.NEGATIVE_INFINITY,void 0===l)for(t=0;!l&&t<d;++t)l=void 0!==(e=s[t]).stack;for(t=0;t<d;++t)n=o[(e=s[t]).index].data,l?An(a,u,e,n):Dn(a,e,n);H.each(u,(function(t){i=t.pos.concat(t.neg),a.min=Math.min(a.min,H.min(i)),a.max=Math.max(a.max,H.max(i))})),a.min=H.isFinite(a.min)&&!isNaN(a.min)?a.min:0,a.max=H.isFinite(a.max)&&!isNaN(a.max)?a.max:1,a.handleTickRangeOptions()},_computeTickLimit:function(){var t;return this.isHorizontal()?Math.ceil(this.width/40):(t=H.options._parseFont(this.options.ticks),Math.ceil(this.height/t.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return this._getScaleLabel(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){return this.getPixelForDecimal((+this.getRightValue(t)-this._startValue)/this._valueRange)},getValueForPixel:function(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange},getPixelForTick:function(t){var e=this.ticksAsNumbers;return t<0||t>e.length-1?null:this.getPixelForValue(e[t])}}),In=Pn;Tn._defaults=In;var Fn=H.valueOrDefault,On=H.math.log10;var Ln={position:"left",ticks:{callback:on.formatters.logarithmic}};function Rn(t,e){return H.isFinite(t)&&t>=0?t:e}var zn=yn.extend({determineDataLimits:function(){var t,e,n,i,a,r,o=this,s=o.options,l=o.chart,u=l.data.datasets,d=o.isHorizontal();function h(t){return d?t.xAxisID===o.id:t.yAxisID===o.id}o.min=Number.POSITIVE_INFINITY,o.max=Number.NEGATIVE_INFINITY,o.minNotZero=Number.POSITIVE_INFINITY;var c=s.stacked;if(void 0===c)for(t=0;t<u.length;t++)if(e=l.getDatasetMeta(t),l.isDatasetVisible(t)&&h(e)&&void 0!==e.stack){c=!0;break}if(s.stacked||c){var f={};for(t=0;t<u.length;t++){var g=[(e=l.getDatasetMeta(t)).type,void 0===s.stacked&&void 0===e.stack?t:"",e.stack].join(".");if(l.isDatasetVisible(t)&&h(e))for(void 0===f[g]&&(f[g]=[]),a=0,r=(i=u[t].data).length;a<r;a++){var p=f[g];n=o._parseValue(i[a]),isNaN(n.min)||isNaN(n.max)||e.data[a].hidden||n.min<0||n.max<0||(p[a]=p[a]||0,p[a]+=n.max)}}H.each(f,(function(t){if(t.length>0){var e=H.min(t),n=H.max(t);o.min=Math.min(o.min,e),o.max=Math.max(o.max,n)}}))}else for(t=0;t<u.length;t++)if(e=l.getDatasetMeta(t),l.isDatasetVisible(t)&&h(e))for(a=0,r=(i=u[t].data).length;a<r;a++)n=o._parseValue(i[a]),isNaN(n.min)||isNaN(n.max)||e.data[a].hidden||n.min<0||n.max<0||(o.min=Math.min(n.min,o.min),o.max=Math.max(n.max,o.max),0!==n.min&&(o.minNotZero=Math.min(n.min,o.minNotZero)));o.min=H.isFinite(o.min)?o.min:null,o.max=H.isFinite(o.max)?o.max:null,o.minNotZero=H.isFinite(o.minNotZero)?o.minNotZero:null,this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;t.min=Rn(e.min,t.min),t.max=Rn(e.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(On(t.min))-1),t.max=Math.pow(10,Math.floor(On(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(On(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(On(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(On(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,e=t.options.ticks,n=!t.isHorizontal(),i={min:Rn(e.min),max:Rn(e.max)},a=t.ticks=function(t,e){var n,i,a=[],r=Fn(t.min,Math.pow(10,Math.floor(On(e.min)))),o=Math.floor(On(e.max)),s=Math.ceil(e.max/Math.pow(10,o));0===r?(n=Math.floor(On(e.minNotZero)),i=Math.floor(e.minNotZero/Math.pow(10,n)),a.push(r),r=i*Math.pow(10,n)):(n=Math.floor(On(r)),i=Math.floor(r/Math.pow(10,n)));var l=n<0?Math.pow(10,Math.abs(n)):1;do{a.push(r),10===++i&&(i=1,l=++n>=0?1:l),r=Math.round(i*Math.pow(10,n)*l)/l}while(n<o||n===o&&i<s);var u=Fn(t.max,r);return a.push(u),a}(i,t);t.max=H.max(a),t.min=H.min(a),e.reverse?(n=!n,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),n&&a.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),yn.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return this._getScaleLabel(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){var e=this.tickValues;return t<0||t>e.length-1?null:this.getPixelForValue(e[t])},_getFirstTickValue:function(t){var e=Math.floor(On(t));return Math.floor(t/Math.pow(10,e))*Math.pow(10,e)},_configure:function(){var t=this,e=t.min,n=0;yn.prototype._configure.call(t),0===e&&(e=t._getFirstTickValue(t.minNotZero),n=Fn(t.options.ticks.fontSize,N.global.defaultFontSize)/t._length),t._startValue=On(e),t._valueOffset=n,t._valueRange=(On(t.max)-On(e))/(1-n)},getPixelForValue:function(t){var e=this,n=0;return(t=+e.getRightValue(t))>e.min&&t>0&&(n=(On(t)-e._startValue)/e._valueRange+e._valueOffset),e.getPixelForDecimal(n)},getValueForPixel:function(t){var e=this,n=e.getDecimalForPixel(t);return 0===n&&0===e.min?0:Math.pow(10,e._startValue+(n-e._valueOffset)*e._valueRange)}}),Nn=Ln;zn._defaults=Nn;var Bn=H.valueOrDefault,En=H.valueAtIndexOrDefault,Wn=H.options.resolve,Vn={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:on.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function Hn(t){var e=t.ticks;return e.display&&t.display?Bn(e.fontSize,N.global.defaultFontSize)+2*e.backdropPaddingY:0}function jn(t,e,n,i,a){return t===i||t===a?{start:e-n/2,end:e+n/2}:t<i||t>a?{start:e-n,end:e}:{start:e,end:e+n}}function qn(t){return 0===t||180===t?"center":t<180?"left":"right"}function Un(t,e,n,i){var a,r,o=n.y+i/2;if(H.isArray(e))for(a=0,r=e.length;a<r;++a)t.fillText(e[a],n.x,o),o+=i;else t.fillText(e,n.x,o)}function Yn(t,e,n){90===t||270===t?n.y-=e.h/2:(t>270||t<90)&&(n.y-=e.h)}function Gn(t){return H.isNumber(t)?t:0}var Xn=Cn.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=Hn(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var t=this,e=t.chart,n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;H.each(e.data.datasets,(function(a,r){if(e.isDatasetVisible(r)){var o=e.getDatasetMeta(r);H.each(a.data,(function(e,a){var r=+t.getRightValue(e);isNaN(r)||o.data[a].hidden||(n=Math.min(r,n),i=Math.max(r,i))}))}})),t.min=n===Number.POSITIVE_INFINITY?0:n,t.max=i===Number.NEGATIVE_INFINITY?0:i,t.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Hn(this.options))},convertTicksToLabels:function(){var t=this;Cn.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map((function(){var e=H.callback(t.options.pointLabels.callback,arguments,t);return e||0===e?e:""}))},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,n,i,a=H.options._parseFont(t.options.pointLabels),r={l:0,r:t.width,t:0,b:t.height-t.paddingTop},o={};t.ctx.font=a.string,t._pointLabelSizes=[];var s,l,u,d=t.chart.data.labels.length;for(e=0;e<d;e++){i=t.getPointPosition(e,t.drawingArea+5),s=t.ctx,l=a.lineHeight,u=t.pointLabels[e],n=H.isArray(u)?{w:H.longestText(s,s.font,u),h:u.length*l}:{w:s.measureText(u).width,h:l},t._pointLabelSizes[e]=n;var h=t.getIndexAngle(e),c=H.toDegrees(h)%360,f=jn(c,i.x,n.w,0,180),g=jn(c,i.y,n.h,90,270);f.start<r.l&&(r.l=f.start,o.l=h),f.end>r.r&&(r.r=f.end,o.r=h),g.start<r.t&&(r.t=g.start,o.t=h),g.end>r.b&&(r.b=g.end,o.b=h)}t.setReductions(t.drawingArea,r,o)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,n){var i=this,a=e.l/Math.sin(n.l),r=Math.max(e.r-i.width,0)/Math.sin(n.r),o=-e.t/Math.cos(n.t),s=-Math.max(e.b-(i.height-i.paddingTop),0)/Math.cos(n.b);a=Gn(a),r=Gn(r),o=Gn(o),s=Gn(s),i.drawingArea=Math.min(Math.floor(t-(a+r)/2),Math.floor(t-(o+s)/2)),i.setCenterPoint(a,r,o,s)},setCenterPoint:function(t,e,n,i){var a=this,r=a.width-e-a.drawingArea,o=t+a.drawingArea,s=n+a.drawingArea,l=a.height-a.paddingTop-i-a.drawingArea;a.xCenter=Math.floor((o+r)/2+a.left),a.yCenter=Math.floor((s+l)/2+a.top+a.paddingTop)},getIndexAngle:function(t){var e=this.chart,n=(t*(360/e.data.labels.length)+((e.options||{}).startAngle||0))%360;return(n<0?n+360:n)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(H.isNullOrUndef(t))return NaN;var n=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*n:(t-e.min)*n},getPointPosition:function(t,e){var n=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(n)*e+this.xCenter,y:Math.sin(n)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(t){var e=this.min,n=this.max;return this.getPointPositionForValue(t||0,this.beginAtZero?0:e<0&&n<0?n:e>0&&n>0?e:0)},_drawGrid:function(){var t,e,n,i=this,a=i.ctx,r=i.options,o=r.gridLines,s=r.angleLines,l=Bn(s.lineWidth,o.lineWidth),u=Bn(s.color,o.color);if(r.pointLabels.display&&function(t){var e=t.ctx,n=t.options,i=n.pointLabels,a=Hn(n),r=t.getDistanceFromCenterForValue(n.ticks.reverse?t.min:t.max),o=H.options._parseFont(i);e.save(),e.font=o.string,e.textBaseline="middle";for(var s=t.chart.data.labels.length-1;s>=0;s--){var l=0===s?a/2:0,u=t.getPointPosition(s,r+l+5),d=En(i.fontColor,s,N.global.defaultFontColor);e.fillStyle=d;var h=t.getIndexAngle(s),c=H.toDegrees(h);e.textAlign=qn(c),Yn(c,t._pointLabelSizes[s],u),Un(e,t.pointLabels[s],u,o.lineHeight)}e.restore()}(i),o.display&&H.each(i.ticks,(function(t,n){0!==n&&(e=i.getDistanceFromCenterForValue(i.ticksAsNumbers[n]),function(t,e,n,i){var a,r=t.ctx,o=e.circular,s=t.chart.data.labels.length,l=En(e.color,i-1),u=En(e.lineWidth,i-1);if((o||s)&&l&&u){if(r.save(),r.strokeStyle=l,r.lineWidth=u,r.setLineDash&&(r.setLineDash(e.borderDash||[]),r.lineDashOffset=e.borderDashOffset||0),r.beginPath(),o)r.arc(t.xCenter,t.yCenter,n,0,2*Math.PI);else{a=t.getPointPosition(0,n),r.moveTo(a.x,a.y);for(var d=1;d<s;d++)a=t.getPointPosition(d,n),r.lineTo(a.x,a.y)}r.closePath(),r.stroke(),r.restore()}}(i,o,e,n))})),s.display&&l&&u){for(a.save(),a.lineWidth=l,a.strokeStyle=u,a.setLineDash&&(a.setLineDash(Wn([s.borderDash,o.borderDash,[]])),a.lineDashOffset=Wn([s.borderDashOffset,o.borderDashOffset,0])),t=i.chart.data.labels.length-1;t>=0;t--)e=i.getDistanceFromCenterForValue(r.ticks.reverse?i.min:i.max),n=i.getPointPosition(t,e),a.beginPath(),a.moveTo(i.xCenter,i.yCenter),a.lineTo(n.x,n.y),a.stroke();a.restore()}},_drawLabels:function(){var t=this,e=t.ctx,n=t.options.ticks;if(n.display){var i,a,r=t.getIndexAngle(0),o=H.options._parseFont(n),s=Bn(n.fontColor,N.global.defaultFontColor);e.save(),e.font=o.string,e.translate(t.xCenter,t.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",H.each(t.ticks,(function(r,l){(0!==l||n.reverse)&&(i=t.getDistanceFromCenterForValue(t.ticksAsNumbers[l]),n.showLabelBackdrop&&(a=e.measureText(r).width,e.fillStyle=n.backdropColor,e.fillRect(-a/2-n.backdropPaddingX,-i-o.size/2-n.backdropPaddingY,a+2*n.backdropPaddingX,o.size+2*n.backdropPaddingY)),e.fillStyle=s,e.fillText(r,0,-i))})),e.restore()}},_drawTitle:H.noop}),Kn=Vn;Xn._defaults=Kn;var Zn=H._deprecated,$n=H.options.resolve,Jn=H.valueOrDefault,Qn=Number.MIN_SAFE_INTEGER||-9007199254740991,ti=Number.MAX_SAFE_INTEGER||9007199254740991,ei={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ni=Object.keys(ei);function ii(t,e){return t-e}function ai(t){return H.valueOrDefault(t.time.min,t.ticks.min)}function ri(t){return H.valueOrDefault(t.time.max,t.ticks.max)}function oi(t,e,n,i){var a=function(t,e,n){for(var i,a,r,o=0,s=t.length-1;o>=0&&o<=s;){if(a=t[(i=o+s>>1)-1]||null,r=t[i],!a)return{lo:null,hi:r};if(r[e]<n)o=i+1;else{if(!(a[e]>n))return{lo:a,hi:r};s=i-1}}return{lo:r,hi:null}}(t,e,n),r=a.lo?a.hi?a.lo:t[t.length-2]:t[0],o=a.lo?a.hi?a.hi:t[t.length-1]:t[1],s=o[e]-r[e],l=s?(n-r[e])/s:0,u=(o[i]-r[i])*l;return r[i]+u}function si(t,e){var n=t._adapter,i=t.options.time,a=i.parser,r=a||i.format,o=e;return"function"==typeof a&&(o=a(o)),H.isFinite(o)||(o="string"==typeof r?n.parse(o,r):n.parse(o)),null!==o?+o:(a||"function"!=typeof r||(o=r(e),H.isFinite(o)||(o=n.parse(o))),o)}function li(t,e){if(H.isNullOrUndef(e))return null;var n=t.options.time,i=si(t,t.getRightValue(e));return null===i?i:(n.round&&(i=+t._adapter.startOf(i,n.round)),i)}function ui(t,e,n,i){var a,r,o,s=ni.length;for(a=ni.indexOf(t);a<s-1;++a)if(o=(r=ei[ni[a]]).steps?r.steps:ti,r.common&&Math.ceil((n-e)/(o*r.size))<=i)return ni[a];return ni[s-1]}function di(t,e,n){var i,a,r=[],o={},s=e.length;for(i=0;i<s;++i)o[a=e[i]]=i,r.push({value:a,major:!1});return 0!==s&&n?function(t,e,n,i){var a,r,o=t._adapter,s=+o.startOf(e[0].value,i),l=e[e.length-1].value;for(a=s;a<=l;a=+o.add(a,1,i))(r=n[a])>=0&&(e[r].major=!0);return e}(t,r,o,n):r}var hi=yn.extend({initialize:function(){this.mergeTicksOptions(),yn.prototype.initialize.call(this)},update:function(){var t=this,e=t.options,n=e.time||(e.time={}),i=t._adapter=new rn._date(e.adapters.date);return Zn("time scale",n.format,"time.format","time.parser"),Zn("time scale",n.min,"time.min","ticks.min"),Zn("time scale",n.max,"time.max","ticks.max"),H.mergeIf(n.displayFormats,i.formats()),yn.prototype.update.apply(t,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),yn.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t,e,n,i,a,r,o,s=this,l=s.chart,u=s._adapter,d=s.options,h=d.time.unit||"day",c=ti,f=Qn,g=[],p=[],m=[],v=s._getLabels();for(t=0,n=v.length;t<n;++t)m.push(li(s,v[t]));for(t=0,n=(l.data.datasets||[]).length;t<n;++t)if(l.isDatasetVisible(t))if(a=l.data.datasets[t].data,H.isObject(a[0]))for(p[t]=[],e=0,i=a.length;e<i;++e)r=li(s,a[e]),g.push(r),p[t][e]=r;else p[t]=m.slice(0),o||(g=g.concat(m),o=!0);else p[t]=[];m.length&&(c=Math.min(c,m[0]),f=Math.max(f,m[m.length-1])),g.length&&(g=n>1?function(t){var e,n,i,a={},r=[];for(e=0,n=t.length;e<n;++e)a[i=t[e]]||(a[i]=!0,r.push(i));return r}(g).sort(ii):g.sort(ii),c=Math.min(c,g[0]),f=Math.max(f,g[g.length-1])),c=li(s,ai(d))||c,f=li(s,ri(d))||f,c=c===ti?+u.startOf(Date.now(),h):c,f=f===Qn?+u.endOf(Date.now(),h)+1:f,s.min=Math.min(c,f),s.max=Math.max(c+1,f),s._table=[],s._timestamps={data:g,datasets:p,labels:m}},buildTicks:function(){var t,e,n,i=this,a=i.min,r=i.max,o=i.options,s=o.ticks,l=o.time,u=i._timestamps,d=[],h=i.getLabelCapacity(a),c=s.source,f=o.distribution;for(u="data"===c||"auto"===c&&"series"===f?u.data:"labels"===c?u.labels:function(t,e,n,i){var a,r=t._adapter,o=t.options,s=o.time,l=s.unit||ui(s.minUnit,e,n,i),u=$n([s.stepSize,s.unitStepSize,1]),d="week"===l&&s.isoWeekday,h=e,c=[];if(d&&(h=+r.startOf(h,"isoWeek",d)),h=+r.startOf(h,d?"day":l),r.diff(n,e,l)>1e5*u)throw e+" and "+n+" are too far apart with stepSize of "+u+" "+l;for(a=h;a<n;a=+r.add(a,u,l))c.push(a);return a!==n&&"ticks"!==o.bounds||c.push(a),c}(i,a,r,h),"ticks"===o.bounds&&u.length&&(a=u[0],r=u[u.length-1]),a=li(i,ai(o))||a,r=li(i,ri(o))||r,t=0,e=u.length;t<e;++t)(n=u[t])>=a&&n<=r&&d.push(n);return i.min=a,i.max=r,i._unit=l.unit||(s.autoSkip?ui(l.minUnit,i.min,i.max,h):function(t,e,n,i,a){var r,o;for(r=ni.length-1;r>=ni.indexOf(n);r--)if(o=ni[r],ei[o].common&&t._adapter.diff(a,i,o)>=e-1)return o;return ni[n?ni.indexOf(n):0]}(i,d.length,l.minUnit,i.min,i.max)),i._majorUnit=s.major.enabled&&"year"!==i._unit?function(t){for(var e=ni.indexOf(t)+1,n=ni.length;e<n;++e)if(ei[ni[e]].common)return ni[e]}(i._unit):void 0,i._table=function(t,e,n,i){if("linear"===i||!t.length)return[{time:e,pos:0},{time:n,pos:1}];var a,r,o,s,l,u=[],d=[e];for(a=0,r=t.length;a<r;++a)(s=t[a])>e&&s<n&&d.push(s);for(d.push(n),a=0,r=d.length;a<r;++a)l=d[a+1],o=d[a-1],s=d[a],void 0!==o&&void 0!==l&&Math.round((l+o)/2)===s||u.push({time:s,pos:a/(r-1)});return u}(i._timestamps.data,a,r,f),i._offsets=function(t,e,n,i,a){var r,o,s=0,l=0;return a.offset&&e.length&&(r=oi(t,"time",e[0],"pos"),s=1===e.length?1-r:(oi(t,"time",e[1],"pos")-r)/2,o=oi(t,"time",e[e.length-1],"pos"),l=1===e.length?o:(o-oi(t,"time",e[e.length-2],"pos"))/2),{start:s,end:l,factor:1/(s+1+l)}}(i._table,d,0,0,o),s.reverse&&d.reverse(),di(i,d,i._majorUnit)},getLabelForIndex:function(t,e){var n=this,i=n._adapter,a=n.chart.data,r=n.options.time,o=a.labels&&t<a.labels.length?a.labels[t]:"",s=a.datasets[e].data[t];return H.isObject(s)&&(o=n.getRightValue(s)),r.tooltipFormat?i.format(si(n,o),r.tooltipFormat):"string"==typeof o?o:i.format(si(n,o),r.displayFormats.datetime)},tickFormatFunction:function(t,e,n,i){var a=this._adapter,r=this.options,o=r.time.displayFormats,s=o[this._unit],l=this._majorUnit,u=o[l],d=n[e],h=r.ticks,c=l&&u&&d&&d.major,f=a.format(t,i||(c?u:s)),g=c?h.major:h.minor,p=$n([g.callback,g.userCallback,h.callback,h.userCallback]);return p?p(f,e,n):f},convertTicksToLabels:function(t){var e,n,i=[];for(e=0,n=t.length;e<n;++e)i.push(this.tickFormatFunction(t[e].value,e,t));return i},getPixelForOffset:function(t){var e=this._offsets,n=oi(this._table,"time",t,"pos");return this.getPixelForDecimal((e.start+n)*e.factor)},getPixelForValue:function(t,e,n){var i=null;if(void 0!==e&&void 0!==n&&(i=this._timestamps.datasets[n][e]),null===i&&(i=li(this,t)),null!==i)return this.getPixelForOffset(i)},getPixelForTick:function(t){var e=this.getTicks();return t>=0&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end,i=oi(this._table,"pos",n,"time");return this._adapter._create(i)},_getLabelSize:function(t){var e=this.options.ticks,n=this.ctx.measureText(t).width,i=H.toRadians(this.isHorizontal()?e.maxRotation:e.minRotation),a=Math.cos(i),r=Math.sin(i),o=Jn(e.fontSize,N.global.defaultFontSize);return{w:n*a+o*r,h:n*r+o*a}},getLabelWidth:function(t){return this._getLabelSize(t).w},getLabelCapacity:function(t){var e=this,n=e.options.time,i=n.displayFormats,a=i[n.unit]||i.millisecond,r=e.tickFormatFunction(t,0,di(e,[t],e._majorUnit),a),o=e._getLabelSize(r),s=Math.floor(e.isHorizontal()?e.width/o.w:e.height/o.h);return e.options.offset&&s--,s>0?s:1}}),ci={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};hi._defaults=ci;var fi={category:kn,linear:Tn,logarithmic:zn,radialLinear:Xn,time:hi},gi={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};rn._date.override("function"==typeof t?{_id:"moment",formats:function(){return gi},parse:function(e,n){return"string"==typeof e&&"string"==typeof n?e=t(e,n):e instanceof t||(e=t(e)),e.isValid()?e.valueOf():null},format:function(e,n){return t(e).format(n)},add:function(e,n,i){return t(e).add(n,i).valueOf()},diff:function(e,n,i){return t(e).diff(t(n),i)},startOf:function(e,n,i){return e=t(e),"isoWeek"===n?e.isoWeekday(i).valueOf():e.startOf(n).valueOf()},endOf:function(e,n){return t(e).endOf(n).valueOf()},_create:function(e){return t(e)}}:{}),N._set("global",{plugins:{filler:{propagate:!0}}});var pi={dataset:function(t){var e=t.fill,n=t.chart,i=n.getDatasetMeta(e),a=i&&n.isDatasetVisible(e)&&i.dataset._children||[],r=a.length||0;return r?function(t,e){return e<r&&a[e]._view||null}:null},boundary:function(t){var e=t.boundary,n=e?e.x:null,i=e?e.y:null;return H.isArray(e)?function(t,n){return e[n]}:function(t){return{x:null===n?t.x:n,y:null===i?t.y:i}}}};function mi(t,e,n){var i,a=t._model||{},r=a.fill;if(void 0===r&&(r=!!a.backgroundColor),!1===r||null===r)return!1;if(!0===r)return"origin";if(i=parseFloat(r,10),isFinite(i)&&Math.floor(i)===i)return"-"!==r[0]&&"+"!==r[0]||(i=e+i),!(i===e||i<0||i>=n)&&i;switch(r){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return r;default:return!1}}function vi(t){return(t.el._scale||{}).getPointPositionForValue?function(t){var e,n,i,a,r,o=t.el._scale,s=o.options,l=o.chart.data.labels.length,u=t.fill,d=[];if(!l)return null;for(e=s.ticks.reverse?o.max:o.min,n=s.ticks.reverse?o.min:o.max,i=o.getPointPositionForValue(0,e),a=0;a<l;++a)r="start"===u||"end"===u?o.getPointPositionForValue(a,"start"===u?e:n):o.getBasePosition(a),s.gridLines.circular&&(r.cx=i.x,r.cy=i.y,r.angle=o.getIndexAngle(a)-Math.PI/2),d.push(r);return d}(t):function(t){var e,n=t.el._model||{},i=t.el._scale||{},a=t.fill,r=null;if(isFinite(a))return null;if("start"===a?r=void 0===n.scaleBottom?i.bottom:n.scaleBottom:"end"===a?r=void 0===n.scaleTop?i.top:n.scaleTop:void 0!==n.scaleZero?r=n.scaleZero:i.getBasePixel&&(r=i.getBasePixel()),null!=r){if(void 0!==r.x&&void 0!==r.y)return r;if(H.isFinite(r))return{x:(e=i.isHorizontal())?r:null,y:e?null:r}}return null}(t)}function bi(t,e,n){var i,a=t[e].fill,r=[e];if(!n)return a;for(;!1!==a&&-1===r.indexOf(a);){if(!isFinite(a))return a;if(!(i=t[a]))return!1;if(i.visible)return a;r.push(a),a=i.fill}return!1}function xi(t){var e=t.fill,n="dataset";return!1===e?null:(isFinite(e)||(n="boundary"),pi[n](t))}function yi(t){return t&&!t.skip}function _i(t,e,n,i,a){var r,o,s,l;if(i&&a){for(t.moveTo(e[0].x,e[0].y),r=1;r<i;++r)H.canvas.lineTo(t,e[r-1],e[r]);if(void 0===n[0].angle)for(t.lineTo(n[a-1].x,n[a-1].y),r=a-1;r>0;--r)H.canvas.lineTo(t,n[r],n[r-1],!0);else for(o=n[0].cx,s=n[0].cy,l=Math.sqrt(Math.pow(n[0].x-o,2)+Math.pow(n[0].y-s,2)),r=a-1;r>0;--r)t.arc(o,s,l,n[r].angle,n[r-1].angle,!0)}}function ki(t,e,n,i,a,r){var o,s,l,u,d,h,c,f,g=e.length,p=i.spanGaps,m=[],v=[],b=0,x=0;for(t.beginPath(),o=0,s=g;o<s;++o)d=n(u=e[l=o%g]._view,l,i),h=yi(u),c=yi(d),r&&void 0===f&&h&&(s=g+(f=o+1)),h&&c?(b=m.push(u),x=v.push(d)):b&&x&&(p?(h&&m.push(u),c&&v.push(d)):(_i(t,m,v,b,x),b=x=0,m=[],v=[]));_i(t,m,v,b,x),t.closePath(),t.fillStyle=a,t.fill()}var wi={id:"filler",afterDatasetsUpdate:function(t,e){var n,i,a,r,o=(t.data.datasets||[]).length,s=e.propagate,l=[];for(i=0;i<o;++i)r=null,(a=(n=t.getDatasetMeta(i)).dataset)&&a._model&&a instanceof kt.Line&&(r={visible:t.isDatasetVisible(i),fill:mi(a,i,o),chart:t,el:a}),n.$filler=r,l.push(r);for(i=0;i<o;++i)(r=l[i])&&(r.fill=bi(l,i,s),r.boundary=vi(r),r.mapper=xi(r))},beforeDatasetsDraw:function(t){var e,n,i,a,r,o,s,l=t._getSortedVisibleDatasetMetas(),u=t.ctx;for(n=l.length-1;n>=0;--n)(e=l[n].$filler)&&e.visible&&(a=(i=e.el)._view,r=i._children||[],o=e.mapper,s=a.backgroundColor||N.global.defaultColor,o&&s&&r.length&&(H.canvas.clipArea(u,t.chartArea),ki(u,r,o,a,s,i._loop),H.canvas.unclipArea(u)))}},Mi=H.rtl.getRtlAdapter,Si=H.noop,Ci=H.valueOrDefault;function Pi(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}N._set("global",{legend:{display:!0,position:"top",align:"center",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(t,e){var n=e.datasetIndex,i=this.chart,a=i.getDatasetMeta(n);a.hidden=null===a.hidden?!i.data.datasets[n].hidden:null,i.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(t){var e=t.data.datasets,n=t.options.legend||{},i=n.labels&&n.labels.usePointStyle;return t._getSortedDatasetMetas().map((function(n){var a=n.controller.getStyle(i?0:void 0);return{text:e[n.index].label,fillStyle:a.backgroundColor,hidden:!t.isDatasetVisible(n.index),lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:a.borderWidth,strokeStyle:a.borderColor,pointStyle:a.pointStyle,rotation:a.rotation,datasetIndex:n.index}}),this)}}},legendCallback:function(t){var e,n,i,a=document.createElement("ul"),r=t.data.datasets;for(a.setAttribute("class",t.id+"-legend"),e=0,n=r.length;e<n;e++)(i=a.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=r[e].backgroundColor,r[e].label&&i.appendChild(document.createTextNode(r[e].label));return a.outerHTML}});var Ai=K.extend({initialize:function(t){H.extend(this,t),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:Si,update:function(t,e,n){var i=this;return i.beforeUpdate(),i.maxWidth=t,i.maxHeight=e,i.margins=n,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:Si,beforeSetDimensions:Si,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:Si,beforeBuildLabels:Si,buildLabels:function(){var t=this,e=t.options.labels||{},n=H.callback(e.generateLabels,[t.chart],t)||[];e.filter&&(n=n.filter((function(n){return e.filter(n,t.chart.data)}))),t.options.reverse&&n.reverse(),t.legendItems=n},afterBuildLabels:Si,beforeFit:Si,fit:function(){var t=this,e=t.options,n=e.labels,i=e.display,a=t.ctx,r=H.options._parseFont(n),o=r.size,s=t.legendHitBoxes=[],l=t.minSize,u=t.isHorizontal();if(u?(l.width=t.maxWidth,l.height=i?10:0):(l.width=i?10:0,l.height=t.maxHeight),i){if(a.font=r.string,u){var d=t.lineWidths=[0],h=0;a.textAlign="left",a.textBaseline="middle",H.each(t.legendItems,(function(t,e){var i=Pi(n,o)+o/2+a.measureText(t.text).width;(0===e||d[d.length-1]+i+2*n.padding>l.width)&&(h+=o+n.padding,d[d.length-(e>0?0:1)]=0),s[e]={left:0,top:0,width:i,height:o},d[d.length-1]+=i+n.padding})),l.height+=h}else{var c=n.padding,f=t.columnWidths=[],g=t.columnHeights=[],p=n.padding,m=0,v=0;H.each(t.legendItems,(function(t,e){var i=Pi(n,o)+o/2+a.measureText(t.text).width;e>0&&v+o+2*c>l.height&&(p+=m+n.padding,f.push(m),g.push(v),m=0,v=0),m=Math.max(m,i),v+=o+c,s[e]={left:0,top:0,width:i,height:o}})),p+=m,f.push(m),g.push(v),l.width+=p}t.width=l.width,t.height=l.height}else t.width=l.width=t.height=l.height=0},afterFit:Si,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var t=this,e=t.options,n=e.labels,i=N.global,a=i.defaultColor,r=i.elements.line,o=t.height,s=t.columnHeights,l=t.width,u=t.lineWidths;if(e.display){var d,h=Mi(e.rtl,t.left,t.minSize.width),c=t.ctx,f=Ci(n.fontColor,i.defaultFontColor),g=H.options._parseFont(n),p=g.size;c.textAlign=h.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.strokeStyle=f,c.fillStyle=f,c.font=g.string;var m=Pi(n,p),v=t.legendHitBoxes,b=function(t,i){switch(e.align){case"start":return n.padding;case"end":return t-i;default:return(t-i+n.padding)/2}},x=t.isHorizontal();d=x?{x:t.left+b(l,u[0]),y:t.top+n.padding,line:0}:{x:t.left+n.padding,y:t.top+b(o,s[0]),line:0},H.rtl.overrideTextDirection(t.ctx,e.textDirection);var y=p+n.padding;H.each(t.legendItems,(function(e,i){var f=c.measureText(e.text).width,g=m+p/2+f,_=d.x,k=d.y;h.setWidth(t.minSize.width),x?i>0&&_+g+n.padding>t.left+t.minSize.width&&(k=d.y+=y,d.line++,_=d.x=t.left+b(l,u[d.line])):i>0&&k+y>t.top+t.minSize.height&&(_=d.x=_+t.columnWidths[d.line]+n.padding,d.line++,k=d.y=t.top+b(o,s[d.line]));var w=h.x(_);!function(t,e,i){if(!(isNaN(m)||m<=0)){c.save();var o=Ci(i.lineWidth,r.borderWidth);if(c.fillStyle=Ci(i.fillStyle,a),c.lineCap=Ci(i.lineCap,r.borderCapStyle),c.lineDashOffset=Ci(i.lineDashOffset,r.borderDashOffset),c.lineJoin=Ci(i.lineJoin,r.borderJoinStyle),c.lineWidth=o,c.strokeStyle=Ci(i.strokeStyle,a),c.setLineDash&&c.setLineDash(Ci(i.lineDash,r.borderDash)),n&&n.usePointStyle){var s=m*Math.SQRT2/2,l=h.xPlus(t,m/2),u=e+p/2;H.canvas.drawPoint(c,i.pointStyle,s,l,u,i.rotation)}else c.fillRect(h.leftForLtr(t,m),e,m,p),0!==o&&c.strokeRect(h.leftForLtr(t,m),e,m,p);c.restore()}}(w,k,e),v[i].left=h.leftForLtr(w,v[i].width),v[i].top=k,function(t,e,n,i){var a=p/2,r=h.xPlus(t,m+a),o=e+a;c.fillText(n.text,r,o),n.hidden&&(c.beginPath(),c.lineWidth=2,c.moveTo(r,o),c.lineTo(h.xPlus(r,i),o),c.stroke())}(w,k,e,f),x?d.x+=g+n.padding:d.y+=y})),H.rtl.restoreTextDirection(t.ctx,e.textDirection)}},_getLegendItemAt:function(t,e){var n,i,a,r=this;if(t>=r.left&&t<=r.right&&e>=r.top&&e<=r.bottom)for(a=r.legendHitBoxes,n=0;n<a.length;++n)if(t>=(i=a[n]).left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height)return r.legendItems[n];return null},handleEvent:function(t){var e,n=this,i=n.options,a="mouseup"===t.type?"click":t.type;if("mousemove"===a){if(!i.onHover&&!i.onLeave)return}else{if("click"!==a)return;if(!i.onClick)return}e=n._getLegendItemAt(t.x,t.y),"click"===a?e&&i.onClick&&i.onClick.call(n,t.native,e):(i.onLeave&&e!==n._hoveredItem&&(n._hoveredItem&&i.onLeave.call(n,t.native,n._hoveredItem),n._hoveredItem=e),i.onHover&&e&&i.onHover.call(n,t.native,e))}});function Di(t,e){var n=new Ai({ctx:t.ctx,options:e,chart:t});pe.configure(t,n,e),pe.addBox(t,n),t.legend=n}var Ti={id:"legend",_element:Ai,beforeInit:function(t){var e=t.options.legend;e&&Di(t,e)},beforeUpdate:function(t){var e=t.options.legend,n=t.legend;e?(H.mergeIf(e,N.global.legend),n?(pe.configure(t,n,e),n.options=e):Di(t,e)):n&&(pe.removeBox(t,n),delete t.legend)},afterEvent:function(t,e){var n=t.legend;n&&n.handleEvent(e)}},Ii=H.noop;N._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var Fi=K.extend({initialize:function(t){H.extend(this,t),this.legendHitBoxes=[]},beforeUpdate:Ii,update:function(t,e,n){var i=this;return i.beforeUpdate(),i.maxWidth=t,i.maxHeight=e,i.margins=n,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:Ii,beforeSetDimensions:Ii,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:Ii,beforeBuildLabels:Ii,buildLabels:Ii,afterBuildLabels:Ii,beforeFit:Ii,fit:function(){var t,e=this,n=e.options,i=e.minSize={},a=e.isHorizontal();n.display?(t=(H.isArray(n.text)?n.text.length:1)*H.options._parseFont(n).lineHeight+2*n.padding,e.width=i.width=a?e.maxWidth:t,e.height=i.height=a?t:e.maxHeight):e.width=i.width=e.height=i.height=0},afterFit:Ii,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var t=this,e=t.ctx,n=t.options;if(n.display){var i,a,r,o=H.options._parseFont(n),s=o.lineHeight,l=s/2+n.padding,u=0,d=t.top,h=t.left,c=t.bottom,f=t.right;e.fillStyle=H.valueOrDefault(n.fontColor,N.global.defaultFontColor),e.font=o.string,t.isHorizontal()?(a=h+(f-h)/2,r=d+l,i=f-h):(a="left"===n.position?h+l:f-l,r=d+(c-d)/2,i=c-d,u=Math.PI*("left"===n.position?-.5:.5)),e.save(),e.translate(a,r),e.rotate(u),e.textAlign="center",e.textBaseline="middle";var g=n.text;if(H.isArray(g))for(var p=0,m=0;m<g.length;++m)e.fillText(g[m],0,p,i),p+=s;else e.fillText(g,0,0,i);e.restore()}}});function Oi(t,e){var n=new Fi({ctx:t.ctx,options:e,chart:t});pe.configure(t,n,e),pe.addBox(t,n),t.titleBlock=n}var Li={},Ri=wi,zi=Ti,Ni={id:"title",_element:Fi,beforeInit:function(t){var e=t.options.title;e&&Oi(t,e)},beforeUpdate:function(t){var e=t.options.title,n=t.titleBlock;e?(H.mergeIf(e,N.global.title),n?(pe.configure(t,n,e),n.options=e):Oi(t,e)):n&&(pe.removeBox(t,n),delete t.titleBlock)}};for(var Bi in Li.filler=Ri,Li.legend=zi,Li.title=Ni,en.helpers=H,function(){function t(t,e,n){var i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}function e(t){return null!=t&&"none"!==t}function n(n,i,a){var r=document.defaultView,o=H._getParentNode(n),s=r.getComputedStyle(n)[i],l=r.getComputedStyle(o)[i],u=e(s),d=e(l),h=Number.POSITIVE_INFINITY;return u||d?Math.min(u?t(s,n,a):h,d?t(l,o,a):h):"none"}H.where=function(t,e){if(H.isArray(t)&&Array.prototype.filter)return t.filter(e);var n=[];return H.each(t,(function(t){e(t)&&n.push(t)})),n},H.findIndex=Array.prototype.findIndex?function(t,e,n){return t.findIndex(e,n)}:function(t,e,n){n=void 0===n?t:n;for(var i=0,a=t.length;i<a;++i)if(e.call(n,t[i],i,t))return i;return-1},H.findNextWhere=function(t,e,n){H.isNullOrUndef(n)&&(n=-1);for(var i=n+1;i<t.length;i++){var a=t[i];if(e(a))return a}},H.findPreviousWhere=function(t,e,n){H.isNullOrUndef(n)&&(n=t.length);for(var i=n-1;i>=0;i--){var a=t[i];if(e(a))return a}},H.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},H.almostEquals=function(t,e,n){return Math.abs(t-e)<n},H.almostWhole=function(t,e){var n=Math.round(t);return n-e<=t&&n+e>=t},H.max=function(t){return t.reduce((function(t,e){return isNaN(e)?t:Math.max(t,e)}),Number.NEGATIVE_INFINITY)},H.min=function(t){return t.reduce((function(t,e){return isNaN(e)?t:Math.min(t,e)}),Number.POSITIVE_INFINITY)},H.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1},H.toRadians=function(t){return t*(Math.PI/180)},H.toDegrees=function(t){return t*(180/Math.PI)},H._decimalPlaces=function(t){if(H.isFinite(t)){for(var e=1,n=0;Math.round(t*e)/e!==t;)e*=10,n++;return n}},H.getAngleFromPoint=function(t,e){var n=e.x-t.x,i=e.y-t.y,a=Math.sqrt(n*n+i*i),r=Math.atan2(i,n);return r<-.5*Math.PI&&(r+=2*Math.PI),{angle:r,distance:a}},H.distanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},H.aliasPixel=function(t){return t%2==0?0:.5},H._alignPixel=function(t,e,n){var i=t.currentDevicePixelRatio,a=n/2;return Math.round((e-a)*i)/i+a},H.splineCurve=function(t,e,n,i){var a=t.skip?e:t,r=e,o=n.skip?e:n,s=Math.sqrt(Math.pow(r.x-a.x,2)+Math.pow(r.y-a.y,2)),l=Math.sqrt(Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)),u=s/(s+l),d=l/(s+l),h=i*(u=isNaN(u)?0:u),c=i*(d=isNaN(d)?0:d);return{previous:{x:r.x-h*(o.x-a.x),y:r.y-h*(o.y-a.y)},next:{x:r.x+c*(o.x-a.x),y:r.y+c*(o.y-a.y)}}},H.EPSILON=Number.EPSILON||1e-14,H.splineCurveMonotone=function(t){var e,n,i,a,r,o,s,l,u,d=(t||[]).map((function(t){return{model:t._model,deltaK:0,mK:0}})),h=d.length;for(e=0;e<h;++e)if(!(i=d[e]).model.skip){if(n=e>0?d[e-1]:null,(a=e<h-1?d[e+1]:null)&&!a.model.skip){var c=a.model.x-i.model.x;i.deltaK=0!==c?(a.model.y-i.model.y)/c:0}!n||n.model.skip?i.mK=i.deltaK:!a||a.model.skip?i.mK=n.deltaK:this.sign(n.deltaK)!==this.sign(i.deltaK)?i.mK=0:i.mK=(n.deltaK+i.deltaK)/2}for(e=0;e<h-1;++e)i=d[e],a=d[e+1],i.model.skip||a.model.skip||(H.almostEquals(i.deltaK,0,this.EPSILON)?i.mK=a.mK=0:(r=i.mK/i.deltaK,o=a.mK/i.deltaK,(l=Math.pow(r,2)+Math.pow(o,2))<=9||(s=3/Math.sqrt(l),i.mK=r*s*i.deltaK,a.mK=o*s*i.deltaK)));for(e=0;e<h;++e)(i=d[e]).model.skip||(n=e>0?d[e-1]:null,a=e<h-1?d[e+1]:null,n&&!n.model.skip&&(u=(i.model.x-n.model.x)/3,i.model.controlPointPreviousX=i.model.x-u,i.model.controlPointPreviousY=i.model.y-u*i.mK),a&&!a.model.skip&&(u=(a.model.x-i.model.x)/3,i.model.controlPointNextX=i.model.x+u,i.model.controlPointNextY=i.model.y+u*i.mK))},H.nextItem=function(t,e,n){return n?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},H.previousItem=function(t,e,n){return n?e<=0?t[t.length-1]:t[e-1]:e<=0?t[0]:t[e-1]},H.niceNum=function(t,e){var n=Math.floor(H.log10(t)),i=t/Math.pow(10,n);return(e?i<1.5?1:i<3?2:i<7?5:10:i<=1?1:i<=2?2:i<=5?5:10)*Math.pow(10,n)},H.requestAnimFrame="undefined"==typeof window?function(t){t()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},H.getRelativePosition=function(t,e){var n,i,a=t.originalEvent||t,r=t.target||t.srcElement,o=r.getBoundingClientRect(),s=a.touches;s&&s.length>0?(n=s[0].clientX,i=s[0].clientY):(n=a.clientX,i=a.clientY);var l=parseFloat(H.getStyle(r,"padding-left")),u=parseFloat(H.getStyle(r,"padding-top")),d=parseFloat(H.getStyle(r,"padding-right")),h=parseFloat(H.getStyle(r,"padding-bottom")),c=o.right-o.left-l-d,f=o.bottom-o.top-u-h;return{x:n=Math.round((n-o.left-l)/c*r.width/e.currentDevicePixelRatio),y:i=Math.round((i-o.top-u)/f*r.height/e.currentDevicePixelRatio)}},H.getConstraintWidth=function(t){return n(t,"max-width","clientWidth")},H.getConstraintHeight=function(t){return n(t,"max-height","clientHeight")},H._calculatePadding=function(t,e,n){return(e=H.getStyle(t,e)).indexOf("%")>-1?n*parseInt(e,10)/100:parseInt(e,10)},H._getParentNode=function(t){var e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e},H.getMaximumWidth=function(t){var e=H._getParentNode(t);if(!e)return t.clientWidth;var n=e.clientWidth,i=n-H._calculatePadding(e,"padding-left",n)-H._calculatePadding(e,"padding-right",n),a=H.getConstraintWidth(t);return isNaN(a)?i:Math.min(i,a)},H.getMaximumHeight=function(t){var e=H._getParentNode(t);if(!e)return t.clientHeight;var n=e.clientHeight,i=n-H._calculatePadding(e,"padding-top",n)-H._calculatePadding(e,"padding-bottom",n),a=H.getConstraintHeight(t);return isNaN(a)?i:Math.min(i,a)},H.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},H.retinaScale=function(t,e){var n=t.currentDevicePixelRatio=e||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==n){var i=t.canvas,a=t.height,r=t.width;i.height=a*n,i.width=r*n,t.ctx.scale(n,n),i.style.height||i.style.width||(i.style.height=a+"px",i.style.width=r+"px")}},H.fontString=function(t,e,n){return e+" "+t+"px "+n},H.longestText=function(t,e,n,i){var a=(i=i||{}).data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(a=i.data={},r=i.garbageCollect=[],i.font=e),t.font=e;var o,s,l,u,d,h=0,c=n.length;for(o=0;o<c;o++)if(null!=(u=n[o])&&!0!==H.isArray(u))h=H.measureText(t,a,r,h,u);else if(H.isArray(u))for(s=0,l=u.length;s<l;s++)null==(d=u[s])||H.isArray(d)||(h=H.measureText(t,a,r,h,d));var f=r.length/2;if(f>n.length){for(o=0;o<f;o++)delete a[r[o]];r.splice(0,f)}return h},H.measureText=function(t,e,n,i,a){var r=e[a];return r||(r=e[a]=t.measureText(a).width,n.push(a)),r>i&&(i=r),i},H.numberOfLabelLines=function(t){var e=1;return H.each(t,(function(t){H.isArray(t)&&t.length>e&&(e=t.length)})),e},H.color=_?function(t){return t instanceof CanvasGradient&&(t=N.global.defaultColor),_(t)}:function(t){return console.error("Color.js not found!"),t},H.getHoverColor=function(t){return t instanceof CanvasPattern||t instanceof CanvasGradient?t:H.color(t).saturate(.5).darken(.1).rgbString()}}(),en._adapters=rn,en.Animation=$,en.animationService=J,en.controllers=Jt,en.DatasetController=it,en.defaults=N,en.Element=K,en.elements=kt,en.Interaction=re,en.layouts=pe,en.platform=Oe,en.plugins=Le,en.Scale=yn,en.scaleService=Re,en.Ticks=on,en.Tooltip=Ye,en.helpers.each(fi,(function(t,e){en.scaleService.registerScaleType(e,t,t._defaults)})),Li)Li.hasOwnProperty(Bi)&&en.plugins.register(Li[Bi]);en.platform.initialize();var Ei=en;return"undefined"!=typeof window&&(window.Chart=en),en.Chart=en,en.Legend=Li.legend._element,en.Title=Li.title._element,en.pluginService=en.plugins,en.PluginBase=en.Element.extend({}),en.canvasHelpers=en.helpers.canvas,en.layoutService=en.layouts,en.LinearScaleBase=Cn,en.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],(function(t){en[t]=function(e,n){return new en(e,en.helpers.merge(n||{},{type:t.charAt(0).toLowerCase()+t.slice(1)}))}})),Ei}));

/*! Select2 4.0.6-rc.1 | https://github.com/select2/select2/blob/master/LICENSE.md */!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c),c}:a(jQuery)}(function(a){var b=function(){if(a&&a.fn&&a.fn.select2&&a.fn.select2.amd)var b=a.fn.select2.amd;var b;return function(){if(!b||!b.requirejs){b?c=b:b={};var a,c,d;!function(b){function e(a,b){return v.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=b&&b.split("/"),p=t.map,q=p&&p["*"]||{};if(a){for(a=a.split("/"),g=a.length-1,t.nodeIdCompat&&x.test(a[g])&&(a[g]=a[g].replace(x,"")),"."===a[0].charAt(0)&&o&&(n=o.slice(0,o.length-1),a=n.concat(a)),k=0;k<a.length;k++)if("."===(m=a[k]))a.splice(k,1),k-=1;else if(".."===m){if(0===k||1===k&&".."===a[2]||".."===a[k-1])continue;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}if((o||q)&&p){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),o)for(l=o.length;l>0;l-=1)if((e=p[o.slice(0,l).join("/")])&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&q&&q[d]&&(i=q[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,c){return function(){var d=w.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),o.apply(b,d.concat([a,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){r[a]=b}}function j(a){if(e(s,a)){var c=s[a];delete s[a],u[a]=!0,n.apply(b,c)}if(!e(r,a)&&!e(u,a))throw new Error("No "+a);return r[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return a?k(a):[]}function m(a){return function(){return t&&t.config&&t.config[a]||{}}}var n,o,p,q,r={},s={},t={},u={},v=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;p=function(a,b){var c,d=k(a),e=d[0],g=b[1];return a=d[1],e&&(e=f(e,g),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(g)):f(a,g):(a=f(a,g),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},q={require:function(a){return g(a)},exports:function(a){var b=r[a];return void 0!==b?b:r[a]={}},module:function(a){return{id:a,uri:"",exports:r[a],config:m(a)}}},n=function(a,c,d,f){var h,k,m,n,o,t,v,w=[],x=typeof d;if(f=f||a,t=l(f),"undefined"===x||"function"===x){for(c=!c.length&&d.length?["require","exports","module"]:c,o=0;o<c.length;o+=1)if(n=p(c[o],t),"require"===(k=n.f))w[o]=q.require(a);else if("exports"===k)w[o]=q.exports(a),v=!0;else if("module"===k)h=w[o]=q.module(a);else if(e(r,k)||e(s,k)||e(u,k))w[o]=j(k);else{if(!n.p)throw new Error(a+" missing "+k);n.p.load(n.n,g(f,!0),i(k),{}),w[o]=r[k]}m=d?d.apply(r[a],w):void 0,a&&(h&&h.exports!==b&&h.exports!==r[a]?r[a]=h.exports:m===b&&v||(r[a]=m))}else a&&(r[a]=d)},a=c=o=function(a,c,d,e,f){if("string"==typeof a)return q[a]?q[a](c):j(p(a,l(c)).f);if(!a.splice){if(t=a,t.deps&&o(t.deps,t.callback),!c)return;c.splice?(a=c,c=d,d=null):a=b}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?n(b,a,c,d):setTimeout(function(){n(b,a,c,d)},4),o},o.config=function(a){return o(a)},a._defined=r,d=function(a,b,c){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");b.splice||(c=b,b=[]),e(r,a)||e(s,a)||(s[a]=[a,b,c])},d.amd={jQuery:!0}}(),b.requirejs=a,b.require=c,b.define=d}}(),b.define("almond",function(){}),b.define("jquery",[],function(){var b=a||$;return null==b&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),b}),b.define("select2/utils",["jquery"],function(a){function b(a){var b=a.prototype,c=[];for(var d in b){"function"==typeof b[d]&&("constructor"!==d&&c.push(d))}return c}var c={};c.Extend=function(a,b){function c(){this.constructor=a}var d={}.hasOwnProperty;for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},c.Decorate=function(a,c){function d(){var b=Array.prototype.unshift,d=c.prototype.constructor.length,e=a.prototype.constructor;d>0&&(b.call(arguments,a.prototype.constructor),e=c.prototype.constructor),e.apply(this,arguments)}function e(){this.constructor=d}var f=b(c),g=b(a);c.displayName=a.displayName,d.prototype=new e;for(var h=0;h<g.length;h++){var i=g[h];d.prototype[i]=a.prototype[i]}for(var j=(function(a){var b=function(){};a in d.prototype&&(b=d.prototype[a]);var e=c.prototype[a];return function(){return Array.prototype.unshift.call(arguments,b),e.apply(this,arguments)}}),k=0;k<f.length;k++){var l=f[k];d.prototype[l]=j(l)}return d};var d=function(){this.listeners={}};d.prototype.on=function(a,b){this.listeners=this.listeners||{},a in this.listeners?this.listeners[a].push(b):this.listeners[a]=[b]},d.prototype.trigger=function(a){var b=Array.prototype.slice,c=b.call(arguments,1);this.listeners=this.listeners||{},null==c&&(c=[]),0===c.length&&c.push({}),c[0]._type=a,a in this.listeners&&this.invoke(this.listeners[a],b.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},d.prototype.invoke=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c].apply(this,b)},c.Observable=d,c.generateChars=function(a){for(var b="",c=0;c<a;c++){b+=Math.floor(36*Math.random()).toString(36)}return b},c.bind=function(a,b){return function(){a.apply(b,arguments)}},c._convertData=function(a){for(var b in a){var c=b.split("-"),d=a;if(1!==c.length){for(var e=0;e<c.length;e++){var f=c[e];f=f.substring(0,1).toLowerCase()+f.substring(1),f in d||(d[f]={}),e==c.length-1&&(d[f]=a[b]),d=d[f]}delete a[b]}}return a},c.hasScroll=function(b,c){var d=a(c),e=c.style.overflowX,f=c.style.overflowY;return(e!==f||"hidden"!==f&&"visible"!==f)&&("scroll"===e||"scroll"===f||(d.innerHeight()<c.scrollHeight||d.innerWidth()<c.scrollWidth))},c.escapeMarkup=function(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof a?a:String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})},c.appendMany=function(b,c){if("1.7"===a.fn.jquery.substr(0,3)){var d=a();a.map(c,function(a){d=d.add(a)}),c=d}b.append(c)},c.__cache={};var e=0;return c.GetUniqueElementId=function(a){var b=a.getAttribute("data-select2-id");return null==b&&(a.id?(b=a.id,a.setAttribute("data-select2-id",b)):(a.setAttribute("data-select2-id",++e),b=e.toString())),b},c.StoreData=function(a,b,d){var e=c.GetUniqueElementId(a);c.__cache[e]||(c.__cache[e]={}),c.__cache[e][b]=d},c.GetData=function(b,d){var e=c.GetUniqueElementId(b);return d?c.__cache[e]&&null!=c.__cache[e][d]?c.__cache[e][d]:a(b).data(d):c.__cache[e]},c.RemoveData=function(a){var b=c.GetUniqueElementId(a);null!=c.__cache[b]&&delete c.__cache[b]},c}),b.define("select2/results",["jquery","./utils"],function(a,b){function c(a,b,d){this.$element=a,this.data=d,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&b.attr("aria-multiselectable","true"),this.$results=b,b},c.prototype.clear=function(){this.$results.empty()},c.prototype.displayMessage=function(b){var c=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var d=a('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),e=this.options.get("translations").get(b.message);d.append(c(e(b.args))),d[0].className+=" select2-results__message",this.$results.append(d)},c.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},c.prototype.append=function(a){this.hideLoading();var b=[];if(null==a.results||0===a.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));a.results=this.sort(a.results);for(var c=0;c<a.results.length;c++){var d=a.results[c],e=this.option(d);b.push(e)}this.$results.append(b)},c.prototype.position=function(a,b){b.find(".select2-results").append(a)},c.prototype.sort=function(a){return this.options.get("sorter")(a)},c.prototype.highlightFirstItem=function(){var a=this.$results.find(".select2-results__option[aria-selected]"),b=a.filter("[aria-selected=true]");b.length>0?b.first().trigger("mouseenter"):a.first().trigger("mouseenter"),this.ensureHighlightVisible()},c.prototype.setClasses=function(){var c=this;this.data.current(function(d){var e=a.map(d,function(a){return a.id.toString()});c.$results.find(".select2-results__option[aria-selected]").each(function(){var c=a(this),d=b.GetData(this,"data"),f=""+d.id;null!=d.element&&d.element.selected||null==d.element&&a.inArray(f,e)>-1?c.attr("aria-selected","true"):c.attr("aria-selected","false")})})},c.prototype.showLoading=function(a){this.hideLoading();var b=this.options.get("translations").get("searching"),c={disabled:!0,loading:!0,text:b(a)},d=this.option(c);d.className+=" loading-results",this.$results.prepend(d)},c.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},c.prototype.option=function(c){var d=document.createElement("li");d.className="select2-results__option";var e={role:"treeitem","aria-selected":"false"};c.disabled&&(delete e["aria-selected"],e["aria-disabled"]="true"),null==c.id&&delete e["aria-selected"],null!=c._resultId&&(d.id=c._resultId),c.title&&(d.title=c.title),c.children&&(e.role="group",e["aria-label"]=c.text,delete e["aria-selected"]);for(var f in e){var g=e[f];d.setAttribute(f,g)}if(c.children){var h=a(d),i=document.createElement("strong");i.className="select2-results__group";a(i);this.template(c,i);for(var j=[],k=0;k<c.children.length;k++){var l=c.children[k],m=this.option(l);j.push(m)}var n=a("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});n.append(j),h.append(i),h.append(n)}else this.template(c,d);return b.StoreData(d,"data",c),d},c.prototype.bind=function(c,d){var e=this,f=c.id+"-results";this.$results.attr("id",f),c.on("results:all",function(a){e.clear(),e.append(a.data),c.isOpen()&&(e.setClasses(),e.highlightFirstItem())}),c.on("results:append",function(a){e.append(a.data),c.isOpen()&&e.setClasses()}),c.on("query",function(a){e.hideMessages(),e.showLoading(a)}),c.on("select",function(){c.isOpen()&&(e.setClasses(),e.highlightFirstItem())}),c.on("unselect",function(){c.isOpen()&&(e.setClasses(),e.highlightFirstItem())}),c.on("open",function(){e.$results.attr("aria-expanded","true"),e.$results.attr("aria-hidden","false"),e.setClasses(),e.ensureHighlightVisible()}),c.on("close",function(){e.$results.attr("aria-expanded","false"),e.$results.attr("aria-hidden","true"),e.$results.removeAttr("aria-activedescendant")}),c.on("results:toggle",function(){var a=e.getHighlightedResults();0!==a.length&&a.trigger("mouseup")}),c.on("results:select",function(){var a=e.getHighlightedResults();if(0!==a.length){var c=b.GetData(a[0],"data");"true"==a.attr("aria-selected")?e.trigger("close",{}):e.trigger("select",{data:c})}}),c.on("results:previous",function(){var a=e.getHighlightedResults(),b=e.$results.find("[aria-selected]"),c=b.index(a);if(!(c<=0)){var d=c-1;0===a.length&&(d=0);var f=b.eq(d);f.trigger("mouseenter");var g=e.$results.offset().top,h=f.offset().top,i=e.$results.scrollTop()+(h-g);0===d?e.$results.scrollTop(0):h-g<0&&e.$results.scrollTop(i)}}),c.on("results:next",function(){var a=e.getHighlightedResults(),b=e.$results.find("[aria-selected]"),c=b.index(a),d=c+1;if(!(d>=b.length)){var f=b.eq(d);f.trigger("mouseenter");var g=e.$results.offset().top+e.$results.outerHeight(!1),h=f.offset().top+f.outerHeight(!1),i=e.$results.scrollTop()+h-g;0===d?e.$results.scrollTop(0):h>g&&e.$results.scrollTop(i)}}),c.on("results:focus",function(a){a.element.addClass("select2-results__option--highlighted")}),c.on("results:message",function(a){e.displayMessage(a)}),a.fn.mousewheel&&this.$results.on("mousewheel",function(a){var b=e.$results.scrollTop(),c=e.$results.get(0).scrollHeight-b+a.deltaY,d=a.deltaY>0&&b-a.deltaY<=0,f=a.deltaY<0&&c<=e.$results.height();d?(e.$results.scrollTop(0),a.preventDefault(),a.stopPropagation()):f&&(e.$results.scrollTop(e.$results.get(0).scrollHeight-e.$results.height()),a.preventDefault(),a.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(c){var d=a(this),f=b.GetData(this,"data");if("true"===d.attr("aria-selected"))return void(e.options.get("multiple")?e.trigger("unselect",{originalEvent:c,data:f}):e.trigger("close",{}));e.trigger("select",{originalEvent:c,data:f})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(c){var d=b.GetData(this,"data");e.getHighlightedResults().removeClass("select2-results__option--highlighted"),e.trigger("results:focus",{data:d,element:a(this)})})},c.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},c.prototype.destroy=function(){this.$results.remove()},c.prototype.ensureHighlightVisible=function(){var a=this.getHighlightedResults();if(0!==a.length){var b=this.$results.find("[aria-selected]"),c=b.index(a),d=this.$results.offset().top,e=a.offset().top,f=this.$results.scrollTop()+(e-d),g=e-d;f-=2*a.outerHeight(!1),c<=2?this.$results.scrollTop(0):(g>this.$results.outerHeight()||g<0)&&this.$results.scrollTop(f)}},c.prototype.template=function(b,c){var d=this.options.get("templateResult"),e=this.options.get("escapeMarkup"),f=d(b,c);null==f?c.style.display="none":"string"==typeof f?c.innerHTML=e(f):a(c).append(f)},c}),b.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),b.define("select2/selection/base",["jquery","../utils","../keys"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,b.Observable),d.prototype.render=function(){var c=a('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=b.GetData(this.$element[0],"old-tabindex")?this._tabindex=b.GetData(this.$element[0],"old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),c.attr("title",this.$element.attr("title")),c.attr("tabindex",this._tabindex),this.$selection=c,c},d.prototype.bind=function(a,b){var d=this,e=(a.id,a.id+"-results");this.container=a,this.$selection.on("focus",function(a){d.trigger("focus",a)}),this.$selection.on("blur",function(a){d._handleBlur(a)}),this.$selection.on("keydown",function(a){d.trigger("keypress",a),a.which===c.SPACE&&a.preventDefault()}),a.on("results:focus",function(a){d.$selection.attr("aria-activedescendant",a.data._resultId)}),a.on("selection:update",function(a){d.update(a.data)}),a.on("open",function(){d.$selection.attr("aria-expanded","true"),d.$selection.attr("aria-owns",e),d._attachCloseHandler(a)}),a.on("close",function(){d.$selection.attr("aria-expanded","false"),d.$selection.removeAttr("aria-activedescendant"),d.$selection.removeAttr("aria-owns"),d.$selection.focus(),window.setTimeout(function(){d.$selection.focus()},0),d._detachCloseHandler(a)}),a.on("enable",function(){d.$selection.attr("tabindex",d._tabindex)}),a.on("disable",function(){d.$selection.attr("tabindex","-1")})},d.prototype._handleBlur=function(b){var c=this;window.setTimeout(function(){document.activeElement==c.$selection[0]||a.contains(c.$selection[0],document.activeElement)||c.trigger("blur",b)},1)},d.prototype._attachCloseHandler=function(c){a(document.body).on("mousedown.select2."+c.id,function(c){var d=a(c.target),e=d.closest(".select2");a(".select2.select2-container--open").each(function(){a(this),this!=e[0]&&b.GetData(this,"element").select2("close")})})},d.prototype._detachCloseHandler=function(b){a(document.body).off("mousedown.select2."+b.id)},d.prototype.position=function(a,b){b.find(".selection").append(a)},d.prototype.destroy=function(){this._detachCloseHandler(this.container)},d.prototype.update=function(a){throw new Error("The `update` method must be defined in child classes.")},d}),b.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(a,b,c,d){function e(){e.__super__.constructor.apply(this,arguments)}return c.Extend(e,b),e.prototype.render=function(){var a=e.__super__.render.call(this);return a.addClass("select2-selection--single"),a.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),a},e.prototype.bind=function(a,b){var c=this;e.__super__.bind.apply(this,arguments);var d=a.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",d).attr("role","textbox").attr("aria-readonly","true"),this.$selection.attr("aria-labelledby",d),this.$selection.on("mousedown",function(a){1===a.which&&c.trigger("toggle",{originalEvent:a})}),this.$selection.on("focus",function(a){}),this.$selection.on("blur",function(a){}),a.on("focus",function(b){a.isOpen()||c.$selection.focus()})},e.prototype.clear=function(){var a=this.$selection.find(".select2-selection__rendered");a.empty(),a.removeAttr("title")},e.prototype.display=function(a,b){var c=this.options.get("templateSelection");return this.options.get("escapeMarkup")(c(a,b))},e.prototype.selectionContainer=function(){return a("<span></span>")},e.prototype.update=function(a){if(0===a.length)return void this.clear();var b=a[0],c=this.$selection.find(".select2-selection__rendered"),d=this.display(b,c);c.empty().append(d),c.attr("title",b.title||b.text)},e}),b.define("select2/selection/multiple",["jquery","./base","../utils"],function(a,b,c){function d(a,b){d.__super__.constructor.apply(this,arguments)}return c.Extend(d,b),d.prototype.render=function(){var a=d.__super__.render.call(this);return a.addClass("select2-selection--multiple"),a.html('<ul class="select2-selection__rendered"></ul>'),a},d.prototype.bind=function(b,e){var f=this;d.__super__.bind.apply(this,arguments),this.$selection.on("click",function(a){f.trigger("toggle",{originalEvent:a})}),this.$selection.on("click",".select2-selection__choice__remove",function(b){if(!f.options.get("disabled")){var d=a(this),e=d.parent(),g=c.GetData(e[0],"data");f.trigger("unselect",{originalEvent:b,data:g})}})},d.prototype.clear=function(){var a=this.$selection.find(".select2-selection__rendered");a.empty(),a.removeAttr("title")},d.prototype.display=function(a,b){var c=this.options.get("templateSelection");return this.options.get("escapeMarkup")(c(a,b))},d.prototype.selectionContainer=function(){return a('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},d.prototype.update=function(a){if(this.clear(),0!==a.length){for(var b=[],d=0;d<a.length;d++){var e=a[d],f=this.selectionContainer(),g=this.display(e,f);f.append(g),f.attr("title",e.title||e.text),c.StoreData(f[0],"data",e),b.push(f)}var h=this.$selection.find(".select2-selection__rendered");c.appendMany(h,b)}},d}),b.define("select2/selection/placeholder",["../utils"],function(a){function b(a,b,c){this.placeholder=this.normalizePlaceholder(c.get("placeholder")),a.call(this,b,c)}return b.prototype.normalizePlaceholder=function(a,b){return"string"==typeof b&&(b={id:"",text:b}),b},b.prototype.createPlaceholder=function(a,b){var c=this.selectionContainer();return c.html(this.display(b)),c.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),c},b.prototype.update=function(a,b){var c=1==b.length&&b[0].id!=this.placeholder.id;if(b.length>1||c)return a.call(this,b);this.clear();var d=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(d)},b}),b.define("select2/selection/allowClear",["jquery","../keys","../utils"],function(a,b,c){function d(){}return d.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(a){d._handleClear(a)}),b.on("keypress",function(a){d._handleKeyboardClear(a,b)})},d.prototype._handleClear=function(a,b){if(!this.options.get("disabled")){var d=this.$selection.find(".select2-selection__clear");if(0!==d.length){b.stopPropagation();var e=c.GetData(d[0],"data"),f=this.$element.val();this.$element.val(this.placeholder.id);var g={data:e};if(this.trigger("clear",g),g.prevented)return void this.$element.val(f);for(var h=0;h<e.length;h++)if(g={data:e[h]},this.trigger("unselect",g),g.prevented)return void this.$element.val(f);this.$element.trigger("change"),this.trigger("toggle",{})}}},d.prototype._handleKeyboardClear=function(a,c,d){d.isOpen()||c.which!=b.DELETE&&c.which!=b.BACKSPACE||this._handleClear(c)},d.prototype.update=function(b,d){if(b.call(this,d),!(this.$selection.find(".select2-selection__placeholder").length>0||0===d.length)){var e=a('<span class="select2-selection__clear">&times;</span>');c.StoreData(e[0],"data",d),this.$selection.find(".select2-selection__rendered").prepend(e)}},d}),b.define("select2/selection/search",["jquery","../utils","../keys"],function(a,b,c){function d(a,b,c){a.call(this,b,c)}return d.prototype.render=function(b){var c=a('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=c,this.$search=c.find("input");var d=b.call(this);return this._transferTabIndex(),d},d.prototype.bind=function(a,d,e){var f=this;a.call(this,d,e),d.on("open",function(){f.$search.trigger("focus")}),d.on("close",function(){f.$search.val(""),f.$search.removeAttr("aria-activedescendant"),f.$search.trigger("focus")}),d.on("enable",function(){f.$search.prop("disabled",!1),f._transferTabIndex()}),d.on("disable",function(){f.$search.prop("disabled",!0)}),d.on("focus",function(a){f.$search.trigger("focus")}),d.on("results:focus",function(a){f.$search.attr("aria-activedescendant",a.id)}),this.$selection.on("focusin",".select2-search--inline",function(a){f.trigger("focus",a)}),this.$selection.on("focusout",".select2-search--inline",function(a){f._handleBlur(a)}),this.$selection.on("keydown",".select2-search--inline",function(a){if(a.stopPropagation(),f.trigger("keypress",a),f._keyUpPrevented=a.isDefaultPrevented(),a.which===c.BACKSPACE&&""===f.$search.val()){var d=f.$searchContainer.prev(".select2-selection__choice");if(d.length>0){var e=b.GetData(d[0],"data");f.searchRemoveChoice(e),a.preventDefault()}}});var g=document.documentMode,h=g&&g<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(a){if(h)return void f.$selection.off("input.search input.searchcheck");f.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(a){if(h&&"input"===a.type)return void f.$selection.off("input.search input.searchcheck");var b=a.which;b!=c.SHIFT&&b!=c.CTRL&&b!=c.ALT&&b!=c.TAB&&f.handleSearch(a)})},d.prototype._transferTabIndex=function(a){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},d.prototype.createPlaceholder=function(a,b){this.$search.attr("placeholder",b.text)},d.prototype.update=function(a,b){var c=this.$search[0]==document.activeElement;if(this.$search.attr("placeholder",""),a.call(this,b),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),c){this.$element.find("[data-select2-tag]").length?this.$element.focus():this.$search.focus()}},d.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var a=this.$search.val();this.trigger("query",{term:a})}this._keyUpPrevented=!1},d.prototype.searchRemoveChoice=function(a,b){this.trigger("unselect",{data:b}),this.$search.val(b.text),this.handleSearch()},d.prototype.resizeSearch=function(){this.$search.css("width","25px");var a="";if(""!==this.$search.attr("placeholder"))a=this.$selection.find(".select2-selection__rendered").innerWidth();else{a=.75*(this.$search.val().length+1)+"em"}this.$search.css("width",a)},d}),b.define("select2/selection/eventRelay",["jquery"],function(a){function b(){}return b.prototype.bind=function(b,c,d){var e=this,f=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"],g=["opening","closing","selecting","unselecting","clearing"];b.call(this,c,d),c.on("*",function(b,c){if(-1!==a.inArray(b,f)){c=c||{};var d=a.Event("select2:"+b,{params:c});e.$element.trigger(d),-1!==a.inArray(b,g)&&(c.prevented=d.isDefaultPrevented())}})},b}),b.define("select2/translation",["jquery","require"],function(a,b){function c(a){this.dict=a||{}}return c.prototype.all=function(){return this.dict},c.prototype.get=function(a){return this.dict[a]},c.prototype.extend=function(b){this.dict=a.extend({},b.all(),this.dict)},c._cache={},c.loadPath=function(a){if(!(a in c._cache)){var d=b(a);c._cache[a]=d}return new c(c._cache[a])},c}),b.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"}}),b.define("select2/data/base",["../utils"],function(a){function b(a,c){b.__super__.constructor.call(this)}return a.Extend(b,a.Observable),b.prototype.current=function(a){throw new Error("The `current` method must be defined in child classes.")},b.prototype.query=function(a,b){throw new Error("The `query` method must be defined in child classes.")},b.prototype.bind=function(a,b){},b.prototype.destroy=function(){},b.prototype.generateResultId=function(b,c){var d=b.id+"-result-";return d+=a.generateChars(4),null!=c.id?d+="-"+c.id.toString():d+="-"+a.generateChars(4),d},b}),b.define("select2/data/select",["./base","../utils","jquery"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,a),d.prototype.current=function(a){var b=[],d=this;this.$element.find(":selected").each(function(){var a=c(this),e=d.item(a);b.push(e)}),a(b)},d.prototype.select=function(a){var b=this;if(a.selected=!0,c(a.element).is("option"))return a.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(d){var e=[];a=[a],a.push.apply(a,d);for(var f=0;f<a.length;f++){var g=a[f].id;-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger("change")});else{var d=a.id;this.$element.val(d),this.$element.trigger("change")}},d.prototype.unselect=function(a){var b=this;if(this.$element.prop("multiple")){if(a.selected=!1,c(a.element).is("option"))return a.element.selected=!1,void this.$element.trigger("change");this.current(function(d){for(var e=[],f=0;f<d.length;f++){var g=d[f].id;g!==a.id&&-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger("change")})}},d.prototype.bind=function(a,b){var c=this;this.container=a,a.on("select",function(a){c.select(a.data)}),a.on("unselect",function(a){c.unselect(a.data)})},d.prototype.destroy=function(){this.$element.find("*").each(function(){b.RemoveData(this)})},d.prototype.query=function(a,b){var d=[],e=this;this.$element.children().each(function(){var b=c(this);if(b.is("option")||b.is("optgroup")){var f=e.item(b),g=e.matches(a,f);null!==g&&d.push(g)}}),b({results:d})},d.prototype.addOptions=function(a){b.appendMany(this.$element,a)},d.prototype.option=function(a){var d;a.children?(d=document.createElement("optgroup"),d.label=a.text):(d=document.createElement("option"),void 0!==d.textContent?d.textContent=a.text:d.innerText=a.text),void 0!==a.id&&(d.value=a.id),a.disabled&&(d.disabled=!0),a.selected&&(d.selected=!0),a.title&&(d.title=a.title);var e=c(d),f=this._normalizeItem(a);return f.element=d,b.StoreData(d,"data",f),e},d.prototype.item=function(a){var d={};if(null!=(d=b.GetData(a[0],"data")))return d;if(a.is("option"))d={id:a.val(),text:a.text(),disabled:a.prop("disabled"),selected:a.prop("selected"),title:a.prop("title")};else if(a.is("optgroup")){d={text:a.prop("label"),children:[],title:a.prop("title")};for(var e=a.children("option"),f=[],g=0;g<e.length;g++){var h=c(e[g]),i=this.item(h);f.push(i)}d.children=f}return d=this._normalizeItem(d),d.element=a[0],b.StoreData(a[0],"data",d),d},d.prototype._normalizeItem=function(a){a!==Object(a)&&(a={id:a,text:a}),a=c.extend({},{text:""},a);var b={selected:!1,disabled:!1};return null!=a.id&&(a.id=a.id.toString()),null!=a.text&&(a.text=a.text.toString()),null==a._resultId&&a.id&&null!=this.container&&(a._resultId=this.generateResultId(this.container,a)),c.extend({},b,a)},d.prototype.matches=function(a,b){return this.options.get("matcher")(a,b)},d}),b.define("select2/data/array",["./select","../utils","jquery"],function(a,b,c){function d(a,b){var c=b.get("data")||[];d.__super__.constructor.call(this,a,b),this.addOptions(this.convertToOptions(c))}return b.Extend(d,a),d.prototype.select=function(a){var b=this.$element.find("option").filter(function(b,c){return c.value==a.id.toString()});0===b.length&&(b=this.option(a),this.addOptions(b)),d.__super__.select.call(this,a)},d.prototype.convertToOptions=function(a){function d(a){return function(){return c(this).val()==a.id}}for(var e=this,f=this.$element.find("option"),g=f.map(function(){return e.item(c(this)).id}).get(),h=[],i=0;i<a.length;i++){var j=this._normalizeItem(a[i]);if(c.inArray(j.id,g)>=0){var k=f.filter(d(j)),l=this.item(k),m=c.extend(!0,{},j,l),n=this.option(m);k.replaceWith(n)}else{var o=this.option(j);if(j.children){var p=this.convertToOptions(j.children);b.appendMany(o,p)}h.push(o)}}return h},d}),b.define("select2/data/ajax",["./array","../utils","jquery"],function(a,b,c){function d(a,b){this.ajaxOptions=this._applyDefaults(b.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),d.__super__.constructor.call(this,a,b)}return b.Extend(d,a),d.prototype._applyDefaults=function(a){var b={data:function(a){return c.extend({},a,{q:a.term})},transport:function(a,b,d){var e=c.ajax(a);return e.then(b),e.fail(d),e}};return c.extend({},b,a,!0)},d.prototype.processResults=function(a){return a},d.prototype.query=function(a,b){function d(){var d=f.transport(f,function(d){var f=e.processResults(d,a);e.options.get("debug")&&window.console&&console.error&&(f&&f.results&&c.isArray(f.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),b(f)},function(){"status"in d&&(0===d.status||"0"===d.status)||e.trigger("results:message",{message:"errorLoading"})});e._request=d}var e=this;null!=this._request&&(c.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var f=c.extend({type:"GET"},this.ajaxOptions);"function"==typeof f.url&&(f.url=f.url.call(this.$element,a)),"function"==typeof f.data&&(f.data=f.data.call(this.$element,a)),this.ajaxOptions.delay&&null!=a.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(d,this.ajaxOptions.delay)):d()},d}),b.define("select2/data/tags",["jquery"],function(a){function b(b,c,d){var e=d.get("tags"),f=d.get("createTag");void 0!==f&&(this.createTag=f);var g=d.get("insertTag");if(void 0!==g&&(this.insertTag=g),b.call(this,c,d),a.isArray(e))for(var h=0;h<e.length;h++){var i=e[h],j=this._normalizeItem(i),k=this.option(j);this.$element.append(k)}}return b.prototype.query=function(a,b,c){function d(a,f){for(var g=a.results,h=0;h<g.length;h++){var i=g[h],j=null!=i.children&&!d({results:i.children},!0);if((i.text||"").toUpperCase()===(b.term||"").toUpperCase()||j)return!f&&(a.data=g,void c(a))}if(f)return!0;var k=e.createTag(b);if(null!=k){var l=e.option(k);l.attr("data-select2-tag",!0),e.addOptions([l]),e.insertTag(g,k)}a.results=g,c(a)}var e=this;if(this._removeOldTags(),null==b.term||null!=b.page)return void a.call(this,b,c);a.call(this,b,d)},b.prototype.createTag=function(b,c){var d=a.trim(c.term);return""===d?null:{id:d,text:d}},b.prototype.insertTag=function(a,b,c){b.unshift(c)},b.prototype._removeOldTags=function(b){this._lastTag;this.$element.find("option[data-select2-tag]").each(function(){this.selected||a(this).remove()})},b}),b.define("select2/data/tokenizer",["jquery"],function(a){function b(a,b,c){var d=c.get("tokenizer");void 0!==d&&(this.tokenizer=d),a.call(this,b,c)}return b.prototype.bind=function(a,b,c){a.call(this,b,c),this.$search=b.dropdown.$search||b.selection.$search||c.find(".select2-search__field")},b.prototype.query=function(b,c,d){function e(b){var c=g._normalizeItem(b);if(!g.$element.find("option").filter(function(){return a(this).val()===c.id}).length){var d=g.option(c);d.attr("data-select2-tag",!0),g._removeOldTags(),g.addOptions([d])}f(c)}function f(a){g.trigger("select",{data:a})}var g=this;c.term=c.term||"";var h=this.tokenizer(c,this.options,e);h.term!==c.term&&(this.$search.length&&(this.$search.val(h.term),this.$search.focus()),c.term=h.term),b.call(this,c,d)},b.prototype.tokenizer=function(b,c,d,e){for(var f=d.get("tokenSeparators")||[],g=c.term,h=0,i=this.createTag||function(a){return{id:a.term,text:a.term}};h<g.length;){var j=g[h];if(-1!==a.inArray(j,f)){var k=g.substr(0,h),l=a.extend({},c,{term:k}),m=i(l);null!=m?(e(m),g=g.substr(h+1)||"",h=0):h++}else h++}return{term:g}},b}),b.define("select2/data/minimumInputLength",[],function(){function a(a,b,c){this.minimumInputLength=c.get("minimumInputLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){if(b.term=b.term||"",b.term.length<this.minimumInputLength)return void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:b.term,params:b}});a.call(this,b,c)},a}),b.define("select2/data/maximumInputLength",[],function(){function a(a,b,c){this.maximumInputLength=c.get("maximumInputLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){if(b.term=b.term||"",this.maximumInputLength>0&&b.term.length>this.maximumInputLength)return void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:b.term,params:b}});a.call(this,b,c)},a}),b.define("select2/data/maximumSelectionLength",[],function(){function a(a,b,c){this.maximumSelectionLength=c.get("maximumSelectionLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){var d=this;this.current(function(e){var f=null!=e?e.length:0;if(d.maximumSelectionLength>0&&f>=d.maximumSelectionLength)return void d.trigger("results:message",{message:"maximumSelected",args:{maximum:d.maximumSelectionLength}});a.call(d,b,c)})},a}),b.define("select2/dropdown",["jquery","./utils"],function(a,b){function c(a,b){this.$element=a,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<span class="select2-dropdown"><span class="select2-results"></span></span>');return b.attr("dir",this.options.get("dir")),this.$dropdown=b,b},c.prototype.bind=function(){},c.prototype.position=function(a,b){},c.prototype.destroy=function(){this.$dropdown.remove()},c}),b.define("select2/dropdown/search",["jquery","../utils"],function(a,b){function c(){}return c.prototype.render=function(b){var c=b.call(this),d=a('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=d,this.$search=d.find("input"),c.prepend(d),c},c.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),this.$search.on("keydown",function(a){e.trigger("keypress",a),e._keyUpPrevented=a.isDefaultPrevented()}),this.$search.on("input",function(b){a(this).off("keyup")}),this.$search.on("keyup input",function(a){e.handleSearch(a)}),c.on("open",function(){e.$search.attr("tabindex",0),e.$search.focus(),window.setTimeout(function(){e.$search.focus()},0)}),c.on("close",function(){e.$search.attr("tabindex",-1),e.$search.val(""),e.$search.blur()}),c.on("focus",function(){c.isOpen()||e.$search.focus()}),c.on("results:all",function(a){if(null==a.query.term||""===a.query.term){e.showSearch(a)?e.$searchContainer.removeClass("select2-search--hide"):e.$searchContainer.addClass("select2-search--hide")}})},c.prototype.handleSearch=function(a){if(!this._keyUpPrevented){var b=this.$search.val();this.trigger("query",{term:b})}this._keyUpPrevented=!1},c.prototype.showSearch=function(a,b){return!0},c}),b.define("select2/dropdown/hidePlaceholder",[],function(){function a(a,b,c,d){this.placeholder=this.normalizePlaceholder(c.get("placeholder")),a.call(this,b,c,d)}return a.prototype.append=function(a,b){b.results=this.removePlaceholder(b.results),a.call(this,b)},a.prototype.normalizePlaceholder=function(a,b){return"string"==typeof b&&(b={id:"",text:b}),b},a.prototype.removePlaceholder=function(a,b){for(var c=b.slice(0),d=b.length-1;d>=0;d--){var e=b[d];this.placeholder.id===e.id&&c.splice(d,1)}return c},a}),b.define("select2/dropdown/infiniteScroll",["jquery"],function(a){function b(a,b,c,d){this.lastParams={},a.call(this,b,c,d),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return b.prototype.append=function(a,b){this.$loadingMore.remove(),this.loading=!1,a.call(this,b),this.showLoadingMore(b)&&this.$results.append(this.$loadingMore)},b.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),c.on("query",function(a){e.lastParams=a,e.loading=!0}),c.on("query:append",function(a){e.lastParams=a,e.loading=!0}),this.$results.on("scroll",function(){var b=a.contains(document.documentElement,e.$loadingMore[0]);if(!e.loading&&b){e.$results.offset().top+e.$results.outerHeight(!1)+50>=e.$loadingMore.offset().top+e.$loadingMore.outerHeight(!1)&&e.loadMore()}})},b.prototype.loadMore=function(){this.loading=!0;var b=a.extend({},{page:1},this.lastParams);b.page++,this.trigger("query:append",b)},b.prototype.showLoadingMore=function(a,b){return b.pagination&&b.pagination.more},b.prototype.createLoadingMore=function(){var b=a('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),c=this.options.get("translations").get("loadingMore");return b.html(c(this.lastParams)),b},b}),b.define("select2/dropdown/attachBody",["jquery","../utils"],function(a,b){function c(b,c,d){this.$dropdownParent=d.get("dropdownParent")||a(document.body),b.call(this,c,d)}return c.prototype.bind=function(a,b,c){var d=this,e=!1;a.call(this,b,c),b.on("open",function(){d._showDropdown(),d._attachPositioningHandler(b),e||(e=!0,b.on("results:all",function(){d._positionDropdown(),d._resizeDropdown()}),b.on("results:append",function(){d._positionDropdown(),d._resizeDropdown()}))}),b.on("close",function(){d._hideDropdown(),d._detachPositioningHandler(b)}),this.$dropdownContainer.on("mousedown",function(a){a.stopPropagation()})},c.prototype.destroy=function(a){a.call(this),this.$dropdownContainer.remove()},c.prototype.position=function(a,b,c){b.attr("class",c.attr("class")),b.removeClass("select2"),b.addClass("select2-container--open"),b.css({position:"absolute",top:-999999}),this.$container=c},c.prototype.render=function(b){var c=a("<span></span>"),d=b.call(this);return c.append(d),this.$dropdownContainer=c,c},c.prototype._hideDropdown=function(a){this.$dropdownContainer.detach()},c.prototype._attachPositioningHandler=function(c,d){var e=this,f="scroll.select2."+d.id,g="resize.select2."+d.id,h="orientationchange.select2."+d.id,i=this.$container.parents().filter(b.hasScroll);i.each(function(){b.StoreData(this,"select2-scroll-position",{x:a(this).scrollLeft(),y:a(this).scrollTop()})}),i.on(f,function(c){var d=b.GetData(this,"select2-scroll-position");a(this).scrollTop(d.y)}),a(window).on(f+" "+g+" "+h,function(a){e._positionDropdown(),e._resizeDropdown()})},c.prototype._detachPositioningHandler=function(c,d){var e="scroll.select2."+d.id,f="resize.select2."+d.id,g="orientationchange.select2."+d.id;this.$container.parents().filter(b.hasScroll).off(e),a(window).off(e+" "+f+" "+g)},c.prototype._positionDropdown=function(){var b=a(window),c=this.$dropdown.hasClass("select2-dropdown--above"),d=this.$dropdown.hasClass("select2-dropdown--below"),e=null,f=this.$container.offset();f.bottom=f.top+this.$container.outerHeight(!1);var g={height:this.$container.outerHeight(!1)};g.top=f.top,g.bottom=f.top+g.height;var h={height:this.$dropdown.outerHeight(!1)},i={top:b.scrollTop(),bottom:b.scrollTop()+b.height()},j=i.top<f.top-h.height,k=i.bottom>f.bottom+h.height,l={left:f.left,top:g.bottom},m=this.$dropdownParent;"static"===m.css("position")&&(m=m.offsetParent());var n=m.offset();l.top-=n.top,l.left-=n.left,c||d||(e="below"),k||!j||c?!j&&k&&c&&(e="below"):e="above",("above"==e||c&&"below"!==e)&&(l.top=g.top-n.top-h.height),null!=e&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+e),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+e)),this.$dropdownContainer.css(l)},c.prototype._resizeDropdown=function(){var a={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(a.minWidth=a.width,a.position="relative",a.width="auto"),this.$dropdown.css(a)},c.prototype._showDropdown=function(a){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},c}),b.define("select2/dropdown/minimumResultsForSearch",[],function(){function a(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];e.children?c+=a(e.children):c++}return c}function b(a,b,c,d){this.minimumResultsForSearch=c.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),a.call(this,b,c,d)}return b.prototype.showSearch=function(b,c){return!(a(c.data.results)<this.minimumResultsForSearch)&&b.call(this,c)},b}),b.define("select2/dropdown/selectOnClose",["../utils"],function(a){function b(){}return b.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on("close",function(a){d._handleSelectOnClose(a)})},b.prototype._handleSelectOnClose=function(b,c){if(c&&null!=c.originalSelect2Event){var d=c.originalSelect2Event;if("select"===d._type||"unselect"===d._type)return}var e=this.getHighlightedResults();if(!(e.length<1)){var f=a.GetData(e[0],"data");null!=f.element&&f.element.selected||null==f.element&&f.selected||this.trigger("select",{data:f})}},b}),b.define("select2/dropdown/closeOnSelect",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on("select",function(a){d._selectTriggered(a)}),b.on("unselect",function(a){d._selectTriggered(a)})},a.prototype._selectTriggered=function(a,b){var c=b.originalEvent;c&&c.ctrlKey||this.trigger("close",{originalEvent:c,originalSelect2Event:b})},a}),b.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(a){var b=a.input.length-a.maximum,c="Please delete "+b+" character";return 1!=b&&(c+="s"),c},inputTooShort:function(a){return"Please enter "+(a.minimum-a.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(a){var b="You can only select "+a.maximum+" item";return 1!=a.maximum&&(b+="s"),b},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),b.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){function D(){this.reset()}return D.prototype.apply=function(l){if(l=a.extend(!0,{},this.defaults,l),null==l.dataAdapter){if(null!=l.ajax?l.dataAdapter=o:null!=l.data?l.dataAdapter=n:l.dataAdapter=m,l.minimumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,r)),l.maximumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,s)),l.maximumSelectionLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,t)),l.tags&&(l.dataAdapter=j.Decorate(l.dataAdapter,p)),null==l.tokenSeparators&&null==l.tokenizer||(l.dataAdapter=j.Decorate(l.dataAdapter,q)),null!=l.query){var C=b(l.amdBase+"compat/query");l.dataAdapter=j.Decorate(l.dataAdapter,C)}if(null!=l.initSelection){var D=b(l.amdBase+"compat/initSelection");l.dataAdapter=j.Decorate(l.dataAdapter,D)}}if(null==l.resultsAdapter&&(l.resultsAdapter=c,null!=l.ajax&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,x)),null!=l.placeholder&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,w)),l.selectOnClose&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,A))),null==l.dropdownAdapter){if(l.multiple)l.dropdownAdapter=u;else{var E=j.Decorate(u,v);l.dropdownAdapter=E}if(0!==l.minimumResultsForSearch&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,z)),l.closeOnSelect&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,B)),null!=l.dropdownCssClass||null!=l.dropdownCss||null!=l.adaptDropdownCssClass){var F=b(l.amdBase+"compat/dropdownCss");l.dropdownAdapter=j.Decorate(l.dropdownAdapter,F)}l.dropdownAdapter=j.Decorate(l.dropdownAdapter,y)}if(null==l.selectionAdapter){if(l.multiple?l.selectionAdapter=e:l.selectionAdapter=d,null!=l.placeholder&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,f)),l.allowClear&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,g)),l.multiple&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,h)),null!=l.containerCssClass||null!=l.containerCss||null!=l.adaptContainerCssClass){var G=b(l.amdBase+"compat/containerCss");l.selectionAdapter=j.Decorate(l.selectionAdapter,G)}l.selectionAdapter=j.Decorate(l.selectionAdapter,i)}if("string"==typeof l.language)if(l.language.indexOf("-")>0){var H=l.language.split("-"),I=H[0];l.language=[l.language,I]}else l.language=[l.language];if(a.isArray(l.language)){var J=new k;l.language.push("en");for(var K=l.language,L=0;L<K.length;L++){var M=K[L],N={};try{N=k.loadPath(M)}catch(a){try{M=this.defaults.amdLanguageBase+M,N=k.loadPath(M)}catch(a){l.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+M+'" could not be automatically loaded. A fallback will be used instead.');continue}}J.extend(N)}l.translations=J}else{var O=k.loadPath(this.defaults.amdLanguageBase+"en"),P=new k(l.language);P.extend(O),l.translations=P}return l},D.prototype.reset=function(){function b(a){function b(a){return l[a]||a}return a.replace(/[^\u0000-\u007E]/g,b)}function c(d,e){if(""===a.trim(d.term))return e;if(e.children&&e.children.length>0){for(var f=a.extend(!0,{},e),g=e.children.length-1;g>=0;g--){null==c(d,e.children[g])&&f.children.splice(g,1)}return f.children.length>0?f:c(d,f)}var h=b(e.text).toUpperCase(),i=b(d.term).toUpperCase();return h.indexOf(i)>-1?e:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:j.escapeMarkup,language:C,matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(a){return a},templateResult:function(a){return a.text},templateSelection:function(a){return a.text},theme:"default",width:"resolve"}},D.prototype.set=function(b,c){var d=a.camelCase(b),e={};e[d]=c;var f=j._convertData(e);a.extend(!0,this.defaults,f)},new D}),b.define("select2/options",["require","jquery","./defaults","./utils"],function(a,b,c,d){function e(b,e){if(this.options=b,null!=e&&this.fromElement(e),this.options=c.apply(this.options),e&&e.is("input")){var f=a(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=d.Decorate(this.options.dataAdapter,f)}}return e.prototype.fromElement=function(a){var c=["select2"];null==this.options.multiple&&(this.options.multiple=a.prop("multiple")),null==this.options.disabled&&(this.options.disabled=a.prop("disabled")),null==this.options.language&&(a.prop("lang")?this.options.language=a.prop("lang").toLowerCase():a.closest("[lang]").prop("lang")&&(this.options.language=a.closest("[lang]").prop("lang"))),null==this.options.dir&&(a.prop("dir")?this.options.dir=a.prop("dir"):a.closest("[dir]").prop("dir")?this.options.dir=a.closest("[dir]").prop("dir"):this.options.dir="ltr"),a.prop("disabled",this.options.disabled),a.prop("multiple",this.options.multiple),d.GetData(a[0],"select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),d.StoreData(a[0],"data",d.GetData(a[0],"select2Tags")),d.StoreData(a[0],"tags",!0)),d.GetData(a[0],"ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),a.attr("ajax--url",d.GetData(a[0],"ajaxUrl")),d.StoreData(a[0],"ajax-Url",d.GetData(a[0],"ajaxUrl")));var e={};e=b.fn.jquery&&"1."==b.fn.jquery.substr(0,2)&&a[0].dataset?b.extend(!0,{},a[0].dataset,d.GetData(a[0])):d.GetData(a[0]);var f=b.extend(!0,{},e);f=d._convertData(f);for(var g in f)b.inArray(g,c)>-1||(b.isPlainObject(this.options[g])?b.extend(this.options[g],f[g]):this.options[g]=f[g]);return this},e.prototype.get=function(a){return this.options[a]},e.prototype.set=function(a,b){this.options[a]=b},e}),b.define("select2/core",["jquery","./options","./utils","./keys"],function(a,b,c,d){var e=function(a,d){null!=c.GetData(a[0],"select2")&&c.GetData(a[0],"select2").destroy(),this.$element=a,this.id=this._generateId(a),d=d||{},this.options=new b(d,a),e.__super__.constructor.call(this);var f=a.attr("tabindex")||0;c.StoreData(a[0],"old-tabindex",f),a.attr("tabindex","-1");var g=this.options.get("dataAdapter");this.dataAdapter=new g(a,this.options);var h=this.render();this._placeContainer(h);var i=this.options.get("selectionAdapter");this.selection=new i(a,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,h);var j=this.options.get("dropdownAdapter");this.dropdown=new j(a,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,h);var k=this.options.get("resultsAdapter");this.results=new k(a,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var l=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(a){l.trigger("selection:update",{data:a})}),a.addClass("select2-hidden-accessible"),a.attr("aria-hidden","true"),this._syncAttributes(),c.StoreData(a[0],"select2",this),a.data("select2",this)};return c.Extend(e,c.Observable),e.prototype._generateId=function(a){var b="";return b=null!=a.attr("id")?a.attr("id"):null!=a.attr("name")?a.attr("name")+"-"+c.generateChars(2):c.generateChars(4),b=b.replace(/(:|\.|\[|\]|,)/g,""),b="select2-"+b},e.prototype._placeContainer=function(a){a.insertAfter(this.$element);var b=this._resolveWidth(this.$element,this.options.get("width"));null!=b&&a.css("width",b)},e.prototype._resolveWidth=function(a,b){var c=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==b){var d=this._resolveWidth(a,"style");return null!=d?d:this._resolveWidth(a,"element")}if("element"==b){var e=a.outerWidth(!1);return e<=0?"auto":e+"px"}if("style"==b){var f=a.attr("style");if("string"!=typeof f)return null;for(var g=f.split(";"),h=0,i=g.length;h<i;h+=1){var j=g[h].replace(/\s/g,""),k=j.match(c);if(null!==k&&k.length>=1)return k[1]}return null}return b},e.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},e.prototype._registerDomEvents=function(){var b=this;this.$element.on("change.select2",function(){b.dataAdapter.current(function(a){b.trigger("selection:update",{data:a})})}),this.$element.on("focus.select2",function(a){b.trigger("focus",a)}),this._syncA=c.bind(this._syncAttributes,this),this._syncS=c.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=d?(this._observer=new d(function(c){a.each(c,b._syncA),a.each(c,b._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",b._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",b._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",b._syncS,!1))},e.prototype._registerDataEvents=function(){var a=this;this.dataAdapter.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerSelectionEvents=function(){var b=this,c=["toggle","focus"];this.selection.on("toggle",function(){b.toggleDropdown()}),this.selection.on("focus",function(a){b.focus(a)}),this.selection.on("*",function(d,e){-1===a.inArray(d,c)&&b.trigger(d,e)})},e.prototype._registerDropdownEvents=function(){var a=this;this.dropdown.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerResultsEvents=function(){var a=this;this.results.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerEvents=function(){var a=this;this.on("open",function(){a.$container.addClass("select2-container--open")}),this.on("close",function(){a.$container.removeClass("select2-container--open")}),this.on("enable",function(){a.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){a.$container.addClass("select2-container--disabled")}),this.on("blur",function(){a.$container.removeClass("select2-container--focus")}),this.on("query",function(b){a.isOpen()||a.trigger("open",{}),this.dataAdapter.query(b,function(c){a.trigger("results:all",{data:c,query:b})})}),this.on("query:append",function(b){this.dataAdapter.query(b,function(c){a.trigger("results:append",{data:c,query:b})})}),this.on("keypress",function(b){var c=b.which;a.isOpen()?c===d.ESC||c===d.TAB||c===d.UP&&b.altKey?(a.close(),b.preventDefault()):c===d.ENTER?(a.trigger("results:select",{}),b.preventDefault()):c===d.SPACE&&b.ctrlKey?(a.trigger("results:toggle",{}),b.preventDefault()):c===d.UP?(a.trigger("results:previous",{}),b.preventDefault()):c===d.DOWN&&(a.trigger("results:next",{}),b.preventDefault()):(c===d.ENTER||c===d.SPACE||c===d.DOWN&&b.altKey)&&(a.open(),b.preventDefault())})},e.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},e.prototype._syncSubtree=function(a,b){var c=!1,d=this;if(!a||!a.target||"OPTION"===a.target.nodeName||"OPTGROUP"===a.target.nodeName){if(b)if(b.addedNodes&&b.addedNodes.length>0)for(var e=0;e<b.addedNodes.length;e++){var f=b.addedNodes[e];f.selected&&(c=!0)}else b.removedNodes&&b.removedNodes.length>0&&(c=!0);else c=!0;c&&this.dataAdapter.current(function(a){d.trigger("selection:update",{data:a})})}},e.prototype.trigger=function(a,b){var c=e.__super__.trigger,d={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(void 0===b&&(b={}),a in d){var f=d[a],g={prevented:!1,name:a,args:b};if(c.call(this,f,g),g.prevented)return void(b.prevented=!0)}c.call(this,a,b)},e.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},e.prototype.open=function(){this.isOpen()||this.trigger("query",{})},e.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},e.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},e.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},e.prototype.focus=function(a){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},e.prototype.enable=function(a){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=a&&0!==a.length||(a=[!0]);var b=!a[0];this.$element.prop("disabled",b)},e.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var a=[];return this.dataAdapter.current(function(b){a=b}),a},e.prototype.val=function(b){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==b||0===b.length)return this.$element.val();var c=b[0];a.isArray(c)&&(c=a.map(c,function(a){return a.toString()})),this.$element.val(c).trigger("change")},e.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",c.GetData(this.$element[0],"old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),c.RemoveData(this.$element[0]),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},e.prototype.render=function(){var b=a('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return b.attr("dir",this.options.get("dir")),this.$container=b,this.$container.addClass("select2-container--"+this.options.get("theme")),c.StoreData(b[0],"element",this.$element),b},e}),b.define("jquery-mousewheel",["jquery"],function(a){return a}),b.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function(a,b,c,d,e){if(null==a.fn.select2){var f=["open","close","destroy"];a.fn.select2=function(b){if("object"==typeof(b=b||{}))return this.each(function(){var d=a.extend(!0,{},b);new c(a(this),d)}),this;if("string"==typeof b){var d,g=Array.prototype.slice.call(arguments,1);return this.each(function(){var a=e.GetData(this,"select2");null==a&&window.console&&console.error&&console.error("The select2('"+b+"') method was called on an element that is not using Select2."),d=a[b].apply(a,g)}),a.inArray(b,f)>-1?this:d}throw new Error("Invalid arguments for Select2: "+b)}}return null==a.fn.select2.defaults&&(a.fn.select2.defaults=d),c}),{define:b.define,require:b.require}}(),c=b.require("jquery.select2");return a.fn.select2.amd=b,c});
function rounddecimalPlaces(num, places) {
    return +(Math.round(num + "e+" + places + "") + "e-" + places + "");
}

function initalizePiaChart() {
    try {
        var config = {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [0, 0],
                    backgroundColor: [
                        '#004164',
                        '#ff5a28'
                    ],
                    borderWidth: 0,
                    weight: 1,
                }],
                labels: ["Principal Amount", "Total Interest"]
            },
            options: {
                tooltips: {
                    callbacks: {
                        label: function (tooltipItem, data) {
                            var label = data.labels[tooltipItem.index] + " : " + data.datasets[0].data[tooltipItem.index].toLocaleString('EN-IN') || '';
                            return label;
                        }
                    }
                },
                responsive: false,
                legend: false,
                animation: {
                    animateScale: false,
                    animateRotate: false
                },
                rotation: 180,
                cutoutPercentage: 75
            }
        };
        var pl_emi_chart = document.getElementById('pl-emi-chart').getContext('2d');
        window.pl_emi_dg = new Chart(pl_emi_chart, config);
    } catch (error) {
        console.log(error);
    }
}

function initalizeBarChart() {
    try {
        var pl_barch_ele = document.getElementById('barch-plemicalc').getContext('2d');
        window.pl_calc_barchart = new Chart(pl_barch_ele, {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'Principal',
                    backgroundColor: "#004164",
                    data: [],
                    order: 3,
                    barPercentage: 0.3
                },
                {
                    label: 'Interest',
                    backgroundColor: "#ff5a28",
                    data: [],
                    order: 2,
                    barPercentage: 0.3
                },
                {
                    label: 'Balance',
                    yAxisID: 'y-axis-2',
                    data: [],
                    order: 1,
                    backgroundColor: '#eabf23',
                    fill: false,
                    borderColor: "#eabf23",
                    borderWidth: 4,
                    type: 'line'
                }
                ]
            },
            options: {
                responsive: true,
                legend: {
                    display: false,
                },
                legendCallback: function (chart) {
                    return chart.data.datasets.map(function (ele, index) {
                        return returnBarChartLegendHTML(ele, index);
                    }).join('');
                },
                scales: {
                    xAxes: [{
                        stacked: true,
                        gridLines: {
                            drawOnChartArea: false
                        },
                        ticks: {
                            callback: function (value, index, values) {
                                return index % 2 == 0 ? value : "";
                            },
                            maxRotation: 45,
                            minRotation: 45,
                            fontSize: 12,
                            fontColor: "#333333"
                        },

                    }],
                    yAxes: [{
                        display: true,
                        stacked: true,
                        position: 'right',
                        id: 'y-axis-1',
                        gridLines: {
                            drawOnChartArea: false
                        },
                        ticks: {
                            callback: function (value, index, values) {
                                return '₹ ' + value.toLocaleString('EN-IN');
                            },
                            fontSize: 12,
                            fontColor: "#333333",
                        },
                        scaleLabel: {
                            display: true,
                            labelString: 'EMI Payment/Year',
                            fontSize: 12,
                            fontStyle: "bold",
                            fontColor: "#333333",
                            padding: 25
                        }
                    },
                    {
                        display: true,
                        position: 'left',
                        id: 'y-axis-2',
                        gridLines: {
                            drawOnChartArea: false
                        },
                        ticks: {
                            callback: function (value, index, values) {
                                return '₹ ' + value.toLocaleString('EN-IN');
                            },
                            fontSize: 12,
                            fontColor: "#333333",
                        },
                        scaleLabel: {
                            display: true,
                            labelString: 'Balance',
                            fontSize: 12,
                            fontStyle: "bold",
                            fontColor: "#333333",
                            padding: 25

                        }
                    }
                    ],
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                    callbacks: {
                        label: function (tooltipItem, data) {

                            var label = data.datasets[tooltipItem.datasetIndex].label || '';

                            if (label) {
                                label += ': ';
                            }
                            label += "₹ " + tooltipItem.yLabel.toLocaleString('EN-IN');
                            return label;
                        }
                    }
                },
            }
        });
        $("#pl-barch-legend-ap").html(pl_calc_barchart.generateLegend());
    } catch (error) {
        console.log(error);
    }
}

function returnBarChartLegendHTML(ele, index) {
    return "<li class=\"plbarch-legend-li\" onclick=\"updateDataset(event, ".concat(index, ")\"><span ").concat(ele.label == "Balance" ? "class='line'" : "", " style=\"background-color: ").concat(ele.backgroundColor, ";\"></span>").concat(ele.label, "</li>");
}

document.addEventListener('DOMContentLoaded', function () {
    if (document.querySelector("#bs-new-emicalc")) {
        try {
            initalizePiaChart();
            initalizeBarChart();
            // BAR CHART LEGEND CLICK UPDATE
            window.updateDataset = function (e, datasetIndex) {
                var index = datasetIndex;
                var ci = pl_calc_barchart;
                var meta = ci.getDatasetMeta(datasetIndex);
                var result = (meta.hidden == true) ? false : true;
                if (result) {
                    e.currentTarget.classList.add('selected');
                } else {
                    e.currentTarget.classList.remove('selected');
                }
                meta.hidden = result;
                ci.update();
            };

            var loanAmountSlider = document.getElementById('range-loanamount');
            var loanAmountInput = $('#loanamount-inp');

            noUiSlider.create(loanAmountSlider, {
                start: Number(emiDetails.minLoanAmm.replace(/,/g, '')),
                connect: [true, false],
                step: 5000,
                orientation: 'horizontal',
                range: {
                    'min': Number(emiDetails.minLoanAmm.replace(/,/g, '')),
                    'max': Number(emiDetails.maxLoanAmm.replace(/,/g, ''))
                },
            });

            loanAmountSlider.noUiSlider.on('update', function (val) {
                loanAmountInput.val(parseInt(val[0]).toLocaleString('EN-IN'));
                renderEMICalculation();
            });

            loanAmountInput.on('change', function () {
                var amt = $(this).val().replace(/,/g, '');
                loanAmountSlider.noUiSlider.set(amt, true);
                renderEMICalculation();
            });

            var tenureSlider = document.getElementById('range-tol');
            var tenureInput = $('#mm-yy-inp');

            noUiSlider.create(tenureSlider, {
                start: Number(emiDetails.minTenure.replace(/,/g, '')),
                connect: [true, false],
                step: 1,
                orientation: 'horizontal',
                range: {
                    'min': Number(emiDetails.minTenure.replace(/,/g, '')),
                    'max': Number(emiDetails.maxTenure.replace(/,/g, ''))
                },
            });

            tenureSlider.noUiSlider.on('update', function (val) {
                tenureInput.val(Number(val[0]).toFixed(0));
                renderEMICalculation();
            });

            tenureInput.on('change', function () {
                var tenure = $(this).val().replace(/,/g, '');
                tenureSlider.noUiSlider.set(tenure, true);
                renderEMICalculation();
            });

            var rateOfInterest = document.getElementById('range-roi');
            var rateOfInterestInput = $('#roi-inp');

            noUiSlider.create(rateOfInterest, {
                start: Number(emiDetails.minRateOfInterest.replace(/,/g, '')),
                connect: [true, false],
                step: 0.1,
                orientation: 'horizontal',
                range: {
                    'min': Number(emiDetails.minRateOfInterest.replace(/,/g, '')),
                    'max': Number(emiDetails.maxRateOfInterest.replace(/,/g, ''))
                },
            });

            rateOfInterest.noUiSlider.on('update', function (val) {
                rateOfInterestInput.val(parseFloat(val[0]));
                renderEMICalculation();

            });

            rateOfInterestInput.on('change', function () {
                var amt = $(this).val();
                rateOfInterest.noUiSlider.set(amt, true);
                renderEMICalculation();
            });

            $('.bs-pers-sl-dd-li').on('mousedown');
            $('.bs-pers-sl-dd-li').on('mousedown', function () {
                var _this = $(this);
                var inpText = _this.text().trim();
                var tolval = Number(tenureInput.val());
                if (!(_this.hasClass('selected'))) {
                    _this.parent().siblings('.bs-pers-sl-dd-inp').val(inpText).change();
                    if (inpText == "Months") {
                        var tolval = Math.round(Number(tolval) * 12);
                        tenureSlider.noUiSlider.updateOptions({
                            start: Number(emiDetails.minTenure.replace(/,/g, '')),
                            range: {
                                'min': Number(emiDetails.minTenure.replace(/,/g, '')),
                                'max': Number(emiDetails.maxTenure.replace(/,/g, ''))
                            }
                        });
                        tenureSlider.noUiSlider.set(tolval, true);
                    } else {
                        var tolval = Math.floor(Number(tolval) / 12);
                        tenureSlider.noUiSlider.updateOptions({
                            start: Number(emiDetails.minTenure.replace(/,/g, '')) / 12,
                            range: {
                                'min': Number(emiDetails.minTenure.replace(/,/g, '')) / 12,
                                'max': Number(emiDetails.maxTenure.replace(/,/g, '')) / 12
                            }
                        });
                        tenureSlider.noUiSlider.set(tolval, true);
                    }
                }
                _this.addClass('selected').siblings().removeClass('selected');
            });

            var readValue = readInputParam();
            renderEMICalculation();
        } catch (error) {
            console.log(error);
        }
        try {
            if (document.querySelector(".aa-emicalc-aplynow")) {
                document.querySelector(".aa-emicalc-aplynow").addEventListener("click", function (event) {
                    try {
                        var calcDetails = readInputParam();
                        var tenureType = $('#loantenure-dd').val().trim();
                        var term = (tenureType == "Months") ? Number(calcDetails.tenure) : Number(calcDetails.tenure) * 12;
                        emiCalculatorApplyNow(calcDetails.loanAmount, term.toString(), calcDetails.roi);
                    } catch (e) {
                        console.log(e);
                    };
                    window.location.href = this.dataset.href;
                });
            }
        } catch (e) { console.log(e); }
    }
});
window.addEventListener('load', function (event) {
    try {
        $('#loanamount-inp').val(emiDetails.minLoanAmm.toLocaleString('EN-IN'));
        $('#mm-yy-inp').val(emiDetails.minTenure.toLocaleString('EN-IN'));
        $('#roi-inp').val(emiDetails.minRateOfInterest.toLocaleString('EN-IN'));
    } catch (error) {
        console.log(error);
    }
});
var monthsShort = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
//for fetch input values
function readInputParam() {
    return {
        loanAmount: document.getElementById("loanamount-inp").value.replace(/\,/g, ''),
        roi: document.getElementById("roi-inp").value.replace(/\,/g, ''),
        tenure: document.getElementById("mm-yy-inp").value.replace(/\,/g, ''),
    };
}

//EMI Calculator Logic Start
function calculateEMI(loan) {
    var interest = loan.roi / 1200;
    var tenureType = $('#loantenure-dd').val().trim();
    var term = tenureType == "Months" ? loan.tenure : loan.tenure * 12;
    // var term = loan.tenure ;
    var top = Math.pow(1 + interest, term);
    var bottom = top - 1;
    var ratio = top / bottom;

    var EMI = loan.loanAmount * interest * ratio;
    var Total = EMI * term;
    var TotalRoi = EMI * term - loan.loanAmount;
    const emiObj = {
        EMI: EMI.toFixed(0),
        Total: Total.toFixed(0),
        principalAmount: loan.loanAmount,
        totalInterest: TotalRoi.toFixed(0),
    };
    renderEmiTableData((getEmiMonthwiseData(loan.loanAmount, term, loan.roi)).emipermonth);
    updateMap((getEmiMonthwiseData(loan.loanAmount, term, loan.roi)).emipermonth);
    return emiObj;
}

function renderEmiTableData(emiData) {
    var rowBodyStart = '<tr class="bs-peremical-bd-rw bs-peremical-rw-details"> <td class="bs-peremical-dt-details" colspan="4"> <div class="bs-peremical-details-tbldiv"> <table class="bs-peremical-details-tbl"> <tbody>';
    var rowBodyEnd = '</tbody> </table> </div> </td> </tr>';
    var emiTable = "";
    Object.keys(emiData).sort().forEach(function(year) {
        var yearHtml = "";
        var principal = 0,
            interest = 0,
            balance = 0;
        emiData[year].forEach(function(month) {
            interest += month["interestcontri"];
            principal += month["principlecontri"];
            balance = month["endbal"];
            yearHtml += '<tr class="bs-peremical-bd-rw"> <td class="bs-peremical-bd-dt pd-first">' + month["month"] + '</td> <td class="bs-peremical-bd-dt">₹ ' + (month["principlecontri"]).toLocaleString("EN-In") + '</td> <td class="bs-peremical-bd-dt">₹ ' + (month["interestcontri"]).toLocaleString("EN-In") + '</td> <td class="bs-peremical-bd-dt">₹ ' + (month["endbal"]).toLocaleString("EN-In") + '</td> </tr>';
        });
        var rowHead = '<tr class="bs-peremical-bd-rw bs-peremical-bd-rw-bg"> <td class="bs-peremical-bd-dt yr-pl-sign"> <span class="tbl-pl"></span>' + year + '</td> <td class="bs-peremical-bd-dt">₹ ' + principal.toLocaleString("EN-In") + '</td> <td class="bs-peremical-bd-dt">₹ ' + interest.toLocaleString("EN-In") + '</td> <td class="bs-peremical-bd-dt">₹ ' + balance.toLocaleString("EN-In") + '</td> </tr>';
        emiTable += rowHead + rowBodyStart + yearHtml + rowBodyEnd;
    });
    document.querySelector(".emi-calc-table-data").innerHTML = "";
    document.querySelector(".emi-calc-table-data").innerHTML = emiTable;
    $('.yr-pl-sign').off('click');
    $('.yr-pl-sign').on('click', function() {
        $(this).toggleClass('clicked');
        $(this).parent().next().find('.bs-peremical-details-tbldiv').slideToggle();
    });
}

function renderEMICalculation() {
    var emiInputs = readInputParam();
    var emiCalculations = calculateEMI(emiInputs);
    changeChart(Number(parseInt(emiCalculations.principalAmount)), Number(parseInt(emiCalculations.totalInterest)));
    document.getElementById("emiAmt").innerHTML = "₹" + Number(parseInt(emiCalculations.EMI).toFixed(0)).toLocaleString("EN-In");
    document.getElementById("totAmtPayable").innerHTML = "₹" + Number(parseInt(emiCalculations.Total).toFixed(0)).toLocaleString("EN-In");
    document.getElementById("pricipleAmt").innerHTML = "₹" + Number(parseInt(emiCalculations.principalAmount).toFixed(0)).toLocaleString("EN-In");
    document.getElementById("totInterest").innerHTML = "₹" + Number(parseInt(emiCalculations.totalInterest).toFixed(0)).toLocaleString("EN-In");
    document.querySelector(".sel-rateofinterest").innerHTML = emiInputs.roi;
    document.querySelector(".sel-months").innerHTML = $('#loantenure-dd').val().trim().toLowerCase() == 'months' ? emiInputs.tenure : Number(emiInputs.tenure) * 12;

}

function getEmiMonthwiseData(loanAmmount, tenure, interestRate) {
    var date = new Date();
    loanAmmount = Number(loanAmmount);
    tenure = Number(tenure);
    interestRate = Number(interestRate);
    var rate = (interestRate / (12 * 100));
    var intRate = rate + 1;
    intRate = Math.pow(intRate, tenure);
    var emi = Number(((loanAmmount * rate * intRate) / (intRate - 1)));
    var emiDataPerMonth = [];
    var startBalance = loanAmmount;
    var totalInterest = 0;
    for (var eachMonth = 1; eachMonth <= tenure; eachMonth++) {
        date.setMonth(date.getMonth() + 1);
        if (!emiDataPerMonth[date.getFullYear()]) {
            emiDataPerMonth[date.getFullYear()] = [];
        }
        var principleContribution, interestContribution, endingBalance, eachMonthData = {};
        interestContribution = Number((startBalance * rate).toFixed(2));
        principleContribution = Number((emi - interestContribution).toFixed(2));
        endingBalance = Number((startBalance - principleContribution));
        totalInterest += Number(interestContribution.toFixed());
        eachMonthData.month = Number(eachMonth);
        eachMonthData.startbal = Number(startBalance.toFixed());
        eachMonthData.principlecontri = Number(principleContribution.toFixed());
        eachMonthData.interestcontri = Number(interestContribution.toFixed());
        eachMonthData.endbal = Number(endingBalance.toFixed()) <= 0 ? 0 : Number(endingBalance.toFixed()) == 1 ? 0 : Number(endingBalance.toFixed());
        eachMonthData.emi = Number(emi.toFixed());
        eachMonthData.year = date.getFullYear();
        eachMonthData.month = monthsShort[date.getMonth()];
        emiDataPerMonth[date.getFullYear()].push(eachMonthData);
        startBalance = endingBalance;
    }
    var emiData = {};
    emiData.loanAmmount = loanAmmount;
    emiData.rate = interestRate;
    emiData.tenure = tenure;
    emiData.totalInterest = Number(totalInterest.toFixed());
    emiData.emipermonth = emiDataPerMonth;
    return emiData;
}

function updateMap(emiData) {
    var years = Object.keys(emiData);
    var principal = [],
        interest = [],
        balance = [];
    Object.keys(emiData).forEach(function(year) {
        var p = 0,
            i = 0,
            b = 0;
        emiData[year].forEach(function(month) {
            p += (month["principlecontri"]);
            i += (month["interestcontri"]);
            b = (month["endbal"]) < 0 ? 0 : (month["endbal"]);
        })
        principal.push(p);
        interest.push(i);
        balance.push(b);
    })
    window.pl_calc_barchart.data.datasets[0].data = principal;
    window.pl_calc_barchart.data.datasets[1].data = interest;
    window.pl_calc_barchart.data.datasets[2].data = balance;
    window.pl_calc_barchart.data.labels = years;
    window.pl_calc_barchart.update();
}

function changeChart(pammount, interest) {
    window.pl_emi_dg.data.datasets[0].data = [pammount, interest];
    window.pl_emi_dg.update();
}
jQuery(function () {
    try{
function initalizePieChart() {
    
    var config = {
        type: 'doughnut',
        data: {
            datasets: [{
                data: [100 ,50],
                backgroundColor: [
                    '#004164',
                    '#ff5a28'
                ],
                borderWidth: 0,
                weight: 1,
            }],
            
            labels:["Total Investment", "Total Interest"]
        },
        options: {
            tooltips: {
                callbacks: {
                    label: function(tooltipItem, data) {
                        var label = data.labels[tooltipItem.index] + " : ₹" +  data.datasets[0].data[tooltipItem.index].toLocaleString('EN-IN') || '';
                        return label;
                    }
                }
            },
            responsive: true,
            legend: false,
            animation: {
                animateScale: false,
                animateRotate: true,
            },
            rotation: 180,
            cutoutPercentage: 75
        }
    };
    
    var pl_sukanya_calc_chart = document.getElementById('pl-sukanya-chart').getContext('2d');
    window.pl_sukanya_dg = new Chart(pl_sukanya_calc_chart, config);

}
initalizePieChart();

    var yearly_investment_sl = document.getElementById('range-yr-investment');
    var yearly_investment_inp = $('#yr-investment-inp');
    noUiSlider.create(yearly_investment_sl, {
        start: Number(sukanyaCalcDetails["minYrInvestment"].replace(/,/g, '')),
        connect: [true, false],
        step: 100,
        orientation: 'horizontal',
        range: {
            'min': Number(sukanyaCalcDetails["minYrInvestment"].replace(/,/g, '')),
            'max': Number(sukanyaCalcDetails["maxYrInvestment"].replace(/,/g, ''))
        },
    });

    yearly_investment_sl.noUiSlider.on('update', function (val) {
        yearly_investment_inp.val(parseInt(val[0]).toLocaleString('EN-IN'));
        renderSukanyaCalculation();
        
    });

    yearly_investment_inp.on('change', function () {
        var yr_investment = $(this).val().replace(/,/g, '');
        yearly_investment_sl.noUiSlider.set( yr_investment);
        renderSukanyaCalculation();
        
    });

    var girl_age_sl = document.getElementById('range-girl-age');
    var girl_age_inp = $('#girl-age-inp');
    noUiSlider.create(girl_age_sl, {
        start: Number(sukanyaCalcDetails["minGirlAge"].replace(/,/g, '')),
        connect: [true, false],
        step: 1,
        orientation: 'horizontal',
        range: {
            'min': Number(sukanyaCalcDetails["minGirlAge"].replace(/,/g, '')),
            'max': Number(sukanyaCalcDetails["maxGirlAge"].replace(/,/g, ''))
        },
    });

    girl_age_sl.noUiSlider.on('update', function (val) {
        girl_age_inp.val(parseInt(val[0]).toLocaleString('EN-IN'));
        renderSukanyaCalculation();
    });

    girl_age_inp.on('change', function () {
        var girl_age = $(this).val().replace(/,/g, '');
        girl_age_sl.noUiSlider.set( girl_age);
        renderSukanyaCalculation();
    });

    var start_year_sl = document.getElementById('range-start-year');
    var start_year_inp = $('#start-year-inp');
    noUiSlider.create(start_year_sl, {
        start: Number(sukanyaCalcDetails["minYear"]),
        connect: [true, false],
        step: 1,
        orientation: 'horizontal',
        range: {
            'min': Number(sukanyaCalcDetails["minYear"]),
            'max': Number(sukanyaCalcDetails["maxYear"])
        },
    });

    start_year_sl.noUiSlider.on('update', function (val) {
        start_year_inp.val(parseInt(val[0]));
        renderSukanyaCalculation();
    });

    start_year_inp.on('change', function () {
        var start_year = $(this).val();
        start_year_sl.noUiSlider.set( start_year);
        renderSukanyaCalculation();
    });
    $(".aa-compcalc-lnk").on('click', function (e) {
            e.preventDefault();
            try {
                bannerClick("");
            } catch (e) {
                console.log(e);
            }
            window.location.href = window.location.origin + this.dataset.href;
        });

        $(".aa-compcalc-cta").on('click', function (e) {
            e.preventDefault();
            try {
                var ctaText = this.innerText.trim();
                ctaInteraction(ctaText, productName);
            } catch (e) {
                console.log(e);
            }
            window.location.href = window.location.origin + this.dataset.href;
        });
    }catch(e){
        console.log("Sukanya Caclulator",e);
    }
});
function sunkanyaInpPararmeter(){
    return {
        yearly_investment :document.getElementById('yr-investment-inp').value.replace(/\,/g, ''),
        girl_age : document.getElementById('girl-age-inp').value,
        start_year : document.getElementById('start-year-inp').value,
    };
}

function calculateSukanyaYojna(ssy){
    var opening_bal = 0;
    var count = 0;
    var yr_investment = parseInt(ssy.yearly_investment);
    var interest = sukanyaCalcDetails.interestRate;
    var year_invested_for = sukanyaCalcDetails.YearInvestedFor;
    for(i = 0 ; i < year_invested_for ; i++){
    var interest_end_of_yr = (opening_bal + yr_investment)/100 * interest;
    var bal_end_of_yr = opening_bal + yr_investment + interest_end_of_yr;
    var total_investment = yr_investment * (count+1);
    var girlAge = Number(ssy.girl_age);
    var year = Number(parseInt(ssy.start_year)) + Number(parseInt(year_invested_for)) ;
    opening_bal = bal_end_of_yr;
    var sukanyaObj = {
        Total_Investment : total_investment,
        Maturity_Value : Math.round(bal_end_of_yr),
        Total_interest : Math.round(interest_end_of_yr),
        Year : year,
        GirlAge : girlAge,
    };
    sukanyaObj[count];
    ++count;
}
    return sukanyaObj;
}

//for render calculation
function renderSukanyaCalculation(){
    var sukanyaInputs = sunkanyaInpPararmeter();
    var ssyCalculation = calculateSukanyaYojna(sukanyaInputs);
    document.getElementById("maturityValue").innerHTML = "₹" + ssyCalculation.Maturity_Value.toLocaleString("EN-In");
    document.getElementById("maturity_val").innerHTML = "₹" + ssyCalculation.Maturity_Value.toLocaleString("EN-In");
    document.getElementById("maturity_yr").innerHTML = ssyCalculation.Year;
    document.getElementById("totalInvestment").innerHTML = "₹" + ssyCalculation.Total_Investment.toLocaleString("EN-In");
    document.getElementById("totalInterest").innerHTML = "₹" + ssyCalculation.Total_interest.toLocaleString("EN-In");
    document.getElementById("mob_maturity_yr").innerHTML = ssyCalculation.Year;
    sukanyaChangeChart(Number(ssyCalculation.Total_Investment), Number(ssyCalculation.Total_interest));
}

function sukanyaChangeChart(totInvestment, totinterest) {
    window.pl_sukanya_dg.data.datasets[0].data = [totInvestment , totinterest];
    window.pl_sukanya_dg.update();
}






try {
    getFormData("emi-form", function (sendData) {
        var analyticsData = new URLSearchParams(sendData);
        var analyticsDataObj = searchParamsConvertToData(analyticsData);
        if(document.querySelector("#cardEmiHybridContainer")){
            document.querySelector("#cardEmiHybridContainer").innerHTML="";
            document.querySelector("#cardEmiHybridContainer").style.display="none";
        }
        if(document.querySelector("#emiTermContainer")){
            document.querySelector("#emiTermContainer").innerHTML="";
            document.querySelector("#emiTermContainer").style.display = "none";
        }
    
        triggerEMICalculator(analyticsDataObj);
    
        var securedValue = document.getElementById("unsecured").value;
        if (securedValue !== undefined && securedValue !== null && securedValue !== "") {
            securedValue;
        } else {
            securedValue = document.getElementById("secured").value;
        }
    
        var value = securedValue;
    
        var formatData = sendData.split("&");
        var eachData = {};
        for (var i = 0; i < formatData.length; i++) {
            var eData = formatData[i].split("=");
            eachData[eData[0]] = eData[1];
        }
        var fleximonths = 0;
        if (eachData.isflexi == "Y" || eachData.isflexi == "y") {
            var months = Number(eachData.tenureloan);
            if (months >= 36 && months < 60) {
                fleximonths = 12;
            }else if(months >= 60){
                fleximonths = 24;
            }
        }
        var JsonDataTerm = callToGetEmiTermData(Number(eachData.loanamount), Number(eachData.tenureloan), Number(eachData.interestrate), fleximonths);
    
        if (value == "secured") {
            cardEMIDisplay(JsonDataTerm);
        } else {
            cardEMIDisplay(JsonDataTerm);
            if (eachData.isflexi == "Y" || eachData.isflexi == "y") {
                if(Number(eachData.tenureloan)>=36){
                    cardEMIHybridDisplay(JsonDataTerm);
                }
            }
        }
    
        var repaymentPopUpTerm = document.getElementById("repaymentPopUpTerm");
        if(repaymentPopUpTerm){
            repaymentPopUpTerm.addEventListener('click', function () { popUpScheduleDataTerm(JsonDataTerm); document.querySelector("#tab-1").classList.add("active"); });
            toggleLoader(false);
        }
        
        var repaymentPopUpHybrid = document.getElementById("repaymentPopUpHybrid");
        if(repaymentPopUpHybrid){
             repaymentPopUpHybrid.addEventListener('click', function () { popUpScheduleDataHybrid(JsonDataTerm); document.querySelector("#tab-1").classList.add("active"); });
                toggleLoader(false);
        }
       
    })
} catch (error) {
    console.log(error);
}

function popUpScheduleDataHybrid(JsonDataTerm) {
    popup_open("#loanPopup-emi");

    var table = document.getElementById("EMIcalcContainer");
    table.innerHTML = "";
    // JsonData.schedules.forEach(function (scheduleData, index, self) {
    var eachMasterData = JsonDataTerm.flexiemipermonth;
    for (eachdata = 0; eachdata < eachMasterData.length; eachdata++) {
        var emiSchedulesPopTableTemplate = document.getElementById("emiSchedulesPopTableTemplate").cloneNode(true);
        var cloneElement = emiSchedulesPopTableTemplate.content;

        cloneElement.querySelector("#index").innerHTML = eachMasterData[eachdata].month;
        cloneElement.querySelector("#balanceAmount").innerHTML = eachMasterData[eachdata].startbal.toLocaleString();
        cloneElement.querySelector("#emi").innerHTML = eachMasterData[eachdata].emi.toLocaleString();
        cloneElement.querySelector("#interestRate").innerHTML = JsonDataTerm.rate;
        cloneElement.querySelector("#principalDistribution").innerHTML = eachMasterData[eachdata].principlecontri.toLocaleString();
        cloneElement.querySelector("#interestDistribution").innerHTML = eachMasterData[eachdata].interestcontri.toLocaleString();
        cloneElement.querySelector("#reduceBalance").innerHTML = eachMasterData[eachdata].endbal === -0 ? 0 : eachMasterData[eachdata].endbal.toLocaleString();

        table.appendChild(cloneElement);
    }
}



function popUpScheduleDataTerm(JsonDataTerm) {

    popup_open("#loanPopup-emi");
    var interestRate = document.getElementById("interestrate").value;

    var table = document.getElementById("EMIcalcContainer");
    table.innerHTML = "";

    var eachMasterData = JsonDataTerm.emipermonth;
    for (eachdata = 0; eachdata < eachMasterData.length; eachdata++) {

        var emiSchedulesPopTableTemplate = document.getElementById("emiSchedulesPopTableTemplate").cloneNode(true);
        var cloneElement = emiSchedulesPopTableTemplate.content;

        cloneElement.querySelector("#index").innerHTML = eachMasterData[eachdata].month;
        cloneElement.querySelector("#balanceAmount").innerHTML = eachMasterData[eachdata].startbal.toLocaleString();
        cloneElement.querySelector("#emi").innerHTML = eachMasterData[eachdata].emi.toLocaleString();
        cloneElement.querySelector("#interestRate").innerHTML = JsonDataTerm.rate;
        cloneElement.querySelector("#principalDistribution").innerHTML = eachMasterData[eachdata].principlecontri.toLocaleString();
        cloneElement.querySelector("#interestDistribution").innerHTML = eachMasterData[eachdata].interestcontri.toLocaleString();
        cloneElement.querySelector("#reduceBalance").innerHTML = eachMasterData[eachdata].endbal === -0 ? 0 : eachMasterData[eachdata].endbal.toLocaleString();

        table.appendChild(cloneElement);
    }
}


function cardEMIDisplay(JsonDataTerm) {


    var totalprofitcal = JsonDataTerm.totalInterest;
    var totalAmtcal = Number(JsonDataTerm.loanAmmount) + Number(JsonDataTerm.totalInterest);

    var interestRate = JsonDataTerm.rate;

    var emiTermContainer = document.getElementById("emiTermContainer");
    emiTermContainer.innerHTML = "";
    var cardEMIDisplayTemplate = document.getElementById("cardEMIDisplayTemplate").cloneNode(true);

    var contentElement = cardEMIDisplayTemplate.content;

    contentElement.querySelector("#title").innerHTML = "Term Loan";
    contentElement.querySelector("#emiTermNewPrice").innerHTML = "₹ " + Number(JsonDataTerm.emipermonth[0].emi).toLocaleString();
    contentElement.querySelector("#emiTermNewPrice").innerHTML = "₹ " + Number(JsonDataTerm.emipermonth[0].emi).toLocaleString();
    contentElement.querySelector("#termrepayold").innerHTML = "₹ " + totalAmtcal.toLocaleString();
    contentElement.querySelector("#termrepaynew").innerHTML = "₹ " + totalAmtcal.toLocaleString();
    contentElement.querySelector("#terminterestold").innerHTML = interestRate + " %";
    contentElement.querySelector("#terminterestold").innerHTML = interestRate + " %";
    contentElement.querySelector("#termprofitold").innerHTML = "₹ " + totalprofitcal.toLocaleString();
    contentElement.querySelector("#termprofitnew").innerHTML = "₹ " + totalprofitcal.toLocaleString();

    findSelectorParent(document.getElementById("thankyoucontainer"), ".emi").style.display = "block";

    emiTermContainer.appendChild(contentElement);
    emiTermContainer.style.display="block";

}


function cardEMIHybridDisplay(JsonDataTerm) {

    var totalAmtcal = Number(JsonDataTerm.loanAmmount) + Number(JsonDataTerm.FlexiTotalInterest);
    var emiTermContainer = document.getElementById("cardEmiHybridContainer");
    emiTermContainer.innerHTML = "";
    var cardEMIHybridDisplayTemplate = document.getElementById("cardEMIHybridDisplayTemplate").cloneNode(true);

    var contentElement = cardEMIHybridDisplayTemplate.content;

    contentElement.querySelector("#title").innerHTML = "Hybrid Flexi";
    contentElement.querySelector("#emihybridOldPrice").innerHTML = "₹ " + Number(JsonDataTerm.flexiemipermonth[0].emi).toLocaleString();
    contentElement.querySelector("#emihybridNewPrice").innerHTML = "₹ " + Number(JsonDataTerm.flexiemipermonth[0].emi).toLocaleString();
    contentElement.querySelector("#hybridrepayold").innerHTML = "₹ " + totalAmtcal.toLocaleString();
    contentElement.querySelector("#hybridrepaynew").innerHTML = "₹ " + totalAmtcal.toLocaleString();
    contentElement.querySelector("#hybridinterestold").innerHTML = JsonDataTerm.rate + " %";
    contentElement.querySelector("#hybridinterestnew").innerHTML = JsonDataTerm.rate + " %";
    contentElement.querySelector("#hybridprofitold").innerHTML = "₹ " + Number(JsonDataTerm.FlexiTotalInterest).toLocaleString();
    contentElement.querySelector("#hybridprofitnew").innerHTML = "₹ " + Number(JsonDataTerm.FlexiTotalInterest).toLocaleString();

    emiTermContainer.appendChild(contentElement);
    emiTermContainer.style.display= "block";
    findSelectorParent(document.getElementById("thankyoucontainer"), ".emi").style.display = "block";

}
var callToGetEmiTermData = function callForGetEmiData(loanAmmount, tenure, interestRate, flexiEmiMonth) {

    flexiEmiMonth = Number(flexiEmiMonth);
    loanAmmount = Number(loanAmmount);
    tenure = Number(tenure);
    interestRate = Number(interestRate);
    var rate = (interestRate / (12 * 100));
    var intRate = rate + 1;
    intRate = Math.pow(intRate,tenure);
    var emi = Number(((loanAmmount * rate * intRate) / (intRate - 1)).toFixed(2));
    var emiDataPerMonth = [];
    var startBalance = loanAmmount;
    var totalInterest = 0;
    for (var eachMonth = 1; eachMonth <= tenure; eachMonth++) {
        var principleContribution, interestContribution, endingBalance, eachMonthData = {};
        interestContribution = Number((startBalance * rate).toFixed(2));
        principleContribution = Number((emi - interestContribution).toFixed(2));
        endingBalance = Number((startBalance - principleContribution).toFixed(2));
        totalInterest += Number(interestContribution.toFixed());
        eachMonthData.month = Number(eachMonth);
        eachMonthData.startbal = Number(startBalance.toFixed());
        eachMonthData.principlecontri = Number(principleContribution.toFixed());
        eachMonthData.interestcontri = Number(interestContribution.toFixed());
        eachMonthData.endbal = Number(endingBalance.toFixed());
        eachMonthData.emi = emi.toFixed();
        emiDataPerMonth.push(eachMonthData);
        startBalance = endingBalance;
    }
    var emiData = {};
    emiData.loanAmmount = loanAmmount;
    emiData.rate = interestRate;
    emiData.tenure = tenure;
    emiData.totalInterest = Number(totalInterest.toFixed());
    emiData.emipermonth = emiDataPerMonth;

    /* For Flexi */
    var FlexiEmiDataPerMonth = [];
    var flexiStartBalance = loanAmmount;
    var FlexiTotalInterest = 0;
    var flexiEmi = flexiStartBalance * rate;
    var flexiintRate = rate + 1;
    flexiintRate = Math.pow(flexiintRate,(tenure - flexiEmiMonth));
    var nonFlexiEmi = Number(((loanAmmount * rate * flexiintRate) / (flexiintRate - 1)).toFixed(2));
    for (var eachMonth = 1; eachMonth <= tenure; eachMonth++) {
        var flexiPrincipleContribution, flexiInterestContribution, flexiEndingBalance, flexiEmiData = {};
        if (eachMonth <= flexiEmiMonth) {
            flexiEmiData.month = Number(eachMonth);
            flexiEmiData.startbal = flexiStartBalance;
            flexiEmiData.principlecontri = 0;
            flexiEmiData.interestcontri = flexiEmi.toFixed();
            flexiEmiData.endbal = flexiStartBalance;
            flexiEmiData.emi = flexiEmi.toFixed();
            FlexiTotalInterest += Number(flexiEmi.toFixed());
        } else {
            flexiInterestContribution = Number((flexiStartBalance * rate).toFixed(2));
            flexiPrincipleContribution = Number((nonFlexiEmi - flexiInterestContribution).toFixed(2));
            flexiEndingBalance = Number((flexiStartBalance - flexiPrincipleContribution).toFixed(2));
            FlexiTotalInterest += Number(flexiInterestContribution);
            flexiEmiData.month = Number(eachMonth);
            flexiEmiData.startbal = Number(flexiStartBalance.toFixed());
            flexiEmiData.principlecontri = Number(flexiPrincipleContribution.toFixed());
            flexiEmiData.interestcontri = Number(flexiInterestContribution.toFixed());
            flexiEmiData.endbal = Number(flexiEndingBalance.toFixed());
            flexiEmiData.emi = nonFlexiEmi.toFixed();
            flexiStartBalance = flexiEndingBalance;
        }
        FlexiEmiDataPerMonth.push(flexiEmiData);
    }
    emiData.FlexiTotalInterest = Number(FlexiTotalInterest.toFixed());
    emiData.flexiemipermonth = FlexiEmiDataPerMonth;

    return emiData;
}

function incometaxApplyClick(){
	triggerLoanEMIApplyNow();
	UTMCheck(event.currentTarget);
}
function calculateLoanAmout(netMonthlyIncome, netMonthlyEMI, loanPerson) {
	var emi = Math.round((netMonthlyIncome * 55 / 100) - netMonthlyEMI);
	var roi;
	var tenure = emiEligibilityDetails.tenure;
	var eLoanAmount;
	var maxLoanAmount = 2500000;
	var minLoanAmount = 0;

	if (loanPerson == 'salaried') {
		roi = emiEligibilityDetails.roiSalaried / 100;
	}
	else {
		roi = emiEligibilityDetails.roiSelfEmployed / 100;
	}

	eLoanAmount = Math.round((emi * (Math.pow((1 + roi / 12), tenure) - 1) / (roi / 12 * Math.pow((1 + roi / 12), tenure))));
	var numSign = eLoanAmount > 0 ? 1 : eLoanAmount == 0 ? 0 : -1;

	if (numSign == 0 || numSign == -1) {
		$('.e-loanamount').text(minLoanAmount);
	} else {
		if (eLoanAmount <= maxLoanAmount) {
			$('.e-loanamount').text(eLoanAmount.toLocaleString('EN-IN'));
		}
		else {
			$('.e-loanamount').text(maxLoanAmount.toLocaleString('EN-IN'));
		}
	}
}

jQuery(function () {

	if ($('.c-plecalc').length > 0) {

		var monthlyIncomeSlider = document.getElementById('range-monthlyincome');
		var monthlyIncomeInput = $('#monthlyincome-inp');

		var monthlyEMISlider = document.getElementById('range-monthlyemi');
		var monthlyEMIInput = $('#monthlyemi-inp');

		var loanFor = $('.pl-tab.active').attr('data-loan');
		var netMonthlyIncomeVal = Number(monthlyIncomeInput.val());
		var netMonthlyEMIVal = Number(monthlyEMIInput.val());

		$('.pl-tab').on('click', function () {
			$(this).addClass('active').siblings().removeClass('active');
			loanFor = $(this).attr('data-loan');
			calculateLoanAmout(netMonthlyIncomeVal, netMonthlyEMIVal, loanFor);
		});

		noUiSlider.create(monthlyIncomeSlider, {
			start: Number(emiEligibilityDetails.minAmount.replace(/,/g, '')),
			connect: [true, false],
			step: 5000,
			orientation: 'horizontal',
			range: {
				'min': Number(emiEligibilityDetails.minAmount.replace(/,/g, '')),
				'max': Number(emiEligibilityDetails.maxAmount.replace(/,/g, ''))
			},
		});

		monthlyIncomeSlider.noUiSlider.on('update', function (val) {
			monthlyIncomeInput.val(parseInt(val[0]).toLocaleString('EN-IN'));
			netMonthlyIncomeVal = parseInt(val[0]);
			calculateLoanAmout(netMonthlyIncomeVal, netMonthlyEMIVal, loanFor);

		});

		monthlyIncomeInput.on('change', function () {
			var amt = $(this).val().replace(/,/g, '');
			monthlyIncomeSlider.noUiSlider.set(amt, true);
		});

		noUiSlider.create(monthlyEMISlider, {
			start: Number(emiEligibilityDetails.minEMI.replace(/,/g, '')),
			connect: [true, false],
			step: 5000,
			orientation: 'horizontal',
			range: {
				'min': Number(emiEligibilityDetails.minEMI.replace(/,/g, '')),
				'max': Number(emiEligibilityDetails.maxEMI.replace(/,/g, ''))
			},
		});

		monthlyEMISlider.noUiSlider.on('update', function (val) {
			monthlyEMIInput.val(parseInt(val[0]).toLocaleString('EN-IN'));
			netMonthlyEMIVal = parseInt(val[0]);
			calculateLoanAmout(netMonthlyIncomeVal, netMonthlyEMIVal, loanFor);
		});

		monthlyEMIInput.on('change', function () {
			var amt = $(this).val().replace(/,/g, '');
			monthlyEMISlider.noUiSlider.set(amt, true);
		});
	}

});


jQuery(function () {
    if ($('.c-bmi-calc').length > 0) {
        var bmiClSlider;
        var personHeight;
        var personWeight;
        var height_inp = $("#bmi-height-inch");
        var heightFeet = $("#bmi-height-feet");
        var personHeightInch = Number(height_inp.val());
        var personHeightFeet = Number(heightFeet.val());

        bmiClSlider = document.getElementById('bmi-bmicl-sl');
        noUiSlider.create(bmiClSlider, {
            start: 18,
            orientation: "horizontal",
            range: {
                'min': [0],
                '25%': [18.5],
                '50%': [25],
                '75%': [30],
                'max': [40]
            }
        });
        bmiClSlider.setAttribute('disabled', true);

        var weight_sl = document.getElementById("bmi-weight-sl");
        var weight_inp = $("#bmi-weight-inp");
        noUiSlider.create(weight_sl, {
            start: Number(bmiDetails.minWeight),
            connect: [true, false],
            step: 1,
            orientation: "horizontal",
            range: {
                min: Number(bmiDetails.minWeight),
                max: Number(bmiDetails.maxWeight),
            },
        });

        weight_sl.noUiSlider.on("update", function (val) {
            weight_inp.val(parseFloat(val[0]));
            personWeight = parseFloat(val[0]);
            calcBMI(personWeight, personHeight);
        });

        weight_inp.on("change", function () {
            var amt = $(this).val();
            weight_sl.noUiSlider.set(amt, true);
        });

        var age_sl = document.getElementById("bmi-age-sl");
        var age_inp = $("#bmi-age-inp");
        noUiSlider.create(age_sl, {
            start: Number(bmiDetails.minAge),
            connect: [true, false],
            step: 1,
            orientation: "horizontal",
            range: {
                min: Number(bmiDetails.minAge),
                max: Number(bmiDetails.maxAge),
            },
        });

        age_sl.noUiSlider.on("update", function (val) {
            age_inp.val(parseFloat(val[0]));
        });

        age_inp.on("change", function () {
            var amt = $(this).val();
            age_sl.noUiSlider.set(amt, true);
        });

        age_inp.on('input',function(e){
            e.target.value = e.target.value.substr(0,3);
        });

        var height_sl = document.getElementById("bmi-height-sl");

        noUiSlider.create(height_sl, {
            start: Number(bmiDetails.minHeight),
            connect: [true, false],
            step: 1,
            orientation: "horizontal",
            range: {
                min: Number(bmiDetails.minHeight),
                max: Number(bmiDetails.maxHeight),
            },
        });

        height_sl.noUiSlider.on("update", function (val) {
            toFeetInch(val[0]);
            personHeight = Number(val[0]);
            personHeightInch = Number(height_inp.val());
            personHeightFeet = Number(heightFeet.val());
            calcBMI(personWeight, personHeight);
        });

        height_inp.on("change", function () {
            personHeightInch = Number($(this).val());
            var sl_height_cm = toCentimeter(personHeightFeet, personHeightInch);
            height_sl.noUiSlider.set(sl_height_cm, true);
        });

        heightFeet.on("change", function () {
            personHeightFeet = Number($(this).val());
            var sl_height_cm = toCentimeter(personHeightFeet, personHeightInch);
            height_sl.noUiSlider.set(sl_height_cm, true);
        });

        $(".gender-check").on("change", function () {
            if ($(this).is(":checked")) {
                $(this).parent().next().addClass("checked");
                $(this).parents(".gender-para").siblings().find(".gender-text").removeClass("checked");
            }
        });

        function toFeetInch(val) {
            var inches = (val * 0.393700787).toFixed(0);
            var feet = Math.floor(inches / 12);
            inches %= 12;

            document.getElementById("bmi-height-feet").value = feet;
            document.getElementById("bmi-height-inch").value = inches;
        }

        function calcBMI(weight, height) {
            var bmiValue = Number(weight / Math.pow(height, 2) * 10000);
            var finalBMI = bmiValue.toFixed(1);
            var bmiStatusField = $('.n-bs-bmi-stat-res');
            var bmiImageDesc = $('.n-bmi-d-txt');
            $('.n-bs-bmi-stat-txt-val').text(finalBMI);

            if (finalBMI < 18.5) {
                bmiStatusField.text(bmiDetails['messages'].underweight.status);
                bmiImageDesc.text(bmiDetails['messages'].underweight.description);
            }
            else if (finalBMI >= 18.5 && finalBMI < 25) {
                bmiStatusField.text(bmiDetails['messages'].normal.status);
                bmiImageDesc.text(bmiDetails['messages'].normal.description);
            }
            else if (finalBMI >= 25 && finalBMI < 30) {
                bmiStatusField.text(bmiDetails['messages'].overweight.status);
                bmiImageDesc.text(bmiDetails['messages'].overweight.description);
            }
            else {
                bmiStatusField.text(bmiDetails['messages'].obese.status);
                bmiImageDesc.text(bmiDetails['messages'].obese.description);
            }
            bmiClSlider.noUiSlider.set(finalBMI, true);
        }

        function toCentimeter(feet, inch) {
            if (feet_cm != 0 && inch_cm != 0) {
                var feet_cm = parseFloat(feet * 30.48);
                var inch_cm = parseFloat(inch * 2.54);
                return feet_cm + inch_cm;
            }
        }
    }
});


jQuery(function () {

    function initRSlider(obj) {
        noUiSlider.create(obj.slider, {
            start: Number(obj.start.replace(/,/g, '')),
            connect: [true, false],
            step: obj.step,
            orientation: 'horizontal',
            range: {
                'min': Number(obj.minRange.replace(/,/g, '')),
                'max': Number(obj.maxRange.replace(/,/g, ''))
            },
        });
    }

    function returnCurrentYear() {
        var getCurrentDate = new Date();
        var currentYear = getCurrentDate.getFullYear().toString();
        return currentYear;
    }

    function calculateIDV(exShowPriceVal, regYearVal) {
        var vehicleAge = Number(returnCurrentYear()) - regYearVal;
        var vehicleAgeText = vehicleAge;
        if (vehicleAge == 0) {
            vehicleAge = 1
        } else if (vehicleAge > 8) {
            vehicleAge = 9;
        }
        var depVal = exShowPriceVal * depreciationPercent[vehicleAge] / 100;
        var finalIDV = Math.round(exShowPriceVal - depVal);
        $('.idvfprice').text('₹' + finalIDV.toLocaleString('EN-IN'));
        $('.idvfyears').text(' ' + vehicleAgeText + ' ');
    }

    if ($('.c-idvcalc').length > 0) {

        var depreciationPercent = {
            1: 5,
            2: 15,
            3: 25,
            4: 30,
            5: 40,
            6: 45,
            7: 50,
            8: 55,
            9: 60
        };

        var exshowPriceInput = $('#exshowprice-inp');

        var sRegYearInput = $('#sregyear-inp');

        var exshowPriceInputVal = Number(exshowPriceInput.val());
        var sRegYearInputVal = Number(sRegYearInput.val());

        // Ex-Showroom slider
        var exshowPriceObj = {
            slider: document.getElementById('range-exshowprice'),
            start: idvDetails.minPrice,
            step: 1,
            minRange: idvDetails.minPrice,
            maxRange: idvDetails.maxPrice
        };

        initRSlider(exshowPriceObj);

        var regYearObj = {
            slider: document.getElementById('range-sregyear'),
            start: idvDetails.minRegYear,
            step: 1,
            minRange: idvDetails.minRegYear,
            maxRange: returnCurrentYear()
        }

        initRSlider(regYearObj);

        $('#make-dropdown').on('change', function () {
            $('.make-name').text($(this).val());
        });

        $('#make-dropdown').select2({
            placeholder: 'Select an option'
        }).change();

        exshowPriceObj.slider.noUiSlider.on('update', function (val) {
            exshowPriceInput.val(parseInt(val[0]).toLocaleString('EN-IN'));

            exshowPriceInputVal = parseInt(val[0]);
            calculateIDV(exshowPriceInputVal, sRegYearInputVal);

        });

        exshowPriceInput.on('change', function () {
            var amt = $(this).val().replace(/,/g, '');
            exshowPriceObj.slider.noUiSlider.set(amt, true);
        });


        regYearObj.slider.noUiSlider.on('update', function (val) {
            sRegYearInput.val(parseInt(val[0]));
            sRegYearInputVal = parseInt(val[0])

            calculateIDV(exshowPriceInputVal, sRegYearInputVal);

        });

        sRegYearInput.on('change', function () {
            var amt = $(this).val().replace(/,/g, '');
            regYearObj.slider.noUiSlider.set(amt, true);
        });
    }
});

function glUTMCheck(ele) {
    var utm_params;
    var urlParams = window.urlObj.search.includes("src_30") || window.urlObj.search.includes("src_60") || window.urlObj.search.includes("src_90") || window.urlObj.search.includes("pid") || window.urlObj.search.includes("utm_source");
    var confParams = window.urlObj.search.includes("prodCode") || window.urlObj.search.includes(" ");
    if (urlParams) {
        utm_params = window.urlObj.search;
        if ($(this).attr("target")) {
            if ($(this).attr("href").includes('?')) {
                if (utm_params.includes('&nav_src')) {
                    if (typeof $(ele).attr("href") !== typeof undefined && $(ele).attr("href") !== false) {
                        window.open($(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(ele).attr("target"));
                        return false;
                    }
                } else {
                    if (typeof $(ele).attr("href") !== typeof undefined && $(ele).attr("href") !== false) {
                        window.open($(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(ele).attr("target"));
                        return false;
                    }
                }
            } else {
                if (typeof $(ele).attr("href") !== typeof undefined && $(ele).attr("href") !== false) {
                    window.open($(ele).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(ele).attr("target"));
                    return false;
                }
            }
        } else {
            if (typeof $(ele).attr("href") !== typeof undefined && $(ele).attr("href") !== false) {
                if ($(ele).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        window.location.href = $(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                        return false;
                    }
                } else {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(ele).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        window.location.href = $(ele).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                        return false;
                    }
                }
            }
        }
    } else {
        if (typeof $(ele).attr("href") !== typeof undefined && $(ele).attr("href") !== false) {
            utm_params = utm;
            if ($(ele).attr("target")) {
                if ($(ele).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.open($(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(ele).attr("target"));
                        return false;
                    } else {
                        window.open($(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length), $(ele).attr("target"));
                        return false;
                    }
                } else {
                    window.open($(ele).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src')), $(ele).attr("target"));
                    return false;
                }
            } else {
                if ($(ele).attr("href").includes('?')) {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        if (utm_params.length > 0) {
                            window.location.href = $(ele).attr("href") + '&' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        } else {
                            window.location.href = $(ele).attr("href");
                            return false;
                        } /* window.location.href = $(ele).attr("href")+ '&' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length); return false; */
                    }
                } else {
                    if (utm_params.includes('&nav_src')) {
                        window.location.href = $(ele).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.indexOf('&nav_src'));
                        return false;
                    } else {
                        if (utm_params.length > 0) {
                            window.location.href = $(ele).attr("href") + '?' + utm_params.substring(utm_params.indexOf('?') + 1, utm_params.length);
                            return false;
                        } else {
                            window.location.href = $(ele).attr("href");
                            return false;
                        } /* window.location.href = $(ele).attr("href")+ '?' + utm_params.substring(utm_params.indexOf('?')+1,utm_params.length); return false; */
                    }
                }
            }
        }
    }
}
var repeatStatus = false;
var countriesData = {};
var countriesMasterData;
var JsonDataCityPincode;
var tosterFlag = false;
var getQuoteFormData = {};
/* New Datepicker */

function validateStartDate(event) {
    var curDate = new Date();
    var validateReturn = {
        "status": false,
        "startDate": ""
    }
    var parentContainer = "";
    if (document.getElementById("travelIndividual")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
    } else if (document.getElementById("travelfamily")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Family form : family");
    } else if (document.getElementById("travelstudent")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Student form : Student");
    } else {
        parentContainer = findSelectorParent(event.target, "FORM");
    }
    var dt = $(parentContainer).find("#tripStartDt").val();
    var mm = $(parentContainer).find("#tripStartMonth").val();
    var yy = $(parentContainer).find("#tripStartYear").val();
    if (mm == "" || yy.length != 4) {
        console.log("wrong date");
    } else {
        // startDate = dt+"/"+mm+"/"+yy;
        validateReturn.startDate = dt + "/" + mm + "/" + yy;
        document.getElementById("tripEndDate").value = validateReturn.startDate;
        var StartDateFormatVal = getFormattedDateTravel(dt, mm, yy);
        if (validateReturn.startDate === "DD/MM/YYYY") {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "StartDateErrorMsg"), "", false)
        } else {


            if (/(((0[1-9]|[12][0-9]|3[01])([-./])(0[13578]|10|12)([-./])(\d{4}))|(([0][1-9]|[12][0-9]|30)([-./])(0[469]|11)([-./])(\d{4}))|((0[1-9]|1[0-9]|2[0-8])([-./])(02)([-./])(\d{4}))|((29)(\.|-|\/)(02)([-./])([02468][048]00))|((29)([-./])(02)([-./])([13579][26]00))|((29)([-./])(02)([-./])([0-9][0-9][0][48]))|((29)([-./])(02)([-./])([0-9][0-9][2468][048]))|((29)([-./])(02)([-./])([0-9][0-9][13579][26])))/.test(validateReturn.startDate)) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "StartDateErrorMsg"), "", false);
                if (StartDateFormatVal < curDate) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "Please Enter Valid Start Date", true);
                    console.log("Enter a valid date");
                    return validateReturn;
                } else if (StartDateFormatVal > curDate.addDays(90)) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "Start Date should not exceed 90 days from Current Date", true);
                    return validateReturn;
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "", false);
                    validateReturn.status = true;
                    validateReturn.startDate = validateReturn.startDate;
                    return validateReturn;
                }
            } else if (validateReturn.startDate === "//") {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "Please Enter Start Date", true);
                return validateReturn;
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "Please Enter Valid Start Date", true);
                return validateReturn;
            }
        }
    }
    return validateReturn;
}

function searchPlans(selector, ajaxObj) {
    var path = (document.getElementById("get-quote-btn")) ? document
        .getElementById("get-quote-btn").getAttribute("data-href") :
        window.location.pathname.split(".")[0];
    AppEvent.trigger(selector, ajaxObj)
        .then(function(response) {
            if (response.status == "FAILURE") {
                toggleLoader(false);
                toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, "", {
                    timeOut: 10e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
            } else if (document.getElementById("travelType")) {
                if (response.status == "SUCCESS") {
                    response.payload.isCampaign = getQuoteFormData.isCampaign;
                    response.qid = "t" + generateRandom();
                    response.payload.startDate = getQuoteFormData.tripStartDate;
                    response.payload.endDate = getQuoteFormData.tripEndDate;
                    response.payload.insureRelation = JSON.parse(getQuoteFormData.insureRelation);
                    response.payload.travelType = getQuoteFormData.travelType;
                    response.payload.emailId = getQuoteFormData.emailId;
                    response.payload.mobileno = getQuoteFormData.mobileno;
                    response.payload.firstName = getQuoteFormData.firstName;
                    response.payload.lastName = getQuoteFormData.lastName;
                    localStorage.setItem("getQuoteData", JSON.stringify(response));

                    document.getElementById("tripStartDt").value = "";
                    document.getElementById("tripStartMonth").value = "";
                    document.getElementById("tripStartYear").value = "";
                    document.getElementById("tripEndDt").value = "";
                    document.getElementById("tripEndMonth").value = "";
                    document.getElementById("tripEndYear").value = "";
                    document.querySelectorAll("#countriesStoreInInput .item").forEach(function elefunc(el) {
                        el.remove()
                    });
                    document.querySelectorAll("#input1").forEach(function agefunc(age) {
                        age.value = ""
                    });
                    if (window.location.href.includes("/travel-Quote")) {
                        readAndPopulateGetQuoteData();
                        document.getElementById("tile-form").setAttribute("style", "display:none");
                        document.getElementById("tile-data").setAttribute("style", "display:block");
                    } else {
                        var utmPara = window.utmParams;
                        try {
                            utmPara.gclId = _satellite.getVisitorId().getMarketingCloudVisitorID() || "";
                        } catch (err) {
                            console.log(err);
                        }

                        var sendData = {
                            "travellerType": document.getElementById("travelType").value,
                            "geographicalAreaCode": response.payload.geographicalAreaCode,
                            "travellingCountries": response.payload.travellingCountries.map(function(countryObj) {
                                return countryObj.countryCode
                            }),
                            "travelStartDate": response.payload.startDate,
                            "travelEndDate": response.payload.endDate,
                            "productCategoryCode": "TGI",
                            "channelType": window.channelType.channelType,
                            "utmParams": utmPara,
                            "proposerDetails": {
                                "firstName": response.payload.firstName,
                                "lastName": response.payload.lastName,
                                "mobileNumber": response.payload.mobileno
                            },
                            "insuredDetails": response.payload.insuredDetails
                        };

                        clickToCallTravelAndHealth(response, AppConstants.API_SELECTOR.TRAVEL_CALL_US.name, sendData);
                    }
                }

            }
            // health code
            else if (document.getElementById("healthType")) {
                if (response.status == "SUCCESS") {
                    response.payload.isCampaign = getQuoteFormData.isCampaign;
                    response.qid = "h" + generateRandom();
                    response.payload.insuringFor = getQuoteFormData.insuringFor;
                    response.payload.gender = getQuoteFormData.gender;
                    response.payload.healthType = getQuoteFormData.healthType;
                    response.payload.pinCode = getQuoteFormData.pinCode;
                    response.payload.mobileno = getQuoteFormData.mobileno;
                    response.payload.isCampaign = getQuoteFormData.isCampaign;
                    response.payload.firstName = getQuoteFormData.firstName;
                    response.payload.lastName = getQuoteFormData.lastName;

                    localStorage.setItem("getQuoteData", JSON.stringify(response));

                    document.getElementById("gender").value = "";
                    document.getElementById("pinCode").value = "";
                    document.getElementById("insuringListInnerText").value = "";


                    if (window.location.href.includes("/health-quote.h")) {
                        loadPlanDetailsHealth(response);
                        document.getElementById("tile-form").setAttribute("style", "display:none");
                        document.getElementById("tile-data").setAttribute("style", "display:block");
                    } else {
                        var utmPara = JSON.parse(getQuoteFormData.utmParams);
                        try {
                            utmPara.gclId = _satellite.getVisitorId().getMarketingCloudVisitorID() || "";
                        } catch (err) {
                            console.log(err);
                        }

                        var sendData = {
                            "productCategoryCode": "HGI",
                            "channelType": JSON.parse(getQuoteFormData.channelType).channelType,
                            "utmParams": utmPara,
                            "proposerDetails": {
                                "firstName": getQuoteFormData.firstName,
                                "lastName": getQuoteFormData.lastName,
                                "mobileNumber": getQuoteFormData.mobileno,
                                "gender": getQuoteFormData.gender,
                                "pinCode": getQuoteFormData.pinCode
                            }
                        };

                        clickToCallTravelAndHealth(response, AppConstants.API_SELECTOR.HEALTH_CALL_US.name, sendData);
                    }

                }
            }

            // health code
            else {
                toastr.error("Get Quote API Failure !!!!", "", {
                    timeOut: 5e3,
                    closeButton: !0,
                    preventDuplicates: !0
                });
                toggleLoader(false);
            }

        }).catch(function(err) {
            toggleLoader(false);
        })
}

function clickToCallTravelAndHealth(response, selector, sendData) {
    var path = (document.getElementById("get-quote-btn")) ? document.getElementById("get-quote-btn").getAttribute("data-href") : window.location.pathname.split(".")[0];
    AppEvent.trigger(selector, sendData).then(function(responsedata) {
        if (response.status == "SUCCESS") {
            var applicationId = responsedata.payload.applicationId || "";
            var mobileno = response.payload.mobileno;
            var appStage = "NA";
            var dob = "NA";
            var trafficType = "No Offer";
            if (responsedata.status == "SUCCESS" && responsedata.payload.existingApplicationFound == true) {
                var resumeAppStage = productName + "_LEAD_PROD_INFO" || "";
                var resumePage = digitalData.page.name;
                triggerToResumeCalls(applicationId, mobileno, appStage, dob, trafficType, resumeAppStage, resumePage);
            } else {
                /*triggerCreateLead(applicationId, productName);*/
                triggerToCreatApplication(applicationId, mobileno, appStage, dob, trafficType);
            }
            if (response.qid) {
                window.location.href = path + "." +
                    response.qid + ".html";
            } else {
                toggleLoader(false);
            }
        } else {
            toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
                timeOut: 5000,
                "closeButton": true,
                "preventDuplicates": true
            });
        }
        popup_close()
        resolve(true);
    }).catch(function(data) {
        if (response.status == "SUCCESS") {
            if (response.qid) {
                window.location.href = path + "." +
                    response.qid + ".html";
            } else {
                toggleLoader(false);
            }
        } else {
            toastr.error(response.errorBean[0].errorCode + " : " + response.errorBean[0].errorMessage, '', {
                timeOut: 5000,
                "closeButton": true,
                "preventDuplicates": true
            });
        }
        reject(false)
    })
}
$("#tripStartDt").keyup(validateStartDate);
$("#tripStartMonth").keyup(validateStartDate);
$("#tripStartYear").keyup(validateStartDate);

function validateEndDate(event) {

    var validateEndReturn = {
        "status": false,
        "endDate": ""
    }
    var parentContainer;
    if (document.getElementById("travelIndividual")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
    } else if (document.getElementById("travelfamily")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Family form : family");
    } else if (document.getElementById("travelstudent")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Student form : Student");
    } else {
        parentContainer = findSelectorParent(event.target, "FORM");
    }

    var ddStart = $(parentContainer).find("#tripStartDt").val();
    var mmStart = $(parentContainer).find("#tripStartMonth").val();
    var yyStart = $(parentContainer).find("#tripStartYear").val();
    var startDate = ddStart + "/" + mmStart + "/" + yyStart;
    var startDateVal = getFormattedDateTravel(ddStart, mmStart, yyStart);

    var dd = $(parentContainer).find("#tripEndDt").val();
    var mm = $(parentContainer).find("#tripEndMonth").val();
    var yy = $(parentContainer).find("#tripEndYear").val();
    // endDate = dd+"/"+mm+"/"+yy;
    // if(endDate!=="//"){
    // validateEndReturn.endDate = dd+"/"+mm+"/"+yy;
    // document.getElementById("tripEndDate").value = validateEndReturn.endDate;
    // }else{
    // document.getElementById("tripEndDate").value = "";
    // }
    if (mm == "" || yy.length != 4) {
        console.log("wrong date");

    } else {
        // endDate = dd+"/"+mm+"/"+yy;
        validateEndReturn.endDate = dd + "/" + mm + "/" + yy;
        document.getElementById("tripEndDate").value = validateEndReturn.endDate;
        var endDateVal = getFormattedDateTravel(dd, mm, yy);
        console.log("Chnaged format ", endDateVal);
        if (validateEndReturn.endDate === "DD/MM/YYYY") {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "", false);
        } else {

            if (/(((0[1-9]|[12][0-9]|3[01])([-./])(0[13578]|10|12)([-./])(\d{4}))|(([0][1-9]|[12][0-9]|30)([-./])(0[469]|11)([-./])(\d{4}))|((0[1-9]|1[0-9]|2[0-8])([-./])(02)([-./])(\d{4}))|((29)(\.|-|\/)(02)([-./])([02468][048]00))|((29)([-./])(02)([-./])([13579][26]00))|((29)([-./])(02)([-./])([0-9][0-9][0][48]))|((29)([-./])(02)([-./])([0-9][0-9][2468][048]))|((29)([-./])(02)([-./])([0-9][0-9][13579][26])))/.test(validateEndReturn.endDate)) {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "", false);
                if ($("#travelType").val()) {
                    var days = 0;
                    switch ($("#travelType").val()) {
                        case "1":
                            days = 179;
                            break;
                        case "2":
                            days = 59;
                            break;
                        case "3":
                            days = 364;
                            break;
                        default:
                            days = 0;
                            break;
                    }
                    var maxDate = startDateVal.addDays(days);
                    var msgDays = days + 1;
                    if (endDateVal < startDateVal || startDate == validateEndReturn.endDate) {
                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "Please Enter Valid End Date ", true);
                        return validateEndReturn;
                    } else if (endDateVal > maxDate) {
                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "End Date should not Exceed " + msgDays + " Days", true);
                        return validateEndReturn;
                    } else {
                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "", false);
                        validateEndReturn.status = true;
                        validateEndReturn.endDate = validateEndReturn.endDate;
                        return validateEndReturn;
                    }
                }
            } else if (validateEndReturn.endDate === "//") {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "Please Enter Start Date", true);
                return validateEndReturn;
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "Please Enter Valid End Date", true);
                return validateEndReturn;
            }
        }
    }

    return validateEndReturn;
}
$("#tripEndDt").keyup(validateEndDate);
$("#tripEndMonth").keyup(validateEndDate);
$("#tripEndYear").keyup(validateEndDate);


document.addEventListener("DOMContentLoaded", function(event) {
    if (!(window.sessionStorage.hasOwnProperty("SS_1"))) {
        callToAuthToken("", "", true);
    }
    $('.lyt-testimonial').each(function() {
        $(this).find('.bs-testimonial').each(function(i) {
            $(this).addClass("type-" + ((i % 2) ? 2 : 1));
        })
    })

    triggerSetProduct(window.productName);

    if (document.getElementById("healthType")) {
        if (document.getElementById("healthType").value == "1") {
            triggerSetProduct(window.productName);
        } else if (document.getElementById("healthType").value == "2") {
            triggerSetProduct(window.productName);

        }
    }

    if ($("#travelType").val()) {
        window.countryPromise = "";
        $('.travelCountries input').keydown(function(e) {
            if (e.keyCode == 13) {
                e.preventDefault();
                return false;
            }
        });
        if (document.getElementsByClassName("travelCountries").length > 0) {
            document.getElementsByClassName("travelCountries").forEach(function(travelCountriesEle) {
                var parentContainer = findSelectorParent(travelCountriesEle, "FORM");
                countriesData[parentContainer.id] = {}

                $(parentContainer).find("#travelCountries").on("input", function(e) {

                    $(parentContainer).find("#travelCountries").width(8 * ((e.target.value.length == 0) ? 1 : e.target.value.length) + "px");
                    $(parentContainer).find("#travelCountries").css("display", "inline-block");
                    if ($(parentContainer).find("#countriesStoreInInput").children().length > 9) {
                        $(parentContainer).find("#travelCountries").val("");
                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Max Countries limit is 10.", true);
                    } else if (e.target.value.length > 1) {
                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Max Countries limit is 10.", false);
                        $(parentContainer).find("#autoFillCountrires").html("");
                        $(parentContainer).find("#autoFillCountrires").removeClass("hide");
                        $(parentContainer).find("#autoFillCountrires").addClass("show");
                        var reg = new RegExp("^" + e.target.value.toLowerCase(), "g")

                        AppConstants.API_SELECTOR.COUNTRY_MASTER.url = AppConstants.API_SELECTOR.COUNTRY_MASTER.url.substring(0, AppConstants.API_SELECTOR.COUNTRY_MASTER.url.indexOf('=') + 1) + e.target.value;
                        // loadCountryData(AppConstants.API_SELECTOR.COUNTRY_MASTER.name,"",countriesData[parentContainer.id],parentContainer);


                        window.countryPromise = AppEvent.trigger(AppConstants.API_SELECTOR.COUNTRY_MASTER.name).then(function(responseData) {
                            if (responseData.payload.length == 0) {
                                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", true);
                            } else {
                                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
                            }
                            countriesData[parentContainer.id].countries = responseData.payload;
                            $(parentContainer).find("#autoFillCountrires").html("");
                            responseData.payload.forEach(function(response, index) {

                                var li = document.createElement("li");
                                li.innerText = response.countryName;
                                if (index == 0) {
                                    li.className = "active";
                                }

                                li.setAttribute("data-cregion", response.countryName);
                                li.setAttribute("data-ccode", response.countryShortCode);
                                li.addEventListener("click", function(e) {
                                    storeCountry("travelCountries", e, parentContainer);
                                    countriesData[parentContainer.id].countries = countriesData[parentContainer.id].countries.filter(function(countryData) {
                                        return (countryData.countryShortCode != response.countryShortCode)
                                    })
                                })
                                $(parentContainer).find("#autoFillCountrires").append(li);
                            })

                        });
                    } else if (e.target.value.length == 0) {
                        $(parentContainer).find("#autoFillCountrires").innerHTML = "";
                        $(parentContainer).find("#autoFillCountrires").removeClass("show");

                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
                    }

                });
            })
        }
        /* }) */
        // triggerSetProduct(AppConstants.ANALYTICS_DATA.PRODUCT_NAME.TRAVEL[$("#travelType").val()]);
        triggerSetProduct(window.productName)
    }
    $(".typ-insuring input[type=tel]").attr("maxlength", "3");
    $(".articleGallery").children().addClass("col-" + $(".articleGallery").children().length);
    // $(".typ-insuring input[type=tel]").attr("onkeypress", "return
    // isNumber(event)");
    $(".countryCode").hide();
    $('.foucsOutInsureingList').on("click", function(e) {

        $(".dropdown-parent").find(".dropdown-content").slideUp(),
            $(".dropdown-parent").find(".dropdown-heading").removeClass("active");
    });


    $(document).on("click", function(e) {
        try {
            var parentContainer = findSelectorParent(e.target, ".bs-dropdown");
            if (parentContainer) {
                $(parentContainer).find("#travelCountries").parent().addClass('focus');
                $(parentContainer).find("#countryCode").hide();
                $(parentContainer).find('#countriesStoreInInput').children().each(function(index, ele) {
                    ele.style.display = "inline-block"
                })

            } else if (e.target.parentElement.parentElement == null) {
                $("#travelCountries").parent().addClass('focus');
                $("#countryCode").hide();
                $('#countriesStoreInInput').children().each(function(index, ele) {
                    ele.style.display = "inline-block"
                })
            } else {
                parentContainer = findSelectorParent(e.target, "FORM")
                if (parentContainer) {
                    $(parentContainer).find("#travelCountries").parent().removeClass('focus');
                    if ($(parentContainer).find("#countriesStoreInInput").children().length > 0) {

                        $(parentContainer).find("#travelCountries").parent().addClass('focus');
                    }
                    if ($(parentContainer).find("#countriesStoreInInput").children().length > 1) {

                        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
                        $(parentContainer).find("#travelCountries").val("");
                        $(parentContainer).find("#countryCode").css("display", "block");
                        $(parentContainer).find("#countryCode").html("+" + ($(parentContainer).find("#countriesStoreInInput").children().length - 1))
                    }
                    $(parentContainer).find('#countriesStoreInInput').children().each(function(index, ele) {
                        if (index > 0) {
                            ele.style.display = "none";
                        } else {
                            ele.style.display = "inline-block"
                        }
                    })
                }
            }
        } catch (error) {
            console.error(error);
        }
    });
    setTimeout(function() {
        document.querySelectorAll("input[type=number],input[type=text],input[type=tel]").forEach(function(eachEle) {
            if (eachEle.value != "" && eachEle.value != undefined && eachEle.value != null) {
                eachEle.click();
            }
        });
    });
})

function storeCountry(id, e, parent) {
    $(parent).find("#" + id).value = "";
    var item = document.createElement("div");
    var name = document.createElement("span");
    var icon = document.createElement("i");
    item.classList.add("item");
    name.classList.add("name");
    name.setAttribute("data-ccode", e.target.getAttribute("data-ccode"));
    icon.className = "icon icon-close";

    icon.setAttribute("data-cid", e.target.getAttribute("data-cid"));
    icon.setAttribute("data-cdesc", e.target.getAttribute("data-cdesc"));
    icon.setAttribute("data-cregion", e.target.getAttribute("data-cregion"));
    icon.setAttribute("data-ccode", e.target.getAttribute("data-ccode"));
    icon.setAttribute("onClick", "removeCountry(this)");
    name.innerHTML = e.target.getAttribute("data-cregion");
    item.appendChild(name);
    item.appendChild(icon);
    var copyItem = item.cloneNode(true);
    var ele = $(parent).find("#countriesStoreInInput").children();
    var status = true;
    for (var i = 0; i < ele.length; i++) {
        status = ($(ele[i]).find("span").attr("data-ccode") == name.innerHTML) ? false : true;
    }
    if (status == true) {
        $(parent).find("#countriesStoreInInput").append(copyItem);
        $(parent).find("#travelCountries").width(11 + "px");
        $(parent).find("#travelCountries").css("margin-left", "5px");
    }
    if ($(parent).find("#countriesStoreInInput").children().length > 0) {
        $(parent).find("#travelCountryDiv").addClass("focus");
    } else {
        $(parent).find("#travelCountryDiv").removeClass("focus");
    }
    if ($(parent).find("#countriesStoreInInput").children().length > 1) {
        $(parent).find("#countryCode").css("display", "block");
        $(parent).find("#countryCode").innerText = "+" + ($(parent).find("#countriesStoreInInput").children().length - 1)
    }

    $(parent).find('#countriesStoreInInput').children().each(function(index, ele) {
        if (index > 1) {
            ele.style.display = "none";
        }
    })
    $(parent).find("#travelCountries").focus()
    $(parent).find("#autoFillCountrires").html("");
    $(parent).find("#travelCountries").val("")
}


function createJsonObjTravel(event) {

    var parentContainer;
    if (document.getElementById("travelIndividual")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
    } else if (document.getElementById("travelfamily")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Family form : family");
    } else if (document.getElementById("travelstudent")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Student form : Student");
    } else {
        parentContainer = findSelectorParent(event.target, "FORM");
    }
    var parentContainer = findSelectorParent(event.target, "FORM");
    if ($(parentContainer).find("#tripStartDate")) {
        $(parentContainer).find("#tripStartDate").val(validateStartDate(event).startDate);
        $(parentContainer).find("#tripEndDate").val(validateEndDate(event).endDate);

        var data = new FormData();
        var extraStatus = true;
        var status = true;
        var tripStartDate = $(parentContainer).find("#tripStartDate").val().replace(/\//g, "-");
        var tripEndDate = $(parentContainer).find("#tripEndDate").val().replace(/\//g, "-");
        var hasFirstName = ($(parentContainer).find("#firstName").length == 1);
        var hasLastName = ($(parentContainer).find("#lastName").length == 1);
        var hasMobileNumber = ($(parentContainer).find("#mobileNumber").length == 1);
        var hasEmail = ($(parentContainer).find("#email").length == 1);
        var hasTravelProductType = ($(parentContainer).find("#travelType").length == 1);
        var mobileNumber, email, firstName, lastName, travelproducttype;
        if (hasFirstName) {
            firstName = $(parentContainer).find("#firstName").val()
        }
        if (hasLastName) {
            lastName = $(parentContainer).find("#lastName").val()
        }
        if (hasMobileNumber) {
            mobileNumber = $(parentContainer).find("#mobileNumber").val()
        }
        if (hasEmail) {
            email = $(parentContainer).find("#email").val()
        }
        if (hasTravelProductType) {
            travelproducttype = $(parentContainer).find("#travelType").val()
        }
        if (/^[0-9\-]+$/g.test(tripStartDate)) {
            status = validateStartDate(event).status;
            if (status) {
                data.append("tripStartDate", dateFormat(tripStartDate));
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "Please Enter Valid Start Date.", true);
                return;
            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripStartDateErrorMsg"), "Please Enter Start Date.", true);
        }
        if (/^[0-9\-]+$/g.test(tripEndDate)) {
            status = validateEndDate(event).status;
            if (status) {
                data.append("tripEndDate", dateFormat(tripEndDate));
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "Please Enter Valid End Date.", true);
                return;
            }
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "tripEndDateErrorMsg"), "Please Enter End Date.", true);
        }
        data.append("travelType", travelproducttype);
        var countryCode = [];
        parentContainer.querySelectorAll("#countriesStoreInInput")[0].querySelectorAll("[data-ccode]").forEach(function(ele) {
            countryCode.push(ele.getAttribute("data-ccode"));
        })
        countryCode = countryCode.filter(function(value, index, self) {
            return (self.indexOf(value) === index);
        })
        if (countryCode.length == 0) {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Country.", true);
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Country.", false);
        }
        var checkInsureringValidation
        if (travelproducttype == "2") {
            checkInsureringValidation = insuringValidation(event, true, "2")
        } else {
            checkInsureringValidation = insuringValidation(event, false, travelproducttype)
        }
        if (hasMobileNumber) {
            if (mobileNumber) {
                if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Insert Valid Mobile Number.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (hasFirstName) {
            if (firstName) {
                if (!(/^[a-zA-Z]+$/.test(firstName))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Insert Valid First Name.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Enter Mobile Number.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Enter First Name.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (hasLastName) {
            if (lastName) {

                if (!(/^[a-zA-Z]+$/.test(lastName))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Enter Valid Last Name.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Enter Valid Last Name.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Enter Last Name.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (hasEmail) {
            if (email) {

                if (!(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Insert Valid Email Id.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Insert Valid Email Id.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Enter Email Id.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (/^[0-9\-]+$/g.test(tripStartDate) && /^[0-9\-]+$/g.test(tripEndDate) && countryCode.length > 0) {

        } else {
            return
        }
        if (!status) {
            return
        }
        if (jsonDataTravel && jsonDataTravel.payload) {
            mobileNumber = jsonDataTravel.payload.mobileno;
            email = jsonDataTravel.payload.email;
            lastName = jsonDataTravel.payload.lastName;
            firstName = jsonDataTravel.payload.firstName;
        }
        AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
        AppData.localStorage.setValue("firstName", firstName || "")
        AppData.localStorage.setValue("lastName", lastName || "")
        AppData.localStorage.setValue("email", email || "")

        data.append("mobileno", mobileNumber || "");
        data.append("isCampaign", $("#isCampaign").val() || "");
        data.append("firstName", firstName || "");
        data.append("lastName", lastName || "");
        data.append("emailId", email || "");
        data.append("insureRelation", JSON.stringify(checkInsureringValidation));
        data.append("countryCode", JSON.stringify(countryCode));
        data.append("channelType", JSON.stringify(window.channelType));
        data.append("utmParams", JSON.stringify(window.utmParams));


        var finalOutPut = [];
        var count = 1;
        JSON.parse(data.get("insureRelation")).map(function(data) {
            return data.relationship
        }).forEach(function(data, index, self) {
            if (self.indexOf(data) == index) {
                finalOutPut.push(data);
            } else {
                count++
                finalOutPut.push(data + count)

            }
        })
        var analyticsInsuringForStr = "";
        JSON.parse(data.get("insureRelation")).forEach(function(obj) {
            analyticsInsuringForStr += obj.relationship + ":" + obj.age + ",";
        })
        triggerTravelQuoteData(JSON.parse(data.get("countryCode")), data.get("tripStartDate"), data.get("tripEndDate"), analyticsInsuringForStr)
        if (jsonDataTravel && jsonDataTravel.payload) {
            var compareStatus = false;
            repeatCountryData = jsonDataTravel.payload.travellingCountries.map(function(data) {
                return data.countryCode
            })
            compareStatus = arraysEqual(repeatCountryData, countryCode)
            if (compareStatus) {
                compareStatus = (data.get("tripStartDate") == jsonDataTravel.payload.startDate)
                if (compareStatus) {
                    if (data.get("mobileno")) {
                        compareStatus = (data.get("mobileno") == jsonDataTravel.payload.mobileno)
                    }
                    if (compareStatus) {
                        if (data.get("firstName")) {
                            compareStatus = (data.get("firstName") == jsonDataTravel.payload.firstName)
                        }
                        if (compareStatus) {
                            if (data.get("lastName")) {
                                compareStatus = (data.get("lastName") == jsonDataTravel.payload.lastName)
                            }
                            if (compareStatus) {
                                if (data.get("emailId")) {
                                    compareStatus = (data.get("emailId") == jsonDataTravel.payload.emailId)
                                }
                                if (compareStatus) {
                                    compareStatus = (data.get("tripEndDate") == jsonDataTravel.payload.endDate)
                                    if (compareStatus) {
                                        var newDataOfInsuring = checkInsureringValidation.map(function(data) {
                                            return {
                                                age: (typeof(data.age) === "string") ? parseInt(data.age) : data.age,
                                                relationship: data.relationship
                                            }
                                        }).sort(function(a, b) {
                                            return a.relationship - b.relationship
                                        })
                                        var oldDataOfInsuring = jsonDataTravel.payload.insuredDetails.map(function(data) {
                                            return {
                                                age: data.age,
                                                relationship: data.relationship
                                            }
                                        }).sort(function(a, b) {
                                            return a.relationship - b.relationship
                                        })
                                        compareStatus = arraysEqual(oldDataOfInsuring, newDataOfInsuring, "age")
                                    }
                                }
                            }
                        }
                    }
                }
            }

            repeatStatus = compareStatus;
        }

        return new URLSearchParams(data).toString();
    }
}

function insuringValidation(event, isFamily, type) {

    $(this).closest('.toast').remove();
    var parentElement = findSelectorParent(event.target, ".bs-form")
    var insureRelation = [];
    var status = true;
    parentElement.querySelectorAll(".checkbox-list").forEach(function(ele) {
        var checkbox = ele.querySelector("input[type=checkbox],input[type=radio]").checked;
        var age = ele.querySelector("input[type=tel]").value;
        var relationship = ele.querySelector("label").innerText.toUpperCase().trim();
        if (checkbox == true && age != "") {
            insureRelation.push({
                "no": null,
                "relationship": relationship,
                "age": age
            })
        } else if (checkbox == true && age == "") {
            toastr.error('Please enter age of ' + relationship + '.', '', {
                timeOut: 5000,
                "closeButton": true,
                "preventDuplicates": true
            });
            status = false;
        } else {
            ele.querySelector("input[type=tel]").value = "";
        }
    })
    var checkboxListsEle = document.querySelectorAll(".checkbox-list");
    var checkboxListsArr = Object.keys(checkboxListsEle)
        // checkboxListsArr.pop();
    var checkboxListsEleLength = checkboxListsArr.filter(function(ele) {
        return checkboxListsEle[ele].querySelector("input[type=checkbox],input[type=radio]").checked;
    }).length
    if (checkboxListsEleLength == 0) {
        toastr.error('Please select Insuring.', '', {
            timeOut: 5000,
            "closeButton": true,
            "preventDuplicates": true
        });
    }

    var insuredStatus = true;
    var ageAdultMax, ageAdultMin, ageChildMax, ageChildMin;

    if (document.getElementById("travelType")) {
        var productValue = document.getElementById("travelType").value;
        if (productValue == "1" || productValue == "2" || productValue == "3") {
            type = (Number.isInteger(type)) ? type : parseInt(type);
            switch (type) {
                case 1:
                    ageAdultMax = 60;
                    ageAdultMin = 18;
                    ageChildMax = 17;
                    ageChildMin = 0;
                    break;
                case 2:
                    ageAdultMax = 60;
                    ageAdultMin = 21;
                    ageChildMax = 20;
                    ageChildMin = 0;
                    break;
                case 3:
                    ageAdultMax = 35;
                    ageAdultMin = 18;
                    ageChildMax = 35;
                    ageChildMin = 16;
                    break;
            }
        }

    }

    if (document.getElementById("healthType")) {
        var healthproductValue = document.getElementById("healthType").value;
        if (healthproductValue == "1" || healthproductValue == "2" || healthproductValue == "3") {
            type = (Number.isInteger(type)) ? type : parseInt(type);
            switch (type) {
                case 1:
                    ageAdultMax = 65;
                    ageAdultMin = 18;
                    ageChildMax = 30;
                    ageChildMin = 0;
                    break;
                case 2:
                    ageAdultMax = 65;
                    ageAdultMin = 18;
                    ageChildMax = 30;
                    ageChildMin = 0;
                    break;
                case 3:
                    ageAdultMax = 35;
                    ageAdultMin = 18;
                    ageChildMax = 35;
                    ageChildMin = 16;
                    break;

            }

        }

    }
    var errorStatus = true;
    $(parentElement).find(".typ-insuring .checkbox-list").each(function(index, ele) {
        if ($(ele).find("[type=tel]").val() != "") {
            errorStatus = true;
            if (/([cC][hH][iI][lL][dD]|[Ss][Oo][nN]|[Dd][Aa][Uu][Gg][Hh][Tt][Ee][Rr]|[Bb][Rr][Oo][Tt][Hh][Ee][Rr]|[Ss][Ii][Ss][Tt][Ee][Rr])/g.test($(ele).find("[type=checkbox],[type=radio]").parent().text().trim())) {
                if ($(ele).find("[type=tel]").val() > ageChildMax) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageChildMin + ' to ' + ageChildMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else if ($(ele).find("[type=tel]").val() < ageChildMin) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageChildMin + ' to ' + ageChildMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else {
                    errorStatus = false;
                }
            } else {
                if ($(ele).find("[type=tel]").val() > ageAdultMax) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageAdultMin + ' to ' + ageAdultMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else if ($(ele).find("[type=tel]").val() < ageAdultMin) {
                    toastr.error($(ele).find("[type=checkbox],[type=radio]").parent().text().trim() + ' age should be between ' + ageAdultMin + ' to ' + ageAdultMax + '.', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    insuredStatus = false;
                } else {
                    errorStatus = false;
                }
            }
        } else {
            if (errorStatus) {

                showError("insuringListInnerTextErrorMsg", "", true)
            } else {
                showError("insuringListInnerTextErrorMsg", "", false)
            }
        }
    })
    if (insuredStatus == false) {
        return false;
    }
    if (status == false) {
        return status;
    }
    if (insureRelation.length != 0) {
        var status = true;

        if (isFamily) {
            if (insureRelation.length > 1) {
                if (insureRelation.filter(function(insureObj) {
                        return (insureObj.relationship != "CHILD" && insureObj.relationship != "SON" && insureObj.relationship != "DAUGHTER")
                    }).length < 1) {

                    toastr.error('select atleast 1 Adult insuring .', '', {
                        timeOut: 5000,
                        "closeButton": true,
                        "preventDuplicates": true
                    });
                    return false;
                }
            } else {
                toastr.error('Select aleast 2 insuring .', '', {
                    timeOut: 5000,
                    "closeButton": true,
                    "preventDuplicates": true
                });
                return false;
            }
        }
    } else {
        return false;
    }

    showError("insuringListInnerTextErrorMsg", "select Insuring", false);
    var insuringListInnerText = $(parentElement).find("#insuringListInnerText");
    var insureData = function(data) {
        if (insuringListInnerText) {
            insuringListInnerText.html(" ");
            var updatedInsureDetails = data.map(function(insureDetails, index, self) {
                insureDetails.ages = []
                insureDetails.index = self.filter(function(insureDetailsObj) {
                    if (insureDetailsObj.relationship == insureDetails.relationship) {
                        insureDetails.ages.push(insureDetailsObj.age)
                    }

                    return (insureDetailsObj.relationship == insureDetails.relationship)
                }).length
                return insureDetails;
            })
            updatedInsureDetails = removeDuplicatesFromObj(updatedInsureDetails, "relationship");
            var insuringListInnerTextStr = "";
            updatedInsureDetails.forEach(function(insuredDetail) {
                insuringListInnerTextStr += ((insuredDetail.index > 1) ? insuredDetail.index : "") + " " + insuredDetail.relationship + "," + " ";
            })
            insuringListInnerText.html(insuringListInnerTextStr.slice(0, -2));
            data.forEach(function(obj) {
                delete obj.ages;
                delete obj.index;
            })
            return data;
        }
    }(insureRelation)
    close_dropdown(".typ-insuring")
    return insureData;
}

function removeCountry(ele) {
    var countryObj = {
        "ccode": ele.getAttribute("data-ccode"),
        "cregion": ele.getAttribute("data-cregion"),
        "cid": ele.getAttribute("data-cid"),
        "cdesc": ele.getAttribute("data-cdesc")
    }

    var parentContainer = findSelectorParent(ele, "FORM");
    if ($(parentContainer).find("#countriesStoreInInput").children().length > 0 && $(parentContainer).find("#travelCountries") != "") {
        $(parentContainer).find("#travelCountries").parent().addClass('focus');

        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
        $(parentContainer).find("#travelCountries").val("");
    } else {
        $(parentContainer).find("#travelCountries").parent().removeClass('focus');
    }
    if ($(parentContainer).find("#countriesStoreInInput").children().length > 1) {

        showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
        $(parentContainer).find("#travelCountries").val("");
        $(parentContainer).find(".countryCode").css("display", "block");
        $(parentContainer).find(".countryCode").html("+" + ($(parentContainer).find("#countriesStoreInInput").children().length - 1))
    }
    $(parentContainer).find('#countriesStoreInInput').children().each(function(index, ele) {
        if (index > 0) {
            ele.style.display = "none";
        } else {
            ele.style.display = "inline-block"
        }
    })
    countriesData[parentContainer.id].countries.push(countryObj);
    var ccode = ele.parentElement.querySelector("[data-ccode]").getAttribute("data-ccode");
    $(parentContainer).find("[data-ccode]").each(function(el) {
        if (this.getAttribute("data-ccode") == ccode) {
            this.parentElement.remove();
            return false;
        }
    })
    if ($(parentContainer).find("#countriesStoreInInput").children().length > 1) {
        $(parentContainer).find("#countryCode").css("display", "block");
        $(parentContainer).find("#countryCode").html("+" + ($(parentContainer).find("#countriesStoreInInput").children().length - 1))
    } else {
        $("#countryCode").hide()
    }
    $(parentContainer).find('#countriesStoreInInput').children().each(function(index, ele) {
        if (index > 0) {
            ele.style.display = "none";
        } else {
            ele.style.display = "inline-block"
        }
    })
}

function ajaxCallGetAQuote(event, str, type) {
    var selector;
    switch (type) {
        case 1:
            var travelFormObj = createJsonObjTravel(event);
            if (travelFormObj != undefined) {
                var ajaxObj = decodeURIComponent(travelFormObj).split("&");
                for (var i = 0; i < ajaxObj.length; i++) {
                    getQuoteFormData[ajaxObj[i].split("=")[0]] = ajaxObj[i].split("=")[1];
                }
                ajaxObj = {
                    "applicationId": null,
                    "insuranceDetails": {
                        "travellerType": getQuoteFormData.travelType,
                        "travellingCountries": JSON.parse(getQuoteFormData.countryCode),
                        "travelStartDate": getQuoteFormData.tripStartDate,
                        "travelEndDate": getQuoteFormData.tripEndDate
                    },
                    "travellerDetails": JSON.parse(getQuoteFormData.insureRelation)
                }
                selector = AppConstants.API_SELECTOR.TRAVEL_SEARCH_PLAN.name;
                break;
            } else {
                return;
            }
        case 2:
            var ajaxObj = decodeURIComponent(createJsonObjHealth(event)).split("&");
            for (var i = 0; i < ajaxObj.length; i++) {
                getQuoteFormData[ajaxObj[i].split("=")[0]] = ajaxObj[i].split("=")[1];
            }
            ajaxObj = {
                "applicationId": null,
                "proposerDetails": {
                    "gender": getQuoteFormData.gender,
                    "pinCode": getQuoteFormData.pinCode
                },
                "insuranceDetails": {
                    "insuringFor": getQuoteFormData.insuringFor
                },
                "filterCriteria": null,
                "insuredDetails": JSON.parse(getQuoteFormData.insureRelation)
            }
        case 2:
            var ajaxObj = decodeURIComponent(createJsonObjHealth(event)).split("&");
            for (var i = 0; i < ajaxObj.length; i++) {
                getQuoteFormData[ajaxObj[i].split("=")[0]] = ajaxObj[i].split("=")[1];
            }
            ajaxObj = {
                "applicationId": null,
                "proposerDetails": {
                    "gender": getQuoteFormData.gender,
                    "pinCode": getQuoteFormData.pinCode
                },
                "insuranceDetails": {
                    "insuringFor": getQuoteFormData.insuringFor
                },
                "filterCriteria": null,
                "insuredDetails": JSON.parse(getQuoteFormData.insureRelation)
            }
            console.log(JSON.stringify(ajaxObj))

            selector = AppConstants.API_SELECTOR.HEALTH_SEARCH_PLANS.name;
            break;

        case 3:
            var ajaxObj = createJsonObj(event);
            break;
    }
    if (ajaxObj && repeatStatus == false) {
        searchPlans(selector, ajaxObj);
    } else if (repeatStatus == true) {
        toastr.warning("Please Change Data for new plans.", '', {
            timeOut: 5000,
            "closeButton": true,
            "preventDuplicates": true
        });
    }
}

function createJsonObjHealth(event) {

    var data = new FormData();

    var parentContainer;
    if (document.getElementById("healthindividual")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Individual form : individual");
    } else if (document.getElementById("healthfamily")) {
        parentContainer = findSelectorParent(event.target, "FORM");
        console.log("Family form : family");
    } else {
        parentContainer = findSelectorParent(event.target, "FORM");
    }


    // var parentContainer = findSelectorParent(event.target, "FORM");
    if ($(parentContainer).find("#gender")) {
        var insuringFor = $(parentContainer).find("#insuringFor").val();
        var pinCode = $(parentContainer).find("#pinCode").val();
        var gender = $(parentContainer).find("#gender").val();
        var hasFirstName = ($(parentContainer).find("#firstName").length == 1);
        var hasLastName = ($(parentContainer).find("#lastName").length == 1);
        var hasMobileNumber = ($(parentContainer).find("#mobileNumber").length == 1);
        var hasEmail = ($(parentContainer).find("#email").length == 1);
        var hasProductType = ($(parentContainer).find("#healthType").length == 1);
        var status = true;
        var mobileNumber, email, firstName, lastName, productType;
        if (hasFirstName) {
            firstName = $(parentContainer).find("#firstName").val()
        }
        if (hasLastName) {
            lastName = $(parentContainer).find("#lastName").val()
        }
        if (hasMobileNumber) {
            mobileNumber = $(parentContainer).find("#mobileNumber").val()
        }
        if (hasEmail) {
            email = $(parentContainer).find("#email").val()
        }
        if (hasProductType) {
            productType = $(parentContainer).find("#healthType").val()
        }
        data.append("insuringFor", insuringFor);
        data.append("gender", gender);
        data.append("utmParams", JSON.stringify(window.utmParams));
        data.append("channelType", JSON.stringify(window.channelType));

        data.append("healthType", productType);

        var statusPincode = true;
        if (!pinCode) {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "pinCodeErrorMsg"), "Enter Pin Code", true);
            statusPincode = false
        } else if (/^[0-9]{6}$/g.test(pinCode)) {
            data.append("pinCode", pinCode);
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "pinCodeErrorMsg"), "Invalid Pin Code", false);
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "pinCodeErrorMsg"), "Invalid Pin Code", true);
            statusPincode = false;
        }

        if (document.getElementById("insuringFor").value == "3") {
            checkInsureringValidation = insuringValidation(event, true, 2)
        } else {
            checkInsureringValidation = insuringValidation(event, false, 1)
        }
        if (hasMobileNumber) {
            if (mobileNumber) {
                if (!(/^[6-9][0-9]{9}$/.test(mobileNumber))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Valid Mobile Number.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "mobileNumberErrorMsg"), "Enter Mobile Number.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (hasFirstName) {
            if (firstName) {

                if (!(/^[a-zA-Z]+$/.test(firstName))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Enter Valid First Name.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Enter First Name.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "firstNameErrorMsg"), "Enter First Name.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (hasLastName) {
            if (lastName) {

                if (!(/^[a-zA-Z]+$/.test(lastName))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Enter Valid Last Name.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Enter Valid Last Name.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "lastNameErrorMsg"), "Enter Last Name.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (hasEmail) {
            if (email) {

                if (!(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email))) {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Enter Valid Email Id.", true);
                    if (status) {
                        status = false;
                    }
                } else {
                    showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Enter Valid Email Id.", false);

                }
            } else {
                showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "emailErrorMsg"), "Enter Email Id.", true);
                if (status) {
                    status = false;
                }
            }
        }
        if (gender && statusPincode) {

        } else {
            return
        }
        if (!status) {
            return
        }


        if (jsonDataHealth && jsonDataHealth.payload) {
            mobileNumber = jsonDataHealth.payload.mobileno;
            email = jsonDataHealth.payload.email;
            lastName = jsonDataHealth.payload.lastName;
            firstName = jsonDataHealth.payload.firstName;
        }
        AppData.localStorage.setValue("mobileNumber", mobileNumber || "")
        AppData.localStorage.setValue("firstName", firstName || "")
        AppData.localStorage.setValue("lastName", lastName || "")
        AppData.localStorage.setValue("email", email || "")
        data.append("mobileno", mobileNumber || "");
        data.append("isCampaign", $("#isCampaign").val() || "");
        data.append("firstName", firstName || "");
        data.append("lastName", lastName || "");
        data.append("emailId", email || "");


        var sumAssuredRangeCodes = $(parentContainer).find("[name=sumAssuredRangeCode]");
        var roomRentCode, sumAssuredRangeCode;
        var roomRentCodes = $(parentContainer).find("[name=roomRentCode]");
        var benefitCodes = $(parentContainer).find("[name=benefitCode]");
        if (sumAssuredRangeCodes) {
            var filterCriteria = {
                "sumAssuredRangeCode": sumAssuredRangeCode || null,
                "roomRentCode": roomRentCode || null,
                "planBenefitDetails": []
            }
            sumAssuredRangeCodes.each(function(data) {
                if (this.checked) {
                    filterCriteria.sumAssuredRangeCode = this.value
                }
            })

            roomRentCodes.each(function(data) {
                if (this.checked) {
                    filterCriteria.roomRentCode = this.value
                }
            })

            benefitCodes.each(function(data) {
                if (this.checked) {
                    filterCriteria.planBenefitDetails.push({
                        "benefitCode": this.value
                    })
                }
            })
        }
        // data.append("filterCriteria", JSON.stringify(filterCriteria));
        data.append("insureRelation", JSON.stringify(checkInsureringValidation));
        var finalOutPut = [];
        var count = 1;
        JSON.parse(data.get("insureRelation")).map(function(data) {
            return data.relationship
        }).forEach(function(data, index, self) {
            if (self.indexOf(data) == index) {
                finalOutPut.push(data);
            } else {
                count++
                finalOutPut.push(data + count)

            }
        })
        var analyticsInsuringForStr = "";
        JSON.parse(data.get("insureRelation")).forEach(function(obj) {
            analyticsInsuringForStr += obj.relationship + ":" + obj.age + ",";
        })
        if (jsonDataHealth && jsonDataHealth.payload) {
            var compareStatus = false;
            compareStatus = (data.get("gender") == jsonDataHealth.payload.gender)
            if (compareStatus) {
                compareStatus = (data.get("pinCode") == jsonDataHealth.payload.pinCode)
                if (compareStatus) {
                    if (data.get("mobileno")) {
                        compareStatus = (data.get("mobileno") == jsonDataHealth.payload.mobileno)
                    }
                    if (compareStatus) {
                        if (data.get("firstName")) {
                            compareStatus = (data.get("firstName") == jsonDataHealth.payload.firstName)
                        }
                        if (compareStatus) {
                            if (data.get("lastName")) {
                                compareStatus = (data.get("lastName") == jsonDataHealth.payload.lastName)
                            }
                            if (compareStatus) {
                                if (data.get("emailId")) {
                                    compareStatus = (data.get("emailId") == jsonDataHealth.payload.emailId)
                                }
                                if (compareStatus) {
                                    var newDataOfInsuring = checkInsureringValidation.map(function(data) {
                                        return {
                                            age: (typeof(data.age) === "string") ? parseInt(data.age) : data.age,
                                            relationship: data.relationship
                                        }
                                    }).sort(function(a, b) {
                                        return a.relationship - b.relationship
                                    })
                                    var oldDataOfInsuring = jsonDataHealth.payload.insuredDetails.map(function(data) {
                                        return {
                                            age: data.age,
                                            relationship: data.relationship
                                        }
                                    }).sort(function(a, b) {
                                        return a.relationship - b.relationship
                                    })
                                    compareStatus = arraysEqual(oldDataOfInsuring, newDataOfInsuring, "age")
                                }
                            }
                        }
                    }
                }
            }
            repeatStatus = compareStatus;
        }

        if (!location.href.includes("/health-quote.h")) {
            triggerHealthGetQuote(data.get("gender"), data.get("pinCode"), analyticsInsuringForStr, data.get("mobileno"), data.get("emailId"));
        }

        return new URLSearchParams(data).toString();
    }
}


function loadCountryData(selector, data, countryDataArr, parentContainer) {
    window.countryPromise = AppEvent.trigger(selector).then(function(responseData) {
        if (responseData.payload.length == 0) {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", true);
        } else {
            showErrorByQuerySelector(createFormLabelQuery(parentContainer.id, "countryErrorMsg"), "Enter Valid Country.", false);
        }
        countryDataArr.countries = responseData.payload;
        $(parentContainer).find("#autoFillCountrires").html("");
        responseData.payload.forEach(function(response, index) {

            var li = document.createElement("li");
            li.innerText = response.countryName;
            if (index == 0) {
                li.className = "active";
            }

            li.setAttribute("data-cregion", response.countryName);
            li.setAttribute("data-ccode", response.countryShortCode);
            li.addEventListener("click", function(e) {
                storeCountry("travelCountries", e, parentContainer);
                countryDataArr.countries = countryDataArr.countries.filter(function(countryData) {
                    return (countryData.countryShortCode != response.countryShortCode)
                })
            })
            $(parentContainer).find("#autoFillCountrires").append(li);
        })

    }).catch(function(err) {
        toggleLoader(false);
    })
}
